<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8 Competitor Methods | Creating the cssr R package</title>
  <meta name="description" content="8 Competitor Methods | Creating the cssr R package" />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="8 Competitor Methods | Creating the cssr R package" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8 Competitor Methods | Creating the cssr R package" />
  
  
  

<meta name="author" content="Gregory Faletto" />


<meta name="date" content="2023-01-30" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="wrapper-functions.html"/>
<link rel="next" href="documenting-the-package-and-adding-readme.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="overview.html"><a href="overview.html"><i class="fa fa-check"></i><b>2</b> Overview</a>
<ul>
<li class="chapter" data-level="2.1" data-path="overview.html"><a href="overview.html#background"><i class="fa fa-check"></i><b>2.1</b> Background</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="overview.html"><a href="overview.html#cpss"><i class="fa fa-check"></i><b>2.1.1</b> Complementary pairs stability selection</a></li>
<li class="chapter" data-level="2.1.2" data-path="overview.html"><a href="overview.html#cluster-stability-selection"><i class="fa fa-check"></i><b>2.1.2</b> Cluster stability selection</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="overview.html"><a href="overview.html#outline"><i class="fa fa-check"></i><b>2.2</b> Outline</a></li>
<li class="chapter" data-level="2.3" data-path="overview.html"><a href="overview.html#package-setup"><i class="fa fa-check"></i><b>2.3</b> Package setup</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="css.html"><a href="css.html"><i class="fa fa-check"></i><b>3</b> The core function: <code>css</code></a>
<ul>
<li class="chapter" data-level="3.1" data-path="css.html"><a href="css.html#main-components-of-css"><i class="fa fa-check"></i><b>3.1</b> Main components of <code>css</code></a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="css.html"><a href="css.html#generating-subsamples"><i class="fa fa-check"></i><b>3.1.1</b> Generating subsamples</a></li>
<li class="chapter" data-level="3.1.2" data-path="css.html"><a href="css.html#forming-selection-matrices"><i class="fa fa-check"></i><b>3.1.2</b> Forming selection matrices</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="css.html"><a href="css.html#helper-functions"><i class="fa fa-check"></i><b>3.2</b> Helper functions</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="tests-for-main-functions-in-cssr.html"><a href="tests-for-main-functions-in-cssr.html"><i class="fa fa-check"></i><b>4</b> Tests for main functions in <code>cssr</code></a></li>
<li class="chapter" data-level="5" data-path="sel-and-pred.html"><a href="sel-and-pred.html"><i class="fa fa-check"></i><b>5</b> Selection and prediction functions</a></li>
<li class="chapter" data-level="6" data-path="other-useful.html"><a href="other-useful.html"><i class="fa fa-check"></i><b>6</b> Other useful functions</a></li>
<li class="chapter" data-level="7" data-path="wrapper-functions.html"><a href="wrapper-functions.html"><i class="fa fa-check"></i><b>7</b> Convenient wrapper functions</a></li>
<li class="chapter" data-level="8" data-path="competitor-methods.html"><a href="competitor-methods.html"><i class="fa fa-check"></i><b>8</b> Competitor Methods</a></li>
<li class="chapter" data-level="9" data-path="documenting-the-package-and-adding-readme.html"><a href="documenting-the-package-and-adding-readme.html"><i class="fa fa-check"></i><b>9</b> Documenting the package and adding README</a>
<ul>
<li class="chapter" data-level="9.1" data-path="documenting-the-package-and-adding-readme.html"><a href="documenting-the-package-and-adding-readme.html#add-readme"><i class="fa fa-check"></i><b>9.1</b> Add README</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Creating the <code>cssr</code> R package</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="competitor-methods" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">8</span> Competitor Methods<a href="competitor-methods.html#competitor-methods" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>We also provide implementations of some competitor feature selection methods. We used these in the simulation studies in our paper to compare cluster stability selection to the protolasso (Redi and Tibshirani, 2016) and the cluster representative lasso (Bühlmann et. al. 2013), two other feature selection methods that are designed for data with clustered features. These feature selection methods are in some ways closely related, so their implementations share helper functions.</p>
<ul>
<li><code><a href='competitor-methods.html#protolasso'>protolasso</a>()</code>
<ul>
<li><code><a href='competitor-methods.html#processClusterLassoInputs'>processClusterLassoInputs</a>()</code> checks and formats the function inputs</li>
<li><code><a href='competitor-methods.html#getXglmnet'>getXglmnet</a>()</code> formats the provided design matrix <code>Xglmnet</code> for the lasso as implemented by <code>glmnet</code> (for the protolasso, this means discarding all features from each cluster except the one most highly correlated with the response; for the cluster representative lasso, this means replacing the clustered features with a simple average of the cluster members).
<ul>
<li><code><a href='competitor-methods.html#checkGetXglmnetInputs'>checkGetXglmnetInputs</a>()</code> verifies the inputs to <code><a href='competitor-methods.html#getXglmnet'>getXglmnet</a>()</code></li>
</ul></li>
<li>Finally, <code><a href='competitor-methods.html#getClusterSelsFromGlmnet'>getClusterSelsFromGlmnet</a>()</code> extracts the relevant output from the results yielded by a <code>glmnet</code> lasso fit.
<ul>
<li><code><a href='competitor-methods.html#getSelectedSets'>getSelectedSets</a>()</code> takes in a single selected set from <code>Xglmnet</code> and yields a selected feature set in the original feature space (with each selected cluster from <code>Xglmnet</code> replaced by its prototype) as well as a selected set of clusters.</li>
</ul></li>
</ul></li>
<li><code><a href='competitor-methods.html#clusterRepLasso'>clusterRepLasso</a>()</code></li>
</ul>
<p><code><a href='competitor-methods.html#protolasso'>protolasso</a>()</code>:</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="competitor-methods.html#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Select features via the protolasso (Reid and Tibshirani 2016)</span></span>
<span id="cb165-2"><a href="competitor-methods.html#cb165-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb165-3"><a href="competitor-methods.html#cb165-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param X An n x p numeric matrix (preferably) or a data.frame (which will</span></span>
<span id="cb165-4"><a href="competitor-methods.html#cb165-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; be coerced internally to a matrix by the function model.matrix) containing</span></span>
<span id="cb165-5"><a href="competitor-methods.html#cb165-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; p &gt;= 2 features/predictors</span></span>
<span id="cb165-6"><a href="competitor-methods.html#cb165-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param y The response; A length n numeric (or integer) real-valued vector.</span></span>
<span id="cb165-7"><a href="competitor-methods.html#cb165-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param clusters A list of integer vectors; each vector should contain the </span></span>
<span id="cb165-8"><a href="competitor-methods.html#cb165-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; indices of a cluster of features (a subset of 1:p). (If there is only one</span></span>
<span id="cb165-9"><a href="competitor-methods.html#cb165-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; cluster, clusters can either be a list of length 1 or an integer vector.)</span></span>
<span id="cb165-10"><a href="competitor-methods.html#cb165-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; All of the provided clusters must be non-overlapping. Every feature not</span></span>
<span id="cb165-11"><a href="competitor-methods.html#cb165-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; appearing in any cluster will be assumed to be unclustered (that is, they</span></span>
<span id="cb165-12"><a href="competitor-methods.html#cb165-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; will be treated as if they are in a &quot;cluster&quot; containing only themselves).</span></span>
<span id="cb165-13"><a href="competitor-methods.html#cb165-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Default is list() (so no clusters are specified).</span></span>
<span id="cb165-14"><a href="competitor-methods.html#cb165-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param nlambda Integer; the number of lambda values to use in the lasso fit</span></span>
<span id="cb165-15"><a href="competitor-methods.html#cb165-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; for the protolasso. Default is 100 (following the default for glmnet). For</span></span>
<span id="cb165-16"><a href="competitor-methods.html#cb165-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; now, nlambda must be at least 2 (using a single lambda is not supported).</span></span>
<span id="cb165-17"><a href="competitor-methods.html#cb165-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return A list with three elements. \item{selected_sets}{A list of integer</span></span>
<span id="cb165-18"><a href="competitor-methods.html#cb165-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; vectors. Entry k of this list contains a selected set (an integer vector) of</span></span>
<span id="cb165-19"><a href="competitor-methods.html#cb165-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; size k yielded by the protolasso (If no set of size k was selected, entry k</span></span>
<span id="cb165-20"><a href="competitor-methods.html#cb165-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; will be empty.)} \item{selected_clusts_list}{A list; each element of the list</span></span>
<span id="cb165-21"><a href="competitor-methods.html#cb165-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; is a named list of selected clusters. (That is, if a selected set of size k</span></span>
<span id="cb165-22"><a href="competitor-methods.html#cb165-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; was yielded by the protolasso, then selected_clusts_list[[k]] is a named</span></span>
<span id="cb165-23"><a href="competitor-methods.html#cb165-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; list of length k, where each member of the list is an integer vector</span></span>
<span id="cb165-24"><a href="competitor-methods.html#cb165-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; of cluster members. In particular, selected_clusts_lists[[k]][[j]] will be</span></span>
<span id="cb165-25"><a href="competitor-methods.html#cb165-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the cluster that contains feature selected_sets[[k]][j].)} \item{beta}{The</span></span>
<span id="cb165-26"><a href="competitor-methods.html#cb165-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; beta output from glmnet when the lasso was estimated on a matrix of</span></span>
<span id="cb165-27"><a href="competitor-methods.html#cb165-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; prototypes. (See documentation for the function glmnet from the glmnet</span></span>
<span id="cb165-28"><a href="competitor-methods.html#cb165-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; package for details.)}</span></span>
<span id="cb165-29"><a href="competitor-methods.html#cb165-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @author Gregory Faletto, Jacob Bien</span></span>
<span id="cb165-30"><a href="competitor-methods.html#cb165-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @references Reid, S., &amp; Tibshirani, R. (2016). Sparse regression and marginal</span></span>
<span id="cb165-31"><a href="competitor-methods.html#cb165-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; testing using cluster prototypes. \emph{Biostatistics}, 17(2), 364–376.</span></span>
<span id="cb165-32"><a href="competitor-methods.html#cb165-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; \url{https://doi.org/10.1093/biostatistics/kxv049}.</span></span>
<span id="cb165-33"><a href="competitor-methods.html#cb165-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @export</span></span>
<span id="cb165-34"><a href="competitor-methods.html#cb165-34" aria-hidden="true" tabindex="-1"></a><span id='protolasso'>protolasso</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(X, y, clusters, <span class="at">nlambda=</span><span class="dv">100</span>){</span>
<span id="cb165-35"><a href="competitor-methods.html#cb165-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-36"><a href="competitor-methods.html#cb165-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Handle and format inputs; get cluster prototypes</span></span>
<span id="cb165-37"><a href="competitor-methods.html#cb165-37" aria-hidden="true" tabindex="-1"></a>    ret <span class="ot">&lt;-</span> <a href='competitor-methods.html#processClusterLassoInputs'>processClusterLassoInputs</a>(X, y, clusters, nlambda)</span>
<span id="cb165-38"><a href="competitor-methods.html#cb165-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-39"><a href="competitor-methods.html#cb165-39" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> ret<span class="sc">$</span>x</span>
<span id="cb165-40"><a href="competitor-methods.html#cb165-40" aria-hidden="true" tabindex="-1"></a>    clusters <span class="ot">&lt;-</span> ret<span class="sc">$</span>clusters</span>
<span id="cb165-41"><a href="competitor-methods.html#cb165-41" aria-hidden="true" tabindex="-1"></a>    prototypes <span class="ot">&lt;-</span> ret<span class="sc">$</span>prototypes</span>
<span id="cb165-42"><a href="competitor-methods.html#cb165-42" aria-hidden="true" tabindex="-1"></a>    feat_names <span class="ot">&lt;-</span> ret<span class="sc">$</span>var_names</span>
<span id="cb165-43"><a href="competitor-methods.html#cb165-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-44"><a href="competitor-methods.html#cb165-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rm</span>(ret)</span>
<span id="cb165-45"><a href="competitor-methods.html#cb165-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-46"><a href="competitor-methods.html#cb165-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Format the design matrix for glmnet according to the protolasso procedure</span></span>
<span id="cb165-47"><a href="competitor-methods.html#cb165-47" aria-hidden="true" tabindex="-1"></a>    X_glmnet <span class="ot">&lt;-</span> <a href='competitor-methods.html#getXglmnet'>getXglmnet</a>(x, clusters, <span class="at">type=</span><span class="st">&quot;protolasso&quot;</span>,</span>
<span id="cb165-48"><a href="competitor-methods.html#cb165-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">prototypes=</span>prototypes)</span>
<span id="cb165-49"><a href="competitor-methods.html#cb165-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-50"><a href="competitor-methods.html#cb165-50" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Estimate the lasso on the cluster prototypes</span></span>
<span id="cb165-51"><a href="competitor-methods.html#cb165-51" aria-hidden="true" tabindex="-1"></a>    fit <span class="ot">&lt;-</span> glmnet<span class="sc">::</span><span class="fu">glmnet</span>(<span class="at">x=</span>X_glmnet, <span class="at">y=</span>y, <span class="at">family=</span><span class="st">&quot;gaussian&quot;</span>, <span class="at">nlambda=</span>nlambda)</span>
<span id="cb165-52"><a href="competitor-methods.html#cb165-52" aria-hidden="true" tabindex="-1"></a>    lasso_sets <span class="ot">&lt;-</span> <span class="fu">unique</span>(glmnet<span class="sc">::</span><span class="fu">predict.glmnet</span>(fit, <span class="at">type=</span><span class="st">&quot;nonzero&quot;</span>))</span>
<span id="cb165-53"><a href="competitor-methods.html#cb165-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-54"><a href="competitor-methods.html#cb165-54" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Finally, obtain a tidy list of selected sets--one for each model size</span></span>
<span id="cb165-55"><a href="competitor-methods.html#cb165-55" aria-hidden="true" tabindex="-1"></a>    cluster_sel_results <span class="ot">&lt;-</span> <a href='competitor-methods.html#getClusterSelsFromGlmnet'>getClusterSelsFromGlmnet</a>(lasso_sets, clusters,</span>
<span id="cb165-56"><a href="competitor-methods.html#cb165-56" aria-hidden="true" tabindex="-1"></a>        prototypes, feat_names)</span>
<span id="cb165-57"><a href="competitor-methods.html#cb165-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-58"><a href="competitor-methods.html#cb165-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">selected_sets=</span>cluster_sel_results<span class="sc">$</span>selected_sets,</span>
<span id="cb165-59"><a href="competitor-methods.html#cb165-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">selected_clusts_list=</span>cluster_sel_results<span class="sc">$</span>selected_clusts_list,</span>
<span id="cb165-60"><a href="competitor-methods.html#cb165-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">beta=</span>fit<span class="sc">$</span>beta))</span>
<span id="cb165-61"><a href="competitor-methods.html#cb165-61" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><code><a href='competitor-methods.html#processClusterLassoInputs'>processClusterLassoInputs</a>()</code>:</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="competitor-methods.html#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Check the inputs to protolasso and clusterRepLasso, format clusters, and</span></span>
<span id="cb166-2"><a href="competitor-methods.html#cb166-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; identify prototypes for each cluster</span></span>
<span id="cb166-3"><a href="competitor-methods.html#cb166-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb166-4"><a href="competitor-methods.html#cb166-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param X An n x p numeric matrix (preferably) or a data.frame (which will</span></span>
<span id="cb166-5"><a href="competitor-methods.html#cb166-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; be coerced internally to a matrix by the function model.matrix) containing</span></span>
<span id="cb166-6"><a href="competitor-methods.html#cb166-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; p &gt;= 2 features/predictors</span></span>
<span id="cb166-7"><a href="competitor-methods.html#cb166-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param y The response; A length n numeric (or integer) real-valued vector.</span></span>
<span id="cb166-8"><a href="competitor-methods.html#cb166-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param clusters A list of integer vectors; each vector should contain the </span></span>
<span id="cb166-9"><a href="competitor-methods.html#cb166-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; indices of a cluster of features (a subset of 1:p). (If there is only one</span></span>
<span id="cb166-10"><a href="competitor-methods.html#cb166-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; cluster, clusters can either be a list of length 1 or an integer vector.)</span></span>
<span id="cb166-11"><a href="competitor-methods.html#cb166-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; All of the provided clusters must be non-overlapping. Every feature not</span></span>
<span id="cb166-12"><a href="competitor-methods.html#cb166-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; appearing in any cluster will be assumed to be unclustered (that is, they</span></span>
<span id="cb166-13"><a href="competitor-methods.html#cb166-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; will be treated as if they are in a &quot;cluster&quot; containing only themselves).</span></span>
<span id="cb166-14"><a href="competitor-methods.html#cb166-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Default is list() (so no clusters are specified).</span></span>
<span id="cb166-15"><a href="competitor-methods.html#cb166-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param nlambda Integer; the number of lambda values to use in the lasso fit</span></span>
<span id="cb166-16"><a href="competitor-methods.html#cb166-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; for the protolasso. Default is 100 (following the default for glmnet). For</span></span>
<span id="cb166-17"><a href="competitor-methods.html#cb166-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; now, nlambda must be at least 2 (using a single lambda is not supported).</span></span>
<span id="cb166-18"><a href="competitor-methods.html#cb166-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return A list with four elements. \item{x}{The provided X, converted to a</span></span>
<span id="cb166-19"><a href="competitor-methods.html#cb166-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; matrix if it was provided as a data.frame, and with column names removed.}</span></span>
<span id="cb166-20"><a href="competitor-methods.html#cb166-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; \item{clusters}{A named list where each entry is an integer vector of indices</span></span>
<span id="cb166-21"><a href="competitor-methods.html#cb166-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; of features that are in a common cluster. (The length of list clusters is</span></span>
<span id="cb166-22"><a href="competitor-methods.html#cb166-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; equal to the number of clusters.) All identified clusters are</span></span>
<span id="cb166-23"><a href="competitor-methods.html#cb166-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; non-overlapping. All features appear in exactly one cluster (any unclustered</span></span>
<span id="cb166-24"><a href="competitor-methods.html#cb166-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; features will be put in their own &quot;cluster&quot; of size 1).}</span></span>
<span id="cb166-25"><a href="competitor-methods.html#cb166-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; \item{prototypes}{An integer vector whose length is equal to the number of</span></span>
<span id="cb166-26"><a href="competitor-methods.html#cb166-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; clusters. Entry i is the index of the feature belonging to cluster i that is</span></span>
<span id="cb166-27"><a href="competitor-methods.html#cb166-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; most highly correlated with y (that is, the prototype for the cluster, as in</span></span>
<span id="cb166-28"><a href="competitor-methods.html#cb166-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the protolasso; see Reid and Tibshirani 2016).} \item{var_names}{If the</span></span>
<span id="cb166-29"><a href="competitor-methods.html#cb166-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; provided X matrix had column names, the names of the featurrs in the provided</span></span>
<span id="cb166-30"><a href="competitor-methods.html#cb166-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; X matrix. If no names were provided, feat_names will be NA.}</span></span>
<span id="cb166-31"><a href="competitor-methods.html#cb166-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @author Gregory Faletto, Jacob Bien</span></span>
<span id="cb166-32"><a href="competitor-methods.html#cb166-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @references Reid, S., &amp; Tibshirani, R. (2016). Sparse regression and marginal</span></span>
<span id="cb166-33"><a href="competitor-methods.html#cb166-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; testing using cluster prototypes. \emph{Biostatistics}, 17(2), 364–376.</span></span>
<span id="cb166-34"><a href="competitor-methods.html#cb166-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; \url{https://doi.org/10.1093/biostatistics/kxv049}.</span></span>
<span id="cb166-35"><a href="competitor-methods.html#cb166-35" aria-hidden="true" tabindex="-1"></a><span id='processClusterLassoInputs'>processClusterLassoInputs</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(X, y, clusters, nlambda){</span>
<span id="cb166-36"><a href="competitor-methods.html#cb166-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-37"><a href="competitor-methods.html#cb166-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.matrix</span>(X) <span class="sc">|</span> <span class="fu">is.data.frame</span>(X))</span>
<span id="cb166-38"><a href="competitor-methods.html#cb166-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-39"><a href="competitor-methods.html#cb166-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if x is a matrix; if it&#39;s a data.frame, convert to matrix.</span></span>
<span id="cb166-40"><a href="competitor-methods.html#cb166-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">is.data.frame</span>(X)){</span>
<span id="cb166-41"><a href="competitor-methods.html#cb166-41" aria-hidden="true" tabindex="-1"></a>        X <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">model.matrix</span>(<span class="sc">~</span> ., X)</span>
<span id="cb166-42"><a href="competitor-methods.html#cb166-42" aria-hidden="true" tabindex="-1"></a>        X <span class="ot">&lt;-</span> X[, <span class="fu">colnames</span>(X) <span class="sc">!=</span> <span class="st">&quot;(Intercept)&quot;</span>]</span>
<span id="cb166-43"><a href="competitor-methods.html#cb166-43" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb166-44"><a href="competitor-methods.html#cb166-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-45"><a href="competitor-methods.html#cb166-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.matrix</span>(X))</span>
<span id="cb166-46"><a href="competitor-methods.html#cb166-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(X)))</span>
<span id="cb166-47"><a href="competitor-methods.html#cb166-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-48"><a href="competitor-methods.html#cb166-48" aria-hidden="true" tabindex="-1"></a>    feat_names <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="cn">NA</span>)</span>
<span id="cb166-49"><a href="competitor-methods.html#cb166-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(<span class="fu">colnames</span>(X))){</span>
<span id="cb166-50"><a href="competitor-methods.html#cb166-50" aria-hidden="true" tabindex="-1"></a>        feat_names <span class="ot">&lt;-</span> <span class="fu">colnames</span>(X)</span>
<span id="cb166-51"><a href="competitor-methods.html#cb166-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="fu">any</span>(<span class="fu">is.na</span>(feat_names))){</span>
<span id="cb166-52"><a href="competitor-methods.html#cb166-52" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stop</span>(<span class="st">&quot;Some features in provided X matrix had valid names and some had NA names; please neither name all features in X or remove the names altogether.&quot;</span>)</span>
<span id="cb166-53"><a href="competitor-methods.html#cb166-53" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb166-54"><a href="competitor-methods.html#cb166-54" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb166-55"><a href="competitor-methods.html#cb166-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-56"><a href="competitor-methods.html#cb166-56" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(X)</span>
<span id="cb166-57"><a href="competitor-methods.html#cb166-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-58"><a href="competitor-methods.html#cb166-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(X) <span class="ot">&lt;-</span> <span class="fu">character</span>()</span>
<span id="cb166-59"><a href="competitor-methods.html#cb166-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-60"><a href="competitor-methods.html#cb166-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.numeric</span>(y) <span class="sc">|</span> <span class="fu">is.integer</span>(y))</span>
<span id="cb166-61"><a href="competitor-methods.html#cb166-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(n <span class="sc">==</span> <span class="fu">length</span>(y))</span>
<span id="cb166-62"><a href="competitor-methods.html#cb166-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(y)))</span>
<span id="cb166-63"><a href="competitor-methods.html#cb166-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-64"><a href="competitor-methods.html#cb166-64" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check clusters argument</span></span>
<span id="cb166-65"><a href="competitor-methods.html#cb166-65" aria-hidden="true" tabindex="-1"></a>    clusters <span class="ot">&lt;-</span> <a href='css.html#checkCssClustersInput'>checkCssClustersInput</a>(clusters)</span>
<span id="cb166-66"><a href="competitor-methods.html#cb166-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-67"><a href="competitor-methods.html#cb166-67" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Format clusters into a list where all features are in exactly one</span></span>
<span id="cb166-68"><a href="competitor-methods.html#cb166-68" aria-hidden="true" tabindex="-1"></a>    <span class="co"># cluster (any unclustered features are put in their own &quot;cluster&quot; of size</span></span>
<span id="cb166-69"><a href="competitor-methods.html#cb166-69" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 1).</span></span>
<span id="cb166-70"><a href="competitor-methods.html#cb166-70" aria-hidden="true" tabindex="-1"></a>    clust_names <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="cn">NA</span>)</span>
<span id="cb166-71"><a href="competitor-methods.html#cb166-71" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(<span class="fu">names</span>(clusters)) <span class="sc">&amp;</span> <span class="fu">is.list</span>(clusters)){</span>
<span id="cb166-72"><a href="competitor-methods.html#cb166-72" aria-hidden="true" tabindex="-1"></a>        clust_names <span class="ot">&lt;-</span> <span class="fu">names</span>(clusters)</span>
<span id="cb166-73"><a href="competitor-methods.html#cb166-73" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb166-74"><a href="competitor-methods.html#cb166-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-75"><a href="competitor-methods.html#cb166-75" aria-hidden="true" tabindex="-1"></a>    cluster_results <span class="ot">&lt;-</span> <a href='css.html#formatClusters'>formatClusters</a>(clusters, <span class="at">p=</span><span class="fu">ncol</span>(X),</span>
<span id="cb166-76"><a href="competitor-methods.html#cb166-76" aria-hidden="true" tabindex="-1"></a>        <span class="at">clust_names=</span>clust_names, <span class="at">get_prototypes=</span><span class="cn">TRUE</span>, <span class="at">x=</span>X, <span class="at">y=</span>y)</span>
<span id="cb166-77"><a href="competitor-methods.html#cb166-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-78"><a href="competitor-methods.html#cb166-78" aria-hidden="true" tabindex="-1"></a>    clusters <span class="ot">&lt;-</span> cluster_results<span class="sc">$</span>clusters</span>
<span id="cb166-79"><a href="competitor-methods.html#cb166-79" aria-hidden="true" tabindex="-1"></a>    prototypes <span class="ot">&lt;-</span> cluster_results<span class="sc">$</span>prototypes</span>
<span id="cb166-80"><a href="competitor-methods.html#cb166-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-81"><a href="competitor-methods.html#cb166-81" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rm</span>(cluster_results)</span>
<span id="cb166-82"><a href="competitor-methods.html#cb166-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-83"><a href="competitor-methods.html#cb166-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(clusters) <span class="sc">==</span> <span class="fu">length</span>(prototypes))</span>
<span id="cb166-84"><a href="competitor-methods.html#cb166-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-85"><a href="competitor-methods.html#cb166-85" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.numeric</span>(nlambda) <span class="sc">|</span> <span class="fu">is.integer</span>(nlambda))</span>
<span id="cb166-86"><a href="competitor-methods.html#cb166-86" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(nlambda) <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb166-87"><a href="competitor-methods.html#cb166-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="sc">!</span><span class="fu">is.na</span>(nlambda))</span>
<span id="cb166-88"><a href="competitor-methods.html#cb166-88" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(nlambda <span class="sc">&gt;=</span> <span class="dv">2</span>)</span>
<span id="cb166-89"><a href="competitor-methods.html#cb166-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-90"><a href="competitor-methods.html#cb166-90" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>X, <span class="at">clusters=</span>clusters, <span class="at">prototypes=</span>prototypes,</span>
<span id="cb166-91"><a href="competitor-methods.html#cb166-91" aria-hidden="true" tabindex="-1"></a>        <span class="at">var_names=</span>feat_names))</span>
<span id="cb166-92"><a href="competitor-methods.html#cb166-92" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Tests for <code><a href='competitor-methods.html#processClusterLassoInputs'>processClusterLassoInputs</a>()</code>:</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="competitor-methods.html#cb167-1" aria-hidden="true" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">test_that</span>(<span class="st">&quot;processClusterLassoInputs works&quot;</span>, {</span>
<span id="cb167-2"><a href="competitor-methods.html#cb167-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">82612</span>)</span>
<span id="cb167-3"><a href="competitor-methods.html#cb167-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb167-4"><a href="competitor-methods.html#cb167-4" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">15</span><span class="sc">*</span><span class="dv">11</span>), <span class="at">nrow=</span><span class="dv">15</span>, <span class="at">ncol=</span><span class="dv">11</span>)</span>
<span id="cb167-5"><a href="competitor-methods.html#cb167-5" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">15</span>)</span>
<span id="cb167-6"><a href="competitor-methods.html#cb167-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb167-7"><a href="competitor-methods.html#cb167-7" aria-hidden="true" tabindex="-1"></a>  good_clusters <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">red_cluster=</span>1L<span class="sc">:</span>4L, <span class="at">green_cluster=</span>5L<span class="sc">:</span>8L)</span>
<span id="cb167-8"><a href="competitor-methods.html#cb167-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-9"><a href="competitor-methods.html#cb167-9" aria-hidden="true" tabindex="-1"></a>  ret <span class="ot">&lt;-</span> <a href='competitor-methods.html#processClusterLassoInputs'>processClusterLassoInputs</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">clusters=</span>good_clusters, <span class="at">nlambda=</span><span class="dv">10</span>)</span>
<span id="cb167-10"><a href="competitor-methods.html#cb167-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-11"><a href="competitor-methods.html#cb167-11" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(ret))</span>
<span id="cb167-12"><a href="competitor-methods.html#cb167-12" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(ret), <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;clusters&quot;</span>, <span class="st">&quot;prototypes&quot;</span>,</span>
<span id="cb167-13"><a href="competitor-methods.html#cb167-13" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">&quot;var_names&quot;</span>))</span>
<span id="cb167-14"><a href="competitor-methods.html#cb167-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb167-15"><a href="competitor-methods.html#cb167-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># X</span></span>
<span id="cb167-16"><a href="competitor-methods.html#cb167-16" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(ret<span class="sc">$</span>x))</span>
<span id="cb167-17"><a href="competitor-methods.html#cb167-17" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(ret<span class="sc">$</span>x)))</span>
<span id="cb167-18"><a href="competitor-methods.html#cb167-18" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(ret<span class="sc">$</span>x))</span>
<span id="cb167-19"><a href="competitor-methods.html#cb167-19" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">ncol</span>(ret<span class="sc">$</span>x), <span class="dv">11</span>)</span>
<span id="cb167-20"><a href="competitor-methods.html#cb167-20" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(ret<span class="sc">$</span>x), <span class="dv">15</span>)</span>
<span id="cb167-21"><a href="competitor-methods.html#cb167-21" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">abs</span>(ret<span class="sc">$</span>x <span class="sc">-</span> x) <span class="sc">&lt;</span> <span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">9</span>)))</span>
<span id="cb167-22"><a href="competitor-methods.html#cb167-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb167-23"><a href="competitor-methods.html#cb167-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># clusters</span></span>
<span id="cb167-24"><a href="competitor-methods.html#cb167-24" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(ret<span class="sc">$</span>clusters))</span>
<span id="cb167-25"><a href="competitor-methods.html#cb167-25" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(ret<span class="sc">$</span>clusters), <span class="dv">5</span>)</span>
<span id="cb167-26"><a href="competitor-methods.html#cb167-26" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="dv">5</span>, <span class="fu">length</span>(<span class="fu">names</span>(ret<span class="sc">$</span>clusters)))</span>
<span id="cb167-27"><a href="competitor-methods.html#cb167-27" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="dv">5</span>, <span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">names</span>(ret<span class="sc">$</span>clusters))))</span>
<span id="cb167-28"><a href="competitor-methods.html#cb167-28" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="st">&quot;red_cluster&quot;</span> <span class="sc">%in%</span> <span class="fu">names</span>(ret<span class="sc">$</span>clusters))</span>
<span id="cb167-29"><a href="competitor-methods.html#cb167-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># testthat::expect_true(&quot;green_cluster&quot; %in% names(ret$clusters))</span></span>
<span id="cb167-30"><a href="competitor-methods.html#cb167-30" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">names</span>(ret<span class="sc">$</span>clusters))))</span>
<span id="cb167-31"><a href="competitor-methods.html#cb167-31" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.null</span>(<span class="fu">names</span>(ret<span class="sc">$</span>clusters))))</span>
<span id="cb167-32"><a href="competitor-methods.html#cb167-32" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">names</span>(ret<span class="sc">$</span>clusters) <span class="sc">!=</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb167-33"><a href="competitor-methods.html#cb167-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-34"><a href="competitor-methods.html#cb167-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># clust_feats &lt;- integer()</span></span>
<span id="cb167-35"><a href="competitor-methods.html#cb167-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># true_list &lt;- list(1:3, 5:8, 4, 9, 10)</span></span>
<span id="cb167-36"><a href="competitor-methods.html#cb167-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># for(i in 1:length(ret$clusters)){</span></span>
<span id="cb167-37"><a href="competitor-methods.html#cb167-37" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   testthat::expect_true(is.integer(ret$clusters[[i]]))</span></span>
<span id="cb167-38"><a href="competitor-methods.html#cb167-38" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   testthat::expect_equal(length(intersect(clust_feats, ret$clusters[[i]])), 0)</span></span>
<span id="cb167-39"><a href="competitor-methods.html#cb167-39" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   testthat::expect_true(all(ret$clusters[[i]] %in% 1:10))</span></span>
<span id="cb167-40"><a href="competitor-methods.html#cb167-40" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   testthat::expect_equal(length(ret$clusters[[i]]),</span></span>
<span id="cb167-41"><a href="competitor-methods.html#cb167-41" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                          length(unique(ret$clusters[[i]])))</span></span>
<span id="cb167-42"><a href="competitor-methods.html#cb167-42" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   testthat::expect_true(all(ret$clusters[[i]] == true_list[[i]]))</span></span>
<span id="cb167-43"><a href="competitor-methods.html#cb167-43" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   clust_feats &lt;- c(clust_feats, ret$clusters[[i]])</span></span>
<span id="cb167-44"><a href="competitor-methods.html#cb167-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># }</span></span>
<span id="cb167-45"><a href="competitor-methods.html#cb167-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb167-46"><a href="competitor-methods.html#cb167-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># testthat::expect_equal(length(clust_feats), 10)</span></span>
<span id="cb167-47"><a href="competitor-methods.html#cb167-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># testthat::expect_equal(10, length(unique(clust_feats)))</span></span>
<span id="cb167-48"><a href="competitor-methods.html#cb167-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># testthat::expect_equal(10, length(intersect(clust_feats, 1:10)))</span></span>
<span id="cb167-49"><a href="competitor-methods.html#cb167-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb167-50"><a href="competitor-methods.html#cb167-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># # prototypes</span></span>
<span id="cb167-51"><a href="competitor-methods.html#cb167-51" aria-hidden="true" tabindex="-1"></a>  <span class="co"># testthat::expect_true(is.integer(ret$prototypes))</span></span>
<span id="cb167-52"><a href="competitor-methods.html#cb167-52" aria-hidden="true" tabindex="-1"></a>  <span class="co"># testthat::expect_identical(ret$prototypes, 1:p)</span></span>
<span id="cb167-53"><a href="competitor-methods.html#cb167-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb167-54"><a href="competitor-methods.html#cb167-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># testthat::expect_equal(<a href='css.html#formatClusters'>formatClusters</a>(clusters=1:p, p=p,</span></span>
<span id="cb167-55"><a href="competitor-methods.html#cb167-55" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                             get_prototypes=TRUE, x=X,</span></span>
<span id="cb167-56"><a href="competitor-methods.html#cb167-56" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                             y=y)$prototypes, p)</span></span>
<span id="cb167-57"><a href="competitor-methods.html#cb167-57" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   </span></span>
<span id="cb167-58"><a href="competitor-methods.html#cb167-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># testthat::expect_identical(<a href='css.html#formatClusters'>formatClusters</a>(clusters=list(1L, 2L:p), p=p,</span></span>
<span id="cb167-59"><a href="competitor-methods.html#cb167-59" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                             get_prototypes=TRUE, x=X,</span></span>
<span id="cb167-60"><a href="competitor-methods.html#cb167-60" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                             y=y)$prototypes,</span></span>
<span id="cb167-61"><a href="competitor-methods.html#cb167-61" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                              as.integer(c(1, p)))</span></span>
<span id="cb167-62"><a href="competitor-methods.html#cb167-62" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   </span></span>
<span id="cb167-63"><a href="competitor-methods.html#cb167-63" aria-hidden="true" tabindex="-1"></a>  <span class="co"># testthat::expect_identical(<a href='css.html#formatClusters'>formatClusters</a>(clusters=3L:p, p=p,</span></span>
<span id="cb167-64"><a href="competitor-methods.html#cb167-64" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                             get_prototypes=TRUE, x=X,</span></span>
<span id="cb167-65"><a href="competitor-methods.html#cb167-65" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                             y=y)$prototypes,</span></span>
<span id="cb167-66"><a href="competitor-methods.html#cb167-66" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                              as.integer(c(p, 1, 2)))</span></span>
<span id="cb167-67"><a href="competitor-methods.html#cb167-67" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb167-68"><a href="competitor-methods.html#cb167-68" aria-hidden="true" tabindex="-1"></a>  <span class="co"># var_names</span></span>
<span id="cb167-69"><a href="competitor-methods.html#cb167-69" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb167-70"><a href="competitor-methods.html#cb167-70" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb167-71"><a href="competitor-methods.html#cb167-71" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb167-72"><a href="competitor-methods.html#cb167-72" aria-hidden="true" tabindex="-1"></a>  <span class="co"># # X as a data.frame</span></span>
<span id="cb167-73"><a href="competitor-methods.html#cb167-73" aria-hidden="true" tabindex="-1"></a>  <span class="co"># X_df &lt;- datasets::mtcars</span></span>
<span id="cb167-74"><a href="competitor-methods.html#cb167-74" aria-hidden="true" tabindex="-1"></a>  <span class="co"># res_fitfun &lt;- <a href='css.html#css'>css</a>(X=X_df, y=stats::rnorm(nrow(X_df)), lambda=0.01, B = 10)</span></span>
<span id="cb167-75"><a href="competitor-methods.html#cb167-75" aria-hidden="true" tabindex="-1"></a>  <span class="co"># testthat::expect_identical(class(res_fitfun), &quot;cssr&quot;)</span></span>
<span id="cb167-76"><a href="competitor-methods.html#cb167-76" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb167-77"><a href="competitor-methods.html#cb167-77" aria-hidden="true" tabindex="-1"></a>  <span class="co"># # X as a dataframe with factors (number of columns of final design matrix</span></span>
<span id="cb167-78"><a href="competitor-methods.html#cb167-78" aria-hidden="true" tabindex="-1"></a>  <span class="co"># # after one-hot encoding factors won&#39;t match number of columns of df2)</span></span>
<span id="cb167-79"><a href="competitor-methods.html#cb167-79" aria-hidden="true" tabindex="-1"></a>  <span class="co"># df2 &lt;- X_df</span></span>
<span id="cb167-80"><a href="competitor-methods.html#cb167-80" aria-hidden="true" tabindex="-1"></a>  <span class="co"># df2$cyl &lt;- as.factor(df2$cyl)</span></span>
<span id="cb167-81"><a href="competitor-methods.html#cb167-81" aria-hidden="true" tabindex="-1"></a>  <span class="co"># df2$vs &lt;- as.factor(df2$vs)</span></span>
<span id="cb167-82"><a href="competitor-methods.html#cb167-82" aria-hidden="true" tabindex="-1"></a>  <span class="co"># df2$am &lt;- as.factor(df2$am)</span></span>
<span id="cb167-83"><a href="competitor-methods.html#cb167-83" aria-hidden="true" tabindex="-1"></a>  <span class="co"># df2$gear &lt;- as.factor(df2$gear)</span></span>
<span id="cb167-84"><a href="competitor-methods.html#cb167-84" aria-hidden="true" tabindex="-1"></a>  <span class="co"># df2$carb &lt;- as.factor(df2$carb)</span></span>
<span id="cb167-85"><a href="competitor-methods.html#cb167-85" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb167-86"><a href="competitor-methods.html#cb167-86" aria-hidden="true" tabindex="-1"></a>  <span class="co"># res_fitfun &lt;- <a href='css.html#css'>css</a>(X=df2, y=stats::rnorm(nrow(X_df)), lambda=0.01, B = 10)</span></span>
<span id="cb167-87"><a href="competitor-methods.html#cb167-87" aria-hidden="true" tabindex="-1"></a>  <span class="co"># testthat::expect_identical(class(res_fitfun), &quot;cssr&quot;)</span></span>
<span id="cb167-88"><a href="competitor-methods.html#cb167-88" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb167-89"><a href="competitor-methods.html#cb167-89" aria-hidden="true" tabindex="-1"></a>  <span class="co"># # X as a matrix with column names</span></span>
<span id="cb167-90"><a href="competitor-methods.html#cb167-90" aria-hidden="true" tabindex="-1"></a>  <span class="co"># x2 &lt;- x</span></span>
<span id="cb167-91"><a href="competitor-methods.html#cb167-91" aria-hidden="true" tabindex="-1"></a>  <span class="co"># colnames(x2) &lt;- LETTERS[1:11]</span></span>
<span id="cb167-92"><a href="competitor-methods.html#cb167-92" aria-hidden="true" tabindex="-1"></a>  <span class="co"># res_names &lt;- <a href='css.html#css'>css</a>(X=x2, y=y, lambda=0.01, clusters=good_clusters, B = 13)</span></span>
<span id="cb167-93"><a href="competitor-methods.html#cb167-93" aria-hidden="true" tabindex="-1"></a>  <span class="co"># testthat::expect_identical(class(res_names), &quot;cssr&quot;)</span></span>
<span id="cb167-94"><a href="competitor-methods.html#cb167-94" aria-hidden="true" tabindex="-1"></a>  <span class="co"># testthat::expect_identical(colnames(x2), colnames(res_names$X))</span></span>
<span id="cb167-95"><a href="competitor-methods.html#cb167-95" aria-hidden="true" tabindex="-1"></a>  <span class="co"># testthat::expect_identical(colnames(x2), colnames(res_names$feat_sel_mat))</span></span>
<span id="cb167-96"><a href="competitor-methods.html#cb167-96" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb167-97"><a href="competitor-methods.html#cb167-97" aria-hidden="true" tabindex="-1"></a>  <span class="co"># # sig_clusters</span></span>
<span id="cb167-98"><a href="competitor-methods.html#cb167-98" aria-hidden="true" tabindex="-1"></a>  <span class="co"># testthat::expect_error(<a href='competitor-methods.html#processClusterLassoInputs'>processClusterLassoInputs</a>(p=19, k_unclustered=2,</span></span>
<span id="cb167-99"><a href="competitor-methods.html#cb167-99" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 cluster_size=5, n_clusters=3,</span></span>
<span id="cb167-100"><a href="competitor-methods.html#cb167-100" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 sig_clusters=&quot;2&quot;, rho=.8,</span></span>
<span id="cb167-101"><a href="competitor-methods.html#cb167-101" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 var=1.1, beta_latent=1.5,</span></span>
<span id="cb167-102"><a href="competitor-methods.html#cb167-102" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 beta_unclustered=-2, snr=1,</span></span>
<span id="cb167-103"><a href="competitor-methods.html#cb167-103" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 sigma_eps_sq=NA),</span></span>
<span id="cb167-104"><a href="competitor-methods.html#cb167-104" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                        &quot;is.numeric(sig_clusters) | is.integer(sig_clusters) is not TRUE&quot;,</span></span>
<span id="cb167-105"><a href="competitor-methods.html#cb167-105" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                        fixed=TRUE)</span></span>
<span id="cb167-106"><a href="competitor-methods.html#cb167-106" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb167-107"><a href="competitor-methods.html#cb167-107" aria-hidden="true" tabindex="-1"></a>  <span class="co"># testthat::expect_error(<a href='competitor-methods.html#processClusterLassoInputs'>processClusterLassoInputs</a>(p=19, k_unclustered=2,</span></span>
<span id="cb167-108"><a href="competitor-methods.html#cb167-108" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 cluster_size=5, n_clusters=3,</span></span>
<span id="cb167-109"><a href="competitor-methods.html#cb167-109" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 sig_clusters=4, rho=.8,</span></span>
<span id="cb167-110"><a href="competitor-methods.html#cb167-110" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 var=1.1, beta_latent=1.5,</span></span>
<span id="cb167-111"><a href="competitor-methods.html#cb167-111" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 beta_unclustered=-2, snr=1,</span></span>
<span id="cb167-112"><a href="competitor-methods.html#cb167-112" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 sigma_eps_sq=NA),</span></span>
<span id="cb167-113"><a href="competitor-methods.html#cb167-113" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                        &quot;sig_clusters &lt;= n_clusters is not TRUE&quot;, fixed=TRUE)</span></span>
<span id="cb167-114"><a href="competitor-methods.html#cb167-114" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb167-115"><a href="competitor-methods.html#cb167-115" aria-hidden="true" tabindex="-1"></a>  <span class="co"># testthat::expect_error(<a href='competitor-methods.html#processClusterLassoInputs'>processClusterLassoInputs</a>(p=19, k_unclustered=2,</span></span>
<span id="cb167-116"><a href="competitor-methods.html#cb167-116" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 cluster_size=5, n_clusters=3,</span></span>
<span id="cb167-117"><a href="competitor-methods.html#cb167-117" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 sig_clusters=-1, rho=.8,</span></span>
<span id="cb167-118"><a href="competitor-methods.html#cb167-118" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 var=1.1, beta_latent=1.5,</span></span>
<span id="cb167-119"><a href="competitor-methods.html#cb167-119" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 beta_unclustered=-2, snr=1,</span></span>
<span id="cb167-120"><a href="competitor-methods.html#cb167-120" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 sigma_eps_sq=NA),</span></span>
<span id="cb167-121"><a href="competitor-methods.html#cb167-121" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                        &quot;sig_clusters &gt;= 0 is not TRUE&quot;, fixed=TRUE)</span></span>
<span id="cb167-122"><a href="competitor-methods.html#cb167-122" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb167-123"><a href="competitor-methods.html#cb167-123" aria-hidden="true" tabindex="-1"></a>  <span class="co"># testthat::expect_error(<a href='competitor-methods.html#processClusterLassoInputs'>processClusterLassoInputs</a>(p=19, k_unclustered=2,</span></span>
<span id="cb167-124"><a href="competitor-methods.html#cb167-124" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 cluster_size=5, n_clusters=3,</span></span>
<span id="cb167-125"><a href="competitor-methods.html#cb167-125" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 sig_clusters=.6, rho=.8,</span></span>
<span id="cb167-126"><a href="competitor-methods.html#cb167-126" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 var=1.1, beta_latent=1.5,</span></span>
<span id="cb167-127"><a href="competitor-methods.html#cb167-127" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 beta_unclustered=-2, snr=1,</span></span>
<span id="cb167-128"><a href="competitor-methods.html#cb167-128" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 sigma_eps_sq=NA),</span></span>
<span id="cb167-129"><a href="competitor-methods.html#cb167-129" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                        &quot;sig_clusters == round(sig_clusters) is not TRUE&quot;,</span></span>
<span id="cb167-130"><a href="competitor-methods.html#cb167-130" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                        fixed=TRUE)</span></span>
<span id="cb167-131"><a href="competitor-methods.html#cb167-131" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb167-132"><a href="competitor-methods.html#cb167-132" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb167-133"><a href="competitor-methods.html#cb167-133" aria-hidden="true" tabindex="-1"></a>  <span class="co"># # n_clusters</span></span>
<span id="cb167-134"><a href="competitor-methods.html#cb167-134" aria-hidden="true" tabindex="-1"></a>  <span class="co"># testthat::expect_error(<a href='competitor-methods.html#processClusterLassoInputs'>processClusterLassoInputs</a>(p=19, k_unclustered=2,</span></span>
<span id="cb167-135"><a href="competitor-methods.html#cb167-135" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 cluster_size=5,</span></span>
<span id="cb167-136"><a href="competitor-methods.html#cb167-136" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 n_clusters=&quot;3&quot;,</span></span>
<span id="cb167-137"><a href="competitor-methods.html#cb167-137" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 sig_clusters=2, rho=.8,</span></span>
<span id="cb167-138"><a href="competitor-methods.html#cb167-138" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 var=1.1, beta_latent=1.5,</span></span>
<span id="cb167-139"><a href="competitor-methods.html#cb167-139" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 beta_unclustered=-2, snr=1,</span></span>
<span id="cb167-140"><a href="competitor-methods.html#cb167-140" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 sigma_eps_sq=NA),</span></span>
<span id="cb167-141"><a href="competitor-methods.html#cb167-141" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                        &quot;is.numeric(n_clusters) | is.integer(n_clusters) is not TRUE&quot;,</span></span>
<span id="cb167-142"><a href="competitor-methods.html#cb167-142" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                        fixed=TRUE)</span></span>
<span id="cb167-143"><a href="competitor-methods.html#cb167-143" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb167-144"><a href="competitor-methods.html#cb167-144" aria-hidden="true" tabindex="-1"></a>  <span class="co"># testthat::expect_error(<a href='competitor-methods.html#processClusterLassoInputs'>processClusterLassoInputs</a>(p=19, k_unclustered=2,</span></span>
<span id="cb167-145"><a href="competitor-methods.html#cb167-145" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 cluster_size=5, n_clusters=3.2,</span></span>
<span id="cb167-146"><a href="competitor-methods.html#cb167-146" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 sig_clusters=2, rho=.8,</span></span>
<span id="cb167-147"><a href="competitor-methods.html#cb167-147" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 var=1.1, beta_latent=1.5,</span></span>
<span id="cb167-148"><a href="competitor-methods.html#cb167-148" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 beta_unclustered=-2, snr=1,</span></span>
<span id="cb167-149"><a href="competitor-methods.html#cb167-149" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 sigma_eps_sq=NA),</span></span>
<span id="cb167-150"><a href="competitor-methods.html#cb167-150" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                        &quot;n_clusters == round(n_clusters) is not TRUE&quot;,</span></span>
<span id="cb167-151"><a href="competitor-methods.html#cb167-151" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                        fixed=TRUE)</span></span>
<span id="cb167-152"><a href="competitor-methods.html#cb167-152" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb167-153"><a href="competitor-methods.html#cb167-153" aria-hidden="true" tabindex="-1"></a>  <span class="co"># testthat::expect_error(<a href='competitor-methods.html#processClusterLassoInputs'>processClusterLassoInputs</a>(p=19, k_unclustered=2,</span></span>
<span id="cb167-154"><a href="competitor-methods.html#cb167-154" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 cluster_size=5, n_clusters=0,</span></span>
<span id="cb167-155"><a href="competitor-methods.html#cb167-155" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 sig_clusters=0, rho=.8,</span></span>
<span id="cb167-156"><a href="competitor-methods.html#cb167-156" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 var=1.1, beta_latent=1.5,</span></span>
<span id="cb167-157"><a href="competitor-methods.html#cb167-157" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 beta_unclustered=-2, snr=1,</span></span>
<span id="cb167-158"><a href="competitor-methods.html#cb167-158" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 sigma_eps_sq=NA),</span></span>
<span id="cb167-159"><a href="competitor-methods.html#cb167-159" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                        &quot;n_clusters &gt;= 1 is not TRUE&quot;, fixed=TRUE)</span></span>
<span id="cb167-160"><a href="competitor-methods.html#cb167-160" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb167-161"><a href="competitor-methods.html#cb167-161" aria-hidden="true" tabindex="-1"></a>  <span class="co"># testthat::expect_error(<a href='competitor-methods.html#processClusterLassoInputs'>processClusterLassoInputs</a>(p=19, k_unclustered=2,</span></span>
<span id="cb167-162"><a href="competitor-methods.html#cb167-162" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 cluster_size=.3, n_clusters=3,</span></span>
<span id="cb167-163"><a href="competitor-methods.html#cb167-163" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 sig_clusters=2, rho=.8,</span></span>
<span id="cb167-164"><a href="competitor-methods.html#cb167-164" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 var=1.1, beta_latent=1.5,</span></span>
<span id="cb167-165"><a href="competitor-methods.html#cb167-165" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 beta_unclustered=-2, snr=1,</span></span>
<span id="cb167-166"><a href="competitor-methods.html#cb167-166" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 sigma_eps_sq=NA),</span></span>
<span id="cb167-167"><a href="competitor-methods.html#cb167-167" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                        &quot;cluster_size &gt;= 1 is not TRUE&quot;, fixed=TRUE)</span></span>
<span id="cb167-168"><a href="competitor-methods.html#cb167-168" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb167-169"><a href="competitor-methods.html#cb167-169" aria-hidden="true" tabindex="-1"></a>  <span class="co"># testthat::expect_error(<a href='competitor-methods.html#processClusterLassoInputs'>processClusterLassoInputs</a>(p=16, k_unclustered=2,</span></span>
<span id="cb167-170"><a href="competitor-methods.html#cb167-170" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 cluster_size=5, n_clusters=3,</span></span>
<span id="cb167-171"><a href="competitor-methods.html#cb167-171" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 sig_clusters=2, rho=.8,</span></span>
<span id="cb167-172"><a href="competitor-methods.html#cb167-172" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 var=1.1, beta_latent=1.5,</span></span>
<span id="cb167-173"><a href="competitor-methods.html#cb167-173" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 beta_unclustered=-2, snr=1,</span></span>
<span id="cb167-174"><a href="competitor-methods.html#cb167-174" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 sigma_eps_sq=NA),</span></span>
<span id="cb167-175"><a href="competitor-methods.html#cb167-175" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                        &quot;p &gt;= n_clusters * cluster_size + k_unclustered is not TRUE&quot;,</span></span>
<span id="cb167-176"><a href="competitor-methods.html#cb167-176" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                        fixed=TRUE)</span></span>
<span id="cb167-177"><a href="competitor-methods.html#cb167-177" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb167-178"><a href="competitor-methods.html#cb167-178" aria-hidden="true" tabindex="-1"></a>  <span class="co"># testthat::expect_error(<a href='competitor-methods.html#processClusterLassoInputs'>processClusterLassoInputs</a>(p=19, k_unclustered=2,</span></span>
<span id="cb167-179"><a href="competitor-methods.html#cb167-179" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 cluster_size=5, n_clusters=3,</span></span>
<span id="cb167-180"><a href="competitor-methods.html#cb167-180" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 sig_clusters=2, rho=8,</span></span>
<span id="cb167-181"><a href="competitor-methods.html#cb167-181" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 var=1.1, beta_latent=1.5,</span></span>
<span id="cb167-182"><a href="competitor-methods.html#cb167-182" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 beta_unclustered=-2, snr=1,</span></span>
<span id="cb167-183"><a href="competitor-methods.html#cb167-183" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 sigma_eps_sq=NA),</span></span>
<span id="cb167-184"><a href="competitor-methods.html#cb167-184" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                        &quot;abs(rho) &lt;= abs(var) is not TRUE&quot;, fixed=TRUE)</span></span>
<span id="cb167-185"><a href="competitor-methods.html#cb167-185" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb167-186"><a href="competitor-methods.html#cb167-186" aria-hidden="true" tabindex="-1"></a>  <span class="co"># testthat::expect_error(<a href='competitor-methods.html#processClusterLassoInputs'>processClusterLassoInputs</a>(p=19, k_unclustered=2,</span></span>
<span id="cb167-187"><a href="competitor-methods.html#cb167-187" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 cluster_size=5, n_clusters=3,</span></span>
<span id="cb167-188"><a href="competitor-methods.html#cb167-188" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 sig_clusters=2, rho=0,</span></span>
<span id="cb167-189"><a href="competitor-methods.html#cb167-189" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 var=1.1, beta_latent=1.5,</span></span>
<span id="cb167-190"><a href="competitor-methods.html#cb167-190" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 beta_unclustered=-2, snr=1,</span></span>
<span id="cb167-191"><a href="competitor-methods.html#cb167-191" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 sigma_eps_sq=NA),</span></span>
<span id="cb167-192"><a href="competitor-methods.html#cb167-192" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                        &quot;rho != 0 is not TRUE&quot;, fixed=TRUE)</span></span>
<span id="cb167-193"><a href="competitor-methods.html#cb167-193" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb167-194"><a href="competitor-methods.html#cb167-194" aria-hidden="true" tabindex="-1"></a>  <span class="co"># testthat::expect_error(<a href='competitor-methods.html#processClusterLassoInputs'>processClusterLassoInputs</a>(p=19, k_unclustered=2,</span></span>
<span id="cb167-195"><a href="competitor-methods.html#cb167-195" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 cluster_size=5, n_clusters=3,</span></span>
<span id="cb167-196"><a href="competitor-methods.html#cb167-196" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 sig_clusters=2, rho=0.8,</span></span>
<span id="cb167-197"><a href="competitor-methods.html#cb167-197" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 var=-1.1, beta_latent=1.5,</span></span>
<span id="cb167-198"><a href="competitor-methods.html#cb167-198" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 beta_unclustered=-2, snr=1,</span></span>
<span id="cb167-199"><a href="competitor-methods.html#cb167-199" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 sigma_eps_sq=NA),</span></span>
<span id="cb167-200"><a href="competitor-methods.html#cb167-200" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                        &quot;var &gt; 0 is not TRUE&quot;, fixed=TRUE)</span></span>
<span id="cb167-201"><a href="competitor-methods.html#cb167-201" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb167-202"><a href="competitor-methods.html#cb167-202" aria-hidden="true" tabindex="-1"></a>  <span class="co"># testthat::expect_error(<a href='competitor-methods.html#processClusterLassoInputs'>processClusterLassoInputs</a>(p=19, k_unclustered=2,</span></span>
<span id="cb167-203"><a href="competitor-methods.html#cb167-203" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 cluster_size=5, n_clusters=3,</span></span>
<span id="cb167-204"><a href="competitor-methods.html#cb167-204" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 sig_clusters=2, rho=0.8,</span></span>
<span id="cb167-205"><a href="competitor-methods.html#cb167-205" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 var=1.1, beta_latent=0,</span></span>
<span id="cb167-206"><a href="competitor-methods.html#cb167-206" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 beta_unclustered=-2, snr=1,</span></span>
<span id="cb167-207"><a href="competitor-methods.html#cb167-207" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 sigma_eps_sq=NA),</span></span>
<span id="cb167-208"><a href="competitor-methods.html#cb167-208" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                        &quot;beta_latent != 0 is not TRUE&quot;, fixed=TRUE)</span></span>
<span id="cb167-209"><a href="competitor-methods.html#cb167-209" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb167-210"><a href="competitor-methods.html#cb167-210" aria-hidden="true" tabindex="-1"></a>  <span class="co"># testthat::expect_error(<a href='competitor-methods.html#processClusterLassoInputs'>processClusterLassoInputs</a>(p=19, k_unclustered=2,</span></span>
<span id="cb167-211"><a href="competitor-methods.html#cb167-211" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 cluster_size=5, n_clusters=3,</span></span>
<span id="cb167-212"><a href="competitor-methods.html#cb167-212" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 sig_clusters=2, rho=0.8,</span></span>
<span id="cb167-213"><a href="competitor-methods.html#cb167-213" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 var=1.1, beta_latent=1.5,</span></span>
<span id="cb167-214"><a href="competitor-methods.html#cb167-214" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 beta_unclustered=0, snr=1,</span></span>
<span id="cb167-215"><a href="competitor-methods.html#cb167-215" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 sigma_eps_sq=NA),</span></span>
<span id="cb167-216"><a href="competitor-methods.html#cb167-216" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                        &quot;beta_unclustered != 0 is not TRUE&quot;, fixed=TRUE)</span></span>
<span id="cb167-217"><a href="competitor-methods.html#cb167-217" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb167-218"><a href="competitor-methods.html#cb167-218" aria-hidden="true" tabindex="-1"></a>  <span class="co"># # k_unclustered</span></span>
<span id="cb167-219"><a href="competitor-methods.html#cb167-219" aria-hidden="true" tabindex="-1"></a>  <span class="co"># testthat::expect_error(<a href='competitor-methods.html#processClusterLassoInputs'>processClusterLassoInputs</a>(p=19, k_unclustered=&quot;2&quot;,</span></span>
<span id="cb167-220"><a href="competitor-methods.html#cb167-220" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 cluster_size=5, n_clusters=3,</span></span>
<span id="cb167-221"><a href="competitor-methods.html#cb167-221" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 sig_clusters=2, rho=0.8,</span></span>
<span id="cb167-222"><a href="competitor-methods.html#cb167-222" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 var=1.1, beta_latent=1.5,</span></span>
<span id="cb167-223"><a href="competitor-methods.html#cb167-223" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 beta_unclustered=-2, snr=1,</span></span>
<span id="cb167-224"><a href="competitor-methods.html#cb167-224" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 sigma_eps_sq=NA),</span></span>
<span id="cb167-225"><a href="competitor-methods.html#cb167-225" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                        &quot;is.numeric(k_unclustered) | is.integer(k_unclustered) is not TRUE&quot;,</span></span>
<span id="cb167-226"><a href="competitor-methods.html#cb167-226" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                        fixed=TRUE)</span></span>
<span id="cb167-227"><a href="competitor-methods.html#cb167-227" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb167-228"><a href="competitor-methods.html#cb167-228" aria-hidden="true" tabindex="-1"></a>  <span class="co"># testthat::expect_error(<a href='competitor-methods.html#processClusterLassoInputs'>processClusterLassoInputs</a>(p=19, k_unclustered=-2,</span></span>
<span id="cb167-229"><a href="competitor-methods.html#cb167-229" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 cluster_size=5, n_clusters=3,</span></span>
<span id="cb167-230"><a href="competitor-methods.html#cb167-230" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 sig_clusters=2, rho=0.8,</span></span>
<span id="cb167-231"><a href="competitor-methods.html#cb167-231" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 var=1.1, beta_latent=1.5,</span></span>
<span id="cb167-232"><a href="competitor-methods.html#cb167-232" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 beta_unclustered=-2, snr=1,</span></span>
<span id="cb167-233"><a href="competitor-methods.html#cb167-233" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 sigma_eps_sq=NA),</span></span>
<span id="cb167-234"><a href="competitor-methods.html#cb167-234" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                        &quot;k_unclustered &gt;= 0 is not TRUE&quot;, fixed=TRUE)</span></span>
<span id="cb167-235"><a href="competitor-methods.html#cb167-235" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb167-236"><a href="competitor-methods.html#cb167-236" aria-hidden="true" tabindex="-1"></a>  <span class="co"># testthat::expect_error(<a href='competitor-methods.html#processClusterLassoInputs'>processClusterLassoInputs</a>(p=19, k_unclustered=.2,</span></span>
<span id="cb167-237"><a href="competitor-methods.html#cb167-237" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 cluster_size=5, n_clusters=3,</span></span>
<span id="cb167-238"><a href="competitor-methods.html#cb167-238" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 sig_clusters=2, rho=0.8,</span></span>
<span id="cb167-239"><a href="competitor-methods.html#cb167-239" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 var=1.1, beta_latent=1.5,</span></span>
<span id="cb167-240"><a href="competitor-methods.html#cb167-240" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 beta_unclustered=-2, snr=1,</span></span>
<span id="cb167-241"><a href="competitor-methods.html#cb167-241" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 sigma_eps_sq=NA),</span></span>
<span id="cb167-242"><a href="competitor-methods.html#cb167-242" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                        &quot;k_unclustered == round(k_unclustered) is not TRUE&quot;,</span></span>
<span id="cb167-243"><a href="competitor-methods.html#cb167-243" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                        fixed=TRUE)</span></span>
<span id="cb167-244"><a href="competitor-methods.html#cb167-244" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb167-245"><a href="competitor-methods.html#cb167-245" aria-hidden="true" tabindex="-1"></a>  <span class="co"># testthat::expect_error(<a href='competitor-methods.html#processClusterLassoInputs'>processClusterLassoInputs</a>(p=19, k_unclustered=2,</span></span>
<span id="cb167-246"><a href="competitor-methods.html#cb167-246" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 cluster_size=5, n_clusters=3,</span></span>
<span id="cb167-247"><a href="competitor-methods.html#cb167-247" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 sig_clusters=2, rho=0.8,</span></span>
<span id="cb167-248"><a href="competitor-methods.html#cb167-248" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 var=1.1, beta_latent=1.5,</span></span>
<span id="cb167-249"><a href="competitor-methods.html#cb167-249" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 beta_unclustered=-2, snr=NA,</span></span>
<span id="cb167-250"><a href="competitor-methods.html#cb167-250" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 sigma_eps_sq=NA),</span></span>
<span id="cb167-251"><a href="competitor-methods.html#cb167-251" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                        &quot;Must specify one of snr or sigma_eps_sq&quot;, fixed=TRUE)</span></span>
<span id="cb167-252"><a href="competitor-methods.html#cb167-252" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb167-253"><a href="competitor-methods.html#cb167-253" aria-hidden="true" tabindex="-1"></a>  <span class="co"># testthat::expect_error(<a href='competitor-methods.html#processClusterLassoInputs'>processClusterLassoInputs</a>(p=19, k_unclustered=2,</span></span>
<span id="cb167-254"><a href="competitor-methods.html#cb167-254" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 cluster_size=5, n_clusters=3,</span></span>
<span id="cb167-255"><a href="competitor-methods.html#cb167-255" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 sig_clusters=2, rho=0.8,</span></span>
<span id="cb167-256"><a href="competitor-methods.html#cb167-256" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 var=1.1, beta_latent=1.5,</span></span>
<span id="cb167-257"><a href="competitor-methods.html#cb167-257" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 beta_unclustered=-2, snr=-.2,</span></span>
<span id="cb167-258"><a href="competitor-methods.html#cb167-258" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 sigma_eps_sq=NA),</span></span>
<span id="cb167-259"><a href="competitor-methods.html#cb167-259" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                        &quot;snr &gt; 0 is not TRUE&quot;, fixed=TRUE)</span></span>
<span id="cb167-260"><a href="competitor-methods.html#cb167-260" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb167-261"><a href="competitor-methods.html#cb167-261" aria-hidden="true" tabindex="-1"></a>  <span class="co"># testthat::expect_error(<a href='competitor-methods.html#processClusterLassoInputs'>processClusterLassoInputs</a>(p=19, k_unclustered=2,</span></span>
<span id="cb167-262"><a href="competitor-methods.html#cb167-262" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 cluster_size=5, n_clusters=3,</span></span>
<span id="cb167-263"><a href="competitor-methods.html#cb167-263" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 sig_clusters=2, rho=0.8,</span></span>
<span id="cb167-264"><a href="competitor-methods.html#cb167-264" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 var=1.1, beta_latent=1.5,</span></span>
<span id="cb167-265"><a href="competitor-methods.html#cb167-265" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 beta_unclustered=-2, snr=NA,</span></span>
<span id="cb167-266"><a href="competitor-methods.html#cb167-266" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                 sigma_eps_sq=-.3),</span></span>
<span id="cb167-267"><a href="competitor-methods.html#cb167-267" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                        &quot;sigma_eps_sq &gt; 0 is not TRUE&quot;, fixed=TRUE)</span></span>
<span id="cb167-268"><a href="competitor-methods.html#cb167-268" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb167-269"><a href="competitor-methods.html#cb167-269" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## Test passed 🥇</code></pre>
<p><code><a href='competitor-methods.html#getXglmnet'>getXglmnet</a>()</code>:</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="competitor-methods.html#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Converts the provided design matrix to an appropriate format for either the</span></span>
<span id="cb169-2"><a href="competitor-methods.html#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; protolasso or the cluster representative lasso.</span></span>
<span id="cb169-3"><a href="competitor-methods.html#cb169-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb169-4"><a href="competitor-methods.html#cb169-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Creates design matrix for glmnet by dealing with clusters (for</span></span>
<span id="cb169-5"><a href="competitor-methods.html#cb169-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; type=&quot;protolasso&quot;, discards all cluster members except prototype; for</span></span>
<span id="cb169-6"><a href="competitor-methods.html#cb169-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; type=&quot;clusterRepLasso&quot;, replaces all cluster members with a simple</span></span>
<span id="cb169-7"><a href="competitor-methods.html#cb169-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; average of all the cluster members).</span></span>
<span id="cb169-8"><a href="competitor-methods.html#cb169-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param x A numeric matrix; the provided matrix with n observations and p</span></span>
<span id="cb169-9"><a href="competitor-methods.html#cb169-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; features.</span></span>
<span id="cb169-10"><a href="competitor-methods.html#cb169-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param clusters A named list where each entry is an integer vector of indices</span></span>
<span id="cb169-11"><a href="competitor-methods.html#cb169-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; of features that are in a common cluster. (The length of list clusters should</span></span>
<span id="cb169-12"><a href="competitor-methods.html#cb169-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; be equal to the number of clusters.) All identified clusters should be</span></span>
<span id="cb169-13"><a href="competitor-methods.html#cb169-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; non-overlapping. All features should appear in exactly one cluster (any</span></span>
<span id="cb169-14"><a href="competitor-methods.html#cb169-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; unclustered features should be put in their own &quot;cluster&quot; of size 1).</span></span>
<span id="cb169-15"><a href="competitor-methods.html#cb169-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param type Character; &quot;protolasso&quot; for the protolasso or &quot;clusterRepLasso&quot;</span></span>
<span id="cb169-16"><a href="competitor-methods.html#cb169-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; for the cluster representative lasso.</span></span>
<span id="cb169-17"><a href="competitor-methods.html#cb169-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param prototypes Only required for type &quot;protolasso&quot;. An integer vector</span></span>
<span id="cb169-18"><a href="competitor-methods.html#cb169-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; whose length is equal to the number of clusters. Entry i should be the</span></span>
<span id="cb169-19"><a href="competitor-methods.html#cb169-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; prototype for cluster i (the feature belonging to cluster i that is most</span></span>
<span id="cb169-20"><a href="competitor-methods.html#cb169-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; highly correlated with y; see Reid and Tibshirani 2016).</span></span>
<span id="cb169-21"><a href="competitor-methods.html#cb169-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return A numeric matrix; the design matrix as required for the protolasso or</span></span>
<span id="cb169-22"><a href="competitor-methods.html#cb169-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; cluster representative lasso, prepared for input to glmnet.</span></span>
<span id="cb169-23"><a href="competitor-methods.html#cb169-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @author Gregory Faletto, Jacob Bien</span></span>
<span id="cb169-24"><a href="competitor-methods.html#cb169-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @references Reid, S., &amp; Tibshirani, R. (2016). Sparse regression and marginal</span></span>
<span id="cb169-25"><a href="competitor-methods.html#cb169-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; testing using cluster prototypes. \emph{Biostatistics}, 17(2), 364–376.</span></span>
<span id="cb169-26"><a href="competitor-methods.html#cb169-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; \url{https://doi.org/10.1093/biostatistics/kxv049}.</span></span>
<span id="cb169-27"><a href="competitor-methods.html#cb169-27" aria-hidden="true" tabindex="-1"></a><span id='getXglmnet'>getXglmnet</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(x, clusters, type, <span class="at">prototypes=</span><span class="cn">NA</span>){</span>
<span id="cb169-28"><a href="competitor-methods.html#cb169-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb169-29"><a href="competitor-methods.html#cb169-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check inputs</span></span>
<span id="cb169-30"><a href="competitor-methods.html#cb169-30" aria-hidden="true" tabindex="-1"></a>    <a href='competitor-methods.html#checkGetXglmnetInputs'>checkGetXglmnetInputs</a>(x, clusters, type, prototypes)</span>
<span id="cb169-31"><a href="competitor-methods.html#cb169-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-32"><a href="competitor-methods.html#cb169-32" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x)</span>
<span id="cb169-33"><a href="competitor-methods.html#cb169-33" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ncol</span>(x)</span>
<span id="cb169-34"><a href="competitor-methods.html#cb169-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-35"><a href="competitor-methods.html#cb169-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># if(n_clusters &gt; 0){</span></span>
<span id="cb169-36"><a href="competitor-methods.html#cb169-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(clusters)){</span>
<span id="cb169-37"><a href="competitor-methods.html#cb169-37" aria-hidden="true" tabindex="-1"></a>        cluster_i <span class="ot">&lt;-</span> clusters[[i]]</span>
<span id="cb169-38"><a href="competitor-methods.html#cb169-38" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb169-39"><a href="competitor-methods.html#cb169-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(type <span class="sc">==</span> <span class="st">&quot;protolasso&quot;</span>){</span>
<span id="cb169-40"><a href="competitor-methods.html#cb169-40" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span>(<span class="fu">length</span>(cluster_i) <span class="sc">&gt;</span> <span class="dv">1</span>){</span>
<span id="cb169-41"><a href="competitor-methods.html#cb169-41" aria-hidden="true" tabindex="-1"></a>                prototype_ind_i <span class="ot">&lt;-</span> <span class="fu">which</span>(prototypes <span class="sc">%in%</span> cluster_i)</span>
<span id="cb169-42"><a href="competitor-methods.html#cb169-42" aria-hidden="true" tabindex="-1"></a>                <span class="fu">stopifnot</span>(<span class="fu">length</span>(prototype_ind_i) <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb169-43"><a href="competitor-methods.html#cb169-43" aria-hidden="true" tabindex="-1"></a>                prototype_i <span class="ot">&lt;-</span> prototypes[prototype_ind_i]</span>
<span id="cb169-44"><a href="competitor-methods.html#cb169-44" aria-hidden="true" tabindex="-1"></a>            } <span class="cf">else</span>{</span>
<span id="cb169-45"><a href="competitor-methods.html#cb169-45" aria-hidden="true" tabindex="-1"></a>                prototype_i <span class="ot">&lt;-</span> cluster_i</span>
<span id="cb169-46"><a href="competitor-methods.html#cb169-46" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb169-47"><a href="competitor-methods.html#cb169-47" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb169-48"><a href="competitor-methods.html#cb169-48" aria-hidden="true" tabindex="-1"></a>            X_glmnet_i <span class="ot">&lt;-</span> x[, prototype_i]</span>
<span id="cb169-49"><a href="competitor-methods.html#cb169-49" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb169-50"><a href="competitor-methods.html#cb169-50" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stopifnot</span>(type <span class="sc">==</span> <span class="st">&quot;clusterRepLasso&quot;</span>)</span>
<span id="cb169-51"><a href="competitor-methods.html#cb169-51" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span>(<span class="fu">length</span>(cluster_i) <span class="sc">&gt;</span> <span class="dv">1</span>){</span>
<span id="cb169-52"><a href="competitor-methods.html#cb169-52" aria-hidden="true" tabindex="-1"></a>                X_glmnet_i <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(x[, cluster_i])</span>
<span id="cb169-53"><a href="competitor-methods.html#cb169-53" aria-hidden="true" tabindex="-1"></a>            } <span class="cf">else</span>{</span>
<span id="cb169-54"><a href="competitor-methods.html#cb169-54" aria-hidden="true" tabindex="-1"></a>                X_glmnet_i <span class="ot">&lt;-</span> x[, cluster_i]</span>
<span id="cb169-55"><a href="competitor-methods.html#cb169-55" aria-hidden="true" tabindex="-1"></a>            }    </span>
<span id="cb169-56"><a href="competitor-methods.html#cb169-56" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb169-57"><a href="competitor-methods.html#cb169-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-58"><a href="competitor-methods.html#cb169-58" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">length</span>(X_glmnet_i) <span class="sc">==</span> n)</span>
<span id="cb169-59"><a href="competitor-methods.html#cb169-59" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb169-60"><a href="competitor-methods.html#cb169-60" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(i <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb169-61"><a href="competitor-methods.html#cb169-61" aria-hidden="true" tabindex="-1"></a>            X_glmnet <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(X_glmnet_i)</span>
<span id="cb169-62"><a href="competitor-methods.html#cb169-62" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span>{</span>
<span id="cb169-63"><a href="competitor-methods.html#cb169-63" aria-hidden="true" tabindex="-1"></a>            X_glmnet <span class="ot">&lt;-</span> <span class="fu">cbind</span>(X_glmnet, X_glmnet_i)</span>
<span id="cb169-64"><a href="competitor-methods.html#cb169-64" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb169-65"><a href="competitor-methods.html#cb169-65" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb169-66"><a href="competitor-methods.html#cb169-66" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">ncol</span>(X_glmnet) <span class="sc">==</span> <span class="fu">length</span>(clusters))</span>
<span id="cb169-67"><a href="competitor-methods.html#cb169-67" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(X_glmnet) <span class="ot">&lt;-</span> <span class="fu">character</span>()</span>
<span id="cb169-68"><a href="competitor-methods.html#cb169-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-69"><a href="competitor-methods.html#cb169-69" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check output</span></span>
<span id="cb169-70"><a href="competitor-methods.html#cb169-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.matrix</span>(X_glmnet))</span>
<span id="cb169-71"><a href="competitor-methods.html#cb169-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">nrow</span>(X_glmnet) <span class="sc">==</span> n)</span>
<span id="cb169-72"><a href="competitor-methods.html#cb169-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">ncol</span>(X_glmnet) <span class="sc">&lt;=</span> p)</span>
<span id="cb169-73"><a href="competitor-methods.html#cb169-73" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">ncol</span>(X_glmnet) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb169-74"><a href="competitor-methods.html#cb169-74" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb169-75"><a href="competitor-methods.html#cb169-75" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(X_glmnet)</span>
<span id="cb169-76"><a href="competitor-methods.html#cb169-76" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><code><a href='competitor-methods.html#checkGetXglmnetInputs'>checkGetXglmnetInputs</a>()</code>:</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="competitor-methods.html#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Verifies the inputs for getXglmnet.</span></span>
<span id="cb170-2"><a href="competitor-methods.html#cb170-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb170-3"><a href="competitor-methods.html#cb170-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param x A numeric matrix; the provided matrix with n observations and p</span></span>
<span id="cb170-4"><a href="competitor-methods.html#cb170-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; features.</span></span>
<span id="cb170-5"><a href="competitor-methods.html#cb170-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param clusters A named list where each entry is an integer vector of indices</span></span>
<span id="cb170-6"><a href="competitor-methods.html#cb170-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; of features that are in a common cluster. (The length of list clusters should</span></span>
<span id="cb170-7"><a href="competitor-methods.html#cb170-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; be equal to the number of clusters.) All identified clusters should be</span></span>
<span id="cb170-8"><a href="competitor-methods.html#cb170-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; non-overlapping. All features should appear in exactly one cluster (any</span></span>
<span id="cb170-9"><a href="competitor-methods.html#cb170-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; unclustered features should be put in their own &quot;cluster&quot; of size 1).</span></span>
<span id="cb170-10"><a href="competitor-methods.html#cb170-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param type Character; &quot;protolasso&quot; for the protolasso or &quot;clusterRepLasso&quot;</span></span>
<span id="cb170-11"><a href="competitor-methods.html#cb170-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; for the cluster representative lasso.</span></span>
<span id="cb170-12"><a href="competitor-methods.html#cb170-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param prototypes Only required for type &quot;protolasso&quot;. An integer vector</span></span>
<span id="cb170-13"><a href="competitor-methods.html#cb170-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; whose length is equal to the number of clusters. Entry i should be the</span></span>
<span id="cb170-14"><a href="competitor-methods.html#cb170-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; prototype for cluster i (the feature belonging to cluster i that is most</span></span>
<span id="cb170-15"><a href="competitor-methods.html#cb170-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; highly correlated with y; see Reid and Tibshirani 2016).</span></span>
<span id="cb170-16"><a href="competitor-methods.html#cb170-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @author Gregory Faletto, Jacob Bien</span></span>
<span id="cb170-17"><a href="competitor-methods.html#cb170-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @references Reid, S., &amp; Tibshirani, R. (2016). Sparse regression and marginal</span></span>
<span id="cb170-18"><a href="competitor-methods.html#cb170-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; testing using cluster prototypes. \emph{Biostatistics}, 17(2), 364–376.</span></span>
<span id="cb170-19"><a href="competitor-methods.html#cb170-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; \url{https://doi.org/10.1093/biostatistics/kxv049}.</span></span>
<span id="cb170-20"><a href="competitor-methods.html#cb170-20" aria-hidden="true" tabindex="-1"></a><span id='checkGetXglmnetInputs'>checkGetXglmnetInputs</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(x, clusters, type, prototypes){</span>
<span id="cb170-21"><a href="competitor-methods.html#cb170-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.matrix</span>(x))</span>
<span id="cb170-22"><a href="competitor-methods.html#cb170-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-23"><a href="competitor-methods.html#cb170-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.list</span>(clusters))</span>
<span id="cb170-24"><a href="competitor-methods.html#cb170-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">all</span>(<span class="fu">lengths</span>(clusters) <span class="sc">&gt;=</span> <span class="dv">1</span>))</span>
<span id="cb170-25"><a href="competitor-methods.html#cb170-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-26"><a href="competitor-methods.html#cb170-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(type) <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb170-27"><a href="competitor-methods.html#cb170-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.character</span>(type))</span>
<span id="cb170-28"><a href="competitor-methods.html#cb170-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="sc">!</span><span class="fu">is.na</span>(type))</span>
<span id="cb170-29"><a href="competitor-methods.html#cb170-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;protolasso&quot;</span>, <span class="st">&quot;clusterRepLasso&quot;</span>))</span>
<span id="cb170-30"><a href="competitor-methods.html#cb170-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-31"><a href="competitor-methods.html#cb170-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(type<span class="sc">==</span><span class="st">&quot;protolasso&quot;</span>){</span>
<span id="cb170-32"><a href="competitor-methods.html#cb170-32" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="sc">!</span><span class="fu">is.na</span>(prototypes))</span>
<span id="cb170-33"><a href="competitor-methods.html#cb170-33" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">is.integer</span>(prototypes))</span>
<span id="cb170-34"><a href="competitor-methods.html#cb170-34" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(prototypes)))</span>
<span id="cb170-35"><a href="competitor-methods.html#cb170-35" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">length</span>(prototypes) <span class="sc">==</span> <span class="fu">length</span>(<span class="fu">unique</span>(prototypes)))</span>
<span id="cb170-36"><a href="competitor-methods.html#cb170-36" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">all</span>(prototypes <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(x)))</span>
<span id="cb170-37"><a href="competitor-methods.html#cb170-37" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb170-38"><a href="competitor-methods.html#cb170-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(clusters)){</span>
<span id="cb170-39"><a href="competitor-methods.html#cb170-39" aria-hidden="true" tabindex="-1"></a>        cluster_i <span class="ot">&lt;-</span> clusters[[i]]</span>
<span id="cb170-40"><a href="competitor-methods.html#cb170-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="fu">length</span>(cluster_i) <span class="sc">&gt;</span> <span class="dv">1</span>){</span>
<span id="cb170-41"><a href="competitor-methods.html#cb170-41" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stopifnot</span>(<span class="fu">sum</span>(prototypes <span class="sc">%in%</span> cluster_i) <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb170-42"><a href="competitor-methods.html#cb170-42" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb170-43"><a href="competitor-methods.html#cb170-43" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb170-44"><a href="competitor-methods.html#cb170-44" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Tests for <code><a href='competitor-methods.html#checkGetXglmnetInputs'>checkGetXglmnetInputs</a>()</code>:</p>
<p>Tests for <code><a href='competitor-methods.html#getXglmnet'>getXglmnet</a>()</code>:</p>
<p><code><a href='competitor-methods.html#getClusterSelsFromGlmnet'>getClusterSelsFromGlmnet</a>()</code>:</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="competitor-methods.html#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Extracts selected clusters and cluster prototypes from the glmnet lasso</span></span>
<span id="cb171-2"><a href="competitor-methods.html#cb171-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; output</span></span>
<span id="cb171-3"><a href="competitor-methods.html#cb171-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb171-4"><a href="competitor-methods.html#cb171-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param lasso_sets A list of integer vectors. Each vector represents a set of</span></span>
<span id="cb171-5"><a href="competitor-methods.html#cb171-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; features selected by the lasso for a given value of the penalty parameter</span></span>
<span id="cb171-6"><a href="competitor-methods.html#cb171-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; lambda.</span></span>
<span id="cb171-7"><a href="competitor-methods.html#cb171-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param clusters A named list where each entry is an integer vector of indices</span></span>
<span id="cb171-8"><a href="competitor-methods.html#cb171-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; of features that are in a common cluster. (The length of list clusters is</span></span>
<span id="cb171-9"><a href="competitor-methods.html#cb171-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; equal to the number of clusters.) All identified clusters must be</span></span>
<span id="cb171-10"><a href="competitor-methods.html#cb171-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; non-overlapping. All features appear in exactly one cluster (any unclustered</span></span>
<span id="cb171-11"><a href="competitor-methods.html#cb171-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; features must be in their own &quot;cluster&quot; of size 1).</span></span>
<span id="cb171-12"><a href="competitor-methods.html#cb171-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param prototypes An integer vector whose length must be equal to the number</span></span>
<span id="cb171-13"><a href="competitor-methods.html#cb171-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; of clusters. Entry i should be the index of the feature belonging to cluster</span></span>
<span id="cb171-14"><a href="competitor-methods.html#cb171-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; i that is most highly correlated with y (that is, the prototype for the</span></span>
<span id="cb171-15"><a href="competitor-methods.html#cb171-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; cluster, as in the protolasso; see Reid and Tibshirani 2016).</span></span>
<span id="cb171-16"><a href="competitor-methods.html#cb171-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param feat_names Character vector; the names of the features in X. (If the</span></span>
<span id="cb171-17"><a href="competitor-methods.html#cb171-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; X provided to protolasso or clusterRepLasso did not have feature names,</span></span>
<span id="cb171-18"><a href="competitor-methods.html#cb171-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; feat_names will be NA.)</span></span>
<span id="cb171-19"><a href="competitor-methods.html#cb171-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return A list containing the following items: \item{selected_sets}{A list of</span></span>
<span id="cb171-20"><a href="competitor-methods.html#cb171-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; integer vectors. Entry k of this list contains a selected set of size k</span></span>
<span id="cb171-21"><a href="competitor-methods.html#cb171-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; yielded by glmnet--each member of the set is the index of a single feature</span></span>
<span id="cb171-22"><a href="competitor-methods.html#cb171-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; from a cluster selected by either the protolasso or the cluster</span></span>
<span id="cb171-23"><a href="competitor-methods.html#cb171-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; representative lasso (the prototype from that cluster--the cluster member</span></span>
<span id="cb171-24"><a href="competitor-methods.html#cb171-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; most highly correlated with y). (If no set of size k was selected, entry k</span></span>
<span id="cb171-25"><a href="competitor-methods.html#cb171-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; will be empty.)} \item{selected_clusts_list}{A list of lists; entry k of this</span></span>
<span id="cb171-26"><a href="competitor-methods.html#cb171-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; list is a list of length k of clusters (the clusters that were selected by</span></span>
<span id="cb171-27"><a href="competitor-methods.html#cb171-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the cluster representative lasso).}</span></span>
<span id="cb171-28"><a href="competitor-methods.html#cb171-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @author Gregory Faletto, Jacob Bien</span></span>
<span id="cb171-29"><a href="competitor-methods.html#cb171-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @references Reid, S., &amp; Tibshirani, R. (2016). Sparse regression and marginal</span></span>
<span id="cb171-30"><a href="competitor-methods.html#cb171-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; testing using cluster prototypes. \emph{Biostatistics}, 17(2), 364–376.</span></span>
<span id="cb171-31"><a href="competitor-methods.html#cb171-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; \url{https://doi.org/10.1093/biostatistics/kxv049}. \cr Bühlmann, P.,</span></span>
<span id="cb171-32"><a href="competitor-methods.html#cb171-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Rütimann, P., van de Geer, S., &amp; Zhang, C. H. (2013). Correlated variables in</span></span>
<span id="cb171-33"><a href="competitor-methods.html#cb171-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; regression: Clustering and sparse estimation.</span></span>
<span id="cb171-34"><a href="competitor-methods.html#cb171-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; \emph{Journal of Statistical Planning and Inference}, 143(11), 1835–1858.</span></span>
<span id="cb171-35"><a href="competitor-methods.html#cb171-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; \url{https://doi.org/10.1016/j.jspi.2013.05.019}.</span></span>
<span id="cb171-36"><a href="competitor-methods.html#cb171-36" aria-hidden="true" tabindex="-1"></a><span id='getClusterSelsFromGlmnet'>getClusterSelsFromGlmnet</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(lasso_sets, clusters, prototypes,</span>
<span id="cb171-37"><a href="competitor-methods.html#cb171-37" aria-hidden="true" tabindex="-1"></a>    feat_names){</span>
<span id="cb171-38"><a href="competitor-methods.html#cb171-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-39"><a href="competitor-methods.html#cb171-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">any</span>(<span class="sc">!</span><span class="fu">is.na</span>(feat_names))){</span>
<span id="cb171-40"><a href="competitor-methods.html#cb171-40" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(feat_names)))</span>
<span id="cb171-41"><a href="competitor-methods.html#cb171-41" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb171-42"><a href="competitor-methods.html#cb171-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-43"><a href="competitor-methods.html#cb171-43" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Largest selected set among all those in lasso_sets</span></span>
<span id="cb171-44"><a href="competitor-methods.html#cb171-44" aria-hidden="true" tabindex="-1"></a>    max_length <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">vapply</span>(lasso_sets, length, <span class="fu">integer</span>(<span class="dv">1</span>)))</span>
<span id="cb171-45"><a href="competitor-methods.html#cb171-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-46"><a href="competitor-methods.html#cb171-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Preparing lists to store </span></span>
<span id="cb171-47"><a href="competitor-methods.html#cb171-47" aria-hidden="true" tabindex="-1"></a>    selected_sets <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb171-48"><a href="competitor-methods.html#cb171-48" aria-hidden="true" tabindex="-1"></a>    selected_clusts_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb171-49"><a href="competitor-methods.html#cb171-49" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb171-50"><a href="competitor-methods.html#cb171-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>max_length){</span>
<span id="cb171-51"><a href="competitor-methods.html#cb171-51" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Lasso selected set of size j</span></span>
<span id="cb171-52"><a href="competitor-methods.html#cb171-52" aria-hidden="true" tabindex="-1"></a>        lasso_sets_j <span class="ot">&lt;-</span> lasso_sets[<span class="fu">lapply</span>(lasso_sets, length) <span class="sc">==</span> j]</span>
<span id="cb171-53"><a href="competitor-methods.html#cb171-53" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Are there any lasso selected sets of size j? (If not, we will skip to</span></span>
<span id="cb171-54"><a href="competitor-methods.html#cb171-54" aria-hidden="true" tabindex="-1"></a>        <span class="co"># the next j, and slot j in the list will be empty.)</span></span>
<span id="cb171-55"><a href="competitor-methods.html#cb171-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="fu">length</span>(lasso_sets_j) <span class="sc">&gt;</span> <span class="dv">0</span>){</span>
<span id="cb171-56"><a href="competitor-methods.html#cb171-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-57"><a href="competitor-methods.html#cb171-57" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Select the first set of size j</span></span>
<span id="cb171-58"><a href="competitor-methods.html#cb171-58" aria-hidden="true" tabindex="-1"></a>            lasso_set_j <span class="ot">&lt;-</span> lasso_sets_j[[<span class="dv">1</span>]]</span>
<span id="cb171-59"><a href="competitor-methods.html#cb171-59" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stopifnot</span>(<span class="fu">length</span>(lasso_set_j) <span class="sc">==</span> j)</span>
<span id="cb171-60"><a href="competitor-methods.html#cb171-60" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb171-61"><a href="competitor-methods.html#cb171-61" aria-hidden="true" tabindex="-1"></a>            ret <span class="ot">&lt;-</span> <a href='competitor-methods.html#getSelectedSets'>getSelectedSets</a>(<span class="at">lasso_set=</span>lasso_set_j, <span class="at">clusters=</span>clusters,</span>
<span id="cb171-62"><a href="competitor-methods.html#cb171-62" aria-hidden="true" tabindex="-1"></a>                <span class="at">prototypes=</span>prototypes, <span class="at">feat_names=</span>feat_names)</span>
<span id="cb171-63"><a href="competitor-methods.html#cb171-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-64"><a href="competitor-methods.html#cb171-64" aria-hidden="true" tabindex="-1"></a>            selected_sets[[j]] <span class="ot">&lt;-</span> ret<span class="sc">$</span>selected_set</span>
<span id="cb171-65"><a href="competitor-methods.html#cb171-65" aria-hidden="true" tabindex="-1"></a>            selected_clusts_list[[j]] <span class="ot">&lt;-</span> ret<span class="sc">$</span>selected_clusts_list</span>
<span id="cb171-66"><a href="competitor-methods.html#cb171-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-67"><a href="competitor-methods.html#cb171-67" aria-hidden="true" tabindex="-1"></a>            <span class="fu">rm</span>(ret)</span>
<span id="cb171-68"><a href="competitor-methods.html#cb171-68" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb171-69"><a href="competitor-methods.html#cb171-69" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb171-70"><a href="competitor-methods.html#cb171-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-71"><a href="competitor-methods.html#cb171-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(selected_sets) <span class="sc">&lt;=</span> max_length)</span>
<span id="cb171-72"><a href="competitor-methods.html#cb171-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(selected_clusts_list) <span class="sc">&lt;=</span> max_length)</span>
<span id="cb171-73"><a href="competitor-methods.html#cb171-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-74"><a href="competitor-methods.html#cb171-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">selected_sets=</span>selected_sets,</span>
<span id="cb171-75"><a href="competitor-methods.html#cb171-75" aria-hidden="true" tabindex="-1"></a>        <span class="at">selected_clusts_list=</span>selected_clusts_list))</span>
<span id="cb171-76"><a href="competitor-methods.html#cb171-76" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><code><a href='competitor-methods.html#getSelectedSets'>getSelectedSets</a>()</code>:</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="competitor-methods.html#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Converts a selected set from X_glmnet to selected sets and selected clusters</span></span>
<span id="cb172-2"><a href="competitor-methods.html#cb172-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; from the original feature space of X.</span></span>
<span id="cb172-3"><a href="competitor-methods.html#cb172-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb172-4"><a href="competitor-methods.html#cb172-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param lasso_set A vector containing the indices of selected cluster</span></span>
<span id="cb172-5"><a href="competitor-methods.html#cb172-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; representatives or prototypes.</span></span>
<span id="cb172-6"><a href="competitor-methods.html#cb172-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param clusters A named list where each entry is an integer vector of indices</span></span>
<span id="cb172-7"><a href="competitor-methods.html#cb172-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; of features that are in a common cluster. (The length of list clusters is</span></span>
<span id="cb172-8"><a href="competitor-methods.html#cb172-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; equal to the number of clusters.) All identified clusters must be</span></span>
<span id="cb172-9"><a href="competitor-methods.html#cb172-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; non-overlapping. All features appear in exactly one cluster (any unclustered</span></span>
<span id="cb172-10"><a href="competitor-methods.html#cb172-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; features must be in their own &quot;cluster&quot; of size 1).</span></span>
<span id="cb172-11"><a href="competitor-methods.html#cb172-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param prototypes An integer vector whose length must be equal to the number</span></span>
<span id="cb172-12"><a href="competitor-methods.html#cb172-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; of clusters. Entry i should be the index of the feature belonging to cluster</span></span>
<span id="cb172-13"><a href="competitor-methods.html#cb172-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; i that is most highly correlated with y (that is, the prototype for the</span></span>
<span id="cb172-14"><a href="competitor-methods.html#cb172-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; cluster, as in the protolasso).</span></span>
<span id="cb172-15"><a href="competitor-methods.html#cb172-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param feat_names Character vector; the names of the features in X.</span></span>
<span id="cb172-16"><a href="competitor-methods.html#cb172-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return A list containing two items: \item{selected_set}{An integer vector</span></span>
<span id="cb172-17"><a href="competitor-methods.html#cb172-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; with length equal to lasso_set containing a set of selected features in the</span></span>
<span id="cb172-18"><a href="competitor-methods.html#cb172-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; original X matrix. (Selections in lasso_set corresponding to a cluster will</span></span>
<span id="cb172-19"><a href="competitor-methods.html#cb172-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; be replaced by the cluster&#39;s prototype from X.)}</span></span>
<span id="cb172-20"><a href="competitor-methods.html#cb172-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; \item{selected_clusts_list}{A named list of integer vectors with length equal</span></span>
<span id="cb172-21"><a href="competitor-methods.html#cb172-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; to selected_set. selected_clusts_list[[k]] will be an integer vector</span></span>
<span id="cb172-22"><a href="competitor-methods.html#cb172-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; containing the indices of the features in X that are in the cluster</span></span>
<span id="cb172-23"><a href="competitor-methods.html#cb172-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; containing prototype selected_set[k].}</span></span>
<span id="cb172-24"><a href="competitor-methods.html#cb172-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @author Gregory Faletto, Jacob Bien</span></span>
<span id="cb172-25"><a href="competitor-methods.html#cb172-25" aria-hidden="true" tabindex="-1"></a><span id='getSelectedSets'>getSelectedSets</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(lasso_set, model_size, clusters, prototypes,</span>
<span id="cb172-26"><a href="competitor-methods.html#cb172-26" aria-hidden="true" tabindex="-1"></a>    feat_names){</span>
<span id="cb172-27"><a href="competitor-methods.html#cb172-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb172-28"><a href="competitor-methods.html#cb172-28" aria-hidden="true" tabindex="-1"></a>    model_size <span class="ot">&lt;-</span> <span class="fu">length</span>(lasso_set)</span>
<span id="cb172-29"><a href="competitor-methods.html#cb172-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-30"><a href="competitor-methods.html#cb172-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(<span class="fu">unique</span>(lasso_set)) <span class="sc">==</span> model_size)</span>
<span id="cb172-31"><a href="competitor-methods.html#cb172-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">all</span>(lasso_set <span class="sc">&lt;=</span> <span class="fu">length</span>(clusters)))</span>
<span id="cb172-32"><a href="competitor-methods.html#cb172-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-33"><a href="competitor-methods.html#cb172-33" aria-hidden="true" tabindex="-1"></a>    selected_set <span class="ot">&lt;-</span> <span class="fu">integer</span>()</span>
<span id="cb172-34"><a href="competitor-methods.html#cb172-34" aria-hidden="true" tabindex="-1"></a>    selected_clusts_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb172-35"><a href="competitor-methods.html#cb172-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Recover features from original feature space</span></span>
<span id="cb172-36"><a href="competitor-methods.html#cb172-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>model_size){</span>
<span id="cb172-37"><a href="competitor-methods.html#cb172-37" aria-hidden="true" tabindex="-1"></a>        selected_cluster_k <span class="ot">&lt;-</span> clusters[[lasso_set[k]]]</span>
<span id="cb172-38"><a href="competitor-methods.html#cb172-38" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">is.integer</span>(selected_cluster_k))</span>
<span id="cb172-39"><a href="competitor-methods.html#cb172-39" aria-hidden="true" tabindex="-1"></a>        selected_clusts_list[[k]] <span class="ot">&lt;-</span> selected_cluster_k</span>
<span id="cb172-40"><a href="competitor-methods.html#cb172-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-41"><a href="competitor-methods.html#cb172-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="fu">length</span>(selected_cluster_k) <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb172-42"><a href="competitor-methods.html#cb172-42" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stopifnot</span>(<span class="sc">!</span>(selected_cluster_k <span class="sc">%in%</span> selected_set))</span>
<span id="cb172-43"><a href="competitor-methods.html#cb172-43" aria-hidden="true" tabindex="-1"></a>            selected_set <span class="ot">&lt;-</span> <span class="fu">c</span>(selected_set, selected_cluster_k)</span>
<span id="cb172-44"><a href="competitor-methods.html#cb172-44" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span>{</span>
<span id="cb172-45"><a href="competitor-methods.html#cb172-45" aria-hidden="true" tabindex="-1"></a>            sel_prototype <span class="ot">&lt;-</span> <span class="fu">which</span>(prototypes <span class="sc">%in%</span> selected_cluster_k)</span>
<span id="cb172-46"><a href="competitor-methods.html#cb172-46" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stopifnot</span>(<span class="fu">length</span>(sel_prototype) <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb172-47"><a href="competitor-methods.html#cb172-47" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stopifnot</span>(<span class="sc">!</span>(prototypes[sel_prototype] <span class="sc">%in%</span> selected_set))</span>
<span id="cb172-48"><a href="competitor-methods.html#cb172-48" aria-hidden="true" tabindex="-1"></a>            selected_set <span class="ot">&lt;-</span> <span class="fu">c</span>(selected_set, prototypes[sel_prototype])</span>
<span id="cb172-49"><a href="competitor-methods.html#cb172-49" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb172-50"><a href="competitor-methods.html#cb172-50" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb172-51"><a href="competitor-methods.html#cb172-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-52"><a href="competitor-methods.html#cb172-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(selected_set) <span class="sc">==</span> model_size)</span>
<span id="cb172-53"><a href="competitor-methods.html#cb172-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(<span class="fu">unique</span>(selected_set)) <span class="sc">==</span> model_size)</span>
<span id="cb172-54"><a href="competitor-methods.html#cb172-54" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb172-55"><a href="competitor-methods.html#cb172-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">any</span>(<span class="sc">!</span><span class="fu">is.na</span>(feat_names))){</span>
<span id="cb172-56"><a href="competitor-methods.html#cb172-56" aria-hidden="true" tabindex="-1"></a>        <span class="fu">names</span>(selected_set) <span class="ot">&lt;-</span> feat_names[selected_set]</span>
<span id="cb172-57"><a href="competitor-methods.html#cb172-57" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb172-58"><a href="competitor-methods.html#cb172-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-59"><a href="competitor-methods.html#cb172-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(selected_clusts_list) <span class="sc">==</span> model_size)</span>
<span id="cb172-60"><a href="competitor-methods.html#cb172-60" aria-hidden="true" tabindex="-1"></a>    all_feats <span class="ot">&lt;-</span> <span class="fu">unlist</span>(selected_clusts_list)</span>
<span id="cb172-61"><a href="competitor-methods.html#cb172-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(all_feats) <span class="sc">==</span> <span class="fu">length</span>(<span class="fu">unique</span>(all_feats)))</span>
<span id="cb172-62"><a href="competitor-methods.html#cb172-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-63"><a href="competitor-methods.html#cb172-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">selected_set=</span>selected_set,</span>
<span id="cb172-64"><a href="competitor-methods.html#cb172-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">selected_clusts_list=</span>selected_clusts_list))</span>
<span id="cb172-65"><a href="competitor-methods.html#cb172-65" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Tests for <code><a href='competitor-methods.html#getSelectedSets'>getSelectedSets</a>()</code>:</p>
<p>Tests for <code><a href='competitor-methods.html#getClusterSelsFromGlmnet'>getClusterSelsFromGlmnet</a>()</code></p>
<p>Finally, tests for <code><a href='competitor-methods.html#protolasso'>protolasso</a>()</code>:</p>
<p><code><a href='competitor-methods.html#clusterRepLasso'>clusterRepLasso</a>()</code>:</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="competitor-methods.html#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Select features via the cluster representative lasso (Bühlmann et. al. 2013)</span></span>
<span id="cb173-2"><a href="competitor-methods.html#cb173-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb173-3"><a href="competitor-methods.html#cb173-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param X An n x p numeric matrix (preferably) or a data.frame (which will</span></span>
<span id="cb173-4"><a href="competitor-methods.html#cb173-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; be coerced internally to a matrix by the function model.matrix) containing</span></span>
<span id="cb173-5"><a href="competitor-methods.html#cb173-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; p &gt;= 2 features/predictors</span></span>
<span id="cb173-6"><a href="competitor-methods.html#cb173-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param y The response; A length n numeric (or integer) real-valued vector.</span></span>
<span id="cb173-7"><a href="competitor-methods.html#cb173-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param clusters A list of integer vectors; each vector should contain the </span></span>
<span id="cb173-8"><a href="competitor-methods.html#cb173-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; indices of a cluster of features (a subset of 1:p). (If there is only one</span></span>
<span id="cb173-9"><a href="competitor-methods.html#cb173-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; cluster, clusters can either be a list of length 1 or an integer vector.)</span></span>
<span id="cb173-10"><a href="competitor-methods.html#cb173-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; All of the provided clusters must be non-overlapping. Every feature not</span></span>
<span id="cb173-11"><a href="competitor-methods.html#cb173-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; appearing in any cluster will be assumed to be unclustered (that is, they</span></span>
<span id="cb173-12"><a href="competitor-methods.html#cb173-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; will be treated as if they are in a &quot;cluster&quot; containing only themselves).</span></span>
<span id="cb173-13"><a href="competitor-methods.html#cb173-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Default is list() (so no clusters are specified).</span></span>
<span id="cb173-14"><a href="competitor-methods.html#cb173-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param nlambda Integer; the number of lambda values to use in the lasso fit</span></span>
<span id="cb173-15"><a href="competitor-methods.html#cb173-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; for the cluster representative lasso. Default is 100 (following the default</span></span>
<span id="cb173-16"><a href="competitor-methods.html#cb173-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; for glmnet). For now, nlambda must be at least 2 (using a single lambda is</span></span>
<span id="cb173-17"><a href="competitor-methods.html#cb173-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; not supported).</span></span>
<span id="cb173-18"><a href="competitor-methods.html#cb173-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return A list with three elements. \item{selected_sets}{A list of integer</span></span>
<span id="cb173-19"><a href="competitor-methods.html#cb173-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; vectors. Entry k of this list contains a selected set (an integer vector) of</span></span>
<span id="cb173-20"><a href="competitor-methods.html#cb173-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; size k yielded by the lasso--each member of the set is the index of a single</span></span>
<span id="cb173-21"><a href="competitor-methods.html#cb173-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; feature from a cluster selected by the cluster representative lasso (the</span></span>
<span id="cb173-22"><a href="competitor-methods.html#cb173-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; prototype from that cluster--the cluster member most highly correlated with</span></span>
<span id="cb173-23"><a href="competitor-methods.html#cb173-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; y). (If no set of size k was selected, entry k will be empty.)}</span></span>
<span id="cb173-24"><a href="competitor-methods.html#cb173-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; \item{selected_clusts_list}{A list; each element of the list is a named list</span></span>
<span id="cb173-25"><a href="competitor-methods.html#cb173-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; of selected clusters. (That is, if a selected set of size k was yielded by</span></span>
<span id="cb173-26"><a href="competitor-methods.html#cb173-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the cluster representative lasso, then selected_clusts_list[[k]] is a named</span></span>
<span id="cb173-27"><a href="competitor-methods.html#cb173-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; list of length k, where each member of the list is an integer vector</span></span>
<span id="cb173-28"><a href="competitor-methods.html#cb173-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; of cluster members. Note that selected_clusts_lists[[k]][[j]] will be the</span></span>
<span id="cb173-29"><a href="competitor-methods.html#cb173-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; cluster that contains feature selected_sets[[k]][j].)} \item{beta}{The beta</span></span>
<span id="cb173-30"><a href="competitor-methods.html#cb173-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; output from glmnet when the lasso was estimated on a matrix of prototypes.</span></span>
<span id="cb173-31"><a href="competitor-methods.html#cb173-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; (See documentation for the function glmnet from the glmnet package for</span></span>
<span id="cb173-32"><a href="competitor-methods.html#cb173-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; details.)}</span></span>
<span id="cb173-33"><a href="competitor-methods.html#cb173-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @references Bühlmann, P., Rütimann, P., van de Geer, S., &amp; Zhang, C. H.</span></span>
<span id="cb173-34"><a href="competitor-methods.html#cb173-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; (2013). Correlated variables in regression: Clustering and sparse estimation.</span></span>
<span id="cb173-35"><a href="competitor-methods.html#cb173-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; \emph{Journal of Statistical Planning and Inference}, 143(11), 1835–1858.</span></span>
<span id="cb173-36"><a href="competitor-methods.html#cb173-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; \url{https://doi.org/10.1016/j.jspi.2013.05.019}. \cr Jerome Friedman, Trevor</span></span>
<span id="cb173-37"><a href="competitor-methods.html#cb173-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Hastie, Robert Tibshirani (2010). Regularization Paths for Generalized Linear</span></span>
<span id="cb173-38"><a href="competitor-methods.html#cb173-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Models via Coordinate Descent. \emph{Journal of Statistical Software}, 33(1)</span></span>
<span id="cb173-39"><a href="competitor-methods.html#cb173-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; &#39; 1-22. URL \url{https://www.jstatsoft.org/v33/i01/}.</span></span>
<span id="cb173-40"><a href="competitor-methods.html#cb173-40" aria-hidden="true" tabindex="-1"></a><span id='clusterRepLasso'>clusterRepLasso</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(X, y, <span class="at">clusters=</span><span class="fu">list</span>(), <span class="at">nlambda=</span><span class="dv">100</span>){</span>
<span id="cb173-41"><a href="competitor-methods.html#cb173-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-42"><a href="competitor-methods.html#cb173-42" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Handle and format inputs; get cluster prototypes</span></span>
<span id="cb173-43"><a href="competitor-methods.html#cb173-43" aria-hidden="true" tabindex="-1"></a>    ret <span class="ot">&lt;-</span> <a href='competitor-methods.html#processClusterLassoInputs'>processClusterLassoInputs</a>(X, y, clusters, nlambda)</span>
<span id="cb173-44"><a href="competitor-methods.html#cb173-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-45"><a href="competitor-methods.html#cb173-45" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> ret<span class="sc">$</span>x</span>
<span id="cb173-46"><a href="competitor-methods.html#cb173-46" aria-hidden="true" tabindex="-1"></a>    clusters <span class="ot">&lt;-</span> ret<span class="sc">$</span>clusters</span>
<span id="cb173-47"><a href="competitor-methods.html#cb173-47" aria-hidden="true" tabindex="-1"></a>    prototypes <span class="ot">&lt;-</span> ret<span class="sc">$</span>prototypes</span>
<span id="cb173-48"><a href="competitor-methods.html#cb173-48" aria-hidden="true" tabindex="-1"></a>    feat_names <span class="ot">&lt;-</span> ret<span class="sc">$</span>var_names</span>
<span id="cb173-49"><a href="competitor-methods.html#cb173-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-50"><a href="competitor-methods.html#cb173-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rm</span>(ret)</span>
<span id="cb173-51"><a href="competitor-methods.html#cb173-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-52"><a href="competitor-methods.html#cb173-52" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Format the design matrix for glmnet according to the cluster</span></span>
<span id="cb173-53"><a href="competitor-methods.html#cb173-53" aria-hidden="true" tabindex="-1"></a>    <span class="co"># representative lasso procedure</span></span>
<span id="cb173-54"><a href="competitor-methods.html#cb173-54" aria-hidden="true" tabindex="-1"></a>    X_glmnet <span class="ot">&lt;-</span> <a href='competitor-methods.html#getXglmnet'>getXglmnet</a>(x, clusters, <span class="at">type=</span><span class="st">&quot;clusterRepLasso&quot;</span>)</span>
<span id="cb173-55"><a href="competitor-methods.html#cb173-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-56"><a href="competitor-methods.html#cb173-56" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Estimate the lasso on the cluster representatives</span></span>
<span id="cb173-57"><a href="competitor-methods.html#cb173-57" aria-hidden="true" tabindex="-1"></a>    fit <span class="ot">&lt;-</span> glmnet<span class="sc">::</span><span class="fu">glmnet</span>(<span class="at">x=</span>X_glmnet, <span class="at">y=</span>y, <span class="at">family=</span><span class="st">&quot;gaussian&quot;</span>, <span class="at">nlambda=</span>nlambda)</span>
<span id="cb173-58"><a href="competitor-methods.html#cb173-58" aria-hidden="true" tabindex="-1"></a>    lasso_sets <span class="ot">&lt;-</span> <span class="fu">unique</span>(glmnet<span class="sc">::</span><span class="fu">predict.glmnet</span>(fit, <span class="at">type=</span><span class="st">&quot;nonzero&quot;</span>))</span>
<span id="cb173-59"><a href="competitor-methods.html#cb173-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-60"><a href="competitor-methods.html#cb173-60" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Finally, extract the desired information from the lasso fit--all the</span></span>
<span id="cb173-61"><a href="competitor-methods.html#cb173-61" aria-hidden="true" tabindex="-1"></a>    <span class="co"># sets of selected clusters (one for each observed model size), and</span></span>
<span id="cb173-62"><a href="competitor-methods.html#cb173-62" aria-hidden="true" tabindex="-1"></a>    <span class="co"># corresponding sets of selected features</span></span>
<span id="cb173-63"><a href="competitor-methods.html#cb173-63" aria-hidden="true" tabindex="-1"></a>    cluster_sel_results <span class="ot">&lt;-</span> <a href='competitor-methods.html#getClusterSelsFromGlmnet'>getClusterSelsFromGlmnet</a>(lasso_sets, clusters,</span>
<span id="cb173-64"><a href="competitor-methods.html#cb173-64" aria-hidden="true" tabindex="-1"></a>        prototypes, feat_names)</span>
<span id="cb173-65"><a href="competitor-methods.html#cb173-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-66"><a href="competitor-methods.html#cb173-66" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">selected_sets=</span>cluster_sel_results<span class="sc">$</span>selected_sets,</span>
<span id="cb173-67"><a href="competitor-methods.html#cb173-67" aria-hidden="true" tabindex="-1"></a>        <span class="at">selected_clusts_list=</span>cluster_sel_results<span class="sc">$</span>selected_clusts_list,</span>
<span id="cb173-68"><a href="competitor-methods.html#cb173-68" aria-hidden="true" tabindex="-1"></a>        <span class="at">beta=</span>fit<span class="sc">$</span>beta))</span>
<span id="cb173-69"><a href="competitor-methods.html#cb173-69" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Tests for <code><a href='competitor-methods.html#clusterRepLasso'>clusterRepLasso</a>()</code>:</p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="wrapper-functions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="documenting-the-package-and-adding-readme.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
