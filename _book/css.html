<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 The core function: css | Creating the cssr R package</title>
  <meta name="description" content="3 The core function: css | Creating the cssr R package" />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="3 The core function: css | Creating the cssr R package" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 The core function: css | Creating the cssr R package" />
  
  
  

<meta name="author" content="Gregory Faletto" />


<meta name="date" content="2023-01-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="overview.html"/>
<link rel="next" href="helper-functions.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="overview.html"><a href="overview.html"><i class="fa fa-check"></i><b>2</b> Overview</a>
<ul>
<li class="chapter" data-level="2.1" data-path="overview.html"><a href="overview.html#background"><i class="fa fa-check"></i><b>2.1</b> Background</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="overview.html"><a href="overview.html#cpss"><i class="fa fa-check"></i><b>2.1.1</b> Complementary pairs stability selection</a></li>
<li class="chapter" data-level="2.1.2" data-path="overview.html"><a href="overview.html#cluster-stability-selection"><i class="fa fa-check"></i><b>2.1.2</b> Cluster stability selection</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="overview.html"><a href="overview.html#outline"><i class="fa fa-check"></i><b>2.2</b> Outline</a></li>
<li class="chapter" data-level="2.3" data-path="overview.html"><a href="overview.html#package-setup"><i class="fa fa-check"></i><b>2.3</b> Package setup</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="css.html"><a href="css.html"><i class="fa fa-check"></i><b>3</b> The core function: <code>css</code></a></li>
<li class="chapter" data-level="4" data-path="helper-functions.html"><a href="helper-functions.html"><i class="fa fa-check"></i><b>4</b> Helper functions</a></li>
<li class="chapter" data-level="5" data-path="tests-for-main-functions-in-cssr-now-that-helper-functions-have-been-defined.html"><a href="tests-for-main-functions-in-cssr-now-that-helper-functions-have-been-defined.html"><i class="fa fa-check"></i><b>5</b> Tests for main functions in <code>cssr</code> (now that helper functions have been defined)</a></li>
<li class="chapter" data-level="6" data-path="sel-and-pred.html"><a href="sel-and-pred.html"><i class="fa fa-check"></i><b>6</b> Selection and prediction functions</a></li>
<li class="chapter" data-level="7" data-path="other-useful.html"><a href="other-useful.html"><i class="fa fa-check"></i><b>7</b> Other useful functions</a></li>
<li class="chapter" data-level="8" data-path="wrapper-functions.html"><a href="wrapper-functions.html"><i class="fa fa-check"></i><b>8</b> Convenient wrapper functions</a></li>
<li class="chapter" data-level="9" data-path="competitor-methods.html"><a href="competitor-methods.html"><i class="fa fa-check"></i><b>9</b> Competitor Methods</a></li>
<li class="chapter" data-level="10" data-path="documenting-the-package-and-adding-readme.html"><a href="documenting-the-package-and-adding-readme.html"><i class="fa fa-check"></i><b>10</b> Documenting the package and adding README</a>
<ul>
<li class="chapter" data-level="10.1" data-path="documenting-the-package-and-adding-readme.html"><a href="documenting-the-package-and-adding-readme.html#add-readme"><i class="fa fa-check"></i><b>10.1</b> Add README</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Creating the <code>cssr</code> R package</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="css" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> The core function: <code>css</code><a href="css.html#css" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The main inputs that <code><a href='css.html#css'>css</a>()</code> accepts are…</p>
<ul>
<li>a design matrix <code>X</code></li>
<li>a response <code>y</code></li>
<li>a selection method <code>fitfun</code> with specified tuning parameter <code>lambda</code>. This specifies <span class="math inline">\(\hat{S}^\lambda(A)\)</span>. In particular:</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="css.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do"><span id='param-fitfun'>###&quot;param-fitfun&quot;###</span></span></span>
<span id="cb5-2"><a href="css.html#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param fitfun A function; the feature selection function used on each</span></span>
<span id="cb5-3"><a href="css.html#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; subsample by cluster stability selection. This can be any feature selection</span></span>
<span id="cb5-4"><a href="css.html#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; method; the only requirement is that it accepts the arguments (and only the</span></span>
<span id="cb5-5"><a href="css.html#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; arguments) `X`, `y`, and `lambda` and returns an integer vector that is a </span></span>
<span id="cb5-6"><a href="css.html#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; subset of `1:p`. For example, `fitfun` could be best subset selection or </span></span>
<span id="cb5-7"><a href="css.html#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; forward stepwise selection or LARS and `lambda` could be the desired model </span></span>
<span id="cb5-8"><a href="css.html#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; size; or `fitfun` could be the elastic net and `lambda` could be a length-two</span></span>
<span id="cb5-9"><a href="css.html#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; vector specifying lambda and alpha. Default is `cssLasso`, an implementation </span></span>
<span id="cb5-10"><a href="css.html#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; of lasso (relying on the R package `glmnet`), where `lambda` must be a </span></span>
<span id="cb5-11"><a href="css.html#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; positive numeric specifying the L1 penalty for the `lasso`.</span></span></code></pre></div>
<p>and</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="css.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="do"><span id='param-lambda'>###&quot;param-lambda&quot;###</span></span></span>
<span id="cb6-2"><a href="css.html#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param lambda A tuning parameter or set of tuning parameters that may be used</span></span>
<span id="cb6-3"><a href="css.html#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; by the feature selection method `fitfun`. In the default case when</span></span>
<span id="cb6-4"><a href="css.html#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; `fitfun = cssLasso`, lambda should be a numeric: the penalty to use for each</span></span>
<span id="cb6-5"><a href="css.html#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; lasso fit. (`<a href='css.html#css'>css</a>()` does not require lambda to be any particular object because</span></span>
<span id="cb6-6"><a href="css.html#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; for a user-specified feature selection method `fitfun`, lambda can be an</span></span>
<span id="cb6-7"><a href="css.html#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; arbitrary object. See the description of `fitfun` below.)</span></span></code></pre></div>
<ul>
<li>a specification of which features belong together in highly correlated clusters. This specifies the clusters <span class="math inline">\(C_1,\ldots, C_K\)</span>. In particular:</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="css.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="do"><span id='param-clusters'>###&quot;param-clusters&quot;###</span></span></span>
<span id="cb7-2"><a href="css.html#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param clusters A list of integer vectors; each vector should contain the </span></span>
<span id="cb7-3"><a href="css.html#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; indices of a cluster of features (a subset of `1:p`). (If there is only one</span></span>
<span id="cb7-4"><a href="css.html#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; cluster, clusters can either be a list of length 1 or an integer vector.)</span></span>
<span id="cb7-5"><a href="css.html#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; All of the provided clusters must be non-overlapping. Every feature not</span></span>
<span id="cb7-6"><a href="css.html#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; appearing in any cluster will be assumed to be unclustered (that is, they</span></span>
<span id="cb7-7"><a href="css.html#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; will be treated as if they are in a &quot;cluster&quot; containing only themselves). If</span></span>
<span id="cb7-8"><a href="css.html#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; clusters is a list of length 0 (or a list only containing clusters of length</span></span>
<span id="cb7-9"><a href="css.html#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; 1), then `<a href='css.html#css'>css</a>()` returns the same results as stability selection (so the</span></span>
<span id="cb7-10"><a href="css.html#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; returned `feat_sel_mat` will be identical to `clus_sel_mat`). Names for the</span></span>
<span id="cb7-11"><a href="css.html#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; clusters will be needed later; any clusters that are not given names in the</span></span>
<span id="cb7-12"><a href="css.html#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; provided list will be given names automatically by `<a href='css.html#css'>css</a>()`. Default is </span></span>
<span id="cb7-13"><a href="css.html#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; `list()` (so no clusters are specified).</span></span></code></pre></div>
<ul>
<li>and a specification of the type of subsamples. For now we only consider the complementary subsets sampling of Shah and Samworth. However, we have included an option for Meinshausen-Buhlmann sampling which we may add later:</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="css.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="do"><span id='param-sampling_type'>###&quot;param-sampling_type&quot;###</span></span></span>
<span id="cb8-2"><a href="css.html#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param sampling_type A character vector; either &quot;SS&quot; or &quot;MB&quot;. For &quot;MB&quot;,</span></span>
<span id="cb8-3"><a href="css.html#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; all B subsamples are drawn randomly (as proposed by Meinshausen and Bühlmann</span></span>
<span id="cb8-4"><a href="css.html#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; 2010). For &quot;SS&quot;, in addition to these B subsamples, the B complementary pair</span></span>
<span id="cb8-5"><a href="css.html#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; subsamples will be drawn as well (see Faletto and Bien 2022 or Shah and</span></span>
<span id="cb8-6"><a href="css.html#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Samworth 2013 for details). Default is &quot;SS&quot;, and &quot;MB&quot; is not supported yet.</span></span></code></pre></div>
<p>The number of subsamples is also up to the user:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="css.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="do"><span id='param-B'>###&quot;param-B&quot;###</span></span></span>
<span id="cb9-2"><a href="css.html#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param B Integer or numeric; the number of subsamples. Note: For</span></span>
<span id="cb9-3"><a href="css.html#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; `sampling_type==&quot;MB&quot;` the total number of subsamples will be `B`; for</span></span>
<span id="cb9-4"><a href="css.html#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; `sampling_type=&quot;SS&quot;` the number of subsamples will be `2*B`. Default is 100</span></span>
<span id="cb9-5"><a href="css.html#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; for `sampling_type=&quot;MB&quot;` and 50 for `sampling_type=&quot;SS&quot;`.</span></span></code></pre></div>
<p>In this section, we will build the function <code><a href='css.html#css'>css</a>()</code> step-by-step.</p>
<ul>
<li><p>First, <code><a href='css.html#css'>css</a>()</code> creates random subsamples of the data: <span class="math inline">\(A_1,\ldots, A_B\)</span> (and <span class="math inline">\(\bar A_1,\ldots, \bar A_B\)</span> for Shah-Samworth subsampling). This is implemented in the function <code><a href='css.html#createSubsamples'>createSubsamples</a>()</code>.</p></li>
<li><p>Next, <code><a href='css.html#css'>css</a>()</code> executes the specified feature selection method <span class="math inline">\(\hat S^\lambda(\cdot)\)</span> on each subsample. This generates a binary matrix, <code>feat_sel_mat</code>, with one row for each subsample and one column for each feature in <code>X</code>. In each row, the entry corresponding to each feature equals 1 if the feature was selected on that subsample and 0 otherwise. <code>feat_sel_mat</code> is one of the outputs of <code><a href='css.html#css'>css</a>()</code>; it is used to calculate the selection proportions for individual features. This is implemented in the function <code><a href='css.html#getSelMatrix'>getSelMatrix</a>()</code>.</p></li>
<li><p>So far this is the same as the original stability selection procedure. Now we take into account the clusters. The function <code><a href='css.html#getClusterSelMatrix'>getClusterSelMatrix</a>()</code> takes in the formatted clusters as well as <code>feat_sel_mat</code> and generates the binary matrix <code>clus_sel_mat</code>, which contains selection indicators for each cluster. <code>clus_sel_mat</code> has the same number of rows as <code>feat_sel_mat</code> and one column for each cluster rather than one for each feature. This is used to calculate the cluster selection proportions.</p></li>
</ul>
<p>The function <code><a href='css.html#css'>css</a>()</code> is specified below. (There are some extra details that I omitted in the above description for brevity; you can read the full details below.)</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="css.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Cluster Stability Selection</span></span>
<span id="cb10-2"><a href="css.html#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb10-3"><a href="css.html#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Executes cluster stability selection algorithm. Takes subsamples of data,</span></span>
<span id="cb10-4"><a href="css.html#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; executes feature selection algorithm on each subsample, and returns matrices</span></span>
<span id="cb10-5"><a href="css.html#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; of feature selection indicators as well as cluster selection indicators.</span></span>
<span id="cb10-6"><a href="css.html#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb10-7"><a href="css.html#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param X An n x p numeric matrix (preferably) or a data.frame (which will</span></span>
<span id="cb10-8"><a href="css.html#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; be coerced internally to a matrix by the function model.matrix) containing</span></span>
<span id="cb10-9"><a href="css.html#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; p &gt;= 2 features/predictors.</span></span>
<span id="cb10-10"><a href="css.html#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param y The response; can be anything that takes the form of an</span></span>
<span id="cb10-11"><a href="css.html#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; n-dimensional vector, with the ith entry corresponding to the ith row of X.</span></span>
<span id="cb10-12"><a href="css.html#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Typically (and for default `fitfun = cssLasso`), `y` should be an n-dimensional</span></span>
<span id="cb10-13"><a href="css.html#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; numeric vector.</span></span>
<span id="cb10-14"><a href="css.html#cb10-14" aria-hidden="true" tabindex="-1"></a><a href='css.html#param-lambda'>&lt;&lt;param-lambda&gt;&gt;</a></span>
<span id="cb10-15"><a href="css.html#cb10-15" aria-hidden="true" tabindex="-1"></a><a href='css.html#param-clusters'>&lt;&lt;param-clusters&gt;&gt;</a></span>
<span id="cb10-16"><a href="css.html#cb10-16" aria-hidden="true" tabindex="-1"></a><a href='css.html#param-fitfun'>&lt;&lt;param-fitfun&gt;&gt;</a></span>
<span id="cb10-17"><a href="css.html#cb10-17" aria-hidden="true" tabindex="-1"></a><a href='css.html#param-sampling_type'>&lt;&lt;param-sampling_type&gt;&gt;</a></span>
<span id="cb10-18"><a href="css.html#cb10-18" aria-hidden="true" tabindex="-1"></a><a href='css.html#param-B'>&lt;&lt;param-B&gt;&gt;</a></span>
<span id="cb10-19"><a href="css.html#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param prop_feats_remove Numeric; if `prop_feats_remove` is greater than 0,</span></span>
<span id="cb10-20"><a href="css.html#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; then on each subsample, each feature is randomly dropped from the design</span></span>
<span id="cb10-21"><a href="css.html#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; matrix that is provided to `fitfun` with probability `prop_feats_remove`</span></span>
<span id="cb10-22"><a href="css.html#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; (independently across features). That is, in a typical subsample,</span></span>
<span id="cb10-23"><a href="css.html#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; `prop_feats_remove*p` features will be dropped (though this number will vary).</span></span>
<span id="cb10-24"><a href="css.html#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; This is similar in spirit (but distinct from) extended stability selection</span></span>
<span id="cb10-25"><a href="css.html#cb10-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; (Beinrucker et. al. 2016); see their paper for some of the benefits of</span></span>
<span id="cb10-26"><a href="css.html#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; dropping features (besides increasing computational speed and decreasing</span></span>
<span id="cb10-27"><a href="css.html#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; memory requirements). For `sampling_type=&quot;SS&quot;`, the features dropped in</span></span>
<span id="cb10-28"><a href="css.html#cb10-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; each complementary pair of subsamples are identical in order to ensure that</span></span>
<span id="cb10-29"><a href="css.html#cb10-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the theoretical guarantees of Faletto and Bien (2022) are retained within</span></span>
<span id="cb10-30"><a href="css.html#cb10-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; each individual pair of subsamples. (Note that this feature is not</span></span>
<span id="cb10-31"><a href="css.html#cb10-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; investigated either theoretically or in simulations by Faletto and Bien</span></span>
<span id="cb10-32"><a href="css.html#cb10-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; 2022). Must be between 0 and 1. Default is 0.</span></span>
<span id="cb10-33"><a href="css.html#cb10-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param train_inds Optional; an integer or numeric vector containing the</span></span>
<span id="cb10-34"><a href="css.html#cb10-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; indices of observations in `X` and `y` to set aside for model training by the</span></span>
<span id="cb10-35"><a href="css.html#cb10-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; function `<a href='sel-and-pred.html#getCssPreds'>getCssPreds</a>()` after feature selection. (This will only work if `y` is</span></span>
<span id="cb10-36"><a href="css.html#cb10-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; real-valued, because `<a href='sel-and-pred.html#getCssPreds'>getCssPreds</a>()` using ordinary least squares regression to</span></span>
<span id="cb10-37"><a href="css.html#cb10-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; generate predictions.) If `train_inds` is not provided, all of the observations</span></span>
<span id="cb10-38"><a href="css.html#cb10-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; in the provided data set will be used for feature selection.</span></span>
<span id="cb10-39"><a href="css.html#cb10-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param num_cores Optional; an integer. If using parallel processing, the</span></span>
<span id="cb10-40"><a href="css.html#cb10-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; number of cores to use for parallel processing (`num_cores` will be supplied</span></span>
<span id="cb10-41"><a href="css.html#cb10-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; internally as the `mc.cores` argument of `parallel::mclapply()`).</span></span>
<span id="cb10-42"><a href="css.html#cb10-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return A list containing the following items:</span></span>
<span id="cb10-43"><a href="css.html#cb10-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; \item{`feat_sel_mat`}{A `B` (or `2*B` for `sampling_type=&quot;SS&quot;`) x `p` numeric (binary) matrix. `feat_sel_mat[i, j] = 1` if feature `j` was selected by the base feature selection method on subsample `i`, and 0 otherwise.}</span></span>
<span id="cb10-44"><a href="css.html#cb10-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; \item{`clus_sel_mat`}{A `B` (or `2*B` for SS sampling) x `length(clusters)` numeric (binary) matrix. `clus_sel_mat[i, j] = 1` if at least one feature from cluster j was selected by the base feature selection method on subsample `i`, and 0 otherwise.}</span></span>
<span id="cb10-45"><a href="css.html#cb10-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; \item{`X`}{The `X` matrix provided to `<a href='css.html#css'>css</a>()`, coerced from a data.frame to a </span></span>
<span id="cb10-46"><a href="css.html#cb10-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; matrix if needed.}</span></span>
<span id="cb10-47"><a href="css.html#cb10-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; \item{`y`}{The `y` vector provided to `<a href='css.html#css'>css</a>()`.}</span></span>
<span id="cb10-48"><a href="css.html#cb10-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; \item{`clusters`}{A named list of integer vectors containing all of the clusters provided to `<a href='css.html#css'>css</a>()`, as well as size 1 clusters of any features not listed in any</span></span>
<span id="cb10-49"><a href="css.html#cb10-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; of the clusters provided to `<a href='css.html#css'>css</a>()`. All clusters will have names; any </span></span>
<span id="cb10-50"><a href="css.html#cb10-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; clusters not provided with a name in the input to `<a href='css.html#css'>css</a>()` will be given names</span></span>
<span id="cb10-51"><a href="css.html#cb10-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; automatically by `<a href='css.html#css'>css</a>()` (of the form c1, etc.).}</span></span>
<span id="cb10-52"><a href="css.html#cb10-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; \item{`train_inds`}{Identical to the `train_inds` provided to `<a href='css.html#css'>css</a>()`.}</span></span>
<span id="cb10-53"><a href="css.html#cb10-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @author Gregory Faletto, Jacob Bien</span></span>
<span id="cb10-54"><a href="css.html#cb10-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @references</span></span>
<span id="cb10-55"><a href="css.html#cb10-55" aria-hidden="true" tabindex="-1"></a><a href='index.html#faletto2022'>&lt;&lt;faletto2022&gt;&gt;</a></span>
<span id="cb10-56"><a href="css.html#cb10-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; </span></span>
<span id="cb10-57"><a href="css.html#cb10-57" aria-hidden="true" tabindex="-1"></a><a href='overview.html#shah2013'>&lt;&lt;shah2013&gt;&gt;</a></span>
<span id="cb10-58"><a href="css.html#cb10-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; </span></span>
<span id="cb10-59"><a href="css.html#cb10-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Meinshausen, N., &amp; Bühlmann, P. (2010). Stability Selection. \emph{Journal of the Royal</span></span>
<span id="cb10-60"><a href="css.html#cb10-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Statistical Society. Series B: Statistical Methodology}, 72(4), 417–473.</span></span>
<span id="cb10-61"><a href="css.html#cb10-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; \url{https://rss.onlinelibrary.wiley.com/doi/full/10.1111/j.1467-9868.2010.00740.x}.</span></span>
<span id="cb10-62"><a href="css.html#cb10-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; </span></span>
<span id="cb10-63"><a href="css.html#cb10-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Beinrucker, A., Dogan, Ü., &amp;</span></span>
<span id="cb10-64"><a href="css.html#cb10-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Blanchard, G. (2016). Extensions of stability selection using subsamples of</span></span>
<span id="cb10-65"><a href="css.html#cb10-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; observations and covariates. \emph{Statistics and Computing}, 26(5), 1059-</span></span>
<span id="cb10-66"><a href="css.html#cb10-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; 1077. \url{https://doi.org/10.1007/s11222-015-9589-y}.</span></span>
<span id="cb10-67"><a href="css.html#cb10-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; </span></span>
<span id="cb10-68"><a href="css.html#cb10-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Jerome Friedman, Trevor Hastie, Robert Tibshirani (2010). Regularization Paths for Generalized</span></span>
<span id="cb10-69"><a href="css.html#cb10-69" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Linear Models via Coordinate Descent. \emph{Journal of Statistical Software},</span></span>
<span id="cb10-70"><a href="css.html#cb10-70" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; 33(1), 1-22. URL \url{https://www.jstatsoft.org/v33/i01/}.</span></span>
<span id="cb10-71"><a href="css.html#cb10-71" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @export</span></span>
<span id="cb10-72"><a href="css.html#cb10-72" aria-hidden="true" tabindex="-1"></a><span id='css'>css</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(X, y, lambda, <span class="at">clusters =</span> <span class="fu">list</span>(), <span class="at">fitfun =</span> cssLasso,</span>
<span id="cb10-73"><a href="css.html#cb10-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">sampling_type =</span> <span class="st">&quot;SS&quot;</span>, <span class="at">B =</span> <span class="fu">ifelse</span>(sampling_type <span class="sc">==</span> <span class="st">&quot;MB&quot;</span>, 100L, 50L),</span>
<span id="cb10-74"><a href="css.html#cb10-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">prop_feats_remove =</span> <span class="dv">0</span>, <span class="at">train_inds =</span> <span class="fu">integer</span>(), <span class="at">num_cores =</span> 1L</span>
<span id="cb10-75"><a href="css.html#cb10-75" aria-hidden="true" tabindex="-1"></a>    ){</span>
<span id="cb10-76"><a href="css.html#cb10-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-77"><a href="css.html#cb10-77" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check inputs</span></span>
<span id="cb10-78"><a href="css.html#cb10-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-79"><a href="css.html#cb10-79" aria-hidden="true" tabindex="-1"></a>    check_list <span class="ot">&lt;-</span> <a href='helper-functions.html#checkCssInputs'>checkCssInputs</a>(X, y, lambda, clusters, fitfun, sampling_type,</span>
<span id="cb10-80"><a href="css.html#cb10-80" aria-hidden="true" tabindex="-1"></a>        B, prop_feats_remove, train_inds, num_cores)</span>
<span id="cb10-81"><a href="css.html#cb10-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-82"><a href="css.html#cb10-82" aria-hidden="true" tabindex="-1"></a>    feat_names <span class="ot">&lt;-</span> check_list<span class="sc">$</span>feat_names</span>
<span id="cb10-83"><a href="css.html#cb10-83" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> check_list<span class="sc">$</span>X</span>
<span id="cb10-84"><a href="css.html#cb10-84" aria-hidden="true" tabindex="-1"></a>    clusters <span class="ot">&lt;-</span> check_list<span class="sc">$</span>clusters</span>
<span id="cb10-85"><a href="css.html#cb10-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-86"><a href="css.html#cb10-86" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rm</span>(check_list)</span>
<span id="cb10-87"><a href="css.html#cb10-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-88"><a href="css.html#cb10-88" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(X)</span>
<span id="cb10-89"><a href="css.html#cb10-89" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ncol</span>(X)</span>
<span id="cb10-90"><a href="css.html#cb10-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-91"><a href="css.html#cb10-91" aria-hidden="true" tabindex="-1"></a>    train_inds <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(train_inds)</span>
<span id="cb10-92"><a href="css.html#cb10-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-93"><a href="css.html#cb10-93" aria-hidden="true" tabindex="-1"></a>    <span class="do">### Create subsamples</span></span>
<span id="cb10-94"><a href="css.html#cb10-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-95"><a href="css.html#cb10-95" aria-hidden="true" tabindex="-1"></a>    sel_inds <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="dv">1</span><span class="sc">:</span>n, train_inds)</span>
<span id="cb10-96"><a href="css.html#cb10-96" aria-hidden="true" tabindex="-1"></a>    n_sel <span class="ot">&lt;-</span> <span class="fu">length</span>(sel_inds)</span>
<span id="cb10-97"><a href="css.html#cb10-97" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(n_sel <span class="sc">&lt;</span> <span class="dv">4</span>){</span>
<span id="cb10-98"><a href="css.html#cb10-98" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stop</span>(<span class="st">&quot;Too many training indices provided (must be at least 4 observations left for feature selection, and ideally many more)&quot;</span>)</span>
<span id="cb10-99"><a href="css.html#cb10-99" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb10-100"><a href="css.html#cb10-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-101"><a href="css.html#cb10-101" aria-hidden="true" tabindex="-1"></a>    subsamps_object <span class="ot">&lt;-</span> <a href='css.html#createSubsamples'>createSubsamples</a>(n_sel, p, B, sampling_type,</span>
<span id="cb10-102"><a href="css.html#cb10-102" aria-hidden="true" tabindex="-1"></a>        prop_feats_remove)</span>
<span id="cb10-103"><a href="css.html#cb10-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-104"><a href="css.html#cb10-104" aria-hidden="true" tabindex="-1"></a>    <span class="do">### Get matrix of selected feature sets from subsamples</span></span>
<span id="cb10-105"><a href="css.html#cb10-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-106"><a href="css.html#cb10-106" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="sc">!</span><span class="fu">is.matrix</span>(y))</span>
<span id="cb10-107"><a href="css.html#cb10-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-108"><a href="css.html#cb10-108" aria-hidden="true" tabindex="-1"></a>    feat_sel_mat <span class="ot">&lt;-</span> <a href='css.html#getSelMatrix'>getSelMatrix</a>(X[sel_inds, ], y[sel_inds], lambda, B,</span>
<span id="cb10-109"><a href="css.html#cb10-109" aria-hidden="true" tabindex="-1"></a>        sampling_type, subsamps_object, num_cores, fitfun)</span>
<span id="cb10-110"><a href="css.html#cb10-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-111"><a href="css.html#cb10-111" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">any</span>(<span class="sc">!</span><span class="fu">is.na</span>(feat_names))){</span>
<span id="cb10-112"><a href="css.html#cb10-112" aria-hidden="true" tabindex="-1"></a>        <span class="fu">colnames</span>(feat_sel_mat) <span class="ot">&lt;-</span> feat_names</span>
<span id="cb10-113"><a href="css.html#cb10-113" aria-hidden="true" tabindex="-1"></a>        <span class="fu">colnames</span>(X) <span class="ot">&lt;-</span> feat_names</span>
<span id="cb10-114"><a href="css.html#cb10-114" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb10-115"><a href="css.html#cb10-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-116"><a href="css.html#cb10-116" aria-hidden="true" tabindex="-1"></a>    <span class="do">### Get selection proportions for clusters corresponding to each feature</span></span>
<span id="cb10-117"><a href="css.html#cb10-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-118"><a href="css.html#cb10-118" aria-hidden="true" tabindex="-1"></a>    clus_sel_mat <span class="ot">&lt;-</span> <a href='css.html#getClusterSelMatrix'>getClusterSelMatrix</a>(clusters, feat_sel_mat)</span>
<span id="cb10-119"><a href="css.html#cb10-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-120"><a href="css.html#cb10-120" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check outputs</span></span>
<span id="cb10-121"><a href="css.html#cb10-121" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="sc">!</span><span class="fu">is.null</span>(<span class="fu">colnames</span>(clus_sel_mat)))</span>
<span id="cb10-122"><a href="css.html#cb10-122" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">all</span>(<span class="fu">colnames</span>(clus_sel_mat) <span class="sc">==</span> <span class="fu">names</span>(clusters)))</span>
<span id="cb10-123"><a href="css.html#cb10-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-124"><a href="css.html#cb10-124" aria-hidden="true" tabindex="-1"></a>    ret <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">feat_sel_mat =</span> feat_sel_mat,</span>
<span id="cb10-125"><a href="css.html#cb10-125" aria-hidden="true" tabindex="-1"></a>        <span class="at">clus_sel_mat =</span> clus_sel_mat,</span>
<span id="cb10-126"><a href="css.html#cb10-126" aria-hidden="true" tabindex="-1"></a>        <span class="at">X =</span> X,</span>
<span id="cb10-127"><a href="css.html#cb10-127" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> y,</span>
<span id="cb10-128"><a href="css.html#cb10-128" aria-hidden="true" tabindex="-1"></a>        <span class="at">clusters =</span> clusters,</span>
<span id="cb10-129"><a href="css.html#cb10-129" aria-hidden="true" tabindex="-1"></a>        <span class="at">train_inds =</span> train_inds</span>
<span id="cb10-130"><a href="css.html#cb10-130" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb10-131"><a href="css.html#cb10-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-132"><a href="css.html#cb10-132" aria-hidden="true" tabindex="-1"></a>    <span class="fu">class</span>(ret) <span class="ot">&lt;-</span> <span class="st">&quot;cssr&quot;</span></span>
<span id="cb10-133"><a href="css.html#cb10-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-134"><a href="css.html#cb10-134" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(ret)</span>
<span id="cb10-135"><a href="css.html#cb10-135" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Tests for <code><a href='css.html#css'>css</a>()</code> and the other functions in this section are located at the end of this document. Next, we’ll build the individual functions one at a time. (The one function above that I didn’t mention at all is <code><a href='helper-functions.html#checkCssInputs'>checkCssInputs</a>()</code>, which confirms that the inputs to <code><a href='css.html#css'>css</a>()</code> are as expected and does some basic formatting on the inputs. To streamline presentation, this and other helper functions are specified later.) First we specify <code><a href='css.html#createSubsamples'>createSubsamples</a>()</code>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="css.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Creates lists of subsamples for stability selection.</span></span>
<span id="cb11-2"><a href="css.html#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb11-3"><a href="css.html#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param n Integer or numeric; sample size of the data set.</span></span>
<span id="cb11-4"><a href="css.html#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param p Integer or numeric; number of features.</span></span>
<span id="cb11-5"><a href="css.html#cb11-5" aria-hidden="true" tabindex="-1"></a><a href='css.html#param-B'>&lt;&lt;param-B&gt;&gt;</a></span>
<span id="cb11-6"><a href="css.html#cb11-6" aria-hidden="true" tabindex="-1"></a><a href='css.html#param-sampling_type'>&lt;&lt;param-sampling_type&gt;&gt;</a></span>
<span id="cb11-7"><a href="css.html#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param num_feats_remove Integer; number of features select automatically on</span></span>
<span id="cb11-8"><a href="css.html#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; every iteration. Determined earlier from input prop_feats_remove to css.</span></span>
<span id="cb11-9"><a href="css.html#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return A list of length `B` (or `2*B` for `sampling_type = &quot;SS&quot;`). If</span></span>
<span id="cb11-10"><a href="css.html#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; `prop_feats_remove = 0`, each list element is an integer vector of length</span></span>
<span id="cb11-11"><a href="css.html#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; `floor(n/2)` containing the indices of a subsample of `1:n`. (For</span></span>
<span id="cb11-12"><a href="css.html#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; `sampling_type==&quot;SS&quot;`, the last `B` subsamples will be complementary pairs of</span></span>
<span id="cb11-13"><a href="css.html#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the first `B` subsamples; see Faletto and Bien 2022 or Shah and Samworth 2013</span></span>
<span id="cb11-14"><a href="css.html#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; for details.) If `prop_feats_remove &gt; 0`, each element is a named list with</span></span>
<span id="cb11-15"><a href="css.html#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; members &quot;subsample&quot; (same as above) and &quot;feats_to_keep&quot;, a logical vector</span></span>
<span id="cb11-16"><a href="css.html#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; of length `p`; `feats_to_keep[j] = TRUE` if feature `j` is chosen for this</span></span>
<span id="cb11-17"><a href="css.html#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; subsample, and false otherwise.</span></span>
<span id="cb11-18"><a href="css.html#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @author Gregory Faletto, Jacob Bien</span></span>
<span id="cb11-19"><a href="css.html#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @references</span></span>
<span id="cb11-20"><a href="css.html#cb11-20" aria-hidden="true" tabindex="-1"></a><a href='index.html#faletto2022'>&lt;&lt;faletto2022&gt;&gt;</a></span>
<span id="cb11-21"><a href="css.html#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; </span></span>
<span id="cb11-22"><a href="css.html#cb11-22" aria-hidden="true" tabindex="-1"></a><a href='overview.html#shah2013'>&lt;&lt;shah2013&gt;&gt;</a></span>
<span id="cb11-23"><a href="css.html#cb11-23" aria-hidden="true" tabindex="-1"></a><span id='createSubsamples'>createSubsamples</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(n, p, B, sampling_type, <span class="at">prop_feats_remove=</span><span class="dv">0</span>){</span>
<span id="cb11-24"><a href="css.html#cb11-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-25"><a href="css.html#cb11-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check inputs</span></span>
<span id="cb11-26"><a href="css.html#cb11-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-27"><a href="css.html#cb11-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(n) <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb11-28"><a href="css.html#cb11-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.numeric</span>(n) <span class="sc">|</span> <span class="fu">is.integer</span>(n))</span>
<span id="cb11-29"><a href="css.html#cb11-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(n <span class="sc">==</span> <span class="fu">round</span>(n))</span>
<span id="cb11-30"><a href="css.html#cb11-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(n <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb11-31"><a href="css.html#cb11-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-32"><a href="css.html#cb11-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(p) <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb11-33"><a href="css.html#cb11-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.numeric</span>(p) <span class="sc">|</span> <span class="fu">is.integer</span>(p))</span>
<span id="cb11-34"><a href="css.html#cb11-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(p <span class="sc">==</span> <span class="fu">round</span>(p))</span>
<span id="cb11-35"><a href="css.html#cb11-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(p <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb11-36"><a href="css.html#cb11-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-37"><a href="css.html#cb11-37" aria-hidden="true" tabindex="-1"></a>    <a href='helper-functions.html#checkSamplingType'>checkSamplingType</a>(sampling_type)</span>
<span id="cb11-38"><a href="css.html#cb11-38" aria-hidden="true" tabindex="-1"></a>    <a href='helper-functions.html#checkPropFeatsRemove'>checkPropFeatsRemove</a>(prop_feats_remove, p)</span>
<span id="cb11-39"><a href="css.html#cb11-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-40"><a href="css.html#cb11-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(prop_feats_remove <span class="sc">==</span> <span class="dv">0</span>){</span>
<span id="cb11-41"><a href="css.html#cb11-41" aria-hidden="true" tabindex="-1"></a>        subsamples <span class="ot">&lt;-</span> <a href='css.html#getSubsamps'>getSubsamps</a>(n, B, sampling_type)</span>
<span id="cb11-42"><a href="css.html#cb11-42" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(subsamples)</span>
<span id="cb11-43"><a href="css.html#cb11-43" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span>{</span>
<span id="cb11-44"><a href="css.html#cb11-44" aria-hidden="true" tabindex="-1"></a>        <span class="co"># In this case, we generate subsamples as well as logical vectors</span></span>
<span id="cb11-45"><a href="css.html#cb11-45" aria-hidden="true" tabindex="-1"></a>        <span class="co"># of features to keep</span></span>
<span id="cb11-46"><a href="css.html#cb11-46" aria-hidden="true" tabindex="-1"></a>        subsamps_and_feats <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb11-47"><a href="css.html#cb11-47" aria-hidden="true" tabindex="-1"></a>        subsamples <span class="ot">&lt;-</span> <a href='css.html#getSubsamps'>getSubsamps</a>(n, B, sampling_type)</span>
<span id="cb11-48"><a href="css.html#cb11-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb11-49"><a href="css.html#cb11-49" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Logical p-vector, where each entry is TRUE with probability</span></span>
<span id="cb11-50"><a href="css.html#cb11-50" aria-hidden="true" tabindex="-1"></a>            <span class="co"># 1 - prop_feats_remove</span></span>
<span id="cb11-51"><a href="css.html#cb11-51" aria-hidden="true" tabindex="-1"></a>            feats_to_keep_i <span class="ot">&lt;-</span> <span class="fu">as.logical</span>(stats<span class="sc">::</span><span class="fu">rbinom</span>(<span class="at">n=</span>p, <span class="at">size=</span><span class="dv">1</span>,</span>
<span id="cb11-52"><a href="css.html#cb11-52" aria-hidden="true" tabindex="-1"></a>                <span class="at">prob=</span><span class="dv">1</span> <span class="sc">-</span> prop_feats_remove))</span>
<span id="cb11-53"><a href="css.html#cb11-53" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Make sure at least two entries are equal to TRUE (so that at</span></span>
<span id="cb11-54"><a href="css.html#cb11-54" aria-hidden="true" tabindex="-1"></a>            <span class="co"># least two features are present for every subsample)--if not,</span></span>
<span id="cb11-55"><a href="css.html#cb11-55" aria-hidden="true" tabindex="-1"></a>            <span class="co"># randomly choose features to add</span></span>
<span id="cb11-56"><a href="css.html#cb11-56" aria-hidden="true" tabindex="-1"></a>            <span class="cf">while</span>(<span class="fu">sum</span>(feats_to_keep_i) <span class="sc">&lt;</span> <span class="dv">2</span>){</span>
<span id="cb11-57"><a href="css.html#cb11-57" aria-hidden="true" tabindex="-1"></a>                false_inds <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="sc">!</span>feats_to_keep_i)</span>
<span id="cb11-58"><a href="css.html#cb11-58" aria-hidden="true" tabindex="-1"></a>                sel_feat <span class="ot">&lt;-</span> <span class="fu">sample</span>(false_inds, <span class="at">size=</span><span class="dv">1</span>)</span>
<span id="cb11-59"><a href="css.html#cb11-59" aria-hidden="true" tabindex="-1"></a>                feats_to_keep_i[sel_feat] <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb11-60"><a href="css.html#cb11-60" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb11-61"><a href="css.html#cb11-61" aria-hidden="true" tabindex="-1"></a>            subsamps_and_feats[[i]] <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">subsample=</span>subsamples[[i]],</span>
<span id="cb11-62"><a href="css.html#cb11-62" aria-hidden="true" tabindex="-1"></a>                <span class="at">feats_to_keep=</span>feats_to_keep_i)</span>
<span id="cb11-63"><a href="css.html#cb11-63" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb11-64"><a href="css.html#cb11-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-65"><a href="css.html#cb11-65" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(sampling_type<span class="sc">==</span><span class="st">&quot;SS&quot;</span>){</span>
<span id="cb11-66"><a href="css.html#cb11-66" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stopifnot</span>(<span class="fu">length</span>(subsamples) <span class="sc">==</span> <span class="dv">2</span><span class="sc">*</span>B)</span>
<span id="cb11-67"><a href="css.html#cb11-67" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb11-68"><a href="css.html#cb11-68" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Keep the same features as in the other subsample (this</span></span>
<span id="cb11-69"><a href="css.html#cb11-69" aria-hidden="true" tabindex="-1"></a>                <span class="co"># ensures that the theoretical guarantee of Shah and Samworth</span></span>
<span id="cb11-70"><a href="css.html#cb11-70" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 2013 remains valid on every individual pair of subsamples)</span></span>
<span id="cb11-71"><a href="css.html#cb11-71" aria-hidden="true" tabindex="-1"></a>                subsamps_and_feats[[B <span class="sc">+</span> i]] <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">subsample=</span>subsamples[[B <span class="sc">+</span> i]],</span>
<span id="cb11-72"><a href="css.html#cb11-72" aria-hidden="true" tabindex="-1"></a>                    <span class="at">feats_to_keep=</span>subsamps_and_feats[[i]]<span class="sc">$</span>feats_to_keep)</span>
<span id="cb11-73"><a href="css.html#cb11-73" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb11-74"><a href="css.html#cb11-74" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb11-75"><a href="css.html#cb11-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-76"><a href="css.html#cb11-76" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Check output</span></span>
<span id="cb11-77"><a href="css.html#cb11-77" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">all</span>(<span class="fu">names</span>(subsamps_and_feats) <span class="sc">==</span> <span class="fu">c</span>(<span class="st">&quot;subsample&quot;</span>,</span>
<span id="cb11-78"><a href="css.html#cb11-78" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;feats_to_keep&quot;</span>)))</span>
<span id="cb11-79"><a href="css.html#cb11-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-80"><a href="css.html#cb11-80" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(subsamps_and_feats)</span>
<span id="cb11-81"><a href="css.html#cb11-81" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb11-82"><a href="css.html#cb11-82" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Shouldn&#39;t be possible to reach this part of function</span></span>
<span id="cb11-83"><a href="css.html#cb11-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;createSubsamples failed to return anything&quot;</span>)</span>
<span id="cb11-84"><a href="css.html#cb11-84" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Notice that <code><a href='css.html#createSubsamples'>createSubsamples</a>()</code> calls some helper functions to check the inputs (again, these are specified later in the helper functions section). <code><a href='css.html#createSubsamples'>createSubsamples</a>()</code> also calls the workhorse function <code><a href='css.html#getSubsamps'>getSubsamps</a>()</code> to generate a list of subsamples.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="css.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Generate list of subsamples</span></span>
<span id="cb12-2"><a href="css.html#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb12-3"><a href="css.html#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co">#` Generate list of `B` (or `2*B` for sampling_type=&quot;SS&quot;) subsamples of size</span></span>
<span id="cb12-4"><a href="css.html#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">#` `n/2`</span></span>
<span id="cb12-5"><a href="css.html#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param n Integer or numeric; sample size of the data set.</span></span>
<span id="cb12-6"><a href="css.html#cb12-6" aria-hidden="true" tabindex="-1"></a><a href='css.html#param-B'>&lt;&lt;param-B&gt;&gt;</a></span>
<span id="cb12-7"><a href="css.html#cb12-7" aria-hidden="true" tabindex="-1"></a><a href='css.html#param-sampling_type'>&lt;&lt;param-sampling_type&gt;&gt;</a></span>
<span id="cb12-8"><a href="css.html#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return A list of length `B` (or `2*B` for `sampling_type=&quot;SS&quot;`), where each</span></span>
<span id="cb12-9"><a href="css.html#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; element is an integer vector of length `floor(n/2)` containing the indices</span></span>
<span id="cb12-10"><a href="css.html#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; of a subsample of `1:n`. For `sampling_type==&quot;SS&quot;`, the last `B` subsamples</span></span>
<span id="cb12-11"><a href="css.html#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; will be complementary pairs of the first `B` subsamples (see Faletto and</span></span>
<span id="cb12-12"><a href="css.html#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Bien 2022 or Shah and Samworth 2013 for details).</span></span>
<span id="cb12-13"><a href="css.html#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @author Gregory Faletto, Jacob Bien</span></span>
<span id="cb12-14"><a href="css.html#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @references</span></span>
<span id="cb12-15"><a href="css.html#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; </span></span>
<span id="cb12-16"><a href="css.html#cb12-16" aria-hidden="true" tabindex="-1"></a><a href='index.html#faletto2022'>&lt;&lt;faletto2022&gt;&gt;</a></span>
<span id="cb12-17"><a href="css.html#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; </span></span>
<span id="cb12-18"><a href="css.html#cb12-18" aria-hidden="true" tabindex="-1"></a><a href='overview.html#shah2013'>&lt;&lt;shah2013&gt;&gt;</a></span>
<span id="cb12-19"><a href="css.html#cb12-19" aria-hidden="true" tabindex="-1"></a><span id='getSubsamps'>getSubsamps</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(n, B, sampling_type){</span>
<span id="cb12-20"><a href="css.html#cb12-20" aria-hidden="true" tabindex="-1"></a>    subsamples <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb12-21"><a href="css.html#cb12-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb12-22"><a href="css.html#cb12-22" aria-hidden="true" tabindex="-1"></a>        subsamples[[i]] <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">sample.int</span>(<span class="at">n=</span>n, <span class="at">size=</span><span class="fu">floor</span>(n<span class="sc">/</span><span class="dv">2</span>), <span class="at">replace=</span><span class="cn">FALSE</span>))</span>
<span id="cb12-23"><a href="css.html#cb12-23" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb12-24"><a href="css.html#cb12-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(subsamples) <span class="sc">==</span> B)</span>
<span id="cb12-25"><a href="css.html#cb12-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># </span><span class="al">TODO</span><span class="co">(gregfaletto): add support for sampling_type=&quot;MB&quot;</span></span>
<span id="cb12-26"><a href="css.html#cb12-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(sampling_type<span class="sc">==</span><span class="st">&quot;SS&quot;</span>){</span>
<span id="cb12-27"><a href="css.html#cb12-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb12-28"><a href="css.html#cb12-28" aria-hidden="true" tabindex="-1"></a>            <span class="co"># For the ith entry, take a subsample of size floor(n/2) from the</span></span>
<span id="cb12-29"><a href="css.html#cb12-29" aria-hidden="true" tabindex="-1"></a>            <span class="co"># remaining n - floor(n/2) observations. (Only necessary to actually</span></span>
<span id="cb12-30"><a href="css.html#cb12-30" aria-hidden="true" tabindex="-1"></a>            <span class="co"># take the subsample if n is odd; if not, the set we want is</span></span>
<span id="cb12-31"><a href="css.html#cb12-31" aria-hidden="true" tabindex="-1"></a>            <span class="co"># setdiff(1:n, subsamples[[i]]), so skip the sample function.)</span></span>
<span id="cb12-32"><a href="css.html#cb12-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span>(n<span class="sc">/</span><span class="dv">2</span> <span class="sc">==</span> <span class="fu">floor</span>(n<span class="sc">/</span><span class="dv">2</span>)){</span>
<span id="cb12-33"><a href="css.html#cb12-33" aria-hidden="true" tabindex="-1"></a>                subsamples[[B <span class="sc">+</span> i]] <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">setdiff</span>(<span class="dv">1</span><span class="sc">:</span>n, subsamples[[i]]))</span>
<span id="cb12-34"><a href="css.html#cb12-34" aria-hidden="true" tabindex="-1"></a>            } <span class="cf">else</span>{</span>
<span id="cb12-35"><a href="css.html#cb12-35" aria-hidden="true" tabindex="-1"></a>                subsamples[[B <span class="sc">+</span> i]] <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">sample</span>(<span class="at">x=</span><span class="fu">setdiff</span>(<span class="dv">1</span><span class="sc">:</span>n,</span>
<span id="cb12-36"><a href="css.html#cb12-36" aria-hidden="true" tabindex="-1"></a>                    subsamples[[i]]), <span class="at">size=</span><span class="fu">floor</span>(n<span class="sc">/</span><span class="dv">2</span>), <span class="at">replace=</span><span class="cn">FALSE</span>))</span>
<span id="cb12-37"><a href="css.html#cb12-37" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb12-38"><a href="css.html#cb12-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-39"><a href="css.html#cb12-39" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Check output</span></span>
<span id="cb12-40"><a href="css.html#cb12-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-41"><a href="css.html#cb12-41" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stopifnot</span>(<span class="fu">is.integer</span>(subsamples[[B <span class="sc">+</span> i]]))</span>
<span id="cb12-42"><a href="css.html#cb12-42" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stopifnot</span>(<span class="fu">all</span>(subsamples[[B <span class="sc">+</span> i]] <span class="sc">==</span></span>
<span id="cb12-43"><a href="css.html#cb12-43" aria-hidden="true" tabindex="-1"></a>                <span class="fu">round</span>(subsamples[[B <span class="sc">+</span> i]])))</span>
<span id="cb12-44"><a href="css.html#cb12-44" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stopifnot</span>(<span class="fu">floor</span>(n<span class="sc">/</span><span class="dv">2</span>) <span class="sc">==</span> <span class="fu">length</span>(subsamples[[B <span class="sc">+</span> i]]))</span>
<span id="cb12-45"><a href="css.html#cb12-45" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stopifnot</span>(<span class="fu">length</span>(subsamples[[B <span class="sc">+</span> i]]) <span class="sc">==</span></span>
<span id="cb12-46"><a href="css.html#cb12-46" aria-hidden="true" tabindex="-1"></a>                <span class="fu">length</span>(<span class="fu">unique</span>(subsamples[[B <span class="sc">+</span> i]])))</span>
<span id="cb12-47"><a href="css.html#cb12-47" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb12-48"><a href="css.html#cb12-48" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">length</span>(subsamples) <span class="sc">==</span> <span class="dv">2</span><span class="sc">*</span>B)</span>
<span id="cb12-49"><a href="css.html#cb12-49" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb12-50"><a href="css.html#cb12-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(subsamples)</span>
<span id="cb12-51"><a href="css.html#cb12-51" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The next function called in the body of <code><a href='css.html#css'>css</a>()</code> is <code><a href='css.html#getSelMatrix'>getSelMatrix</a>()</code>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="css.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Generates matrix of selection indicators from stability selection.</span></span>
<span id="cb13-2"><a href="css.html#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb13-3"><a href="css.html#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param x an n x p numeric matrix or a data.frame containing the predictors.</span></span>
<span id="cb13-4"><a href="css.html#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param y A response vector; can be any response that takes the form of a</span></span>
<span id="cb13-5"><a href="css.html#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; length n vector and is used (or not used) by fitfun. Typically (and for</span></span>
<span id="cb13-6"><a href="css.html#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; default fitfun = cssLasso), y should be an n-dimensional numeric vector</span></span>
<span id="cb13-7"><a href="css.html#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; containing the response.</span></span>
<span id="cb13-8"><a href="css.html#cb13-8" aria-hidden="true" tabindex="-1"></a><a href='css.html#param-lambda'>&lt;&lt;param-lambda&gt;&gt;</a></span>
<span id="cb13-9"><a href="css.html#cb13-9" aria-hidden="true" tabindex="-1"></a><a href='css.html#param-B'>&lt;&lt;param-B&gt;&gt;</a></span>
<span id="cb13-10"><a href="css.html#cb13-10" aria-hidden="true" tabindex="-1"></a><a href='css.html#param-sampling_type'>&lt;&lt;param-sampling_type&gt;&gt;</a></span>
<span id="cb13-11"><a href="css.html#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param subsamps_object A list of length `B` (or `2*B` if `sampling_type=&quot;SS&quot;`),</span></span>
<span id="cb13-12"><a href="css.html#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; where each element is one of the following: \item{subsample}{An integer</span></span>
<span id="cb13-13"><a href="css.html#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; vector of size `n/2` containing the indices of the observations in the</span></span>
<span id="cb13-14"><a href="css.html#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; subsample.} \item{drop_var_input}{A named list containing two elements: one</span></span>
<span id="cb13-15"><a href="css.html#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; named &quot;subsample&quot;, matching the previous description, and a logical vector</span></span>
<span id="cb13-16"><a href="css.html#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; named &quot;feats_to_keep&quot; containing the indices of the features to be</span></span>
<span id="cb13-17"><a href="css.html#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; automatically selected.} (The first object is the output of the function</span></span>
<span id="cb13-18"><a href="css.html#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; createSubsamples when the provided prop_feats_remove is 0, the default, and</span></span>
<span id="cb13-19"><a href="css.html#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the second object is the output of createSubsamples when prop_feats_remove &gt;</span></span>
<span id="cb13-20"><a href="css.html#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; 0.)</span></span>
<span id="cb13-21"><a href="css.html#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param num_cores Optional; an integer. If using parallel processing, the</span></span>
<span id="cb13-22"><a href="css.html#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; number of cores to use for parallel processing (num_cores will be supplied</span></span>
<span id="cb13-23"><a href="css.html#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; internally as the mc.cores argument of parallel::mclapply).</span></span>
<span id="cb13-24"><a href="css.html#cb13-24" aria-hidden="true" tabindex="-1"></a><a href='css.html#param-fitfun'>&lt;&lt;param-fitfun&gt;&gt;</a></span>
<span id="cb13-25"><a href="css.html#cb13-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return A binary integer matrix of dimension `B` x `p` (if sampling_type ==</span></span>
<span id="cb13-26"><a href="css.html#cb13-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; &quot;MB&quot;) or `2*B` x `p` (if sampling_type == &quot;SS&quot;). res[i, j] = 1 if feature j</span></span>
<span id="cb13-27"><a href="css.html#cb13-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; was selected on subsample i and equals 0 otherwise. (That is, each row is a</span></span>
<span id="cb13-28"><a href="css.html#cb13-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; selected set.)</span></span>
<span id="cb13-29"><a href="css.html#cb13-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @author Gregory Faletto, Jacob Bien</span></span>
<span id="cb13-30"><a href="css.html#cb13-30" aria-hidden="true" tabindex="-1"></a><span id='getSelMatrix'>getSelMatrix</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, lambda, B, sampling_type, subsamps_object,</span>
<span id="cb13-31"><a href="css.html#cb13-31" aria-hidden="true" tabindex="-1"></a>    num_cores, <span class="at">fitfun=</span>cssLasso){</span>
<span id="cb13-32"><a href="css.html#cb13-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-33"><a href="css.html#cb13-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check inputs</span></span>
<span id="cb13-34"><a href="css.html#cb13-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-35"><a href="css.html#cb13-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.matrix</span>(x))</span>
<span id="cb13-36"><a href="css.html#cb13-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(x)))</span>
<span id="cb13-37"><a href="css.html#cb13-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-38"><a href="css.html#cb13-38" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x)</span>
<span id="cb13-39"><a href="css.html#cb13-39" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ncol</span>(x)</span>
<span id="cb13-40"><a href="css.html#cb13-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-41"><a href="css.html#cb13-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(y) <span class="sc">==</span> n)</span>
<span id="cb13-42"><a href="css.html#cb13-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="sc">!</span><span class="fu">is.matrix</span>(y))</span>
<span id="cb13-43"><a href="css.html#cb13-43" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Intentionally don&#39;t check y or lambda further to allow for flexibility--these</span></span>
<span id="cb13-44"><a href="css.html#cb13-44" aria-hidden="true" tabindex="-1"></a>    <span class="co"># inputs should be checked within fitfun.</span></span>
<span id="cb13-45"><a href="css.html#cb13-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-46"><a href="css.html#cb13-46" aria-hidden="true" tabindex="-1"></a>    <a href='helper-functions.html#checkSamplingType'>checkSamplingType</a>(sampling_type)</span>
<span id="cb13-47"><a href="css.html#cb13-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-48"><a href="css.html#cb13-48" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get list of selected feature sets from subsamples</span></span>
<span id="cb13-49"><a href="css.html#cb13-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-50"><a href="css.html#cb13-50" aria-hidden="true" tabindex="-1"></a>    res_list <span class="ot">&lt;-</span> parallel<span class="sc">::</span><span class="fu">mclapply</span>(<span class="at">X=</span>subsamps_object, <span class="at">FUN=</span>cssLoop, <span class="at">x=</span>x, <span class="at">y=</span>y,</span>
<span id="cb13-51"><a href="css.html#cb13-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">lambda=</span>lambda, <span class="at">fitfun=</span>fitfun, <span class="at">mc.cores=</span>num_cores)</span>
<span id="cb13-52"><a href="css.html#cb13-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-53"><a href="css.html#cb13-53" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Store selected sets in B x p (or `2*B` x p for &quot;SS&quot;) binary matrix</span></span>
<span id="cb13-54"><a href="css.html#cb13-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(sampling_type<span class="sc">==</span><span class="st">&quot;SS&quot;</span>){</span>
<span id="cb13-55"><a href="css.html#cb13-55" aria-hidden="true" tabindex="-1"></a>        res <span class="ot">&lt;-</span> <span class="fu">matrix</span>(0L, <span class="dv">2</span><span class="sc">*</span>B, p)</span>
<span id="cb13-56"><a href="css.html#cb13-56" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span>(sampling_type<span class="sc">==</span><span class="st">&quot;MB&quot;</span>){</span>
<span id="cb13-57"><a href="css.html#cb13-57" aria-hidden="true" tabindex="-1"></a>        res <span class="ot">&lt;-</span> <span class="fu">matrix</span>(0L, B, p)</span>
<span id="cb13-58"><a href="css.html#cb13-58" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span>{</span>
<span id="cb13-59"><a href="css.html#cb13-59" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stop</span>(<span class="st">&quot;!(sampling_type %in% c(SS, MB)) (don&#39;t know how to set dimensions of res&quot;</span>)</span>
<span id="cb13-60"><a href="css.html#cb13-60" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb13-61"><a href="css.html#cb13-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-62"><a href="css.html#cb13-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(res_list) <span class="sc">==</span> <span class="fu">nrow</span>(res))</span>
<span id="cb13-63"><a href="css.html#cb13-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-64"><a href="css.html#cb13-64" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get selected sets into matrix res</span></span>
<span id="cb13-65"><a href="css.html#cb13-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-66"><a href="css.html#cb13-66" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(res)){</span>
<span id="cb13-67"><a href="css.html#cb13-67" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="fu">length</span>(res_list[[i]]) <span class="sc">==</span> <span class="dv">0</span>){</span>
<span id="cb13-68"><a href="css.html#cb13-68" aria-hidden="true" tabindex="-1"></a>            <span class="co"># If no features are selected, don&#39;t fill in anything in this row</span></span>
<span id="cb13-69"><a href="css.html#cb13-69" aria-hidden="true" tabindex="-1"></a>            <span class="cf">next</span></span>
<span id="cb13-70"><a href="css.html#cb13-70" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb13-71"><a href="css.html#cb13-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-72"><a href="css.html#cb13-72" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.integer</span>(res_list[[i]])){</span>
<span id="cb13-73"><a href="css.html#cb13-73" aria-hidden="true" tabindex="-1"></a>            <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;failed on iteration&quot;</span>, i))</span>
<span id="cb13-74"><a href="css.html#cb13-74" aria-hidden="true" tabindex="-1"></a>            <span class="fu">print</span>(res_list[[i]])</span>
<span id="cb13-75"><a href="css.html#cb13-75" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stop</span>(<span class="st">&quot;Something seems to be wrong with the feature selection method (fitfun failed to return an integer vector)&quot;</span>)</span>
<span id="cb13-76"><a href="css.html#cb13-76" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb13-77"><a href="css.html#cb13-77" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">length</span>(res_list[[i]]) <span class="sc">&lt;=</span> p <span class="sc">&amp;</span> <span class="fu">length</span>(res_list[[i]]) <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb13-78"><a href="css.html#cb13-78" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(res_list[[i]])))</span>
<span id="cb13-79"><a href="css.html#cb13-79" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">max</span>(res_list[[i]]) <span class="sc">&lt;=</span> p)</span>
<span id="cb13-80"><a href="css.html#cb13-80" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">min</span>(res_list[[i]]) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb13-81"><a href="css.html#cb13-81" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">length</span>(res_list[[i]]) <span class="sc">==</span> <span class="fu">length</span>(<span class="fu">unique</span>(res_list[[i]])))</span>
<span id="cb13-82"><a href="css.html#cb13-82" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="sc">!</span>(<span class="st">&quot;try-error&quot;</span> <span class="sc">%in%</span> <span class="fu">class</span>(res_list[[i]]) <span class="sc">|</span></span>
<span id="cb13-83"><a href="css.html#cb13-83" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;error&quot;</span> <span class="sc">%in%</span> <span class="fu">class</span>(res_list[[i]]) <span class="sc">|</span></span>
<span id="cb13-84"><a href="css.html#cb13-84" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;simpleError&quot;</span> <span class="sc">%in%</span> <span class="fu">class</span>(res_list[[i]]) <span class="sc">|</span></span>
<span id="cb13-85"><a href="css.html#cb13-85" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;condition&quot;</span> <span class="sc">%in%</span> <span class="fu">class</span>(res_list[[i]])))</span>
<span id="cb13-86"><a href="css.html#cb13-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-87"><a href="css.html#cb13-87" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Store selected variables in the ith row of res</span></span>
<span id="cb13-88"><a href="css.html#cb13-88" aria-hidden="true" tabindex="-1"></a>        res[i, res_list[[i]]] <span class="ot">&lt;-</span> 1L</span>
<span id="cb13-89"><a href="css.html#cb13-89" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb13-90"><a href="css.html#cb13-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-91"><a href="css.html#cb13-91" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check output</span></span>
<span id="cb13-92"><a href="css.html#cb13-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-93"><a href="css.html#cb13-93" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.matrix</span>(res))</span>
<span id="cb13-94"><a href="css.html#cb13-94" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(sampling_type<span class="sc">==</span><span class="st">&quot;SS&quot;</span>){</span>
<span id="cb13-95"><a href="css.html#cb13-95" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">nrow</span>(res) <span class="sc">==</span> <span class="dv">2</span><span class="sc">*</span>B)</span>
<span id="cb13-96"><a href="css.html#cb13-96" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span>{</span>
<span id="cb13-97"><a href="css.html#cb13-97" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">nrow</span>(res) <span class="sc">==</span> B)</span>
<span id="cb13-98"><a href="css.html#cb13-98" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb13-99"><a href="css.html#cb13-99" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">ncol</span>(res) <span class="sc">==</span> p)</span>
<span id="cb13-100"><a href="css.html#cb13-100" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">all</span>(res <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)))</span>
<span id="cb13-101"><a href="css.html#cb13-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-102"><a href="css.html#cb13-102" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(res)</span>
<span id="cb13-103"><a href="css.html#cb13-103" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Again, <code><a href='css.html#getSelMatrix'>getSelMatrix</a>()</code> uses some helper functions to check the inputs for safety. <code><a href='css.html#getSelMatrix'>getSelMatrix</a>()</code> leverages the function <code>mclapply()</code> from the parallel package, in order to allow for parallel processing if the user has set this up. This requires a helper function <code><a href='helper-functions.html#cssLoop'>cssLoop</a>()</code>, which is also specified in the later section for helper functions.</p>
<p><code><a href='css.html#getSelMatrix'>getSelMatrix</a>()</code> also uses a feature selection function <code>fitfun</code> as an input. <code>fitfun</code> can be provided by the user as an input to <code><a href='css.html#css'>css</a>()</code>. We provide one default <code>fitfun</code>, <code><a href='css.html#cssLasso'>cssLasso</a>()</code>, which works on a real-valued response y given a specified penalty parameter lambda &gt; 0. Both for its own importance and to show an example of a valid <code>fitfun</code>, we show <code><a href='css.html#cssLasso'>cssLasso</a>()</code> here.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="css.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Provided fitfun implementing the lasso</span></span>
<span id="cb14-2"><a href="css.html#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb14-3"><a href="css.html#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Function used to select features with the lasso on each subsample in cluster</span></span>
<span id="cb14-4"><a href="css.html#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; stability selection. Uses glmnet implementation of the lasso.</span></span>
<span id="cb14-5"><a href="css.html#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param X A design matrix containing the predictors. (In practice this will</span></span>
<span id="cb14-6"><a href="css.html#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; be a subsample of the full design matrix provided to `<a href='css.html#css'>css</a>()`.)</span></span>
<span id="cb14-7"><a href="css.html#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param y A numeric vector containing the response.</span></span>
<span id="cb14-8"><a href="css.html#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param lambda Numeric; a nonnegative number for the lasso penalty to use</span></span>
<span id="cb14-9"><a href="css.html#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; on each subsample. (For now, only one lambda value can be provided to</span></span>
<span id="cb14-10"><a href="css.html#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; `<a href='css.html#cssLasso'>cssLasso</a>()`; in the future, we plan to allow for multiple lambda values to be</span></span>
<span id="cb14-11"><a href="css.html#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; provided to `<a href='css.html#cssLasso'>cssLasso</a>()`, as described in Faletto and Bien 2022.)</span></span>
<span id="cb14-12"><a href="css.html#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return An integer vector; the indices of the features selected by the lasso.</span></span>
<span id="cb14-13"><a href="css.html#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @author Gregory Faletto, Jacob Bien</span></span>
<span id="cb14-14"><a href="css.html#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @references </span></span>
<span id="cb14-15"><a href="css.html#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; </span></span>
<span id="cb14-16"><a href="css.html#cb14-16" aria-hidden="true" tabindex="-1"></a><a href='index.html#faletto2022'>&lt;&lt;faletto2022&gt;&gt;</a></span>
<span id="cb14-17"><a href="css.html#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; </span></span>
<span id="cb14-18"><a href="css.html#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Jerome Friedman, Trevor Hastie,</span></span>
<span id="cb14-19"><a href="css.html#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Robert Tibshirani (2010). Regularization Paths for Generalized Linear Models</span></span>
<span id="cb14-20"><a href="css.html#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; via Coordinate Descent. \emph{Journal of Statistical Software}, 33(1), 1-22.</span></span>
<span id="cb14-21"><a href="css.html#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; URL \url{https://www.jstatsoft.org/v33/i01/}.</span></span>
<span id="cb14-22"><a href="css.html#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @export</span></span>
<span id="cb14-23"><a href="css.html#cb14-23" aria-hidden="true" tabindex="-1"></a><span id='cssLasso'>cssLasso</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(X, y, lambda){</span>
<span id="cb14-24"><a href="css.html#cb14-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check inputs</span></span>
<span id="cb14-25"><a href="css.html#cb14-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-26"><a href="css.html#cb14-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># </span><span class="al">TODO</span><span class="co">(gregfaletto) allow cssLasso to accept a vector of lambda values rather</span></span>
<span id="cb14-27"><a href="css.html#cb14-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># than just a single one.</span></span>
<span id="cb14-28"><a href="css.html#cb14-28" aria-hidden="true" tabindex="-1"></a>    <a href='helper-functions.html#checkCssLassoInputs'>checkCssLassoInputs</a>(X, y, lambda)</span>
<span id="cb14-29"><a href="css.html#cb14-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-30"><a href="css.html#cb14-30" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(X)</span>
<span id="cb14-31"><a href="css.html#cb14-31" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ncol</span>(X)</span>
<span id="cb14-32"><a href="css.html#cb14-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-33"><a href="css.html#cb14-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fit a lasso path (full path for speed, per glmnet documentation)</span></span>
<span id="cb14-34"><a href="css.html#cb14-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-35"><a href="css.html#cb14-35" aria-hidden="true" tabindex="-1"></a>    lasso_model <span class="ot">&lt;-</span> glmnet<span class="sc">::</span><span class="fu">glmnet</span>(X, y, <span class="at">family=</span><span class="st">&quot;gaussian&quot;</span>)</span>
<span id="cb14-36"><a href="css.html#cb14-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">all.equal</span>(<span class="fu">class</span>(lasso_model), <span class="fu">c</span>(<span class="st">&quot;elnet&quot;</span>, <span class="st">&quot;glmnet&quot;</span>)))</span>
<span id="cb14-37"><a href="css.html#cb14-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-38"><a href="css.html#cb14-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get coefficients at desired lambda</span></span>
<span id="cb14-39"><a href="css.html#cb14-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-40"><a href="css.html#cb14-40" aria-hidden="true" tabindex="-1"></a>    pred <span class="ot">&lt;-</span> glmnet<span class="sc">::</span><span class="fu">predict.glmnet</span>(lasso_model, <span class="at">type=</span><span class="st">&quot;nonzero&quot;</span>,</span>
<span id="cb14-41"><a href="css.html#cb14-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">s=</span>lambda, <span class="at">exact=</span><span class="cn">TRUE</span>, <span class="at">newx=</span>X, <span class="at">x=</span>X, <span class="at">y=</span>y)</span>
<span id="cb14-42"><a href="css.html#cb14-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-43"><a href="css.html#cb14-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">is.null</span>(pred[[<span class="dv">1</span>]])){<span class="fu">return</span>(<span class="fu">integer</span>())}</span>
<span id="cb14-44"><a href="css.html#cb14-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-45"><a href="css.html#cb14-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.data.frame</span>(pred))</span>
<span id="cb14-46"><a href="css.html#cb14-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="sc">!</span>(<span class="st">&quot;try-error&quot;</span> <span class="sc">%in%</span> <span class="fu">class</span>(pred) <span class="sc">|</span> <span class="st">&quot;error&quot;</span> <span class="sc">%in%</span> <span class="fu">class</span>(pred) <span class="sc">|</span></span>
<span id="cb14-47"><a href="css.html#cb14-47" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;simpleError&quot;</span> <span class="sc">%in%</span> <span class="fu">class</span>(pred) <span class="sc">|</span> <span class="st">&quot;condition&quot;</span> <span class="sc">%in%</span> <span class="fu">class</span>(pred)))</span>
<span id="cb14-48"><a href="css.html#cb14-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-49"><a href="css.html#cb14-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">length</span>(<span class="fu">dim</span>(pred)) <span class="sc">==</span> <span class="dv">2</span>){</span>
<span id="cb14-50"><a href="css.html#cb14-50" aria-hidden="true" tabindex="-1"></a>        selected_glmnet <span class="ot">&lt;-</span> pred[, <span class="dv">1</span>]</span>
<span id="cb14-51"><a href="css.html#cb14-51" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span>(<span class="fu">length</span>(<span class="fu">dim</span>(pred)) <span class="sc">==</span> <span class="dv">3</span>){</span>
<span id="cb14-52"><a href="css.html#cb14-52" aria-hidden="true" tabindex="-1"></a>        selected_glmnet <span class="ot">&lt;-</span> pred[, <span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb14-53"><a href="css.html#cb14-53" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span>(<span class="fu">length</span>(<span class="fu">dim</span>(pred)) <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb14-54"><a href="css.html#cb14-54" aria-hidden="true" tabindex="-1"></a>        selected_glmnet <span class="ot">&lt;-</span> pred</span>
<span id="cb14-55"><a href="css.html#cb14-55" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span>{</span>
<span id="cb14-56"><a href="css.html#cb14-56" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stop</span>(<span class="st">&quot;length(dim(pred)) not 1, 2, or 3&quot;</span>)</span>
<span id="cb14-57"><a href="css.html#cb14-57" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb14-58"><a href="css.html#cb14-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-59"><a href="css.html#cb14-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(selected_glmnet) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb14-60"><a href="css.html#cb14-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(selected_glmnet) <span class="sc">&lt;=</span> <span class="fu">ncol</span>(X))</span>
<span id="cb14-61"><a href="css.html#cb14-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">all</span>(selected_glmnet <span class="sc">==</span> <span class="fu">round</span>(selected_glmnet)))</span>
<span id="cb14-62"><a href="css.html#cb14-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(selected_glmnet) <span class="sc">==</span> <span class="fu">length</span>(<span class="fu">unique</span>(selected_glmnet)))</span>
<span id="cb14-63"><a href="css.html#cb14-63" aria-hidden="true" tabindex="-1"></a>    selected_glmnet <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(selected_glmnet)</span>
<span id="cb14-64"><a href="css.html#cb14-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-65"><a href="css.html#cb14-65" aria-hidden="true" tabindex="-1"></a>    selected <span class="ot">&lt;-</span> <span class="fu">sort</span>(selected_glmnet)</span>
<span id="cb14-66"><a href="css.html#cb14-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-67"><a href="css.html#cb14-67" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(selected)</span>
<span id="cb14-68"><a href="css.html#cb14-68" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Notice that <code><a href='css.html#cssLasso'>cssLasso</a>()</code> depends on the package <code>glmnet</code>, and calls the function <code><a href='helper-functions.html#checkCssLassoInputs'>checkCssLassoInputs</a>()</code>, which verifies that the inputs to <code><a href='css.html#cssLasso'>cssLasso</a>()</code> are as needed. (In particular, the function <code><a href='css.html#css'>css</a>()</code> imposes very few requirements on <code>lambda</code> and <code>y</code> to allow the end user flexibility for any specified <code>fitfun</code>. <code><a href='helper-functions.html#checkCssLassoInputs'>checkCssLassoInputs</a>()</code> ensures that <code>y</code> is a real-valued response, <code>lambda</code> is a nonnegative real number, etc.) <code><a href='helper-functions.html#checkCssLassoInputs'>checkCssLassoInputs</a>()</code> is specified in the helper functions section later.</p>
<p>Finally, <code><a href='css.html#getClusterSelMatrix'>getClusterSelMatrix</a>()</code> is the last significant function called within <code><a href='css.html#css'>css</a>()</code>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="css.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Get cluster selection matrix</span></span>
<span id="cb15-2"><a href="css.html#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb15-3"><a href="css.html#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Given a matrix of feature selection indicator variables and a list of</span></span>
<span id="cb15-4"><a href="css.html#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; clusters of features, returns a matrix of cluster indicator variables.</span></span>
<span id="cb15-5"><a href="css.html#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb15-6"><a href="css.html#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param clusters A named list where each entry is an integer vector of indices</span></span>
<span id="cb15-7"><a href="css.html#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; of features that are in a common cluster, as in the output of formatClusters.</span></span>
<span id="cb15-8"><a href="css.html#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; (The length of list clusters is equal to the number of clusters.) All</span></span>
<span id="cb15-9"><a href="css.html#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; identified clusters must be non-overlapping, and all features must appear in</span></span>
<span id="cb15-10"><a href="css.html#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; exactly one cluster (any unclustered features should be in their own</span></span>
<span id="cb15-11"><a href="css.html#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; &quot;cluster&quot; of size 1).</span></span>
<span id="cb15-12"><a href="css.html#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param res A binary integer matrix. es[i, j] = 1 if feature j was selected</span></span>
<span id="cb15-13"><a href="css.html#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; on subsample i and equals 0 otherwise, as in the output of `<a href='css.html#getSelMatrix'>getSelMatrix</a>()`.</span></span>
<span id="cb15-14"><a href="css.html#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; (That is, each row is a selected set.)</span></span>
<span id="cb15-15"><a href="css.html#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return A binary integer matrix with the same number of rows</span></span>
<span id="cb15-16"><a href="css.html#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; as res and length(clusters) columns. Entry i, j is 1 if at least</span></span>
<span id="cb15-17"><a href="css.html#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; one member of cluster j was selected on subsample i, and 0 otherwise.</span></span>
<span id="cb15-18"><a href="css.html#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @author Gregory Faletto, Jacob Bien</span></span>
<span id="cb15-19"><a href="css.html#cb15-19" aria-hidden="true" tabindex="-1"></a><span id='getClusterSelMatrix'>getClusterSelMatrix</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(clusters, res){</span>
<span id="cb15-20"><a href="css.html#cb15-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-21"><a href="css.html#cb15-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check input</span></span>
<span id="cb15-22"><a href="css.html#cb15-22" aria-hidden="true" tabindex="-1"></a>    <a href='helper-functions.html#checkGetClusterSelMatrixInput'>checkGetClusterSelMatrixInput</a>(clusters, res)</span>
<span id="cb15-23"><a href="css.html#cb15-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-24"><a href="css.html#cb15-24" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ncol</span>(res)</span>
<span id="cb15-25"><a href="css.html#cb15-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-26"><a href="css.html#cb15-26" aria-hidden="true" tabindex="-1"></a>    n_clusters <span class="ot">&lt;-</span> <span class="fu">length</span>(clusters)</span>
<span id="cb15-27"><a href="css.html#cb15-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-28"><a href="css.html#cb15-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Matrix of cluster selection proportions (with n_clusters columns)</span></span>
<span id="cb15-29"><a href="css.html#cb15-29" aria-hidden="true" tabindex="-1"></a>    res_n_clusters <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(0L, <span class="fu">nrow</span>(res)<span class="sc">*</span>n_clusters), <span class="at">nrow=</span><span class="fu">nrow</span>(res),</span>
<span id="cb15-30"><a href="css.html#cb15-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">ncol=</span>n_clusters)</span>
<span id="cb15-31"><a href="css.html#cb15-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(res_n_clusters) <span class="ot">&lt;-</span> <span class="fu">names</span>(clusters)</span>
<span id="cb15-32"><a href="css.html#cb15-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-33"><a href="css.html#cb15-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_clusters){</span>
<span id="cb15-34"><a href="css.html#cb15-34" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Identify rows of res where at least one feature from this cluster</span></span>
<span id="cb15-35"><a href="css.html#cb15-35" aria-hidden="true" tabindex="-1"></a>        <span class="co"># was selected</span></span>
<span id="cb15-36"><a href="css.html#cb15-36" aria-hidden="true" tabindex="-1"></a>        rows_j_sel <span class="ot">&lt;-</span> <span class="fu">apply</span>(res, <span class="dv">1</span>, <span class="cf">function</span>(x){<span class="fu">any</span>(x[clusters[[j]]] <span class="sc">==</span> <span class="dv">1</span>)})</span>
<span id="cb15-37"><a href="css.html#cb15-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-38"><a href="css.html#cb15-38" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Put ones in these rows of res_n_clusters[, j]</span></span>
<span id="cb15-39"><a href="css.html#cb15-39" aria-hidden="true" tabindex="-1"></a>        res_n_clusters[rows_j_sel, j] <span class="ot">&lt;-</span> 1L</span>
<span id="cb15-40"><a href="css.html#cb15-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-41"><a href="css.html#cb15-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="fu">length</span>(clusters[[j]]) <span class="sc">&lt;=</span> <span class="dv">1</span>){</span>
<span id="cb15-42"><a href="css.html#cb15-42" aria-hidden="true" tabindex="-1"></a>            <span class="cf">next</span></span>
<span id="cb15-43"><a href="css.html#cb15-43" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-44"><a href="css.html#cb15-44" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-45"><a href="css.html#cb15-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-46"><a href="css.html#cb15-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check output</span></span>
<span id="cb15-47"><a href="css.html#cb15-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.matrix</span>(res_n_clusters))</span>
<span id="cb15-48"><a href="css.html#cb15-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">identical</span>(<span class="fu">colnames</span>(res_n_clusters), <span class="fu">names</span>(clusters)))</span>
<span id="cb15-49"><a href="css.html#cb15-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">all</span>(res_n_clusters <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)))</span>
<span id="cb15-50"><a href="css.html#cb15-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">ncol</span>(res_n_clusters) <span class="sc">==</span> <span class="fu">length</span>(clusters))</span>
<span id="cb15-51"><a href="css.html#cb15-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-52"><a href="css.html#cb15-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(res_n_clusters)</span>
<span id="cb15-53"><a href="css.html#cb15-53" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The helper function <code><a href='helper-functions.html#checkGetClusterSelMatrixInput'>checkGetClusterSelMatrixInput</a>()</code> verifies the inputs to <code><a href='css.html#getClusterSelMatrix'>getClusterSelMatrix</a>()</code>.</p>
<p>With the above and the helper functions below, the <code><a href='css.html#css'>css</a>()</code> function is complete!</p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="overview.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="helper-functions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
