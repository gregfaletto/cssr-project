<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Tests for main functions in css (now that helper functions have been defined) | Creating the cssr R package</title>
  <meta name="description" content="4 Tests for main functions in css (now that helper functions have been defined) | Creating the cssr R package" />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Tests for main functions in css (now that helper functions have been defined) | Creating the cssr R package" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Tests for main functions in css (now that helper functions have been defined) | Creating the cssr R package" />
  
  
  

<meta name="author" content="Gregory Faletto" />


<meta name="date" content="2023-01-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="helper-functions.html"/>
<link rel="next" href="competitor-methods.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Package setup</a></li>
<li class="chapter" data-level="2" data-path="now-to-the-package-itself.html"><a href="now-to-the-package-itself.html"><i class="fa fa-check"></i><b>2</b> Now to the package itself</a>
<ul>
<li class="chapter" data-level="2.1" data-path="now-to-the-package-itself.html"><a href="now-to-the-package-itself.html#the-core-function-css"><i class="fa fa-check"></i><b>2.1</b> The core function: css</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="helper-functions.html"><a href="helper-functions.html"><i class="fa fa-check"></i><b>3</b> Helper Functions</a></li>
<li class="chapter" data-level="4" data-path="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html"><i class="fa fa-check"></i><b>4</b> Tests for main functions in css (now that helper functions have been defined)</a>
<ul>
<li class="chapter" data-level="4.1" data-path="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#selection-and-prediction-functions"><i class="fa fa-check"></i><b>4.1</b> Selection and Prediction Functions</a></li>
<li class="chapter" data-level="4.2" data-path="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#other-useful-functions"><i class="fa fa-check"></i><b>4.2</b> Other useful functions</a></li>
<li class="chapter" data-level="4.3" data-path="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#convenient-wrapper-functions"><i class="fa fa-check"></i><b>4.3</b> Convenient Wrapper Functions</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="competitor-methods.html"><a href="competitor-methods.html"><i class="fa fa-check"></i><b>5</b> Competitor Methods</a></li>
<li class="chapter" data-level="6" data-path="documenting-the-package-and-building.html"><a href="documenting-the-package-and-building.html"><i class="fa fa-check"></i><b>6</b> Documenting the package and building</a></li>
<li class="chapter" data-level="7" data-path="add-readme.html"><a href="add-readme.html"><i class="fa fa-check"></i><b>7</b> Add README</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Creating the <code>cssr</code> R package</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">4</span> Tests for main functions in css (now that helper functions have been defined)<a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Tests for createSubsamples:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-1" aria-hidden="true" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">test_that</span>(<span class="st">&quot;createSubsamples works&quot;</span>, {</span>
<span id="cb56-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-2" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#createSubsamples'>createSubsamples</a>(<span class="at">n=</span>20L, <span class="at">p=</span>5L, <span class="at">B=</span>11L, <span class="at">sampling_type=</span><span class="st">&quot;SS&quot;</span>,</span>
<span id="cb56-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prop_feats_remove=</span><span class="dv">0</span>)</span>
<span id="cb56-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-4" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res))</span>
<span id="cb56-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-5" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), <span class="dv">2</span><span class="sc">*</span><span class="dv">11</span>)</span>
<span id="cb56-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-6" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">lengths</span>(res) <span class="sc">==</span> <span class="dv">20</span><span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb56-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-7" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">unique</span>(res[[<span class="dv">13</span>]])), <span class="dv">20</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb56-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-9" aria-hidden="true" tabindex="-1"></a>  set <span class="ot">&lt;-</span> res[[<span class="dv">4</span>]]</span>
<span id="cb56-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-10" aria-hidden="true" tabindex="-1"></a>  comp_set <span class="ot">&lt;-</span> res[[<span class="dv">4</span> <span class="sc">+</span> <span class="dv">11</span>]]</span>
<span id="cb56-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-12" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">intersect</span>(set, comp_set)), <span class="dv">0</span>)</span>
<span id="cb56-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-13" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">union</span>(set, comp_set)), <span class="fu">length</span>(<span class="fu">c</span>(set, comp_set)))</span>
<span id="cb56-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-14" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="dv">20</span>, <span class="fu">length</span>(<span class="fu">c</span>(set, comp_set)))</span>
<span id="cb56-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Try odd n</span></span>
<span id="cb56-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-18" aria-hidden="true" tabindex="-1"></a>  res_odd <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#createSubsamples'>createSubsamples</a>(<span class="at">n=</span>19L, <span class="at">p=</span>23L, <span class="at">B=</span>13L, <span class="at">sampling_type=</span><span class="st">&quot;SS&quot;</span>,</span>
<span id="cb56-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-19" aria-hidden="true" tabindex="-1"></a>                              <span class="at">prop_feats_remove=</span><span class="dv">0</span>)</span>
<span id="cb56-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-20" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res_odd))</span>
<span id="cb56-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-21" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res_odd), <span class="dv">2</span><span class="sc">*</span><span class="dv">13</span>)</span>
<span id="cb56-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-22" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">lengths</span>(res_odd) <span class="sc">==</span> <span class="fu">floor</span>(<span class="dv">19</span><span class="sc">/</span><span class="dv">2</span>)))</span>
<span id="cb56-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-23" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">unique</span>(res_odd[[<span class="dv">3</span>]])), <span class="fu">floor</span>(<span class="dv">19</span><span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb56-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-25" aria-hidden="true" tabindex="-1"></a>  set_odd <span class="ot">&lt;-</span> res_odd[[<span class="dv">2</span>]]</span>
<span id="cb56-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-26" aria-hidden="true" tabindex="-1"></a>  comp_set_odd <span class="ot">&lt;-</span> res_odd[[<span class="dv">2</span> <span class="sc">+</span> <span class="dv">13</span>]]</span>
<span id="cb56-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-28" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">intersect</span>(set_odd, comp_set_odd)), <span class="dv">0</span>)</span>
<span id="cb56-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-29" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">union</span>(set_odd, comp_set_odd)),</span>
<span id="cb56-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-30" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">length</span>(<span class="fu">c</span>(set_odd, comp_set_odd)))</span>
<span id="cb56-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-31" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="dv">19</span> <span class="sc">-</span> <span class="dv">1</span>, <span class="fu">length</span>(<span class="fu">c</span>(set_odd, comp_set_odd)))</span>
<span id="cb56-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-33" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='now-to-the-package-itself.html#createSubsamples'>createSubsamples</a>(<span class="at">n=</span>20L, <span class="at">p=</span>5L, <span class="at">B=</span>11L, <span class="at">sampling_type=</span><span class="st">&quot;MB&quot;</span>,</span>
<span id="cb56-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-34" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prop_feats_remove=</span><span class="dv">0</span>),</span>
<span id="cb56-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-35" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;sampling_type MB is not yet supported (and isn&#39;t recommended anyway)&quot;</span>,</span>
<span id="cb56-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-36" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb56-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># misspecified sampling_type (not specifying error because contains quotation</span></span>
<span id="cb56-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># marks)</span></span>
<span id="cb56-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-39" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='now-to-the-package-itself.html#createSubsamples'>createSubsamples</a>(<span class="at">n=</span>20L, <span class="at">p=</span>5L, <span class="at">B=</span>11L, <span class="at">sampling_type=</span><span class="st">&quot;S&quot;</span>,</span>
<span id="cb56-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-40" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prop_feats_remove=</span><span class="dv">0</span>))</span>
<span id="cb56-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-41" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='now-to-the-package-itself.html#createSubsamples'>createSubsamples</a>(<span class="at">n=</span><span class="fl">11.1</span>, <span class="at">p=</span>5L, <span class="at">B=</span>11L, <span class="at">sampling_type=</span><span class="st">&quot;SS&quot;</span>,</span>
<span id="cb56-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-42" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prop_feats_remove=</span><span class="dv">0</span>),</span>
<span id="cb56-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-43" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;n == round(n) is not TRUE&quot;</span>,</span>
<span id="cb56-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-44" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb56-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-45" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='now-to-the-package-itself.html#createSubsamples'>createSubsamples</a>(<span class="at">n=</span><span class="sc">-</span>20L, <span class="at">p=</span>5L, <span class="at">B=</span>11L, <span class="at">sampling_type=</span><span class="st">&quot;SS&quot;</span>,</span>
<span id="cb56-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-46" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prop_feats_remove=</span><span class="dv">0</span>),</span>
<span id="cb56-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-47" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;n &gt; 0 is not TRUE&quot;</span>,</span>
<span id="cb56-48"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-48" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb56-49"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-49" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='now-to-the-package-itself.html#createSubsamples'>createSubsamples</a>(<span class="at">n=</span>20L, <span class="at">p=</span>5L, <span class="at">B=</span><span class="fl">25.6</span>, <span class="at">sampling_type=</span><span class="st">&quot;SS&quot;</span>,</span>
<span id="cb56-50"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-50" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prop_feats_remove=</span><span class="dv">0</span>),</span>
<span id="cb56-51"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-51" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;length(subsamples) == B is not TRUE&quot;</span>,</span>
<span id="cb56-52"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-52" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb56-53"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb56-53" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## Test passed 😸</code></pre>
<p>Tests for getSubsamps</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb58-1" aria-hidden="true" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">test_that</span>(<span class="st">&quot;getSubsamps works&quot;</span>, {</span>
<span id="cb58-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb58-2" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#getSubsamps'>getSubsamps</a>(<span class="at">n=</span>18L, <span class="at">B=</span>21L, <span class="at">sampling_type=</span><span class="st">&quot;SS&quot;</span>)</span>
<span id="cb58-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb58-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb58-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb58-4" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res))</span>
<span id="cb58-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb58-5" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), <span class="dv">2</span><span class="sc">*</span><span class="dv">21</span>)</span>
<span id="cb58-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb58-6" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">lengths</span>(res) <span class="sc">==</span> <span class="dv">18</span><span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb58-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb58-7" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">unique</span>(res[[<span class="dv">7</span>]])), <span class="dv">18</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb58-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb58-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb58-9" aria-hidden="true" tabindex="-1"></a>  set <span class="ot">&lt;-</span> res[[<span class="dv">3</span>]]</span>
<span id="cb58-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb58-10" aria-hidden="true" tabindex="-1"></a>  comp_set <span class="ot">&lt;-</span> res[[<span class="dv">3</span> <span class="sc">+</span> <span class="dv">21</span>]]</span>
<span id="cb58-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb58-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb58-12" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">intersect</span>(set, comp_set)), <span class="dv">0</span>)</span>
<span id="cb58-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb58-13" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">union</span>(set, comp_set)), <span class="fu">length</span>(<span class="fu">c</span>(set, comp_set)))</span>
<span id="cb58-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb58-14" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="dv">18</span>, <span class="fu">length</span>(<span class="fu">c</span>(set, comp_set)))</span>
<span id="cb58-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb58-15" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## Test passed 😸</code></pre>
<p>Tests for getSelMatrix</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-1" aria-hidden="true" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">test_that</span>(<span class="st">&quot;getSelMatrix works&quot;</span>, {</span>
<span id="cb60-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">98623</span>)</span>
<span id="cb60-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">25</span><span class="sc">*</span><span class="dv">6</span>), <span class="at">nrow=</span><span class="dv">25</span>, <span class="at">ncol=</span><span class="dv">6</span>)</span>
<span id="cb60-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-4" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">25</span>)</span>
<span id="cb60-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-5" aria-hidden="true" tabindex="-1"></a>  subsamps_object <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#createSubsamples'>createSubsamples</a>(<span class="at">n=</span><span class="dv">25</span>, <span class="at">p=</span><span class="dv">6</span>, <span class="at">B=</span><span class="dv">12</span>, <span class="at">sampling_type=</span><span class="st">&quot;SS&quot;</span>,</span>
<span id="cb60-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-6" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">prop_feats_remove=</span><span class="dv">0</span>)</span>
<span id="cb60-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-7" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#getSelMatrix'>getSelMatrix</a>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">lambda=</span><span class="fl">0.01</span>, <span class="at">B=</span><span class="dv">12</span>, <span class="at">sampling_type=</span><span class="st">&quot;SS&quot;</span>,</span>
<span id="cb60-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">subsamps_object=</span>subsamps_object, <span class="at">num_cores=</span><span class="dv">1</span>,</span>
<span id="cb60-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">fitfun=</span>cssLasso)</span>
<span id="cb60-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-11" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(res))</span>
<span id="cb60-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-12" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(res), <span class="dv">2</span><span class="sc">*</span><span class="dv">12</span>)</span>
<span id="cb60-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-13" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">ncol</span>(res), <span class="dv">6</span>)</span>
<span id="cb60-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-14" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(res <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)))</span>
<span id="cb60-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-15" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">is.integer</span>(res)))</span>
<span id="cb60-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Try a different fitfun</span></span>
<span id="cb60-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-19" aria-hidden="true" tabindex="-1"></a>  <span id='testFitfun'>testFitfun</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(X, y, lambda){</span>
<span id="cb60-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-20" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ncol</span>(X)</span>
<span id="cb60-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(p <span class="sc">&gt;=</span> <span class="dv">2</span>)</span>
<span id="cb60-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Choose p/2 features randomly</span></span>
<span id="cb60-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-23" aria-hidden="true" tabindex="-1"></a>    selected <span class="ot">&lt;-</span> <span class="fu">sample.int</span>(p, <span class="at">size=</span><span class="fu">floor</span>(p<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb60-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(selected)</span>
<span id="cb60-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb60-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Note that value of lambda doesn&#39;t matter</span></span>
<span id="cb60-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-28" aria-hidden="true" tabindex="-1"></a>  res2 <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#getSelMatrix'>getSelMatrix</a>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">lambda=</span><span class="st">&quot;foo&quot;</span>, <span class="at">B=</span><span class="dv">12</span>, <span class="at">sampling_type=</span><span class="st">&quot;SS&quot;</span>,</span>
<span id="cb60-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-29" aria-hidden="true" tabindex="-1"></a>                      <span class="at">subsamps_object=</span>subsamps_object, <span class="at">num_cores=</span><span class="dv">1</span>,</span>
<span id="cb60-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-30" aria-hidden="true" tabindex="-1"></a>                      <span class="at">fitfun=</span>testFitfun)</span>
<span id="cb60-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-32" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(res2))</span>
<span id="cb60-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-33" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(res2), <span class="dv">2</span><span class="sc">*</span><span class="dv">12</span>)</span>
<span id="cb60-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-34" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">ncol</span>(res2), <span class="dv">6</span>)</span>
<span id="cb60-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-35" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(res2 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)))</span>
<span id="cb60-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-36" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">is.integer</span>(res2)))</span>
<span id="cb60-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-38" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='now-to-the-package-itself.html#getSelMatrix'>getSelMatrix</a>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">lambda=</span><span class="st">&quot;0.02&quot;</span>, <span class="at">B=</span><span class="dv">12</span>, <span class="at">sampling_type=</span><span class="st">&quot;SS&quot;</span>,</span>
<span id="cb60-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-39" aria-hidden="true" tabindex="-1"></a>                      <span class="at">subsamps_object=</span><span class="st">&quot;subsamps_object&quot;</span>, <span class="at">num_cores=</span><span class="dv">1</span>,</span>
<span id="cb60-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-40" aria-hidden="true" tabindex="-1"></a>                      <span class="at">fitfun=</span>testFitfun),</span>
<span id="cb60-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-41" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;is.integer(subsample) is not TRUE&quot;</span>,</span>
<span id="cb60-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-42" aria-hidden="true" tabindex="-1"></a>                      <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb60-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-43" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='now-to-the-package-itself.html#getSelMatrix'>getSelMatrix</a>(<span class="at">x=</span>x[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>, ], <span class="at">y=</span>y, <span class="at">lambda=</span><span class="st">&quot;foo&quot;</span>, <span class="at">B=</span><span class="dv">12</span>, <span class="at">sampling_type=</span><span class="st">&quot;SS&quot;</span>,</span>
<span id="cb60-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-44" aria-hidden="true" tabindex="-1"></a>                      <span class="at">subsamps_object=</span>subsamps_object, <span class="at">num_cores=</span><span class="dv">1</span>,</span>
<span id="cb60-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-45" aria-hidden="true" tabindex="-1"></a>                      <span class="at">fitfun=</span>testFitfun),</span>
<span id="cb60-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-46" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;length(y) == n is not TRUE&quot;</span>,</span>
<span id="cb60-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-47" aria-hidden="true" tabindex="-1"></a>                      <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb60-48"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-48" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='now-to-the-package-itself.html#getSelMatrix'>getSelMatrix</a>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">lambda=</span><span class="sc">-</span><span class="fl">0.02</span>, <span class="at">B=</span><span class="dv">12</span>, <span class="at">sampling_type=</span><span class="st">&quot;SS&quot;</span>,</span>
<span id="cb60-49"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-49" aria-hidden="true" tabindex="-1"></a>                      <span class="at">subsamps_object=</span>subsamps_object, <span class="at">num_cores=</span><span class="dv">1</span>,</span>
<span id="cb60-50"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-50" aria-hidden="true" tabindex="-1"></a>                      <span class="at">fitfun=</span>cssLasso),</span>
<span id="cb60-51"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-51" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;For method cssLasso, lambda must be nonnegative.&quot;</span>,</span>
<span id="cb60-52"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-52" aria-hidden="true" tabindex="-1"></a>                      <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb60-53"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Wrong B</span></span>
<span id="cb60-54"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-54" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='now-to-the-package-itself.html#getSelMatrix'>getSelMatrix</a>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">lambda=</span><span class="fl">0.02</span>, <span class="at">B=</span><span class="dv">37</span>, <span class="at">sampling_type=</span><span class="st">&quot;SS&quot;</span>,</span>
<span id="cb60-55"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-55" aria-hidden="true" tabindex="-1"></a>                      <span class="at">subsamps_object=</span>subsamps_object, <span class="at">num_cores=</span><span class="dv">1</span>,</span>
<span id="cb60-56"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-56" aria-hidden="true" tabindex="-1"></a>                      <span class="at">fitfun=</span>cssLasso),</span>
<span id="cb60-57"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-57" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;length(res_list) == nrow(res) is not TRUE&quot;</span>,</span>
<span id="cb60-58"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-58" aria-hidden="true" tabindex="-1"></a>                      <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb60-59"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb60-59" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## Test passed 🎉</code></pre>
<p>Tests for cssLasso</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb62-1" aria-hidden="true" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">test_that</span>(<span class="st">&quot;cssLasso works&quot;</span>, {</span>
<span id="cb62-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">24509</span>)</span>
<span id="cb62-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb62-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">15</span><span class="sc">*</span><span class="dv">4</span>), <span class="at">nrow=</span><span class="dv">15</span>, <span class="at">ncol=</span><span class="dv">4</span>)</span>
<span id="cb62-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb62-4" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">15</span>)</span>
<span id="cb62-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb62-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb62-6" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#cssLasso'>cssLasso</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">lambda=</span><span class="fl">0.01</span>)</span>
<span id="cb62-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb62-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb62-8" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.integer</span>(res))</span>
<span id="cb62-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb62-9" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res) <span class="sc">&lt;=</span> <span class="dv">4</span>)</span>
<span id="cb62-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb62-10" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res) <span class="sc">&gt;=</span> <span class="dv">0</span>)</span>
<span id="cb62-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb62-11" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res) <span class="sc">==</span> <span class="fu">length</span>(<span class="fu">unique</span>(res)))</span>
<span id="cb62-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb62-12" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(res <span class="sc">&lt;=</span> <span class="dv">4</span>))</span>
<span id="cb62-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb62-13" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(res <span class="sc">&gt;=</span> <span class="dv">1</span>))</span>
<span id="cb62-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb62-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb62-15" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='now-to-the-package-itself.html#cssLasso'>cssLasso</a>(<span class="at">X=</span>x[<span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>, ], <span class="at">y=</span>y, <span class="at">lambda=</span><span class="fl">0.01</span>),</span>
<span id="cb62-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb62-16" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;For method cssLasso, y must be a vector of length equal to nrow(X).&quot;</span>,</span>
<span id="cb62-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb62-17" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb62-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb62-18" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='now-to-the-package-itself.html#cssLasso'>cssLasso</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">lambda=</span><span class="sc">-</span><span class="fl">0.01</span>),</span>
<span id="cb62-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb62-19" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;For method cssLasso, lambda must be nonnegative.&quot;</span>,</span>
<span id="cb62-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb62-20" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb62-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb62-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb62-22" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## Test passed 😀</code></pre>
<p>Tests for getClusterSelMatrix:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-1" aria-hidden="true" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">test_that</span>(<span class="st">&quot;getClusterSelMatrix works&quot;</span>, {</span>
<span id="cb64-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-2" aria-hidden="true" tabindex="-1"></a>  good_clusters <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">red_cluster=</span>1L<span class="sc">:</span>5L,</span>
<span id="cb64-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">green_cluster=</span>6L<span class="sc">:</span>8L, <span class="at">blue_clust=</span>9L)</span>
<span id="cb64-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-5" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> <span class="dv">14</span></span>
<span id="cb64-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-6" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="dv">9</span></span>
<span id="cb64-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-8" aria-hidden="true" tabindex="-1"></a>  res_entries <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">size=</span><span class="dv">2</span><span class="sc">*</span>B<span class="sc">*</span>p, <span class="at">replace=</span><span class="cn">TRUE</span>))</span>
<span id="cb64-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-10" aria-hidden="true" tabindex="-1"></a>  good_res <span class="ot">&lt;-</span> <span class="fu">matrix</span>(res_entries, <span class="at">nrow=</span><span class="dv">2</span><span class="sc">*</span>B, <span class="at">ncol=</span>p)</span>
<span id="cb64-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-12" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#getClusterSelMatrix'>getClusterSelMatrix</a>(good_clusters, good_res)</span>
<span id="cb64-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-14" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(res))</span>
<span id="cb64-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-15" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(res), <span class="dv">2</span><span class="sc">*</span>B)</span>
<span id="cb64-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 3 clusters</span></span>
<span id="cb64-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-17" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">ncol</span>(res), <span class="dv">3</span>)</span>
<span id="cb64-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-18" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">colnames</span>(res), <span class="fu">c</span>(<span class="st">&quot;red_cluster&quot;</span>, <span class="st">&quot;green_cluster&quot;</span>,</span>
<span id="cb64-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-19" aria-hidden="true" tabindex="-1"></a>                                              <span class="st">&quot;blue_clust&quot;</span>))</span>
<span id="cb64-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-20" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">is.integer</span>(res)))</span>
<span id="cb64-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-21" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(res <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)))</span>
<span id="cb64-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-23" aria-hidden="true" tabindex="-1"></a>  clust_2 <span class="ot">&lt;-</span> good_clusters[[<span class="dv">2</span>]]</span>
<span id="cb64-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-25" aria-hidden="true" tabindex="-1"></a>  any_one <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(good_res[, clust_2]) <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb64-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">any</span>(any_one)){</span>
<span id="cb64-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-27" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(res[any_one, <span class="dv">2</span>] <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb64-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb64-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-30" aria-hidden="true" tabindex="-1"></a>  all_zeros <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(good_res[, clust_2]) <span class="sc">==</span> <span class="dv">0</span></span>
<span id="cb64-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">any</span>(all_zeros)){</span>
<span id="cb64-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-32" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(res[all_zeros, <span class="dv">2</span>] <span class="sc">==</span> <span class="dv">0</span>))</span>
<span id="cb64-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-33" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb64-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Not all features in a cluster</span></span>
<span id="cb64-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-36" aria-hidden="true" tabindex="-1"></a>  bad_clusters <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">red_cluster=</span>1L<span class="sc">:</span>5L, <span class="at">green_cluster=</span>6L<span class="sc">:</span>7L, <span class="at">blue_clust=</span>9L)</span>
<span id="cb64-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-38" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='now-to-the-package-itself.html#getClusterSelMatrix'>getClusterSelMatrix</a>(bad_clusters, good_res),</span>
<span id="cb64-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-39" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;length(all_clustered_feats) == p is not TRUE&quot;</span>,</span>
<span id="cb64-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-40" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb64-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-42" aria-hidden="true" tabindex="-1"></a>  bad_res_entries <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>), <span class="at">size=</span><span class="dv">2</span><span class="sc">*</span>B<span class="sc">*</span>p, <span class="at">replace=</span><span class="cn">TRUE</span>))</span>
<span id="cb64-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-44" aria-hidden="true" tabindex="-1"></a>  bad_res <span class="ot">&lt;-</span> <span class="fu">matrix</span>(bad_res_entries, <span class="at">nrow=</span><span class="dv">2</span><span class="sc">*</span>B, <span class="at">ncol=</span>p)</span>
<span id="cb64-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-46" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='now-to-the-package-itself.html#getClusterSelMatrix'>getClusterSelMatrix</a>(good_clusters, bad_res),</span>
<span id="cb64-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-47" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;all(res %in% c(0, 1)) is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb64-48"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb64-48" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## Test passed 🌈</code></pre>
<p>Finally, tests for css itself!</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-1" aria-hidden="true" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">test_that</span>(<span class="st">&quot;css works&quot;</span>, {</span>
<span id="cb66-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">8712</span>)</span>
<span id="cb66-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-4" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">15</span><span class="sc">*</span><span class="dv">11</span>), <span class="at">nrow=</span><span class="dv">15</span>, <span class="at">ncol=</span><span class="dv">11</span>)</span>
<span id="cb66-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-5" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">15</span>)</span>
<span id="cb66-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Intentionally don&#39;t provide clusters for all feature, mix up formatting,</span></span>
<span id="cb66-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># etc.</span></span>
<span id="cb66-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-9" aria-hidden="true" tabindex="-1"></a>  good_clusters <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">red_cluster=</span>1L<span class="sc">:</span>5L,</span>
<span id="cb66-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-10" aria-hidden="true" tabindex="-1"></a>                        <span class="at">green_cluster=</span>6L<span class="sc">:</span>8L,</span>
<span id="cb66-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-11" aria-hidden="true" tabindex="-1"></a>                        <span class="at">c4=</span><span class="dv">10</span><span class="sc">:</span><span class="dv">11</span>)</span>
<span id="cb66-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-13" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">lambda=</span><span class="fl">0.01</span>, <span class="at">clusters=</span>good_clusters, <span class="at">fitfun =</span> cssLasso,</span>
<span id="cb66-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">sampling_type =</span> <span class="st">&quot;SS&quot;</span>, <span class="at">B =</span> <span class="dv">13</span>,</span>
<span id="cb66-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">prop_feats_remove =</span> <span class="dv">0</span>, <span class="at">train_inds =</span> <span class="fu">integer</span>(), <span class="at">num_cores =</span> 1L)</span>
<span id="cb66-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Basic output</span></span>
<span id="cb66-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-18" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res))</span>
<span id="cb66-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-19" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">class</span>(res), <span class="st">&quot;cssr&quot;</span>)</span>
<span id="cb66-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-20" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(res), <span class="fu">c</span>(<span class="st">&quot;feat_sel_mat&quot;</span>, <span class="st">&quot;clus_sel_mat&quot;</span>, <span class="st">&quot;X&quot;</span>,</span>
<span id="cb66-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-21" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">&quot;y&quot;</span>, <span class="st">&quot;clusters&quot;</span>, <span class="st">&quot;train_inds&quot;</span>))</span>
<span id="cb66-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># feat_sel mat</span></span>
<span id="cb66-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-24" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.integer</span>(res<span class="sc">$</span>feat_sel_mat))</span>
<span id="cb66-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-25" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(res<span class="sc">$</span>feat_sel_mat))</span>
<span id="cb66-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-26" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(res<span class="sc">$</span>feat_sel_mat <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)))</span>
<span id="cb66-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-27" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">ncol</span>(res<span class="sc">$</span>feat_sel_mat), <span class="dv">11</span>)</span>
<span id="cb66-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-28" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_null</span>(<span class="fu">colnames</span>(res<span class="sc">$</span>feat_sel_mat))</span>
<span id="cb66-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># clus_sel_mat</span></span>
<span id="cb66-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-31" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.integer</span>(res<span class="sc">$</span>clus_sel_mat))</span>
<span id="cb66-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-32" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(res<span class="sc">$</span>clus_sel_mat))</span>
<span id="cb66-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-33" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(res<span class="sc">$</span>clus_sel_mat <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)))</span>
<span id="cb66-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 4 clusters</span></span>
<span id="cb66-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-35" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">ncol</span>(res<span class="sc">$</span>clus_sel_mat), <span class="dv">4</span>)</span>
<span id="cb66-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-36" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">colnames</span>(res<span class="sc">$</span>clus_sel_mat), <span class="fu">names</span>(res<span class="sc">$</span>clusters))</span>
<span id="cb66-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-37" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">colnames</span>(res<span class="sc">$</span>clus_sel_mat)), <span class="dv">4</span>)</span>
<span id="cb66-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-38" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">colnames</span>(res<span class="sc">$</span>clus_sel_mat))), <span class="dv">4</span>)</span>
<span id="cb66-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-39" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">colnames</span>(res<span class="sc">$</span>clus_sel_mat))))</span>
<span id="cb66-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-40" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.null</span>(<span class="fu">colnames</span>(res<span class="sc">$</span>clus_sel_mat))))</span>
<span id="cb66-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># X</span></span>
<span id="cb66-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-43" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(res<span class="sc">$</span>X))</span>
<span id="cb66-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-44" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(res<span class="sc">$</span>X)))</span>
<span id="cb66-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-45" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res<span class="sc">$</span>X))</span>
<span id="cb66-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-46" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">ncol</span>(res<span class="sc">$</span>X), <span class="dv">11</span>)</span>
<span id="cb66-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-47" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(res<span class="sc">$</span>X), <span class="dv">15</span>)</span>
<span id="cb66-48"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-49"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># y</span></span>
<span id="cb66-50"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-50" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res<span class="sc">$</span>y))</span>
<span id="cb66-51"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-51" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res<span class="sc">$</span>y), <span class="dv">15</span>)</span>
<span id="cb66-52"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-53"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># clusters</span></span>
<span id="cb66-54"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-54" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res<span class="sc">$</span>clusters))</span>
<span id="cb66-55"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-55" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res<span class="sc">$</span>clusters), <span class="fu">length</span>(<span class="fu">names</span>(res<span class="sc">$</span>clusters)))</span>
<span id="cb66-56"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-56" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res<span class="sc">$</span>clusters),</span>
<span id="cb66-57"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-57" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">names</span>(res<span class="sc">$</span>clusters))))</span>
<span id="cb66-58"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-58" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">names</span>(res<span class="sc">$</span>clusters))))</span>
<span id="cb66-59"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-59" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.null</span>(<span class="fu">names</span>(res<span class="sc">$</span>clusters))))</span>
<span id="cb66-60"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-60" aria-hidden="true" tabindex="-1"></a>  clust_feats <span class="ot">&lt;-</span> <span class="fu">integer</span>()</span>
<span id="cb66-61"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-61" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(res<span class="sc">$</span>clusters)){</span>
<span id="cb66-62"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-62" aria-hidden="true" tabindex="-1"></a>    clust_feats <span class="ot">&lt;-</span> <span class="fu">c</span>(clust_feats, res<span class="sc">$</span>clusters[[i]])</span>
<span id="cb66-63"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-63" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb66-64"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-64" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(clust_feats), <span class="fu">length</span>(<span class="fu">unique</span>(clust_feats)))</span>
<span id="cb66-65"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-65" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(clust_feats), <span class="fu">length</span>(<span class="fu">intersect</span>(clust_feats,</span>
<span id="cb66-66"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-66" aria-hidden="true" tabindex="-1"></a>                                                               <span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>)))</span>
<span id="cb66-67"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-67" aria-hidden="true" tabindex="-1"></a>  <span class="co"># train_inds</span></span>
<span id="cb66-68"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-68" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(res<span class="sc">$</span>train_inds, <span class="fu">integer</span>())</span>
<span id="cb66-69"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-70"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-70" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Trying other inputs</span></span>
<span id="cb66-71"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-71" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-72"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-72" aria-hidden="true" tabindex="-1"></a>  <span class="co"># X as a data.frame</span></span>
<span id="cb66-73"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-73" aria-hidden="true" tabindex="-1"></a>  X_df <span class="ot">&lt;-</span> datasets<span class="sc">::</span>mtcars</span>
<span id="cb66-74"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-74" aria-hidden="true" tabindex="-1"></a>  res_fitfun <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>X_df, <span class="at">y=</span>stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="fu">nrow</span>(X_df)), <span class="at">lambda=</span><span class="fl">0.01</span>, <span class="at">B =</span> <span class="dv">10</span>)</span>
<span id="cb66-75"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-75" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">class</span>(res_fitfun), <span class="st">&quot;cssr&quot;</span>)</span>
<span id="cb66-76"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-76" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-77"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-77" aria-hidden="true" tabindex="-1"></a>  <span class="co"># X as a dataframe with factors (number of columns of final design matrix</span></span>
<span id="cb66-78"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-78" aria-hidden="true" tabindex="-1"></a>  <span class="co"># after one-hot encoding factors won&#39;t match number of columns of df2)</span></span>
<span id="cb66-79"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-79" aria-hidden="true" tabindex="-1"></a>  df2 <span class="ot">&lt;-</span> X_df</span>
<span id="cb66-80"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-80" aria-hidden="true" tabindex="-1"></a>  df2<span class="sc">$</span>cyl <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df2<span class="sc">$</span>cyl)</span>
<span id="cb66-81"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-81" aria-hidden="true" tabindex="-1"></a>  df2<span class="sc">$</span>vs <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df2<span class="sc">$</span>vs)</span>
<span id="cb66-82"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-82" aria-hidden="true" tabindex="-1"></a>  df2<span class="sc">$</span>am <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df2<span class="sc">$</span>am)</span>
<span id="cb66-83"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-83" aria-hidden="true" tabindex="-1"></a>  df2<span class="sc">$</span>gear <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df2<span class="sc">$</span>gear)</span>
<span id="cb66-84"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-84" aria-hidden="true" tabindex="-1"></a>  df2<span class="sc">$</span>carb <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df2<span class="sc">$</span>carb)</span>
<span id="cb66-85"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-85" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-86"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-86" aria-hidden="true" tabindex="-1"></a>  res_fitfun <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>df2, <span class="at">y=</span>stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="fu">nrow</span>(X_df)), <span class="at">lambda=</span><span class="fl">0.01</span>, <span class="at">B =</span> <span class="dv">10</span>)</span>
<span id="cb66-87"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-87" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">class</span>(res_fitfun), <span class="st">&quot;cssr&quot;</span>)</span>
<span id="cb66-88"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-88" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-89"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-89" aria-hidden="true" tabindex="-1"></a>  <span class="co"># X as a matrix with column names</span></span>
<span id="cb66-90"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-90" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> x</span>
<span id="cb66-91"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(x2) <span class="ot">&lt;-</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>]</span>
<span id="cb66-92"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-92" aria-hidden="true" tabindex="-1"></a>  res_names <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x2, <span class="at">y=</span>y, <span class="at">lambda=</span><span class="fl">0.01</span>, <span class="at">clusters=</span>good_clusters, <span class="at">B =</span> <span class="dv">13</span>)</span>
<span id="cb66-93"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-93" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">class</span>(res_names), <span class="st">&quot;cssr&quot;</span>)</span>
<span id="cb66-94"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-94" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">colnames</span>(x2), <span class="fu">colnames</span>(res_names<span class="sc">$</span>X))</span>
<span id="cb66-95"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-95" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">colnames</span>(x2), <span class="fu">colnames</span>(res_names<span class="sc">$</span>feat_sel_mat))</span>
<span id="cb66-96"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-97"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-97" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Custom fitfun with nonsense lambda (which will be ignored by fitfun, and</span></span>
<span id="cb66-98"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-98" aria-hidden="true" tabindex="-1"></a>  <span class="co"># shouldn&#39;t throw any error, because the acceptable input for lambda should be</span></span>
<span id="cb66-99"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-99" aria-hidden="true" tabindex="-1"></a>  <span class="co"># enforced only by fitfun)</span></span>
<span id="cb66-100"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-101"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-101" aria-hidden="true" tabindex="-1"></a>  <span id='testFitfun'>testFitfun</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(X, y, lambda){</span>
<span id="cb66-102"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-102" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ncol</span>(X)</span>
<span id="cb66-103"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-103" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(p <span class="sc">&gt;=</span> <span class="dv">2</span>)</span>
<span id="cb66-104"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-104" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Choose p/2 features randomly</span></span>
<span id="cb66-105"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-105" aria-hidden="true" tabindex="-1"></a>    selected <span class="ot">&lt;-</span> <span class="fu">sample.int</span>(p, <span class="at">size=</span><span class="fu">floor</span>(p<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb66-106"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-106" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(selected)</span>
<span id="cb66-107"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-107" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb66-108"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-109"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-109" aria-hidden="true" tabindex="-1"></a>  res_fitfun <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">lambda=</span><span class="fu">c</span>(<span class="st">&quot;foo&quot;</span>, <span class="fu">as.character</span>(<span class="cn">NA</span>), <span class="st">&quot;bar&quot;</span>),</span>
<span id="cb66-110"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-110" aria-hidden="true" tabindex="-1"></a>                    <span class="at">clusters=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">B =</span> <span class="dv">10</span>, <span class="at">fitfun=</span>testFitfun)</span>
<span id="cb66-111"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-111" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">class</span>(res_fitfun), <span class="st">&quot;cssr&quot;</span>)</span>
<span id="cb66-112"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-113"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-113" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Bad lambda</span></span>
<span id="cb66-114"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-114" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">lambda=</span><span class="sc">-</span><span class="fl">0.01</span>, <span class="at">B =</span> <span class="dv">10</span>),</span>
<span id="cb66-115"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-115" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;For method cssLasso, lambda must be nonnegative.&quot;</span>,</span>
<span id="cb66-116"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-116" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb66-117"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-118"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-118" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">lambda=</span><span class="st">&quot;foo&quot;</span>, <span class="at">B =</span> <span class="dv">10</span>),</span>
<span id="cb66-119"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-119" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;For method cssLasso, lambda must be a numeric.&quot;</span>,</span>
<span id="cb66-120"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-120" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb66-121"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-122"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-122" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Single cluster</span></span>
<span id="cb66-123"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-123" aria-hidden="true" tabindex="-1"></a>  res_sing_clust <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">lambda=</span><span class="fl">0.01</span>, <span class="at">clusters=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">B =</span> <span class="dv">10</span>)</span>
<span id="cb66-124"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-124" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">class</span>(res_sing_clust), <span class="st">&quot;cssr&quot;</span>)</span>
<span id="cb66-125"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-125" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res_sing_clust<span class="sc">$</span>clusters), <span class="dv">11</span> <span class="sc">-</span> <span class="dv">3</span> <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb66-126"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-126" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">names</span>(res_sing_clust<span class="sc">$</span>clusters))) <span class="sc">==</span> <span class="dv">11</span> <span class="sc">-</span></span>
<span id="cb66-127"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-127" aria-hidden="true" tabindex="-1"></a>                          <span class="dv">3</span> <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb66-128"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-128" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">names</span>(res_sing_clust<span class="sc">$</span>clusters))))</span>
<span id="cb66-129"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-129" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.null</span>(<span class="fu">names</span>(res_sing_clust<span class="sc">$</span>clusters))))</span>
<span id="cb66-130"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-131"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-131" aria-hidden="true" tabindex="-1"></a>  <span class="co"># No cluster</span></span>
<span id="cb66-132"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-132" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">class</span>(<a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">lambda=</span><span class="fl">0.01</span>, <span class="at">B =</span> <span class="dv">10</span>)), <span class="st">&quot;cssr&quot;</span>)</span>
<span id="cb66-133"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-133" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-134"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-134" aria-hidden="true" tabindex="-1"></a>  <span class="co"># All clusters named</span></span>
<span id="cb66-135"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-135" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">class</span>(<a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">clusters=</span><span class="fu">list</span>(<span class="st">&quot;a&quot;</span><span class="ot">=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb66-136"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-136" aria-hidden="true" tabindex="-1"></a>                                                               <span class="st">&quot;b&quot;</span><span class="ot">=</span><span class="dv">6</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb66-137"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-137" aria-hidden="true" tabindex="-1"></a>                                                               <span class="st">&quot;c&quot;</span><span class="ot">=</span><span class="dv">11</span>),</span>
<span id="cb66-138"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-138" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">lambda=</span><span class="fl">0.01</span>, <span class="at">B=</span><span class="dv">10</span>)), <span class="st">&quot;cssr&quot;</span>)</span>
<span id="cb66-139"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-140"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-140" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Other sampling types</span></span>
<span id="cb66-141"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-141" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">lambda=</span><span class="dv">1</span>, <span class="at">sampling_type=</span><span class="st">&quot;MB&quot;</span>),</span>
<span id="cb66-142"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-142" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;sampling_type MB is not yet supported (and isn&#39;t recommended anyway)&quot;</span>,</span>
<span id="cb66-143"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-143" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb66-144"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-145"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-145" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Error has quotation marks in it</span></span>
<span id="cb66-146"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-146" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">lambda=</span><span class="dv">1</span>, <span class="at">sampling_type=</span><span class="st">&quot;S&quot;</span>))</span>
<span id="cb66-147"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-148"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-148" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">lambda=</span><span class="dv">1</span>, <span class="at">sampling_type=</span><span class="dv">1</span>),</span>
<span id="cb66-149"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-149" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;is.character(sampling_type) is not TRUE&quot;</span>,</span>
<span id="cb66-150"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-150" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb66-151"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-152"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-152" aria-hidden="true" tabindex="-1"></a>  <span class="co"># B</span></span>
<span id="cb66-153"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-153" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_warning</span>(<a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">lambda=</span><span class="dv">1</span>, <span class="at">B=</span><span class="dv">5</span>),</span>
<span id="cb66-154"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-154" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;Small values of B may lead to poor results.&quot;</span>,</span>
<span id="cb66-155"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-155" aria-hidden="true" tabindex="-1"></a>                           <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb66-156"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-157"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-157" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">lambda=</span><span class="dv">1</span>, <span class="at">B=</span><span class="fu">list</span>(<span class="dv">10</span>)),</span>
<span id="cb66-158"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-158" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;is.numeric(B) | is.integer(B) is not TRUE&quot;</span>,</span>
<span id="cb66-159"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-159" aria-hidden="true" tabindex="-1"></a>                           <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb66-160"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-160" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-161"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-161" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Clusters</span></span>
<span id="cb66-162"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-162" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">lambda=</span><span class="dv">1</span>, <span class="at">clusters=</span><span class="st">&quot;red&quot;</span>),</span>
<span id="cb66-163"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-163" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;is.numeric(clusters) | is.integer(clusters) is not TRUE&quot;</span>,</span>
<span id="cb66-164"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-164" aria-hidden="true" tabindex="-1"></a>                           <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb66-165"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-166"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-166" aria-hidden="true" tabindex="-1"></a>  <span class="co"># prop_feats_remove</span></span>
<span id="cb66-167"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-167" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">class</span>(<a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">lambda=</span><span class="fl">0.01</span>, <span class="at">B =</span> <span class="dv">10</span>,</span>
<span id="cb66-168"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-168" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">prop_feats_remove=</span><span class="fl">0.3</span>)), <span class="st">&quot;cssr&quot;</span>)</span>
<span id="cb66-169"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-169" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Weirdly high, but still valid, value of prop_feats_remove</span></span>
<span id="cb66-170"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-170" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">class</span>(<a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">lambda=</span><span class="fl">0.01</span>, <span class="at">B =</span> <span class="dv">10</span>,</span>
<span id="cb66-171"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-171" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">prop_feats_remove=</span><span class="fl">0.9999999999</span>)), <span class="st">&quot;cssr&quot;</span>)</span>
<span id="cb66-172"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-172" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-173"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-173" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Use train_inds argument</span></span>
<span id="cb66-174"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-174" aria-hidden="true" tabindex="-1"></a>  res_train <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">lambda=</span><span class="fl">0.01</span>, <span class="at">B =</span> <span class="dv">10</span>, <span class="at">train_inds=</span><span class="dv">11</span><span class="sc">:</span><span class="dv">15</span>)</span>
<span id="cb66-175"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-175" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(res_train<span class="sc">$</span>train_inds, <span class="dv">11</span><span class="sc">:</span><span class="dv">15</span>)</span>
<span id="cb66-176"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-177"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb66-177" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## Test passed 🥳</code></pre>
<div id="selection-and-prediction-functions" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Selection and Prediction Functions<a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#selection-and-prediction-functions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now that css has been defined and tested, we write functions to work with the output of css. The output of these functions will be of more direct interest for most end users than the output of css. These functions are defined separately from css because the most computationally intensive steps happen within css. css can be called only once on a data set, and then the functions that follow can be explored relatively quickly (one can try different parameters, etc.).</p>
<ul>
<li>getCssSelections takes in the results of css along with user-defined parameters on how to select clusters (a mininmum or maximum number of clusters to select, along with a cutoff for cluster selection proportions) and selects clusters as well as features from those clusters.</li>
<li>getCssDesign takes in the same inputs as getCssSelections along with an unlabeled test matrix of features X (containing the same features as the X matrix provided originally to css). It uses the results from css to select clusters like getCssSelections, then it uses a user-selected weighting scheme to compute weighted averages of the cluster members. It returns a test matrix of cluster representatives, which can be used for downstream predictive tasks.</li>
<li>Finally, getCssPreds has the same inputs as getCssPreds <em>FIX THIS TYPO</em>, except it also accepts a set of labeled training data (where the response must be real-valued). getCssPreds selects clusters, forms matrices of cluster representatives on the training and test data, uses the training matrix of cluster representatives (along with the vector of responses for the training data) to estimate a linear model via ordinary least squares, and finally generates predictions on the test data using this linear model.</li>
</ul>
<p>As in the previous section, we first define each function and then define the helper functions called by that function. Tests are written for each function as soon as all of its dependencies have been defined.</p>
<ul>
<li>getCssSelections
<ul>
<li>Calls checkCutoff, which checks that the specified cutoff input is as expected</li>
<li>checkWeighting verifies the weighting input to getCssSelections</li>
<li>checkMinNumClusts confirms that the min_num_clusts parameter provided to getCssSelections is as expected</li>
<li>Likewise for checkMaxNumClusts</li>
<li>getSelectedClusters is the workhorse function of getCssSelections, doing most of the work to get the selected clusters (and the selected features from those clusters) with the verified inputs
<ul>
<li>checkSelectedClusters checks internally that the selected clusters are as expected</li>
<li>getAllClustWeights gets the weights for each of the members of the selected clusters
<ul>
<li>getClustWeights gets the weights for a single cluster</li>
</ul></li>
<li>checkGetSelectedClustersOutput verifies the output of getSelectedClusters</li>
</ul></li>
</ul></li>
<li>getCssDesign
<ul>
<li>checkNewXProvided confirms that the design matrix provided to getCssDesign matches the characteristics of the matrix that was provided to css.
<ul>
<li>checkXInputResults also verifies these inputs (and is also used by getCssPreds on both the training and test data)</li>
</ul></li>
<li>formCssDesign is the workhorse function, generating a matrix of cluster representatives with the verified inputs to getCssDesign
<ul>
<li>checkFormCssDesignInputs verifies the inputs to formCssDesign (somewhat redundantly here, but formCssDesign is called by more than one function, so this verifies the inputs to formCssDesign regardless of where it is called).</li>
</ul></li>
</ul></li>
<li>getCssPreds
<ul>
<li>checkGetCssPredsInputs verifies the inputs to getCssPreds</li>
</ul></li>
</ul>
<p>getCssSelections:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Obtain a selected set of clusters and features</span></span>
<span id="cb68-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb68-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Generate sets of selected clusters and features from cluster stability</span></span>
<span id="cb68-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; selection.</span></span>
<span id="cb68-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param css_results An object of class &quot;cssr&quot; (the output of the function</span></span>
<span id="cb68-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; css).</span></span>
<span id="cb68-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param weighting Character; determines how to calculate the weights for</span></span>
<span id="cb68-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; individual features within the selected clusters. Only those features with</span></span>
<span id="cb68-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; nonzero weight within the selected clusters will be returned. Must be one of</span></span>
<span id="cb68-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; &quot;sparse&quot;, &quot;weighted_avg&quot;, or &quot;simple_avg&#39;. For &quot;sparse&quot;, all the weight is</span></span>
<span id="cb68-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; put on the most frequently</span></span>
<span id="cb68-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; selected individual cluster member (or divided equally among all the clusters</span></span>
<span id="cb68-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; that are tied for the top selection proportion if there is a tie). For</span></span>
<span id="cb68-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; &quot;weighted_avg&quot;, only the features within a selected cluster that were</span></span>
<span id="cb68-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; themselves selected on at least one subsample will have nonzero weight. For</span></span>
<span id="cb68-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; &quot;simple_avg&quot;, each cluster member gets equal weight regardless of the</span></span>
<span id="cb68-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; individual feature selection proportions (that is, all cluster members within</span></span>
<span id="cb68-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; each selected cluster will be returned.). See Faletto and Bien (2022) for</span></span>
<span id="cb68-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; details. Default is &quot;sparse&quot;.</span></span>
<span id="cb68-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param cutoff Numeric; getCssSelections will select and return only of those</span></span>
<span id="cb68-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; clusters with selection proportions equal to at least cutoff. Must be between</span></span>
<span id="cb68-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; 0 and 1. Default is 0 (in which case either all clusters are selected, or</span></span>
<span id="cb68-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; max_num_clusts are selected, if max_num_clusts is specified).</span></span>
<span id="cb68-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param min_num_clusts Integer or numeric; the minimum number of clusters to</span></span>
<span id="cb68-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; use regardless of cutoff. (That is, if the chosen cutoff returns fewer than</span></span>
<span id="cb68-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; min_num_clusts clusters, the cutoff will be increased until at least</span></span>
<span id="cb68-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; min_num_clusts clusters are selected.) Default is 1.</span></span>
<span id="cb68-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param max_num_clusts Integer or numeric; the maximum number of clusters to</span></span>
<span id="cb68-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; use regardless of cutoff. (That is, if the chosen cutoff returns more than</span></span>
<span id="cb68-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; max_num_clusts clusters, the cutoff will be decreased until at most</span></span>
<span id="cb68-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; max_num_clusts clusters are selected.) Default is NA (in which case</span></span>
<span id="cb68-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; max_num_clusts is ignored).</span></span>
<span id="cb68-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return A named list with two items. \item{selected_clusts}{A named list of</span></span>
<span id="cb68-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; integer vectors; each vector contains the indices of the features in one of</span></span>
<span id="cb68-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the selected clusters.} \item{selected_feats}{A named integer vector; the</span></span>
<span id="cb68-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; indices of the features with nonzero weights from all of the selected</span></span>
<span id="cb68-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; clusters.}</span></span>
<span id="cb68-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @author Gregory Faletto, Jacob Bien</span></span>
<span id="cb68-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @references Faletto, G., &amp; Bien, J. (2022). Cluster Stability Selection.</span></span>
<span id="cb68-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; \emph{arXiv preprint arXiv:2201.00494}.</span></span>
<span id="cb68-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; \url{https://arxiv.org/abs/2201.00494}.</span></span>
<span id="cb68-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @export</span></span>
<span id="cb68-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-43" aria-hidden="true" tabindex="-1"></a><span id='getCssSelections'>getCssSelections</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(css_results, <span class="at">weighting=</span><span class="st">&quot;sparse&quot;</span>, <span class="at">cutoff=</span><span class="dv">0</span>,</span>
<span id="cb68-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_num_clusts=</span><span class="dv">1</span>, <span class="at">max_num_clusts=</span><span class="cn">NA</span>){</span>
<span id="cb68-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check inputs</span></span>
<span id="cb68-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">class</span>(css_results) <span class="sc">==</span> <span class="st">&quot;cssr&quot;</span>)</span>
<span id="cb68-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-47" aria-hidden="true" tabindex="-1"></a>    <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkCutoff'>checkCutoff</a>(cutoff)</span>
<span id="cb68-48"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-48" aria-hidden="true" tabindex="-1"></a>    <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkWeighting'>checkWeighting</a>(weighting)</span>
<span id="cb68-49"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-50"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-50" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ncol</span>(css_results<span class="sc">$</span>feat_sel_mat)</span>
<span id="cb68-51"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-52"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-52" aria-hidden="true" tabindex="-1"></a>    <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkMinNumClusts'>checkMinNumClusts</a>(min_num_clusts, p, <span class="fu">length</span>(css_results<span class="sc">$</span>clusters))</span>
<span id="cb68-53"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-54"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-54" aria-hidden="true" tabindex="-1"></a>    max_num_clusts <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkMaxNumClusts'>checkMaxNumClusts</a>(max_num_clusts, min_num_clusts, p,</span>
<span id="cb68-55"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-55" aria-hidden="true" tabindex="-1"></a>        <span class="fu">length</span>(css_results<span class="sc">$</span>clusters))</span>
<span id="cb68-56"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-57"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-57" aria-hidden="true" tabindex="-1"></a>    sel_results <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getSelectedClusters'>getSelectedClusters</a>(css_results, weighting, cutoff,</span>
<span id="cb68-58"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-58" aria-hidden="true" tabindex="-1"></a>        min_num_clusts, max_num_clusts)</span>
<span id="cb68-59"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-60"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-60" aria-hidden="true" tabindex="-1"></a>    <span class="co"># sel_results$selected_clusts is guaranteed to have length at least 1 by</span></span>
<span id="cb68-61"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-61" aria-hidden="true" tabindex="-1"></a>    <span class="co"># getSelectedClusters</span></span>
<span id="cb68-62"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-62" aria-hidden="true" tabindex="-1"></a>    sel_clust_names <span class="ot">&lt;-</span> <span class="fu">names</span>(sel_results<span class="sc">$</span>selected_clusts)</span>
<span id="cb68-63"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-64"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(sel_clust_names) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb68-65"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">all</span>(sel_clust_names <span class="sc">%in%</span> <span class="fu">names</span>(css_results<span class="sc">$</span>clusters)))</span>
<span id="cb68-66"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-67"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-67" aria-hidden="true" tabindex="-1"></a>    sel_clusts <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb68-68"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-68" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sel_clust_names)){</span>
<span id="cb68-69"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-69" aria-hidden="true" tabindex="-1"></a>        sel_clusts[[i]] <span class="ot">&lt;-</span> css_results<span class="sc">$</span>clusters[[sel_clust_names[i]]]</span>
<span id="cb68-70"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-70" aria-hidden="true" tabindex="-1"></a>        <span class="fu">names</span>(sel_clusts)[i] <span class="ot">&lt;-</span> sel_clust_names[i]</span>
<span id="cb68-71"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-71" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb68-72"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-73"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-73" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.list</span>(sel_clusts))</span>
<span id="cb68-74"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(sel_clusts) <span class="sc">==</span> <span class="fu">length</span>(sel_clust_names))</span>
<span id="cb68-75"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-76"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-76" aria-hidden="true" tabindex="-1"></a>    <span class="co"># sel_results$selected_feats is guaranteed to have length at least as long</span></span>
<span id="cb68-77"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-77" aria-hidden="true" tabindex="-1"></a>    <span class="co"># as sel_results$selected_clusts by getSelectedClusters</span></span>
<span id="cb68-78"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-78" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">selected_clusts=</span>sel_clusts,</span>
<span id="cb68-79"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-79" aria-hidden="true" tabindex="-1"></a>        <span class="at">selected_feats=</span>sel_results<span class="sc">$</span>selected_feats))</span>
<span id="cb68-80"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb68-80" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>checkCutoff:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Helper function to confirm that the argument cutoff to several functions is</span></span>
<span id="cb69-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; as expected</span></span>
<span id="cb69-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb69-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param cutoff Numeric; only those clusters with selection proportions equal</span></span>
<span id="cb69-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; to at least cutoff will be selected by cluster stability selection. Must be</span></span>
<span id="cb69-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; between 0 and 1.</span></span>
<span id="cb69-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb69-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @author Gregory Faletto, Jacob Bien</span></span>
<span id="cb69-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb69-8" aria-hidden="true" tabindex="-1"></a><span id='checkCutoff'>checkCutoff</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(cutoff){</span>
<span id="cb69-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb69-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.numeric</span>(cutoff) <span class="sc">|</span> <span class="fu">is.integer</span>(cutoff))</span>
<span id="cb69-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb69-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(cutoff) <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb69-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb69-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="sc">!</span><span class="fu">is.na</span>(cutoff))</span>
<span id="cb69-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb69-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(cutoff <span class="sc">&gt;=</span> <span class="dv">0</span>)</span>
<span id="cb69-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb69-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(cutoff <span class="sc">&lt;=</span> <span class="dv">1</span>)</span>
<span id="cb69-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb69-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Tests for checkCutoff:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb70-1" aria-hidden="true" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">test_that</span>(<span class="st">&quot;checkCutoff works&quot;</span>, {</span>
<span id="cb70-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb70-2" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_null</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkCutoff'>checkCutoff</a>(<span class="dv">0</span>))</span>
<span id="cb70-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb70-3" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_null</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkCutoff'>checkCutoff</a>(<span class="fl">0.2</span>))</span>
<span id="cb70-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb70-4" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_null</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkCutoff'>checkCutoff</a>(<span class="dv">1</span>))</span>
<span id="cb70-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb70-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb70-6" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkCutoff'>checkCutoff</a>(<span class="sc">-</span>.<span class="dv">2</span>), <span class="st">&quot;cutoff &gt;= 0 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb70-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb70-7" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkCutoff'>checkCutoff</a>(<span class="dv">2</span>), <span class="st">&quot;cutoff &lt;= 1 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb70-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb70-8" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkCutoff'>checkCutoff</a>(<span class="st">&quot;.3&quot;</span>),</span>
<span id="cb70-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb70-9" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;is.numeric(cutoff) | is.integer(cutoff) is not TRUE&quot;</span>,</span>
<span id="cb70-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb70-10" aria-hidden="true" tabindex="-1"></a>                        <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb70-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb70-11" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkCutoff'>checkCutoff</a>(<span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">nrow=</span><span class="dv">4</span>, <span class="at">ncol=</span><span class="dv">3</span>)),</span>
<span id="cb70-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb70-12" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;length(cutoff) == 1 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb70-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb70-13" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkCutoff'>checkCutoff</a>(<span class="fu">numeric</span>()),</span>
<span id="cb70-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb70-14" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;length(cutoff) == 1 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb70-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb70-15" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkCutoff'>checkCutoff</a>(<span class="fu">as.numeric</span>(<span class="cn">NA</span>)),</span>
<span id="cb70-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb70-16" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;!is.na(cutoff) is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb70-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb70-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb70-18" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## Test passed 😀</code></pre>
<p>checkWeighting:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Helper function to confirm that the argument weighting to several </span></span>
<span id="cb72-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; functions is as expected</span></span>
<span id="cb72-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb72-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param weighting Character; determines how to calculate the weights to</span></span>
<span id="cb72-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; combine features from the selected clusters into weighted averages, called</span></span>
<span id="cb72-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb72-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; cluster representatives. Must be one of &quot;sparse&quot;, &quot;weighted_avg&quot;, or</span></span>
<span id="cb72-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb72-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; &quot;simple_avg&#39;.</span></span>
<span id="cb72-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb72-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @author Gregory Faletto, Jacob Bien</span></span>
<span id="cb72-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb72-9" aria-hidden="true" tabindex="-1"></a><span id='checkWeighting'>checkWeighting</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(weighting){</span>
<span id="cb72-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb72-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(weighting)<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb72-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb72-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="sc">!</span><span class="fu">is.na</span>(weighting))</span>
<span id="cb72-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb72-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.character</span>(weighting)){</span>
<span id="cb72-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb72-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stop</span>(<span class="st">&quot;Weighting must be a character&quot;</span>)</span>
<span id="cb72-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb72-14" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb72-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb72-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span>(weighting <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;sparse&quot;</span>, <span class="st">&quot;simple_avg&quot;</span>, <span class="st">&quot;weighted_avg&quot;</span>))){</span>
<span id="cb72-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb72-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stop</span>(<span class="st">&quot;Weighting must be a character and one of sparse, simple_avg, or weighted_avg&quot;</span>)</span>
<span id="cb72-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb72-17" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb72-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb72-18" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Tests for checkWeighting:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb73-1" aria-hidden="true" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">test_that</span>(<span class="st">&quot;checkWeighting works&quot;</span>, {</span>
<span id="cb73-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb73-2" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_null</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkWeighting'>checkWeighting</a>(<span class="st">&quot;sparse&quot;</span>))</span>
<span id="cb73-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb73-3" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_null</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkWeighting'>checkWeighting</a>(<span class="st">&quot;simple_avg&quot;</span>))</span>
<span id="cb73-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb73-4" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_null</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkWeighting'>checkWeighting</a>(<span class="st">&quot;weighted_avg&quot;</span>))</span>
<span id="cb73-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb73-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb73-6" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkWeighting'>checkWeighting</a>(<span class="fu">c</span>(<span class="st">&quot;sparse&quot;</span>, <span class="st">&quot;simple_avg&quot;</span>)),</span>
<span id="cb73-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb73-7" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;length(weighting) == 1 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb73-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb73-8" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkWeighting'>checkWeighting</a>(<span class="cn">NA</span>), <span class="st">&quot;!is.na(weighting) is not TRUE&quot;</span>,</span>
<span id="cb73-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb73-9" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb73-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb73-10" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkWeighting'>checkWeighting</a>(<span class="dv">1</span>), <span class="st">&quot;Weighting must be a character&quot;</span>,</span>
<span id="cb73-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb73-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb73-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb73-12" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkWeighting'>checkWeighting</a>(<span class="st">&quot;spasre&quot;</span>),</span>
<span id="cb73-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb73-13" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;Weighting must be a character and one of sparse, simple_avg, or weighted_avg&quot;</span>,</span>
<span id="cb73-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb73-14" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb73-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb73-15" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## Test passed 🌈</code></pre>
<p>checkMinNumClusts:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Helper function to confirm that the argument min_num_clusts to several </span></span>
<span id="cb75-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; functions is as expected</span></span>
<span id="cb75-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb75-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param min_num_clusts Integer or numeric; the minimum number of clusters to</span></span>
<span id="cb75-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; use regardless of cutoff. (That is, if the chosen cutoff returns fewer than</span></span>
<span id="cb75-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb75-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; min_num_clusts clusters, the cutoff will be increased until at least</span></span>
<span id="cb75-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb75-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; min_num_clusts clusters are selected.)</span></span>
<span id="cb75-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb75-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param p The number of features; since this is an upper bound on the number</span></span>
<span id="cb75-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb75-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; of clusters of features, it is also an upper bound on min_num_clusts.</span></span>
<span id="cb75-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb75-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param n_clusters The number of clusters; note that this is an upper bound</span></span>
<span id="cb75-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb75-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; on min_num_clusts</span></span>
<span id="cb75-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb75-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @author Gregory Faletto, Jacob Bien</span></span>
<span id="cb75-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb75-13" aria-hidden="true" tabindex="-1"></a><span id='checkMinNumClusts'>checkMinNumClusts</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(min_num_clusts, p, n_clusters){</span>
<span id="cb75-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb75-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(min_num_clusts) <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb75-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb75-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.numeric</span>(min_num_clusts) <span class="sc">|</span> <span class="fu">is.integer</span>(min_num_clusts))</span>
<span id="cb75-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb75-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="sc">!</span><span class="fu">is.na</span>(min_num_clusts))</span>
<span id="cb75-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb75-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(min_num_clusts <span class="sc">==</span> <span class="fu">round</span>(min_num_clusts))</span>
<span id="cb75-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb75-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(min_num_clusts <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb75-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb75-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(min_num_clusts <span class="sc">&lt;=</span> p)</span>
<span id="cb75-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb75-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(min_num_clusts <span class="sc">&lt;=</span> n_clusters)</span>
<span id="cb75-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb75-21" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Tests for checkMinNumClusts:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb76-1" aria-hidden="true" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">test_that</span>(<span class="st">&quot;checkMinNumClusts works&quot;</span>, {</span>
<span id="cb76-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb76-2" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_null</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkMinNumClusts'>checkMinNumClusts</a>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">4</span>))</span>
<span id="cb76-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb76-3" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_null</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkMinNumClusts'>checkMinNumClusts</a>(<span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">6</span>))</span>
<span id="cb76-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb76-4" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_null</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkMinNumClusts'>checkMinNumClusts</a>(<span class="dv">3</span>, <span class="dv">1932</span>, <span class="dv">3</span>))</span>
<span id="cb76-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb76-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb76-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb76-6" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkMinNumClusts'>checkMinNumClusts</a>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>), <span class="dv">5</span>, <span class="dv">4</span>),</span>
<span id="cb76-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb76-7" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;length(min_num_clusts) == 1 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb76-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb76-8" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkMinNumClusts'>checkMinNumClusts</a>(<span class="st">&quot;3&quot;</span>, <span class="st">&quot;1932&quot;</span>, <span class="st">&quot;3&quot;</span>),</span>
<span id="cb76-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb76-9" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;is.numeric(min_num_clusts) | is.integer(min_num_clusts) is not TRUE&quot;</span>,</span>
<span id="cb76-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb76-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb76-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb76-11" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkMinNumClusts'>checkMinNumClusts</a>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>),</span>
<span id="cb76-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb76-12" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;is.numeric(min_num_clusts) | is.integer(min_num_clusts) is not TRUE&quot;</span>,</span>
<span id="cb76-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb76-13" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb76-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb76-14" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkMinNumClusts'>checkMinNumClusts</a>(<span class="fu">as.numeric</span>(<span class="cn">NA</span>), <span class="fu">as.numeric</span>(<span class="cn">NA</span>),</span>
<span id="cb76-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb76-15" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">as.numeric</span>(<span class="cn">NA</span>)),</span>
<span id="cb76-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb76-16" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;!is.na(min_num_clusts) is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb76-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb76-17" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkMinNumClusts'>checkMinNumClusts</a>(<span class="dv">0</span>, <span class="dv">13</span>, <span class="dv">7</span>),</span>
<span id="cb76-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb76-18" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;min_num_clusts &gt;= 1 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb76-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb76-19" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkMinNumClusts'>checkMinNumClusts</a>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">9</span>, <span class="dv">8</span>),</span>
<span id="cb76-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb76-20" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;min_num_clusts &gt;= 1 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb76-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb76-21" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkMinNumClusts'>checkMinNumClusts</a>(<span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">5</span>),</span>
<span id="cb76-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb76-22" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;min_num_clusts &lt;= p is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb76-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb76-23" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkMinNumClusts'>checkMinNumClusts</a>(<span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">5</span>),</span>
<span id="cb76-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb76-24" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;min_num_clusts &lt;= n_clusters is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb76-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb76-25" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## Test passed 🥇</code></pre>
<p>checkMaxNumClusts:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Helper function to confirm that the argument max_num_clusts to several </span></span>
<span id="cb78-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; functions is as expected</span></span>
<span id="cb78-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb78-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param max_num_clusts Integer or numeric; the maximum number of clusters to</span></span>
<span id="cb78-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; use regardless of cutoff. (That is, if the chosen cutoff returns more than</span></span>
<span id="cb78-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb78-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; max_num_clusts clusters, the cutoff will be decreased until at most</span></span>
<span id="cb78-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb78-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; max_num_clusts clusters are selected.) Can be NA, in which case</span></span>
<span id="cb78-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb78-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; max_num_clusts will be ignored.</span></span>
<span id="cb78-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb78-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param min_num_clusts Integer or numeric; the minimum number of clusters to</span></span>
<span id="cb78-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb78-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; use regardless of cutoff. (That is, if the chosen cutoff returns fewer than</span></span>
<span id="cb78-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb78-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; min_num_clusts clusters, the cutoff will be increased until at least</span></span>
<span id="cb78-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb78-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; min_num_clusts clusters are selected.) max_num_clusts must be at least as</span></span>
<span id="cb78-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb78-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; large as min_num_clusts.</span></span>
<span id="cb78-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb78-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param p The number of features; since this is an upper bound on the number</span></span>
<span id="cb78-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb78-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; of clusters of features, it is also an upper bound on max_num_clusts.</span></span>
<span id="cb78-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb78-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param n_clusters The number of clusters; note that this is an upper bound</span></span>
<span id="cb78-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb78-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; on max_num_clusts</span></span>
<span id="cb78-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb78-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return The provided max_num_clusts, coerced to an integer if needed, and</span></span>
<span id="cb78-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb78-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; coerced to be less than or equal to the total number of clusters.</span></span>
<span id="cb78-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb78-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @author Gregory Faletto, Jacob Bien</span></span>
<span id="cb78-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb78-21" aria-hidden="true" tabindex="-1"></a><span id='checkMaxNumClusts'>checkMaxNumClusts</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(max_num_clusts, min_num_clusts, p, n_clusters){</span>
<span id="cb78-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb78-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(max_num_clusts) <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb78-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb78-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.na</span>(max_num_clusts)){</span>
<span id="cb78-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb78-24" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">is.numeric</span>(max_num_clusts) <span class="sc">|</span> <span class="fu">is.integer</span>(max_num_clusts))</span>
<span id="cb78-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb78-25" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(max_num_clusts <span class="sc">==</span> <span class="fu">round</span>(max_num_clusts))</span>
<span id="cb78-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb78-26" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(max_num_clusts <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb78-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb78-27" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(max_num_clusts <span class="sc">&lt;=</span> p)</span>
<span id="cb78-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb78-28" aria-hidden="true" tabindex="-1"></a>        max_num_clusts <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">min</span>(n_clusters, max_num_clusts))</span>
<span id="cb78-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb78-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(max_num_clusts <span class="sc">&gt;=</span> min_num_clusts)</span>
<span id="cb78-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb78-30" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb78-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb78-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(max_num_clusts)</span>
<span id="cb78-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb78-32" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Tests for checkMaxNumClusts:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb79-1" aria-hidden="true" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">test_that</span>(<span class="st">&quot;checkMaxNumClusts works&quot;</span>, {</span>
<span id="cb79-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb79-2" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkMaxNumClusts'>checkMaxNumClusts</a>(<span class="at">max_num_clusts=</span><span class="dv">4</span>, <span class="at">min_num_clusts=</span><span class="dv">1</span>,</span>
<span id="cb79-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb79-3" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">p=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">4</span>), <span class="dv">4</span>)</span>
<span id="cb79-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb79-4" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkMaxNumClusts'>checkMaxNumClusts</a>(<span class="at">max_num_clusts=</span><span class="dv">5</span>, <span class="at">min_num_clusts=</span><span class="dv">1</span>,</span>
<span id="cb79-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb79-5" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">p=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">4</span>), <span class="dv">4</span>)</span>
<span id="cb79-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb79-6" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.na</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkMaxNumClusts'>checkMaxNumClusts</a>(<span class="at">max_num_clusts=</span><span class="cn">NA</span>,</span>
<span id="cb79-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb79-7" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">min_num_clusts=</span><span class="dv">3</span>, <span class="at">p=</span><span class="dv">5</span>,</span>
<span id="cb79-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb79-8" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">n_clusters=</span><span class="dv">4</span>)))</span>
<span id="cb79-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb79-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb79-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb79-10" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkMaxNumClusts'>checkMaxNumClusts</a>(<span class="at">max_num_clusts=</span><span class="st">&quot;4&quot;</span>, <span class="at">min_num_clusts=</span><span class="dv">1</span>,</span>
<span id="cb79-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb79-11" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">p=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">4</span>),</span>
<span id="cb79-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb79-12" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;is.numeric(max_num_clusts) | is.integer(max_num_clusts) is not TRUE&quot;</span>,</span>
<span id="cb79-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb79-13" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb79-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb79-14" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkMaxNumClusts'>checkMaxNumClusts</a>(<span class="at">max_num_clusts=</span><span class="fl">3.2</span>, <span class="at">min_num_clusts=</span><span class="dv">2</span>,</span>
<span id="cb79-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb79-15" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">p=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">4</span>),</span>
<span id="cb79-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb79-16" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;max_num_clusts == round(max_num_clusts) is not TRUE&quot;</span>,</span>
<span id="cb79-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb79-17" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb79-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb79-18" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkMaxNumClusts'>checkMaxNumClusts</a>(<span class="at">max_num_clusts=</span><span class="dv">1</span>, <span class="at">min_num_clusts=</span><span class="dv">2</span>,</span>
<span id="cb79-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb79-19" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">p=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">4</span>),</span>
<span id="cb79-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb79-20" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;max_num_clusts &gt;= min_num_clusts is not TRUE&quot;</span>,</span>
<span id="cb79-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb79-21" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb79-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb79-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb79-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb79-23" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkMaxNumClusts'>checkMaxNumClusts</a>(<span class="at">max_num_clusts=</span><span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>),</span>
<span id="cb79-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb79-24" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">min_num_clusts=</span><span class="dv">2</span>,</span>
<span id="cb79-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb79-25" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">p=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">4</span>),</span>
<span id="cb79-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb79-26" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;length(max_num_clusts) == 1 is not TRUE&quot;</span>,</span>
<span id="cb79-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb79-27" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb79-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb79-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb79-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb79-29" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkMaxNumClusts'>checkMaxNumClusts</a>(<span class="at">max_num_clusts=</span><span class="st">&quot;4&quot;</span>,</span>
<span id="cb79-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb79-30" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">min_num_clusts=</span><span class="st">&quot;2&quot;</span>,</span>
<span id="cb79-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb79-31" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">p=</span><span class="st">&quot;5&quot;</span>, <span class="at">n_clusters=</span><span class="st">&quot;4&quot;</span>),</span>
<span id="cb79-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb79-32" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;is.numeric(max_num_clusts) | is.integer(max_num_clusts) is not TRUE&quot;</span>,</span>
<span id="cb79-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb79-33" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb79-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb79-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb79-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb79-35" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkMaxNumClusts'>checkMaxNumClusts</a>(<span class="at">max_num_clusts=</span><span class="sc">-</span><span class="dv">1</span>, <span class="at">min_num_clusts=</span><span class="dv">2</span>,</span>
<span id="cb79-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb79-36" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">p=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">4</span>),</span>
<span id="cb79-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb79-37" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;max_num_clusts &gt;= 1 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb79-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb79-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb79-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb79-39" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkMaxNumClusts'>checkMaxNumClusts</a>(<span class="at">max_num_clusts=</span><span class="dv">6</span>, <span class="at">min_num_clusts=</span><span class="dv">2</span>,</span>
<span id="cb79-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb79-40" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">p=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">4</span>),</span>
<span id="cb79-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb79-41" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;max_num_clusts &lt;= p is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb79-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb79-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb79-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb79-43" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkMaxNumClusts'>checkMaxNumClusts</a>(<span class="at">max_num_clusts=</span><span class="dv">1</span>, <span class="at">min_num_clusts=</span><span class="dv">2</span>,</span>
<span id="cb79-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb79-44" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">p=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">4</span>),</span>
<span id="cb79-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb79-45" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;max_num_clusts &gt;= min_num_clusts is not TRUE&quot;</span>,</span>
<span id="cb79-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb79-46" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb79-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb79-47" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## Test passed 😀</code></pre>
<p>getSelectedClusters:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; From css output, obtain names of selected clusters and selection proportions,</span></span>
<span id="cb81-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; indices of all selected features, and weights of individual cluster members</span></span>
<span id="cb81-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb81-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; If cutoff is too high for at least min_num_clusts clusters to be selected,</span></span>
<span id="cb81-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; then it will be lowered until min_num_clusts can be selected. After that, if</span></span>
<span id="cb81-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the cutoff is too low such that more than max_num_clusts are selected, then</span></span>
<span id="cb81-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the cutoff will be increased until no more than max_num_clusts are selected.</span></span>
<span id="cb81-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Note that because clusters can have tied selection proportions, it is</span></span>
<span id="cb81-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; possible that the number of selected clusters will be strictly lower than</span></span>
<span id="cb81-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; max_num_clusts or strictly greater than min_num_clusts. In fact, it is</span></span>
<span id="cb81-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; possible that both cutoffs won&#39;t be able to be satisfied simulteaneously,</span></span>
<span id="cb81-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; even if there is a strictly positive difference between max_num_clusts and</span></span>
<span id="cb81-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; min_num_clusts. If this occurs, max_num_clusts will take precedence over</span></span>
<span id="cb81-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; min_num_clusts. getSelectedClusters will throw an error if the provided</span></span>
<span id="cb81-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; inputs don&#39;t allow it to select any clusters. </span></span>
<span id="cb81-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; </span></span>
<span id="cb81-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param css_results An object of class &quot;cssr&quot; (the output of the function</span></span>
<span id="cb81-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; css).</span></span>
<span id="cb81-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param weighting Character; determines how to calculate the weights for</span></span>
<span id="cb81-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; individual features within the selected clusters. Only those features with</span></span>
<span id="cb81-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; nonzero weight within the selected clusters will be returned. Must be one of</span></span>
<span id="cb81-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; &quot;sparse&quot;, &quot;weighted_avg&quot;, or &quot;simple_avg&#39;. For &quot;sparse&quot;, all the weight is</span></span>
<span id="cb81-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; put on the most frequently</span></span>
<span id="cb81-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; selected individual cluster member (or divided equally among all the clusters</span></span>
<span id="cb81-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; that are tied for the top selection proportion if there is a tie). For</span></span>
<span id="cb81-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; &quot;weighted_avg&quot;, only the features within a selected cluster that were</span></span>
<span id="cb81-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; themselves selected on at least one subsample will have nonzero weight. For</span></span>
<span id="cb81-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; &quot;simple_avg&quot;, each cluster member gets equal weight regardless of the</span></span>
<span id="cb81-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; individual feature selection proportions (that is, all cluster members within</span></span>
<span id="cb81-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; each selected cluster will be returned.). See Faletto and Bien (2022) for</span></span>
<span id="cb81-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; details.</span></span>
<span id="cb81-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param cutoff Numeric; getCssSelections will select and return only of those</span></span>
<span id="cb81-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; clusters with selection proportions equal to at least cutoff. Must be between</span></span>
<span id="cb81-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; 0 and 1.</span></span>
<span id="cb81-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param min_num_clusts Integer or numeric; the minimum number of clusters to</span></span>
<span id="cb81-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; use regardless of cutoff. (That is, if the chosen cutoff returns fewer than</span></span>
<span id="cb81-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; min_num_clusts clusters, the cutoff will be increased until at least</span></span>
<span id="cb81-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; min_num_clusts clusters are selected.)</span></span>
<span id="cb81-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param max_num_clusts Integer or numeric; the maximum number of clusters to</span></span>
<span id="cb81-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; use regardless of cutoff. (That is, if the chosen cutoff returns more than</span></span>
<span id="cb81-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; max_num_clusts clusters, the cutoff will be decreased until at most</span></span>
<span id="cb81-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; max_num_clusts clusters are selected.) If NA, max_num_clusts is ignored.</span></span>
<span id="cb81-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return A named list with the following elements: \item{selected_clusts}{A</span></span>
<span id="cb81-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; named numeric vector containing the selection proportions for the selected</span></span>
<span id="cb81-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; clusters. The name of each entry is the name of the corresponding cluster.}</span></span>
<span id="cb81-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; \item{selected_feats}{A named integer vector; the indices of the features</span></span>
<span id="cb81-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; with nonzero weights from all of the selected clusters.} \item{weights}{A</span></span>
<span id="cb81-48"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; named list of the same length as the number of selected clusters. Each list</span></span>
<span id="cb81-49"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; element weights[[j]] is a numeric vector of the weights to use for the jth</span></span>
<span id="cb81-50"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; selected cluster, and it has the same name as the cluster it corresponds</span></span>
<span id="cb81-51"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; to.}</span></span>
<span id="cb81-52"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @author Gregory Faletto, Jacob Bien</span></span>
<span id="cb81-53"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-53" aria-hidden="true" tabindex="-1"></a><span id='getSelectedClusters'>getSelectedClusters</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(css_results, weighting, cutoff, min_num_clusts,</span>
<span id="cb81-54"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-54" aria-hidden="true" tabindex="-1"></a>    max_num_clusts){</span>
<span id="cb81-55"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-55" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check input</span></span>
<span id="cb81-56"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">class</span>(css_results) <span class="sc">==</span> <span class="st">&quot;cssr&quot;</span>)</span>
<span id="cb81-57"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-58"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-58" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Eliminate clusters with selection proportions below cutoff</span></span>
<span id="cb81-59"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-59" aria-hidden="true" tabindex="-1"></a>    clus_sel_props <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(css_results<span class="sc">$</span>clus_sel_mat)</span>
<span id="cb81-60"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-61"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-61" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get selected clusters</span></span>
<span id="cb81-62"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-62" aria-hidden="true" tabindex="-1"></a>    selected_clusts <span class="ot">&lt;-</span> clus_sel_props[clus_sel_props <span class="sc">&gt;=</span> cutoff]</span>
<span id="cb81-63"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-63" aria-hidden="true" tabindex="-1"></a>    B <span class="ot">&lt;-</span> <span class="fu">nrow</span>(css_results<span class="sc">$</span>feat_sel_mat)</span>
<span id="cb81-64"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-65"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-65" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check that selected_clusts has length at least min_num_clusts</span></span>
<span id="cb81-66"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-66" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span>(<span class="fu">length</span>(selected_clusts) <span class="sc">&lt;</span> min_num_clusts){</span>
<span id="cb81-67"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-67" aria-hidden="true" tabindex="-1"></a>        cutoff <span class="ot">&lt;-</span> cutoff <span class="sc">-</span> <span class="dv">1</span><span class="sc">/</span>B</span>
<span id="cb81-68"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-68" aria-hidden="true" tabindex="-1"></a>        selected_clusts <span class="ot">&lt;-</span> clus_sel_props[clus_sel_props <span class="sc">&gt;=</span> cutoff]</span>
<span id="cb81-69"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-69" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb81-70"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-71"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-71" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check that selected_clusts has length at most max_num_clusts</span></span>
<span id="cb81-72"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-72" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.na</span>(max_num_clusts)){</span>
<span id="cb81-73"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-73" aria-hidden="true" tabindex="-1"></a>        n_clusters <span class="ot">&lt;-</span> <span class="fu">ncol</span>(css_results<span class="sc">$</span>clus_sel_mat)</span>
<span id="cb81-74"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-74" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span>(<span class="fu">length</span>(selected_clusts) <span class="sc">&gt;</span> max_num_clusts){</span>
<span id="cb81-75"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-75" aria-hidden="true" tabindex="-1"></a>            cutoff <span class="ot">&lt;-</span> cutoff <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>B</span>
<span id="cb81-76"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-76" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span>(cutoff <span class="sc">&gt;</span> <span class="dv">1</span>){</span>
<span id="cb81-77"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-77" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb81-78"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-78" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb81-79"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-79" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Make sure we don&#39;t reduce to a selected set of size 0</span></span>
<span id="cb81-80"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-80" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span>(<span class="fu">any</span>(clus_sel_props <span class="sc">&gt;=</span> cutoff)){</span>
<span id="cb81-81"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-81" aria-hidden="true" tabindex="-1"></a>                selected_clusts <span class="ot">&lt;-</span> clus_sel_props[clus_sel_props <span class="sc">&gt;=</span> cutoff]</span>
<span id="cb81-82"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-82" aria-hidden="true" tabindex="-1"></a>            } <span class="cf">else</span>{</span>
<span id="cb81-83"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-83" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb81-84"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-84" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb81-85"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-85" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb81-86"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-86" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb81-87"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-88"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-88" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(selected_clusts) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb81-89"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-90"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-90" aria-hidden="true" tabindex="-1"></a>    clust_names <span class="ot">&lt;-</span> <span class="fu">names</span>(selected_clusts)</span>
<span id="cb81-91"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-92"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-92" aria-hidden="true" tabindex="-1"></a>    n_sel_clusts <span class="ot">&lt;-</span> <span class="fu">length</span>(selected_clusts)</span>
<span id="cb81-93"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-94"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-94" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check that n_sel_clusts is as expected, and throw warnings or an error if</span></span>
<span id="cb81-95"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-95" aria-hidden="true" tabindex="-1"></a>    <span class="co"># not</span></span>
<span id="cb81-96"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-96" aria-hidden="true" tabindex="-1"></a>    <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkSelectedClusters'>checkSelectedClusters</a>(n_sel_clusts, min_num_clusts, max_num_clusts,</span>
<span id="cb81-97"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-97" aria-hidden="true" tabindex="-1"></a>        <span class="fu">max</span>(clus_sel_props))</span>
<span id="cb81-98"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-98" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb81-99"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-99" aria-hidden="true" tabindex="-1"></a>    <span class="do">### Get selected features from selected clusters</span></span>
<span id="cb81-100"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-100" aria-hidden="true" tabindex="-1"></a>    clusters <span class="ot">&lt;-</span> css_results<span class="sc">$</span>clusters</span>
<span id="cb81-101"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-101" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">all</span>(clust_names <span class="sc">%in%</span> <span class="fu">names</span>(clusters)))</span>
<span id="cb81-102"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-103"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-103" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get a list of weights for all of the selected clusters</span></span>
<span id="cb81-104"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-104" aria-hidden="true" tabindex="-1"></a>    weights <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getAllClustWeights'>getAllClustWeights</a>(css_results, selected_clusts, weighting)</span>
<span id="cb81-105"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-106"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-106" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get selected features from each cluster (those features with nonzero</span></span>
<span id="cb81-107"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-107" aria-hidden="true" tabindex="-1"></a>    <span class="co"># weights)</span></span>
<span id="cb81-108"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-108" aria-hidden="true" tabindex="-1"></a>    selected_feats <span class="ot">&lt;-</span> <span class="fu">integer</span>()</span>
<span id="cb81-109"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-109" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_sel_clusts){</span>
<span id="cb81-110"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-110" aria-hidden="true" tabindex="-1"></a>        clus_i_name <span class="ot">&lt;-</span> clust_names[i]</span>
<span id="cb81-111"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-111" aria-hidden="true" tabindex="-1"></a>        clust_i <span class="ot">&lt;-</span> clusters[[clus_i_name]]</span>
<span id="cb81-112"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-112" aria-hidden="true" tabindex="-1"></a>        weights_i <span class="ot">&lt;-</span> weights[[i]]</span>
<span id="cb81-113"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-113" aria-hidden="true" tabindex="-1"></a>        selected_feats <span class="ot">&lt;-</span> <span class="fu">c</span>(selected_feats, clust_i[weights_i <span class="sc">!=</span> <span class="dv">0</span>])</span>
<span id="cb81-114"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-114" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb81-115"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-116"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-116" aria-hidden="true" tabindex="-1"></a>    feat_names <span class="ot">&lt;-</span> <span class="fu">colnames</span>(css_results<span class="sc">$</span>feat_sel_mat)</span>
<span id="cb81-117"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-118"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-118" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(selected_feats) <span class="ot">&lt;-</span> feat_names[selected_feats]</span>
<span id="cb81-119"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-120"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-120" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check output (already checked weights wihin getAllClustWeights)</span></span>
<span id="cb81-121"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-122"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-122" aria-hidden="true" tabindex="-1"></a>    <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGetSelectedClustersOutput'>checkGetSelectedClustersOutput</a>(selected_clusts, selected_feats,</span>
<span id="cb81-123"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-123" aria-hidden="true" tabindex="-1"></a>        weights, <span class="at">n_clusters=</span><span class="fu">length</span>(clusters), <span class="at">p=</span><span class="fu">ncol</span>(css_results<span class="sc">$</span>feat_sel_mat))</span>
<span id="cb81-124"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-125"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-125" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">selected_clusts=</span>selected_clusts,</span>
<span id="cb81-126"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-126" aria-hidden="true" tabindex="-1"></a>        <span class="at">selected_feats=</span>selected_feats, <span class="at">weights=</span>weights))</span>
<span id="cb81-127"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb81-127" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>checkSelectedClusters:</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Helper function to check operations within getSelectedClusters function</span></span>
<span id="cb82-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb82-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param n_sel_clusts The number of selected clusters; should be constrained</span></span>
<span id="cb82-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; by min_num_clusts and max_num_clusts (though it may not be possible to</span></span>
<span id="cb82-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb82-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; satisfy both constraints simulteneously, in which case a warning will be</span></span>
<span id="cb82-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb82-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; thrown).</span></span>
<span id="cb82-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb82-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param min_num_clusts Integer or numeric; the minimum number of clusters to</span></span>
<span id="cb82-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb82-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; use regardless of cutoff. (That is, if the chosen cutoff returns fewer than</span></span>
<span id="cb82-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb82-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; min_num_clusts clusters, the cutoff will be increased until at least</span></span>
<span id="cb82-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb82-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; min_num_clusts clusters are selected.)</span></span>
<span id="cb82-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb82-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param max_num_clusts Integer or numeric; the maximum number of clusters to</span></span>
<span id="cb82-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb82-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; use regardless of cutoff. (That is, if the chosen cutoff returns more than</span></span>
<span id="cb82-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb82-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; max_num_clusts clusters, the cutoff will be decreased until at most</span></span>
<span id="cb82-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb82-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; max_num_clusts clusters are selected.) If NA, max_num_clusts is ignored.</span></span>
<span id="cb82-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb82-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param max_sel_prop Numeric; the maximum selection proportion observed for </span></span>
<span id="cb82-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb82-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; any cluster.</span></span>
<span id="cb82-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb82-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @author Gregory Faletto, Jacob Bien</span></span>
<span id="cb82-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb82-18" aria-hidden="true" tabindex="-1"></a><span id='checkSelectedClusters'>checkSelectedClusters</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(n_sel_clusts, min_num_clusts, max_num_clusts,</span>
<span id="cb82-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb82-19" aria-hidden="true" tabindex="-1"></a>    max_sel_prop){</span>
<span id="cb82-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb82-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(n_sel_clusts <span class="sc">==</span> <span class="dv">0</span>){</span>
<span id="cb82-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb82-21" aria-hidden="true" tabindex="-1"></a>        err <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;No clusters selected with this cutoff (try a cutoff below the maximum cluster selection proportion, &quot;</span>,</span>
<span id="cb82-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb82-22" aria-hidden="true" tabindex="-1"></a>            max_sel_prop, <span class="st">&quot;)&quot;</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb82-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb82-23" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stop</span>(err)</span>
<span id="cb82-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb82-24" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb82-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb82-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb82-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(n_sel_clusts <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb82-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb82-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb82-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># It may be impossible to get at least min_num_clusts or at most</span></span>
<span id="cb82-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb82-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># max_num_clusts; if so, give a warning</span></span>
<span id="cb82-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb82-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(n_sel_clusts <span class="sc">&lt;</span> min_num_clusts){</span>
<span id="cb82-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb82-31" aria-hidden="true" tabindex="-1"></a>        warn <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;Returning fewer than min_num_clusts = &quot;</span>, min_num_clusts,</span>
<span id="cb82-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb82-32" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot; clusters because decreasing the cutoff any further would require returning more than max_num_clusts = &quot;</span>,</span>
<span id="cb82-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb82-33" aria-hidden="true" tabindex="-1"></a>            max_num_clusts, <span class="st">&quot; clusters&quot;</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb82-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb82-34" aria-hidden="true" tabindex="-1"></a>        <span class="fu">warning</span>(warn)</span>
<span id="cb82-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb82-35" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb82-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb82-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.na</span>(max_num_clusts)){</span>
<span id="cb82-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb82-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(n_sel_clusts <span class="sc">&gt;</span> max_num_clusts){</span>
<span id="cb82-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb82-38" aria-hidden="true" tabindex="-1"></a>            warn <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;Returning more than max_num_clusts = &quot;</span>,</span>
<span id="cb82-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb82-39" aria-hidden="true" tabindex="-1"></a>                max_num_clusts,</span>
<span id="cb82-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb82-40" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot; clusters because increasing the cutoff any further would require returning 0 clusters&quot;</span>,</span>
<span id="cb82-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb82-41" aria-hidden="true" tabindex="-1"></a>                <span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb82-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb82-42" aria-hidden="true" tabindex="-1"></a>            <span class="fu">warning</span>(warn)</span>
<span id="cb82-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb82-43" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb82-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb82-44" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb82-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb82-45" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Test for checkSelectedClusters:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb83-1" aria-hidden="true" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">test_that</span>(<span class="st">&quot;checkSelectedClusters works&quot;</span>, {</span>
<span id="cb83-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb83-2" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_null</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkSelectedClusters'>checkSelectedClusters</a>(<span class="at">n_sel_clusts=</span><span class="dv">5</span>, <span class="at">min_num_clusts=</span><span class="dv">1</span>,</span>
<span id="cb83-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb83-3" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">max_num_clusts=</span><span class="cn">NA</span>, <span class="at">max_sel_prop=</span>.<span class="dv">8</span>))</span>
<span id="cb83-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb83-4" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_null</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkSelectedClusters'>checkSelectedClusters</a>(<span class="at">n_sel_clusts=</span><span class="dv">5</span>, <span class="at">min_num_clusts=</span><span class="dv">2</span>,</span>
<span id="cb83-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb83-5" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">max_num_clusts=</span><span class="dv">5</span>, <span class="at">max_sel_prop=</span>.<span class="dv">3</span>))</span>
<span id="cb83-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb83-6" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_null</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkSelectedClusters'>checkSelectedClusters</a>(<span class="at">n_sel_clusts=</span><span class="dv">2</span>, <span class="at">min_num_clusts=</span><span class="dv">2</span>,</span>
<span id="cb83-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb83-7" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">max_num_clusts=</span><span class="dv">5</span>, <span class="at">max_sel_prop=</span>.<span class="dv">3</span>))</span>
<span id="cb83-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb83-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb83-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb83-10" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkSelectedClusters'>checkSelectedClusters</a>(<span class="at">n_sel_clusts=</span><span class="dv">0</span>, <span class="at">min_num_clusts=</span><span class="dv">2</span>,</span>
<span id="cb83-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb83-11" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">max_num_clusts=</span><span class="dv">5</span>,</span>
<span id="cb83-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb83-12" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">max_sel_prop=</span>.<span class="dv">6</span>),</span>
<span id="cb83-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb83-13" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;No clusters selected with this cutoff (try a cutoff below the maximum cluster selection proportion, 0.6)&quot;</span>,</span>
<span id="cb83-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb83-14" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb83-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb83-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb83-16" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_warning</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkSelectedClusters'>checkSelectedClusters</a>(<span class="at">n_sel_clusts=</span><span class="dv">1</span>,</span>
<span id="cb83-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb83-17" aria-hidden="true" tabindex="-1"></a>                                                 <span class="at">min_num_clusts=</span><span class="dv">2</span>,</span>
<span id="cb83-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb83-18" aria-hidden="true" tabindex="-1"></a>                                                 <span class="at">max_num_clusts=</span><span class="dv">5</span>,</span>
<span id="cb83-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb83-19" aria-hidden="true" tabindex="-1"></a>                                                 <span class="at">max_sel_prop=</span>.<span class="dv">6</span>),</span>
<span id="cb83-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb83-20" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;Returning fewer than min_num_clusts = 2 clusters because decreasing the cutoff any further would require returning more than max_num_clusts = 5 clusters&quot;</span>,</span>
<span id="cb83-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb83-21" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb83-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb83-22" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_warning</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkSelectedClusters'>checkSelectedClusters</a>(<span class="at">n_sel_clusts=</span><span class="dv">6</span>,</span>
<span id="cb83-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb83-23" aria-hidden="true" tabindex="-1"></a>                                                 <span class="at">min_num_clusts=</span><span class="dv">2</span>,</span>
<span id="cb83-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb83-24" aria-hidden="true" tabindex="-1"></a>                                                 <span class="at">max_num_clusts=</span><span class="dv">5</span>,</span>
<span id="cb83-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb83-25" aria-hidden="true" tabindex="-1"></a>                                                 <span class="at">max_sel_prop=</span>.<span class="dv">6</span>),</span>
<span id="cb83-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb83-26" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;Returning more than max_num_clusts = 5 clusters because increasing the cutoff any further would require returning 0 clusters&quot;</span>,</span>
<span id="cb83-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb83-27" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb83-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb83-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb83-29" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## Test passed 🥇</code></pre>
<p>getAllClustWeights:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Calculate weights for each cluster member of all of the selected clusters.</span></span>
<span id="cb85-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; </span></span>
<span id="cb85-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param css_results An object of class &quot;cssr&quot; (the output of the function</span></span>
<span id="cb85-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; css).</span></span>
<span id="cb85-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param sel_clusters A named numeric vector containing the selection</span></span>
<span id="cb85-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; proportions for the selected clusters. The name of each entry is the name</span></span>
<span id="cb85-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; of the corresponding cluster.</span></span>
<span id="cb85-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param weighting Character; determines how to calculate the weights for</span></span>
<span id="cb85-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; individual features within the selected clusters. Only those features with</span></span>
<span id="cb85-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; nonzero weight within the selected clusters will be returned. Must be one of</span></span>
<span id="cb85-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; &quot;sparse&quot;, &quot;weighted_avg&quot;, or &quot;simple_avg&#39;. For &quot;sparse&quot;, all the weight is</span></span>
<span id="cb85-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; put on the most frequently</span></span>
<span id="cb85-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; selected individual cluster member (or divided equally among all the clusters</span></span>
<span id="cb85-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; that are tied for the top selection proportion if there is a tie). For</span></span>
<span id="cb85-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; &quot;weighted_avg&quot;, only the features within a selected cluster that were</span></span>
<span id="cb85-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; themselves selected on at least one subsample will have nonzero weight. For</span></span>
<span id="cb85-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; &quot;simple_avg&quot;, each cluster member gets equal weight regardless of the</span></span>
<span id="cb85-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; individual feature selection proportions (that is, all cluster members within</span></span>
<span id="cb85-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; each selected cluster will be returned.). See Faletto and Bien (2022) for</span></span>
<span id="cb85-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; details.</span></span>
<span id="cb85-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return A named list of the same length as sel_clusters of numeric vectors.</span></span>
<span id="cb85-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; weights[[j]] is the weights to use for the jth selected cluster, and it has</span></span>
<span id="cb85-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the same name as the cluster it corresponds to.</span></span>
<span id="cb85-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @author Gregory Faletto, Jacob Bien</span></span>
<span id="cb85-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-25" aria-hidden="true" tabindex="-1"></a><span id='getAllClustWeights'>getAllClustWeights</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(css_results, sel_clusters, weighting){</span>
<span id="cb85-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check inputs</span></span>
<span id="cb85-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">class</span>(css_results) <span class="sc">==</span> <span class="st">&quot;cssr&quot;</span>)</span>
<span id="cb85-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.numeric</span>(sel_clusters))</span>
<span id="cb85-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-31" aria-hidden="true" tabindex="-1"></a>    p_ret <span class="ot">&lt;-</span> <span class="fu">length</span>(sel_clusters)</span>
<span id="cb85-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">names</span>(sel_clusters))) <span class="sc">==</span> p_ret)</span>
<span id="cb85-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(p_ret <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb85-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-35" aria-hidden="true" tabindex="-1"></a>    <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkWeighting'>checkWeighting</a>(weighting)</span>
<span id="cb85-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get selection proportions and clusters</span></span>
<span id="cb85-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-38" aria-hidden="true" tabindex="-1"></a>    feat_sel_props <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(css_results<span class="sc">$</span>feat_sel_mat)</span>
<span id="cb85-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-40" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">length</span>(feat_sel_props)</span>
<span id="cb85-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(p <span class="sc">&gt;=</span> p_ret)</span>
<span id="cb85-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-43" aria-hidden="true" tabindex="-1"></a>    clusters <span class="ot">&lt;-</span> css_results<span class="sc">$</span>clusters</span>
<span id="cb85-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">all</span>(<span class="fu">names</span>(sel_clusters) <span class="sc">%in%</span> <span class="fu">names</span>(clusters)))</span>
<span id="cb85-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Identify weights</span></span>
<span id="cb85-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-47" aria-hidden="true" tabindex="-1"></a>    weights <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb85-48"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-49"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>p_ret){</span>
<span id="cb85-50"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-50" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Find the members of the cluster feature j is a member of</span></span>
<span id="cb85-51"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-51" aria-hidden="true" tabindex="-1"></a>        cluster_j <span class="ot">&lt;-</span> clusters[[<span class="fu">names</span>(sel_clusters)[j]]]</span>
<span id="cb85-52"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-52" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Get the weights for this cluster and add them to the list</span></span>
<span id="cb85-53"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-53" aria-hidden="true" tabindex="-1"></a>        weights[[j]] <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getClustWeights'>getClustWeights</a>(cluster_j, weighting, feat_sel_props)</span>
<span id="cb85-54"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-54" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb85-55"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-56"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-56" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add names to weights</span></span>
<span id="cb85-57"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(weights) <span class="ot">&lt;-</span> <span class="fu">names</span>(sel_clusters)</span>
<span id="cb85-58"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-59"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-59" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check output</span></span>
<span id="cb85-60"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-61"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(weights) <span class="sc">==</span> p_ret)</span>
<span id="cb85-62"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.list</span>(weights))</span>
<span id="cb85-63"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-64"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-64" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>p_ret){</span>
<span id="cb85-65"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-65" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">length</span>(clusters[[<span class="fu">names</span>(sel_clusters)[i]]]) <span class="sc">==</span></span>
<span id="cb85-66"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-66" aria-hidden="true" tabindex="-1"></a>            <span class="fu">length</span>(weights[[i]]))</span>
<span id="cb85-67"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-67" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">all</span>(weights[[i]] <span class="sc">&gt;=</span> <span class="dv">0</span>))</span>
<span id="cb85-68"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-68" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">all</span>(weights[[i]] <span class="sc">&lt;=</span> <span class="dv">1</span>))</span>
<span id="cb85-69"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-69" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">abs</span>(<span class="fu">sum</span>(weights[[i]]) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">&lt;</span> <span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">6</span>))</span>
<span id="cb85-70"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-70" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb85-71"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(weights)</span>
<span id="cb85-72"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb85-72" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>getClustWeights:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Calculate weights for members of a cluster using selection proportions</span></span>
<span id="cb86-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb86-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Given a cluster of features, the selection proportions for each cluster</span></span>
<span id="cb86-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; member, and a specified weighting scheme, calculate the appropriate weights</span></span>
<span id="cb86-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; for the cluster.</span></span>
<span id="cb86-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param cluster_i An integer vector containing the indices of the members</span></span>
<span id="cb86-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; of a cluster.</span></span>
<span id="cb86-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param weighting Character; determines how to calculate the weights for</span></span>
<span id="cb86-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; individual features within the selected clusters. Only those features with</span></span>
<span id="cb86-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; nonzero weight within the selected clusters will be returned. Must be one of</span></span>
<span id="cb86-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; &quot;sparse&quot;, &quot;weighted_avg&quot;, or &quot;simple_avg&#39;. For &quot;sparse&quot;, all the weight is</span></span>
<span id="cb86-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; put on the most frequently</span></span>
<span id="cb86-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; selected individual cluster member (or divided equally among all the clusters</span></span>
<span id="cb86-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; that are tied for the top selection proportion if there is a tie). For</span></span>
<span id="cb86-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; &quot;weighted_avg&quot;, only the features within a selected cluster that were</span></span>
<span id="cb86-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; themselves selected on at least one subsample will have nonzero weight. For</span></span>
<span id="cb86-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; &quot;simple_avg&quot;, each cluster member gets equal weight regardless of the</span></span>
<span id="cb86-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; individual feature selection proportions (that is, all cluster members within</span></span>
<span id="cb86-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; each selected cluster will be returned.). See Faletto and Bien (2022) for</span></span>
<span id="cb86-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; details.</span></span>
<span id="cb86-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param feat_sel_props A numeric vector of selection proportions corresponding</span></span>
<span id="cb86-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; to each of the p features.</span></span>
<span id="cb86-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return A numeric vector of the same length as cluster_i containing the</span></span>
<span id="cb86-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; weights corresponding to each of the features in cluster_i. The weights</span></span>
<span id="cb86-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; will all be nonnegative and sum to 1.</span></span>
<span id="cb86-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @author Gregory Faletto, Jacob Bien</span></span>
<span id="cb86-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-27" aria-hidden="true" tabindex="-1"></a><span id='getClustWeights'>getClustWeights</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(cluster_i, weighting, feat_sel_props){</span>
<span id="cb86-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.integer</span>(cluster_i) <span class="sc">|</span> <span class="fu">is.numeric</span>(cluster_i))</span>
<span id="cb86-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">all</span>(cluster_i <span class="sc">==</span> <span class="fu">round</span>(cluster_i)))</span>
<span id="cb86-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-31" aria-hidden="true" tabindex="-1"></a>    n_weights <span class="ot">&lt;-</span> <span class="fu">length</span>(cluster_i)</span>
<span id="cb86-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(<span class="fu">unique</span>(cluster_i)) <span class="sc">==</span> n_weights)</span>
<span id="cb86-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-34" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">length</span>(feat_sel_props)</span>
<span id="cb86-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">all</span>(cluster_i <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span>p))</span>
<span id="cb86-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get the selection proportions of each cluster member</span></span>
<span id="cb86-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-38" aria-hidden="true" tabindex="-1"></a>    sel_props <span class="ot">&lt;-</span> feat_sel_props[cluster_i]</span>
<span id="cb86-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">all</span>(sel_props <span class="sc">&gt;=</span> <span class="dv">0</span>))</span>
<span id="cb86-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">all</span>(sel_props <span class="sc">&lt;=</span> <span class="dv">1</span>))</span>
<span id="cb86-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-43" aria-hidden="true" tabindex="-1"></a>    weights_i <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">as.numeric</span>(<span class="cn">NA</span>), n_weights)</span>
<span id="cb86-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Weighted or simple average?</span></span>
<span id="cb86-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(weighting <span class="sc">==</span> <span class="st">&quot;sparse&quot;</span>){</span>
<span id="cb86-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-47" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Sparse cluster stability selection: All features in cluster with</span></span>
<span id="cb86-48"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-48" aria-hidden="true" tabindex="-1"></a>        <span class="co"># selection proportion equal to the max</span></span>
<span id="cb86-49"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-49" aria-hidden="true" tabindex="-1"></a>        <span class="co"># for the cluster get equal weight; rest of cluster gets 0 weight</span></span>
<span id="cb86-50"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-50" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="fu">sum</span>(sel_props) <span class="sc">==</span> <span class="dv">0</span>){</span>
<span id="cb86-51"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-51" aria-hidden="true" tabindex="-1"></a>            weights_i <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span>n_weights, n_weights)</span>
<span id="cb86-52"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-52" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span>{</span>
<span id="cb86-53"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-53" aria-hidden="true" tabindex="-1"></a>            maxes <span class="ot">&lt;-</span> sel_props<span class="sc">==</span><span class="fu">max</span>(sel_props)</span>
<span id="cb86-54"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-55"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-55" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stopifnot</span>(<span class="fu">sum</span>(maxes) <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb86-56"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-56" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stopifnot</span>(<span class="fu">sum</span>(maxes) <span class="sc">&lt;=</span> n_weights)</span>
<span id="cb86-57"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-58"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-58" aria-hidden="true" tabindex="-1"></a>            weights_i <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n_weights)</span>
<span id="cb86-59"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-59" aria-hidden="true" tabindex="-1"></a>            weights_i[maxes] <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">sum</span>(maxes)</span>
<span id="cb86-60"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-60" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb86-61"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-61" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span>(weighting <span class="sc">==</span> <span class="st">&quot;weighted_avg&quot;</span>){</span>
<span id="cb86-62"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-62" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Get weights for weighted average</span></span>
<span id="cb86-63"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-63" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="fu">sum</span>(sel_props) <span class="sc">==</span> <span class="dv">0</span>){</span>
<span id="cb86-64"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-64" aria-hidden="true" tabindex="-1"></a>            weights_i <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span>n_weights, n_weights)</span>
<span id="cb86-65"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-65" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span>{</span>
<span id="cb86-66"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-66" aria-hidden="true" tabindex="-1"></a>            weights_i <span class="ot">&lt;-</span> sel_props<span class="sc">/</span><span class="fu">sum</span>(sel_props)</span>
<span id="cb86-67"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-67" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb86-68"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-68" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span>(weighting <span class="sc">==</span> <span class="st">&quot;simple_avg&quot;</span>){</span>
<span id="cb86-69"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-69" aria-hidden="true" tabindex="-1"></a>        weights_i <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span>n_weights, n_weights)</span>
<span id="cb86-70"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-70" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span>{</span>
<span id="cb86-71"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-71" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stop</span>(<span class="st">&quot;weighting must be one of sparse, simple_avg, or weighted_avg&quot;</span>)</span>
<span id="cb86-72"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-72" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb86-73"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-74"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">abs</span>(<span class="fu">sum</span>(weights_i) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">&lt;</span> <span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">6</span>))</span>
<span id="cb86-75"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-75" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(weights_i) <span class="sc">==</span> n_weights)</span>
<span id="cb86-76"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-76" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(weights_i) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb86-77"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-77" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">all</span>(weights_i <span class="sc">&gt;=</span> <span class="dv">0</span>))</span>
<span id="cb86-78"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-78" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">all</span>(weights_i <span class="sc">&lt;=</span> <span class="dv">1</span>))</span>
<span id="cb86-79"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-80"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-80" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(weights_i)</span>
<span id="cb86-81"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb86-81" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Tests for getClustWeights:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb87-1" aria-hidden="true" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">test_that</span>(<span class="st">&quot;getClustWeights works&quot;</span>, {</span>
<span id="cb87-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb87-2" aria-hidden="true" tabindex="-1"></a>  sel_props <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span>)</span>
<span id="cb87-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb87-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb87-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sparse</span></span>
<span id="cb87-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb87-5" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getClustWeights'>getClustWeights</a>(<span class="at">cluster_i=</span><span class="fu">c</span>(3L, 4L, 5L),</span>
<span id="cb87-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb87-6" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">weighting=</span><span class="st">&quot;sparse&quot;</span>,</span>
<span id="cb87-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb87-7" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">feat_sel_props=</span>sel_props),</span>
<span id="cb87-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb87-8" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb87-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb87-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb87-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb87-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># weighted_avg</span></span>
<span id="cb87-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb87-11" aria-hidden="true" tabindex="-1"></a>  cluster<span class="ot">=</span><span class="fu">c</span>(1L, 3L, 5L)</span>
<span id="cb87-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb87-12" aria-hidden="true" tabindex="-1"></a>  true_weights <span class="ot">&lt;-</span> sel_props[cluster]<span class="sc">/</span><span class="fu">sum</span>(sel_props[cluster])</span>
<span id="cb87-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb87-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb87-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb87-14" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getClustWeights'>getClustWeights</a>(<span class="at">cluster_i=</span>cluster,</span>
<span id="cb87-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb87-15" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">weighting=</span><span class="st">&quot;weighted_avg&quot;</span>,</span>
<span id="cb87-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb87-16" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">feat_sel_props=</span>sel_props),</span>
<span id="cb87-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb87-17" aria-hidden="true" tabindex="-1"></a>                             true_weights)</span>
<span id="cb87-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb87-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb87-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb87-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># simple_avg</span></span>
<span id="cb87-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb87-20" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getClustWeights'>getClustWeights</a>(<span class="at">cluster_i=</span><span class="fu">c</span>(2L, 3L, 4L, 5L),</span>
<span id="cb87-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb87-21" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">weighting=</span><span class="st">&quot;simple_avg&quot;</span>,</span>
<span id="cb87-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb87-22" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">feat_sel_props=</span>sel_props),</span>
<span id="cb87-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb87-23" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">rep</span>(<span class="fl">0.25</span>, <span class="dv">4</span>))</span>
<span id="cb87-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb87-24" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## Test passed 🥳</code></pre>
<p>Tests for getAllClustWeights:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-1" aria-hidden="true" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">test_that</span>(<span class="st">&quot;getAllClustWeights works&quot;</span>, {</span>
<span id="cb89-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb89-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">1872</span>)</span>
<span id="cb89-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb89-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-5" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">10</span><span class="sc">*</span><span class="dv">5</span>), <span class="at">nrow=</span><span class="dv">10</span>, <span class="at">ncol=</span><span class="dv">5</span>)</span>
<span id="cb89-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-6" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">10</span>)</span>
<span id="cb89-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb89-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-8" aria-hidden="true" tabindex="-1"></a>  clust_names <span class="ot">&lt;-</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb89-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb89-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-10" aria-hidden="true" tabindex="-1"></a>  good_clusters <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">5</span>)</span>
<span id="cb89-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb89-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(good_clusters) <span class="ot">&lt;-</span> clust_names</span>
<span id="cb89-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb89-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-14" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">lambda=</span><span class="fl">0.01</span>, <span class="at">clusters=</span>good_clusters, <span class="at">fitfun =</span> cssLasso,</span>
<span id="cb89-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">sampling_type =</span> <span class="st">&quot;SS&quot;</span>, <span class="at">B =</span> <span class="dv">10</span>, <span class="at">prop_feats_remove =</span> <span class="dv">0</span>, <span class="at">train_inds =</span> <span class="fu">integer</span>(),</span>
<span id="cb89-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">num_cores =</span> 1L)</span>
<span id="cb89-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb89-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-18" aria-hidden="true" tabindex="-1"></a>  sel_props <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(res<span class="sc">$</span>feat_sel_mat)</span>
<span id="cb89-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb89-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-20" aria-hidden="true" tabindex="-1"></a>  sel_clusts <span class="ot">&lt;-</span> <span class="fu">list</span>(1L<span class="sc">:</span>2L, 3L<span class="sc">:</span>4L)</span>
<span id="cb89-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb89-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(sel_clusts) <span class="ot">&lt;-</span> clust_names[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb89-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb89-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sparse</span></span>
<span id="cb89-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-25" aria-hidden="true" tabindex="-1"></a>  true_weights <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb89-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb89-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>){</span>
<span id="cb89-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-28" aria-hidden="true" tabindex="-1"></a>    weights_i <span class="ot">&lt;-</span> sel_props[sel_clusts[[i]]]<span class="sc">/</span><span class="fu">sum</span>(sel_props[sel_clusts[[i]]])</span>
<span id="cb89-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-29" aria-hidden="true" tabindex="-1"></a>    true_weights[[i]] <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(weights_i))</span>
<span id="cb89-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-30" aria-hidden="true" tabindex="-1"></a>    true_weights[[i]][weights_i <span class="sc">==</span> <span class="fu">max</span>(weights_i)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb89-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-31" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb89-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb89-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(true_weights) <span class="ot">&lt;-</span> clust_names[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb89-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb89-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-35" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getAllClustWeights'>getAllClustWeights</a>(res,</span>
<span id="cb89-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-36" aria-hidden="true" tabindex="-1"></a>                                                <span class="fu">colMeans</span>(res<span class="sc">$</span>clus_sel_mat[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]),</span>
<span id="cb89-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-37" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">&quot;sparse&quot;</span>), true_weights)</span>
<span id="cb89-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># weighted_avg</span></span>
<span id="cb89-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-40" aria-hidden="true" tabindex="-1"></a>  true_weights <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb89-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-42" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>){</span>
<span id="cb89-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-43" aria-hidden="true" tabindex="-1"></a>    true_weights[[i]] <span class="ot">&lt;-</span> sel_props[sel_clusts[[i]]]<span class="sc">/</span><span class="fu">sum</span>(sel_props[sel_clusts[[i]]])</span>
<span id="cb89-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-44" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb89-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb89-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(true_weights) <span class="ot">&lt;-</span> clust_names[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb89-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-48"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-48" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getAllClustWeights'>getAllClustWeights</a>(res,</span>
<span id="cb89-49"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-49" aria-hidden="true" tabindex="-1"></a>                                                <span class="fu">colMeans</span>(res<span class="sc">$</span>clus_sel_mat[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]),</span>
<span id="cb89-50"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-50" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">&quot;weighted_avg&quot;</span>), true_weights)</span>
<span id="cb89-51"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-52"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-52" aria-hidden="true" tabindex="-1"></a>  <span class="co"># simple_avg</span></span>
<span id="cb89-53"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-53" aria-hidden="true" tabindex="-1"></a>  true_weights <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb89-54"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-55"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-55" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>){</span>
<span id="cb89-56"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-56" aria-hidden="true" tabindex="-1"></a>    n_weights_i <span class="ot">&lt;-</span> <span class="fu">length</span>(sel_clusts[[i]])</span>
<span id="cb89-57"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-57" aria-hidden="true" tabindex="-1"></a>    true_weights[[i]] <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span>n_weights_i, n_weights_i)</span>
<span id="cb89-58"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-58" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb89-59"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb89-60"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(true_weights) <span class="ot">&lt;-</span> clust_names[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb89-61"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-62"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-62" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getAllClustWeights'>getAllClustWeights</a>(res,</span>
<span id="cb89-63"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-63" aria-hidden="true" tabindex="-1"></a>                                                <span class="fu">colMeans</span>(res<span class="sc">$</span>clus_sel_mat[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]),</span>
<span id="cb89-64"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-64" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">&quot;simple_avg&quot;</span>), true_weights)</span>
<span id="cb89-65"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-66"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-66" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Errors</span></span>
<span id="cb89-67"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-68"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-68" aria-hidden="true" tabindex="-1"></a>  <span class="co"># css_results not correct (error has quotation marks)</span></span>
<span id="cb89-69"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-69" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getAllClustWeights'>getAllClustWeights</a>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="fu">colMeans</span>(res<span class="sc">$</span>clus_sel_mat[,</span>
<span id="cb89-70"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-70" aria-hidden="true" tabindex="-1"></a>                                                                           <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]),</span>
<span id="cb89-71"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-71" aria-hidden="true" tabindex="-1"></a>                                            <span class="st">&quot;simple_avg&quot;</span>))</span>
<span id="cb89-72"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-73"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-73" aria-hidden="true" tabindex="-1"></a>  bad_sel_clusts <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(res<span class="sc">$</span>clus_sel_mat[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span>
<span id="cb89-74"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(bad_sel_clusts) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;apple&quot;</span>, <span class="st">&quot;banana&quot;</span>)</span>
<span id="cb89-75"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-75" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getAllClustWeights'>getAllClustWeights</a>(res, bad_sel_clusts, <span class="st">&quot;sparse&quot;</span>),</span>
<span id="cb89-76"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-76" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;all(names(sel_clusters) %in% names(clusters)) is not TRUE&quot;</span>,</span>
<span id="cb89-77"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-77" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb89-78"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-79"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-80"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-80" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getAllClustWeights'>getAllClustWeights</a>(res, <span class="fu">colMeans</span>(res<span class="sc">$</span>clus_sel_mat[,</span>
<span id="cb89-81"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-81" aria-hidden="true" tabindex="-1"></a>                                                                           <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]),</span>
<span id="cb89-82"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-82" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">c</span>(<span class="st">&quot;sparse&quot;</span>, <span class="st">&quot;simple_avg&quot;</span>)),</span>
<span id="cb89-83"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-83" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;length(weighting) == 1 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb89-84"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-85"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-85" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getAllClustWeights'>getAllClustWeights</a>(res, <span class="fu">colMeans</span>(res<span class="sc">$</span>clus_sel_mat[,</span>
<span id="cb89-86"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-86" aria-hidden="true" tabindex="-1"></a>                                                                           <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]),</span>
<span id="cb89-87"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-87" aria-hidden="true" tabindex="-1"></a>                                            <span class="cn">NA</span>),</span>
<span id="cb89-88"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-88" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;!is.na(weighting) is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb89-89"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-90"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-90" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getAllClustWeights'>getAllClustWeights</a>(res, <span class="fu">colMeans</span>(res<span class="sc">$</span>clus_sel_mat[,</span>
<span id="cb89-91"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-91" aria-hidden="true" tabindex="-1"></a>                                                                           <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]),</span>
<span id="cb89-92"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-92" aria-hidden="true" tabindex="-1"></a>                                            <span class="dv">1</span>),</span>
<span id="cb89-93"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-93" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;Weighting must be a character&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb89-94"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-95"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-95" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getAllClustWeights'>getAllClustWeights</a>(res, <span class="fu">colMeans</span>(res<span class="sc">$</span>clus_sel_mat[,</span>
<span id="cb89-96"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-96" aria-hidden="true" tabindex="-1"></a>                                                                           <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]),</span>
<span id="cb89-97"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-97" aria-hidden="true" tabindex="-1"></a>                                            <span class="st">&quot;spasre&quot;</span>),</span>
<span id="cb89-98"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-98" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;Weighting must be a character and one of sparse, simple_avg, or weighted_avg&quot;</span>,</span>
<span id="cb89-99"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-99" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb89-100"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-101"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb89-101" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## Test passed 🥇</code></pre>
<p>checkGetSelectedClustersOutput:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Helper function to check that output of getSelectedClusters is as expected</span></span>
<span id="cb91-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb91-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param selected_clusts A named numeric vector containing the selection</span></span>
<span id="cb91-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; proportions for the selected clusters. The name of each entry is the name of</span></span>
<span id="cb91-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb91-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the corresponding cluster.</span></span>
<span id="cb91-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb91-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param selected_feats A named integer vector; the indices of the features</span></span>
<span id="cb91-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb91-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; with nonzero weights from all of the selected clusters.</span></span>
<span id="cb91-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb91-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param weights A named list of the same length as the number of selected</span></span>
<span id="cb91-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb91-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; clusters. Each list element weights[[j]] is a numeric vector of the weights</span></span>
<span id="cb91-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb91-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; to use for the jth selected cluster, and it has the same name as the cluster</span></span>
<span id="cb91-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb91-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; it corresponds to.</span></span>
<span id="cb91-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb91-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param n_clusters Integer; the number of clusters in the data (upper bound</span></span>
<span id="cb91-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb91-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; for the length of selected_clusts)</span></span>
<span id="cb91-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb91-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param p Integer; number of features in the data (all selected_feats should</span></span>
<span id="cb91-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb91-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; be in 1:p)</span></span>
<span id="cb91-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb91-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @author Gregory Faletto, Jacob Bien</span></span>
<span id="cb91-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb91-17" aria-hidden="true" tabindex="-1"></a><span id='checkGetSelectedClustersOutput'>checkGetSelectedClustersOutput</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(selected_clusts, selected_feats,</span>
<span id="cb91-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb91-18" aria-hidden="true" tabindex="-1"></a>    weights, n_clusters, p){</span>
<span id="cb91-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb91-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.numeric</span>(selected_clusts))</span>
<span id="cb91-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb91-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">all</span>(selected_clusts <span class="sc">&gt;=</span> <span class="dv">0</span>))</span>
<span id="cb91-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb91-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">all</span>(selected_clusts <span class="sc">&lt;=</span> <span class="dv">1</span>))</span>
<span id="cb91-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb91-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(selected_clusts) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb91-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb91-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(selected_clusts) <span class="sc">&lt;=</span> n_clusters)</span>
<span id="cb91-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb91-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(<span class="fu">names</span>(selected_clusts)) <span class="sc">==</span></span>
<span id="cb91-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb91-25" aria-hidden="true" tabindex="-1"></a>        <span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">names</span>(selected_clusts))))</span>
<span id="cb91-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb91-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="sc">!</span><span class="fu">is.null</span>(<span class="fu">names</span>(selected_clusts)))</span>
<span id="cb91-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb91-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">names</span>(selected_clusts)) <span class="sc">&amp;</span></span>
<span id="cb91-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb91-28" aria-hidden="true" tabindex="-1"></a>        <span class="fu">names</span>(selected_clusts) <span class="sc">!=</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb91-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb91-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(<span class="fu">names</span>(selected_clusts)) <span class="sc">==</span> <span class="fu">length</span>(selected_clusts))</span>
<span id="cb91-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb91-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.integer</span>(selected_feats))</span>
<span id="cb91-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb91-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(selected_feats) <span class="sc">==</span> <span class="fu">length</span>(<span class="fu">unique</span>(selected_feats)))</span>
<span id="cb91-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb91-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">all</span>(selected_feats <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span>p))</span>
<span id="cb91-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb91-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(selected_clusts) <span class="sc">&lt;=</span> <span class="fu">length</span>(selected_feats))</span>
<span id="cb91-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb91-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">identical</span>(<span class="fu">names</span>(weights), <span class="fu">names</span>(selected_clusts)))</span>
<span id="cb91-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb91-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(weights) <span class="sc">==</span> <span class="fu">length</span>(selected_clusts)) </span>
<span id="cb91-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb91-36" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Tests for checkGetSelectedClustersOutput:</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-1" aria-hidden="true" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">test_that</span>(<span class="st">&quot;checkGetSelectedClustersOutput works&quot;</span>, {</span>
<span id="cb92-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb92-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-3" aria-hidden="true" tabindex="-1"></a>  sel_clusts <span class="ot">&lt;-</span> <span class="fl">0.1</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)</span>
<span id="cb92-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(sel_clusts) <span class="ot">&lt;-</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>]</span>
<span id="cb92-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb92-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-6" aria-hidden="true" tabindex="-1"></a>  weights <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb92-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb92-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>){</span>
<span id="cb92-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-9" aria-hidden="true" tabindex="-1"></a>    weights[[i]] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.3</span>)</span>
<span id="cb92-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb92-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-11" aria-hidden="true" tabindex="-1"></a>  weights[[<span class="dv">9</span>]] <span class="ot">&lt;-</span> <span class="fl">0.4</span></span>
<span id="cb92-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(weights) <span class="ot">&lt;-</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>]</span>
<span id="cb92-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb92-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-14" aria-hidden="true" tabindex="-1"></a>  sel_feats <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">:</span><span class="dv">26</span></span>
<span id="cb92-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(sel_feats) <span class="ot">&lt;-</span> LETTERS[<span class="dv">10</span><span class="sc">:</span><span class="dv">26</span>]</span>
<span id="cb92-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb92-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-17" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_null</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGetSelectedClustersOutput'>checkGetSelectedClustersOutput</a>(<span class="at">selected_clusts=</span>sel_clusts,</span>
<span id="cb92-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-18" aria-hidden="true" tabindex="-1"></a>                                                       <span class="at">selected_feats=</span>sel_feats,</span>
<span id="cb92-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-19" aria-hidden="true" tabindex="-1"></a>                                                       <span class="at">weights=</span>weights,</span>
<span id="cb92-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-20" aria-hidden="true" tabindex="-1"></a>                                                       <span class="at">n_clusters=</span><span class="dv">10</span>, <span class="at">p=</span><span class="dv">30</span>))</span>
<span id="cb92-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb92-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-22" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGetSelectedClustersOutput'>checkGetSelectedClustersOutput</a>(<span class="at">selected_clusts=</span>letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],</span>
<span id="cb92-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-23" aria-hidden="true" tabindex="-1"></a>                                                       <span class="at">selected_feats=</span>sel_feats,</span>
<span id="cb92-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-24" aria-hidden="true" tabindex="-1"></a>                                                       <span class="at">weights=</span>weights,</span>
<span id="cb92-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-25" aria-hidden="true" tabindex="-1"></a>                                                       <span class="at">n_clusters=</span><span class="dv">10</span>, <span class="at">p=</span><span class="dv">30</span>),</span>
<span id="cb92-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-26" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;is.numeric(selected_clusts) is not TRUE&quot;</span>,</span>
<span id="cb92-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-27" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb92-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb92-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-29" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGetSelectedClustersOutput'>checkGetSelectedClustersOutput</a>(<span class="at">selected_clusts=</span><span class="sc">-</span>sel_clusts,</span>
<span id="cb92-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-30" aria-hidden="true" tabindex="-1"></a>                                                       <span class="at">selected_feats=</span>sel_feats,</span>
<span id="cb92-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-31" aria-hidden="true" tabindex="-1"></a>                                                       <span class="at">weights=</span>weights,</span>
<span id="cb92-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-32" aria-hidden="true" tabindex="-1"></a>                                                       <span class="at">n_clusters=</span><span class="dv">10</span>, <span class="at">p=</span><span class="dv">30</span>),</span>
<span id="cb92-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-33" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;all(selected_clusts &gt;= 0) is not TRUE&quot;</span>,</span>
<span id="cb92-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-34" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb92-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb92-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-36" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGetSelectedClustersOutput'>checkGetSelectedClustersOutput</a>(<span class="at">selected_clusts=</span><span class="dv">10</span><span class="sc">*</span>sel_clusts,</span>
<span id="cb92-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-37" aria-hidden="true" tabindex="-1"></a>                                                       <span class="at">selected_feats=</span>sel_feats,</span>
<span id="cb92-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-38" aria-hidden="true" tabindex="-1"></a>                                                       <span class="at">weights=</span>weights,</span>
<span id="cb92-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-39" aria-hidden="true" tabindex="-1"></a>                                                       <span class="at">n_clusters=</span><span class="dv">10</span>, <span class="at">p=</span><span class="dv">30</span>),</span>
<span id="cb92-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-40" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;all(selected_clusts &lt;= 1) is not TRUE&quot;</span>,</span>
<span id="cb92-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-41" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb92-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb92-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-43" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGetSelectedClustersOutput'>checkGetSelectedClustersOutput</a>(<span class="at">selected_clusts=</span><span class="fu">numeric</span>(),</span>
<span id="cb92-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-44" aria-hidden="true" tabindex="-1"></a>                                                       <span class="at">selected_feats=</span>sel_feats,</span>
<span id="cb92-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-45" aria-hidden="true" tabindex="-1"></a>                                                       <span class="at">weights=</span>weights,</span>
<span id="cb92-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-46" aria-hidden="true" tabindex="-1"></a>                                                       <span class="at">n_clusters=</span><span class="dv">10</span>, <span class="at">p=</span><span class="dv">30</span>),</span>
<span id="cb92-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-47" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;length(selected_clusts) &gt;= 1 is not TRUE&quot;</span>,</span>
<span id="cb92-48"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-48" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb92-49"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb92-50"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-50" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGetSelectedClustersOutput'>checkGetSelectedClustersOutput</a>(<span class="at">selected_clusts=</span>sel_clusts,</span>
<span id="cb92-51"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-51" aria-hidden="true" tabindex="-1"></a>                               <span class="at">selected_feats=</span>sel_feats,</span>
<span id="cb92-52"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-52" aria-hidden="true" tabindex="-1"></a>                               <span class="at">weights=</span>weights,</span>
<span id="cb92-53"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-53" aria-hidden="true" tabindex="-1"></a>                               <span class="at">n_clusters=</span><span class="dv">8</span>, <span class="at">p=</span><span class="dv">30</span>),</span>
<span id="cb92-54"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-54" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;length(selected_clusts) &lt;= n_clusters is not TRUE&quot;</span>,</span>
<span id="cb92-55"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-55" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb92-56"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb92-57"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-57" aria-hidden="true" tabindex="-1"></a>  bad_clusts <span class="ot">&lt;-</span> sel_clusts</span>
<span id="cb92-58"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(bad_clusts) <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">&quot;a&quot;</span>, <span class="fu">length</span>(bad_clusts))</span>
<span id="cb92-59"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb92-60"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-60" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGetSelectedClustersOutput'>checkGetSelectedClustersOutput</a>(<span class="at">selected_clusts=</span>bad_clusts,</span>
<span id="cb92-61"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-61" aria-hidden="true" tabindex="-1"></a>                               <span class="at">selected_feats=</span>sel_feats,</span>
<span id="cb92-62"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-62" aria-hidden="true" tabindex="-1"></a>                               <span class="at">weights=</span>weights,</span>
<span id="cb92-63"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-63" aria-hidden="true" tabindex="-1"></a>                               <span class="at">n_clusters=</span><span class="dv">10</span>, <span class="at">p=</span><span class="dv">30</span>),</span>
<span id="cb92-64"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-64" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;length(names(selected_clusts)) == length(unique(names(selected_clusts))) is not TRUE&quot;</span>,</span>
<span id="cb92-65"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-65" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb92-66"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-66" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb92-67"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-67" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGetSelectedClustersOutput'>checkGetSelectedClustersOutput</a>(<span class="at">selected_clusts=</span><span class="fu">unname</span>(sel_clusts),</span>
<span id="cb92-68"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-68" aria-hidden="true" tabindex="-1"></a>                                                       <span class="at">selected_feats=</span>sel_feats,</span>
<span id="cb92-69"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-69" aria-hidden="true" tabindex="-1"></a>                                                       <span class="at">weights=</span>weights,</span>
<span id="cb92-70"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-70" aria-hidden="true" tabindex="-1"></a>                                                       <span class="at">n_clusters=</span><span class="dv">10</span>, <span class="at">p=</span><span class="dv">30</span>),</span>
<span id="cb92-71"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-71" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;!is.null(names(selected_clusts)) is not TRUE&quot;</span>,</span>
<span id="cb92-72"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-72" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb92-73"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-73" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb92-74"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-74" aria-hidden="true" tabindex="-1"></a>  bad_clusts <span class="ot">&lt;-</span> sel_clusts</span>
<span id="cb92-75"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(bad_clusts)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span>
<span id="cb92-76"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-76" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb92-77"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-77" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGetSelectedClustersOutput'>checkGetSelectedClustersOutput</a>(<span class="at">selected_clusts=</span>bad_clusts,</span>
<span id="cb92-78"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-78" aria-hidden="true" tabindex="-1"></a>                               <span class="at">selected_feats=</span>sel_feats, <span class="at">weights=</span>weights,</span>
<span id="cb92-79"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-79" aria-hidden="true" tabindex="-1"></a>                               <span class="at">n_clusters=</span><span class="dv">10</span>, <span class="at">p=</span><span class="dv">30</span>),</span>
<span id="cb92-80"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-80" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;all(!is.na(names(selected_clusts)) &amp; names(selected_clusts) !=  .... is not TRUE&quot;</span>,</span>
<span id="cb92-81"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-81" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb92-82"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-82" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb92-83"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(bad_clusts)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="cn">NA</span>)</span>
<span id="cb92-84"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-84" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb92-85"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-85" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGetSelectedClustersOutput'>checkGetSelectedClustersOutput</a>(<span class="at">selected_clusts=</span>bad_clusts,</span>
<span id="cb92-86"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-86" aria-hidden="true" tabindex="-1"></a>                               <span class="at">selected_feats=</span>sel_feats, <span class="at">weights=</span>weights,</span>
<span id="cb92-87"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-87" aria-hidden="true" tabindex="-1"></a>                               <span class="at">n_clusters=</span><span class="dv">10</span>, <span class="at">p=</span><span class="dv">30</span>),</span>
<span id="cb92-88"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-88" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;all(!is.na(names(selected_clusts)) &amp; names(selected_clusts) !=  .... is not TRUE&quot;</span>,</span>
<span id="cb92-89"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-89" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb92-90"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-90" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb92-91"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-91" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGetSelectedClustersOutput'>checkGetSelectedClustersOutput</a>(<span class="at">selected_clusts=</span>sel_clusts,</span>
<span id="cb92-92"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-92" aria-hidden="true" tabindex="-1"></a>                                                       <span class="at">selected_feats=</span><span class="fl">0.1</span>,</span>
<span id="cb92-93"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-93" aria-hidden="true" tabindex="-1"></a>                                                       <span class="at">weights=</span>weights,</span>
<span id="cb92-94"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-94" aria-hidden="true" tabindex="-1"></a>                                                       <span class="at">n_clusters=</span><span class="dv">10</span>, <span class="at">p=</span><span class="dv">30</span>),</span>
<span id="cb92-95"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-95" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;is.integer(selected_feats) is not TRUE&quot;</span>,</span>
<span id="cb92-96"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-96" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb92-97"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-97" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb92-98"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-98" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGetSelectedClustersOutput'>checkGetSelectedClustersOutput</a>(<span class="at">selected_clusts=</span>sel_clusts,</span>
<span id="cb92-99"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-99" aria-hidden="true" tabindex="-1"></a>                                                       <span class="at">selected_feats=</span><span class="fu">c</span>(1L,</span>
<span id="cb92-100"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-100" aria-hidden="true" tabindex="-1"></a>                                                                        <span class="fu">rep</span>(2L,</span>
<span id="cb92-101"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-101" aria-hidden="true" tabindex="-1"></a>                                                                            <span class="dv">2</span>)),</span>
<span id="cb92-102"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-102" aria-hidden="true" tabindex="-1"></a>                                                       <span class="at">weights=</span>weights,</span>
<span id="cb92-103"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-103" aria-hidden="true" tabindex="-1"></a>                                                       <span class="at">n_clusters=</span><span class="dv">10</span>, <span class="at">p=</span><span class="dv">30</span>),</span>
<span id="cb92-104"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-104" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;length(selected_feats) == length(unique(selected_feats)) is not TRUE&quot;</span>,</span>
<span id="cb92-105"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-105" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb92-106"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-106" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb92-107"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-107" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGetSelectedClustersOutput'>checkGetSelectedClustersOutput</a>(<span class="at">selected_clusts=</span>sel_clusts,</span>
<span id="cb92-108"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-108" aria-hidden="true" tabindex="-1"></a>                               <span class="at">selected_feats=</span>sel_feats, <span class="at">weights=</span>weights,</span>
<span id="cb92-109"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-109" aria-hidden="true" tabindex="-1"></a>                               <span class="at">n_clusters=</span><span class="dv">10</span>, <span class="at">p=</span><span class="dv">25</span>),</span>
<span id="cb92-110"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-110" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;all(selected_feats %in% 1:p) is not TRUE&quot;</span>,</span>
<span id="cb92-111"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-111" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb92-112"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-112" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb92-113"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-113" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGetSelectedClustersOutput'>checkGetSelectedClustersOutput</a>(<span class="at">selected_clusts=</span>sel_clusts,</span>
<span id="cb92-114"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-114" aria-hidden="true" tabindex="-1"></a>                               <span class="at">selected_feats=</span>sel_feats[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>], <span class="at">weights=</span>weights,</span>
<span id="cb92-115"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-115" aria-hidden="true" tabindex="-1"></a>                               <span class="at">n_clusters=</span><span class="dv">10</span>, <span class="at">p=</span><span class="dv">25</span>),</span>
<span id="cb92-116"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-116" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;length(selected_clusts) &lt;= length(selected_feats) is not TRUE&quot;</span>,</span>
<span id="cb92-117"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-117" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb92-118"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-118" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb92-119"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb92-119" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## Test passed 🥇</code></pre>
<p>Tests for getSelectedClusters</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-1" aria-hidden="true" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">test_that</span>(<span class="st">&quot;getSelectedClusters works&quot;</span>, {</span>
<span id="cb94-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">26717</span>)</span>
<span id="cb94-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb94-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-4" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">10</span><span class="sc">*</span><span class="dv">5</span>), <span class="at">nrow=</span><span class="dv">10</span>, <span class="at">ncol=</span><span class="dv">5</span>)</span>
<span id="cb94-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-5" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">10</span>)</span>
<span id="cb94-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb94-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-7" aria-hidden="true" tabindex="-1"></a>  good_clusters <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;apple&quot;</span><span class="ot">=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="st">&quot;banana&quot;</span><span class="ot">=</span><span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="st">&quot;cantaloupe&quot;</span><span class="ot">=</span><span class="dv">5</span>)</span>
<span id="cb94-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb94-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-9" aria-hidden="true" tabindex="-1"></a>  css_res <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">lambda=</span><span class="fl">0.01</span>, <span class="at">clusters=</span>good_clusters, <span class="at">B =</span> <span class="dv">10</span>)</span>
<span id="cb94-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-11" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getSelectedClusters'>getSelectedClusters</a>(css_res, <span class="at">weighting=</span><span class="st">&quot;sparse&quot;</span>, <span class="at">cutoff=</span><span class="fl">0.05</span>,</span>
<span id="cb94-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-12" aria-hidden="true" tabindex="-1"></a>                             <span class="at">min_num_clusts=</span><span class="dv">1</span>, <span class="at">max_num_clusts=</span><span class="cn">NA</span>)</span>
<span id="cb94-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-14" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res))</span>
<span id="cb94-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-15" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), <span class="dv">3</span>)</span>
<span id="cb94-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-16" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(res), <span class="fu">c</span>(<span class="st">&quot;selected_clusts&quot;</span>, <span class="st">&quot;selected_feats&quot;</span>,</span>
<span id="cb94-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-17" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">&quot;weights&quot;</span>))</span>
<span id="cb94-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-18" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_clusts) <span class="sc">&lt;=</span></span>
<span id="cb94-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-19" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">length</span>(res<span class="sc">$</span>selected_feats))</span>
<span id="cb94-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-21" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res<span class="sc">$</span>selected_clusts))</span>
<span id="cb94-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-22" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_clusts) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb94-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-23" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts)),</span>
<span id="cb94-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-24" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">length</span>(res<span class="sc">$</span>selected_clusts))</span>
<span id="cb94-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-25" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts)),</span>
<span id="cb94-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-26" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts))))</span>
<span id="cb94-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-27" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(res<span class="sc">$</span>selected_clusts <span class="sc">&gt;=</span> <span class="dv">0</span>))</span>
<span id="cb94-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-28" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(res<span class="sc">$</span>selected_clusts <span class="sc">&lt;=</span> <span class="dv">1</span>))</span>
<span id="cb94-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-30" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.integer</span>(res<span class="sc">$</span>selected_feats))</span>
<span id="cb94-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-31" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_feats) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb94-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-32" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_feats)),</span>
<span id="cb94-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-33" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_feats))))</span>
<span id="cb94-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-34" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(res<span class="sc">$</span>selected_feats <span class="sc">&gt;=</span> <span class="dv">1</span>))</span>
<span id="cb94-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-35" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(res<span class="sc">$</span>selected_feats <span class="sc">&lt;=</span> <span class="dv">5</span>))</span>
<span id="cb94-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-36" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_feats),</span>
<span id="cb94-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-37" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">length</span>(<span class="fu">unique</span>(res<span class="sc">$</span>selected_feats)))</span>
<span id="cb94-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-39" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_clusts), <span class="fu">length</span>(res<span class="sc">$</span>weights))</span>
<span id="cb94-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-40" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(res<span class="sc">$</span>weights)){</span>
<span id="cb94-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-41" aria-hidden="true" tabindex="-1"></a>    weights_i <span class="ot">&lt;-</span> res<span class="sc">$</span>weights[[i]]</span>
<span id="cb94-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-42" aria-hidden="true" tabindex="-1"></a>    num_nonzero_weights <span class="ot">&lt;-</span> <span class="fu">sum</span>(weights_i <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb94-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-43" aria-hidden="true" tabindex="-1"></a>    <span class="co"># For &quot;sparse&quot; weighting, tither there should only be one nonzero weight and</span></span>
<span id="cb94-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-44" aria-hidden="true" tabindex="-1"></a>    <span class="co"># it should equal 1 (if there were no ties in selection proportions among</span></span>
<span id="cb94-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># cluster members) or the nonzero weights should all be</span></span>
<span id="cb94-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 1/num_nonzero_weights</span></span>
<span id="cb94-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-47" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(weights_i[weights_i <span class="sc">&gt;</span> <span class="dv">0</span>] <span class="sc">==</span> <span class="dv">1</span><span class="sc">/</span>num_nonzero_weights))</span>
<span id="cb94-48"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-48" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb94-49"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-50"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># weighted_avg</span></span>
<span id="cb94-51"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-51" aria-hidden="true" tabindex="-1"></a>  res_weighted <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getSelectedClusters'>getSelectedClusters</a>(css_res, <span class="at">weighting=</span><span class="st">&quot;weighted_avg&quot;</span>,</span>
<span id="cb94-52"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-52" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">cutoff=</span><span class="fl">0.05</span>, <span class="at">min_num_clusts=</span><span class="dv">1</span>,</span>
<span id="cb94-53"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-53" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">max_num_clusts=</span><span class="cn">NA</span>)</span>
<span id="cb94-54"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-55"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-55" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res_weighted<span class="sc">$</span>selected_clusts),</span>
<span id="cb94-56"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-56" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">length</span>(res_weighted<span class="sc">$</span>weights))</span>
<span id="cb94-57"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-57" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(res_weighted<span class="sc">$</span>weights)){</span>
<span id="cb94-58"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-58" aria-hidden="true" tabindex="-1"></a>    weights_i <span class="ot">&lt;-</span> res_weighted<span class="sc">$</span>weights[[i]]</span>
<span id="cb94-59"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-59" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(weights_i <span class="sc">&gt;=</span> <span class="dv">0</span>))</span>
<span id="cb94-60"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-60" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(weights_i <span class="sc">&lt;=</span> <span class="dv">1</span>))</span>
<span id="cb94-61"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-61" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb94-62"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-63"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-63" aria-hidden="true" tabindex="-1"></a>  <span class="co"># simple_avg</span></span>
<span id="cb94-64"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-64" aria-hidden="true" tabindex="-1"></a>  res_simple <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getSelectedClusters'>getSelectedClusters</a>(css_res, <span class="at">weighting=</span><span class="st">&quot;simple_avg&quot;</span>,</span>
<span id="cb94-65"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-65" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">cutoff=</span><span class="fl">0.05</span>, <span class="at">min_num_clusts=</span><span class="dv">1</span>,</span>
<span id="cb94-66"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-66" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">max_num_clusts=</span><span class="cn">NA</span>)</span>
<span id="cb94-67"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-68"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-68" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res_simple<span class="sc">$</span>selected_clusts),</span>
<span id="cb94-69"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-69" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">length</span>(res_simple<span class="sc">$</span>weights))</span>
<span id="cb94-70"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-70" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(res_simple<span class="sc">$</span>weights)){</span>
<span id="cb94-71"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-71" aria-hidden="true" tabindex="-1"></a>    weights_i <span class="ot">&lt;-</span> res_simple<span class="sc">$</span>weights[[i]]</span>
<span id="cb94-72"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-72" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">unique</span>(weights_i)), <span class="dv">1</span>)</span>
<span id="cb94-73"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-73" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(weights_i), <span class="fu">sum</span>(weights_i <span class="sc">&gt;</span> <span class="dv">0</span>))</span>
<span id="cb94-74"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-74" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb94-75"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-76"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-76" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Test min_num_clusts</span></span>
<span id="cb94-77"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-77" aria-hidden="true" tabindex="-1"></a>  res2 <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getSelectedClusters'>getSelectedClusters</a>(css_res, <span class="at">weighting=</span><span class="st">&quot;weighted_avg&quot;</span>, <span class="at">cutoff=</span><span class="dv">1</span>,</span>
<span id="cb94-78"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-78" aria-hidden="true" tabindex="-1"></a>                             <span class="at">min_num_clusts=</span><span class="dv">3</span>, <span class="at">max_num_clusts=</span><span class="cn">NA</span>)</span>
<span id="cb94-79"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-79" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res2))</span>
<span id="cb94-80"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-80" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res2<span class="sc">$</span>selected_clusts), <span class="dv">3</span>)</span>
<span id="cb94-81"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-82"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-82" aria-hidden="true" tabindex="-1"></a>  res3 <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getSelectedClusters'>getSelectedClusters</a>(css_res, <span class="at">weighting=</span><span class="st">&quot;sparse&quot;</span>, <span class="at">cutoff=</span><span class="dv">1</span>,</span>
<span id="cb94-83"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-83" aria-hidden="true" tabindex="-1"></a>                             <span class="at">min_num_clusts=</span><span class="dv">2</span>, <span class="at">max_num_clusts=</span><span class="cn">NA</span>)</span>
<span id="cb94-84"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-84" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res3<span class="sc">$</span>selected_clusts) <span class="sc">&gt;=</span> <span class="dv">2</span>)</span>
<span id="cb94-85"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-86"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-86" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Test max_num_clusts</span></span>
<span id="cb94-87"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-87" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ensure there is at least one relevant feature</span></span>
<span id="cb94-88"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-88" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> x</span>
<span id="cb94-89"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-89" aria-hidden="true" tabindex="-1"></a>  x2[, <span class="dv">5</span>] <span class="ot">&lt;-</span> y</span>
<span id="cb94-90"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-90" aria-hidden="true" tabindex="-1"></a>  css_res2 <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x2, <span class="at">y=</span>y, <span class="at">lambda=</span><span class="fl">0.01</span>, <span class="at">clusters=</span>good_clusters, <span class="at">B =</span> <span class="dv">10</span>)</span>
<span id="cb94-91"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-91" aria-hidden="true" tabindex="-1"></a>  res4 <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getSelectedClusters'>getSelectedClusters</a>(css_res2, <span class="at">weighting=</span><span class="st">&quot;simple_avg&quot;</span>, <span class="at">cutoff=</span><span class="dv">0</span>,</span>
<span id="cb94-92"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-92" aria-hidden="true" tabindex="-1"></a>                             <span class="at">min_num_clusts=</span><span class="dv">1</span>, <span class="at">max_num_clusts=</span><span class="dv">1</span>)</span>
<span id="cb94-93"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-93" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res4))</span>
<span id="cb94-94"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-94" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res4<span class="sc">$</span>selected_clusts), <span class="dv">1</span>)</span>
<span id="cb94-95"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-96"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-96" aria-hidden="true" tabindex="-1"></a>  res5 <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getSelectedClusters'>getSelectedClusters</a>(css_res, <span class="at">weighting=</span><span class="st">&quot;weighted_avg&quot;</span>, <span class="at">cutoff=</span><span class="dv">0</span>,</span>
<span id="cb94-97"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-97" aria-hidden="true" tabindex="-1"></a>                             <span class="at">min_num_clusts=</span><span class="dv">1</span>, <span class="at">max_num_clusts=</span><span class="dv">2</span>)</span>
<span id="cb94-98"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-98" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res5<span class="sc">$</span>selected_clusts) <span class="sc">&lt;=</span> <span class="dv">2</span>)</span>
<span id="cb94-99"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-99" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb94-100"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-100" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Name features</span></span>
<span id="cb94-101"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(x) <span class="ot">&lt;-</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(x)]</span>
<span id="cb94-102"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-102" aria-hidden="true" tabindex="-1"></a>  css_res3 <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">lambda=</span><span class="fl">0.01</span>, <span class="at">clusters=</span>good_clusters, <span class="at">B =</span> <span class="dv">10</span>)</span>
<span id="cb94-103"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-103" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getSelectedClusters'>getSelectedClusters</a>(css_res3, <span class="at">weighting=</span><span class="st">&quot;sparse&quot;</span>, <span class="at">cutoff=</span><span class="fl">0.05</span>,</span>
<span id="cb94-104"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-104" aria-hidden="true" tabindex="-1"></a>                             <span class="at">min_num_clusts=</span><span class="dv">1</span>, <span class="at">max_num_clusts=</span><span class="cn">NA</span>)</span>
<span id="cb94-105"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-106"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-106" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res))</span>
<span id="cb94-107"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-107" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), <span class="dv">3</span>)</span>
<span id="cb94-108"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-108" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(res), <span class="fu">c</span>(<span class="st">&quot;selected_clusts&quot;</span>, <span class="st">&quot;selected_feats&quot;</span>,</span>
<span id="cb94-109"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-109" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">&quot;weights&quot;</span>))</span>
<span id="cb94-110"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-110" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_clusts) <span class="sc">&lt;=</span></span>
<span id="cb94-111"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-111" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">length</span>(res<span class="sc">$</span>selected_feats))</span>
<span id="cb94-112"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-113"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-113" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res<span class="sc">$</span>selected_clusts))</span>
<span id="cb94-114"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-114" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_clusts) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb94-115"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-115" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts)),</span>
<span id="cb94-116"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-116" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">length</span>(res<span class="sc">$</span>selected_clusts))</span>
<span id="cb94-117"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-117" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts)),</span>
<span id="cb94-118"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-118" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts))))</span>
<span id="cb94-119"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-119" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(res<span class="sc">$</span>selected_clusts <span class="sc">&gt;=</span> <span class="dv">0</span>))</span>
<span id="cb94-120"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-120" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(res<span class="sc">$</span>selected_clusts <span class="sc">&lt;=</span> <span class="dv">1</span>))</span>
<span id="cb94-121"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-122"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-122" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.integer</span>(res<span class="sc">$</span>selected_feats))</span>
<span id="cb94-123"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-123" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_feats) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb94-124"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-124" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_feats)),</span>
<span id="cb94-125"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-125" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_feats))))</span>
<span id="cb94-126"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-126" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(res<span class="sc">$</span>selected_feats <span class="sc">&gt;=</span> <span class="dv">1</span>))</span>
<span id="cb94-127"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-127" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(res<span class="sc">$</span>selected_feats <span class="sc">&lt;=</span> <span class="dv">5</span>))</span>
<span id="cb94-128"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-128" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_feats),</span>
<span id="cb94-129"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-129" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">length</span>(<span class="fu">unique</span>(res<span class="sc">$</span>selected_feats)))</span>
<span id="cb94-130"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-130" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_feats)),</span>
<span id="cb94-131"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-131" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">length</span>(res<span class="sc">$</span>selected_feats))</span>
<span id="cb94-132"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-132" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_feats)),</span>
<span id="cb94-133"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-133" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_feats))))</span>
<span id="cb94-134"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb94-134" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## Test passed 🎊</code></pre>
<p>Finally, tests for getCssSelections</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-1" aria-hidden="true" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">test_that</span>(<span class="st">&quot;getCssSelections works&quot;</span>, {</span>
<span id="cb96-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">26717</span>)</span>
<span id="cb96-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb96-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-5" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">10</span><span class="sc">*</span><span class="dv">7</span>), <span class="at">nrow=</span><span class="dv">10</span>, <span class="at">ncol=</span><span class="dv">7</span>)</span>
<span id="cb96-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-6" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">10</span>)</span>
<span id="cb96-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb96-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-8" aria-hidden="true" tabindex="-1"></a>  good_clusters <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;apple&quot;</span><span class="ot">=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="st">&quot;banana&quot;</span><span class="ot">=</span><span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="st">&quot;cantaloupe&quot;</span><span class="ot">=</span><span class="dv">5</span>)</span>
<span id="cb96-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb96-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-10" aria-hidden="true" tabindex="-1"></a>  css_res <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">lambda=</span><span class="fl">0.01</span>, <span class="at">clusters=</span>good_clusters, <span class="at">B =</span> <span class="dv">10</span>)</span>
<span id="cb96-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-12" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssSelections'>getCssSelections</a>(css_res)</span>
<span id="cb96-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-14" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res))</span>
<span id="cb96-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-15" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), <span class="dv">2</span>)</span>
<span id="cb96-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-16" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(res), <span class="fu">c</span>(<span class="st">&quot;selected_clusts&quot;</span>, <span class="st">&quot;selected_feats&quot;</span>))</span>
<span id="cb96-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-17" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_clusts) <span class="sc">&lt;=</span></span>
<span id="cb96-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-18" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">length</span>(res<span class="sc">$</span>selected_feats))</span>
<span id="cb96-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-20" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res<span class="sc">$</span>selected_clusts))</span>
<span id="cb96-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-21" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts)),</span>
<span id="cb96-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-22" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">length</span>(res<span class="sc">$</span>selected_clusts))</span>
<span id="cb96-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-23" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts)),</span>
<span id="cb96-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-24" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts))))</span>
<span id="cb96-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-25" aria-hidden="true" tabindex="-1"></a>  already_used_feats <span class="ot">&lt;-</span> <span class="fu">integer</span>()</span>
<span id="cb96-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(res<span class="sc">$</span>selected_clusts)){</span>
<span id="cb96-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-27" aria-hidden="true" tabindex="-1"></a>    sels_i <span class="ot">&lt;-</span> res<span class="sc">$</span>selected_clusts[[i]]</span>
<span id="cb96-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-28" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(sels_i) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb96-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-29" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.integer</span>(sels_i))</span>
<span id="cb96-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-30" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(sels_i <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>))</span>
<span id="cb96-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-31" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(sels_i), <span class="fu">length</span>(<span class="fu">unique</span>(sels_i)))</span>
<span id="cb96-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-32" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">intersect</span>(already_used_feats, sels_i)), <span class="dv">0</span>)</span>
<span id="cb96-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-33" aria-hidden="true" tabindex="-1"></a>    already_used_feats <span class="ot">&lt;-</span> <span class="fu">c</span>(already_used_feats, sels_i)</span>
<span id="cb96-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-34" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb96-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-35" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(already_used_feats) <span class="sc">&lt;=</span> <span class="dv">11</span>)</span>
<span id="cb96-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-36" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(already_used_feats),</span>
<span id="cb96-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-37" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">length</span>(<span class="fu">unique</span>(already_used_feats)))</span>
<span id="cb96-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-38" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(already_used_feats <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>))</span>
<span id="cb96-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-40" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.integer</span>(res<span class="sc">$</span>selected_feats))</span>
<span id="cb96-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-41" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_feats) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb96-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-42" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_feats)),</span>
<span id="cb96-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-43" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_feats))))</span>
<span id="cb96-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-44" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(res<span class="sc">$</span>selected_feats <span class="sc">&gt;=</span> <span class="dv">1</span>))</span>
<span id="cb96-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-45" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(res<span class="sc">$</span>selected_feats <span class="sc">&lt;=</span> <span class="dv">7</span>))</span>
<span id="cb96-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-46" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_feats),</span>
<span id="cb96-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-47" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">length</span>(<span class="fu">unique</span>(res<span class="sc">$</span>selected_feats)))</span>
<span id="cb96-48"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-49"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Test min_num_clusts (should be 5 clusters--3 named ones, plus last two get</span></span>
<span id="cb96-50"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># put in their own unnamed clusters automatically by css)</span></span>
<span id="cb96-51"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-51" aria-hidden="true" tabindex="-1"></a>  res2 <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssSelections'>getCssSelections</a>(css_res, <span class="at">weighting=</span><span class="st">&quot;weighted_avg&quot;</span>, <span class="at">cutoff=</span><span class="dv">1</span>,</span>
<span id="cb96-52"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-52" aria-hidden="true" tabindex="-1"></a>                             <span class="at">min_num_clusts=</span><span class="dv">5</span>, <span class="at">max_num_clusts=</span><span class="cn">NA</span>)</span>
<span id="cb96-53"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-53" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res2))</span>
<span id="cb96-54"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-54" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res2<span class="sc">$</span>selected_clusts), <span class="dv">5</span>)</span>
<span id="cb96-55"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-56"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-56" aria-hidden="true" tabindex="-1"></a>  res3 <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssSelections'>getCssSelections</a>(css_res, <span class="at">weighting=</span><span class="st">&quot;sparse&quot;</span>, <span class="at">cutoff=</span><span class="dv">1</span>,</span>
<span id="cb96-57"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-57" aria-hidden="true" tabindex="-1"></a>                             <span class="at">min_num_clusts=</span><span class="dv">3</span>, <span class="at">max_num_clusts=</span><span class="cn">NA</span>)</span>
<span id="cb96-58"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-58" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res3<span class="sc">$</span>selected_clusts) <span class="sc">&gt;=</span> <span class="dv">3</span>)</span>
<span id="cb96-59"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-60"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-60" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Test max_num_clusts</span></span>
<span id="cb96-61"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ensure there is at least one relevant feature</span></span>
<span id="cb96-62"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-62" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> x</span>
<span id="cb96-63"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-63" aria-hidden="true" tabindex="-1"></a>  x2[, <span class="dv">5</span>] <span class="ot">&lt;-</span> y</span>
<span id="cb96-64"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-64" aria-hidden="true" tabindex="-1"></a>  css_res2 <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x2, <span class="at">y=</span>y, <span class="at">lambda=</span><span class="fl">0.01</span>, <span class="at">clusters=</span>good_clusters, <span class="at">B =</span> <span class="dv">10</span>)</span>
<span id="cb96-65"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-65" aria-hidden="true" tabindex="-1"></a>  res4 <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssSelections'>getCssSelections</a>(css_res2, <span class="at">weighting=</span><span class="st">&quot;simple_avg&quot;</span>, <span class="at">cutoff=</span><span class="dv">0</span>,</span>
<span id="cb96-66"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-66" aria-hidden="true" tabindex="-1"></a>                             <span class="at">min_num_clusts=</span><span class="dv">1</span>, <span class="at">max_num_clusts=</span><span class="dv">1</span>)</span>
<span id="cb96-67"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-67" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res4))</span>
<span id="cb96-68"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-68" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res4<span class="sc">$</span>selected_clusts), <span class="dv">1</span>)</span>
<span id="cb96-69"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-70"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-70" aria-hidden="true" tabindex="-1"></a>  res5 <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssSelections'>getCssSelections</a>(css_res, <span class="at">weighting=</span><span class="st">&quot;weighted_avg&quot;</span>, <span class="at">cutoff=</span><span class="dv">0</span>,</span>
<span id="cb96-71"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-71" aria-hidden="true" tabindex="-1"></a>                             <span class="at">min_num_clusts=</span><span class="dv">1</span>, <span class="at">max_num_clusts=</span><span class="dv">2</span>)</span>
<span id="cb96-72"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-72" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res5<span class="sc">$</span>selected_clusts) <span class="sc">&lt;=</span> <span class="dv">2</span>)</span>
<span id="cb96-73"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-74"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-74" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Name features</span></span>
<span id="cb96-75"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(x) <span class="ot">&lt;-</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(x)]</span>
<span id="cb96-76"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-76" aria-hidden="true" tabindex="-1"></a>  css_res3 <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">lambda=</span><span class="fl">0.01</span>, <span class="at">clusters=</span>good_clusters, <span class="at">B =</span> <span class="dv">10</span>)</span>
<span id="cb96-77"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-77" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssSelections'>getCssSelections</a>(css_res3, <span class="at">weighting=</span><span class="st">&quot;sparse&quot;</span>, <span class="at">cutoff=</span><span class="fl">0.05</span>,</span>
<span id="cb96-78"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-78" aria-hidden="true" tabindex="-1"></a>                             <span class="at">min_num_clusts=</span><span class="dv">1</span>, <span class="at">max_num_clusts=</span><span class="cn">NA</span>)</span>
<span id="cb96-79"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-80"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-80" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res))</span>
<span id="cb96-81"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-81" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), <span class="dv">2</span>)</span>
<span id="cb96-82"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-82" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(res), <span class="fu">c</span>(<span class="st">&quot;selected_clusts&quot;</span>, <span class="st">&quot;selected_feats&quot;</span>))</span>
<span id="cb96-83"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-83" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_clusts) <span class="sc">&lt;=</span></span>
<span id="cb96-84"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-84" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">length</span>(res<span class="sc">$</span>selected_feats))</span>
<span id="cb96-85"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-86"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-86" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_feats)),</span>
<span id="cb96-87"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-87" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">length</span>(res<span class="sc">$</span>selected_feats))</span>
<span id="cb96-88"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-88" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_feats)),</span>
<span id="cb96-89"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-89" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_feats))))</span>
<span id="cb96-90"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-91"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-91" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Bad inputs</span></span>
<span id="cb96-92"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-92" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Error has quotation marks in it</span></span>
<span id="cb96-93"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-93" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssSelections'>getCssSelections</a>(<span class="st">&quot;css_results&quot;</span>))</span>
<span id="cb96-94"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-94" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssSelections'>getCssSelections</a>(css_res, <span class="at">weighting=</span><span class="st">&quot;spasre&quot;</span>),</span>
<span id="cb96-95"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-95" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;Weighting must be a character and one of sparse, simple_avg, or weighted_avg&quot;</span>,</span>
<span id="cb96-96"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-96" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb96-97"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-97" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssSelections'>getCssSelections</a>(css_res, <span class="at">cutoff=</span><span class="sc">-</span>.<span class="dv">5</span>),</span>
<span id="cb96-98"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-98" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;cutoff &gt;= 0 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb96-99"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-99" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssSelections'>getCssSelections</a>(css_res, <span class="at">min_num_clusts=</span><span class="dv">0</span>),</span>
<span id="cb96-100"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-100" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;min_num_clusts &gt;= 1 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb96-101"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-101" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssSelections'>getCssSelections</a>(css_res, <span class="at">min_num_clusts=</span><span class="dv">0</span>),</span>
<span id="cb96-102"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-102" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;min_num_clusts &gt;= 1 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb96-103"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-103" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssSelections'>getCssSelections</a>(css_res, <span class="at">max_num_clusts=</span><span class="dv">50</span>),</span>
<span id="cb96-104"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-104" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;max_num_clusts &lt;= p is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb96-105"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-105" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssSelections'>getCssSelections</a>(css_res, <span class="at">max_num_clusts=</span><span class="fl">4.5</span>),</span>
<span id="cb96-106"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-106" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;max_num_clusts == round(max_num_clusts) is not TRUE&quot;</span>,</span>
<span id="cb96-107"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-107" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb96-108"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb96-108" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## Test passed 🥳</code></pre>
<p>getCssDesign</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Obtain a design matrix of cluster representatives</span></span>
<span id="cb98-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb98-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Takes a matrix of observations from the original feature space and returns</span></span>
<span id="cb98-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; a matrix of representatives from the selected clusters based on the results</span></span>
<span id="cb98-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; of cluster stability selection.</span></span>
<span id="cb98-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param css_results An object of class &quot;cssr&quot; (the output of the function</span></span>
<span id="cb98-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; css).</span></span>
<span id="cb98-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param newX A numeric matrix (preferably) or a data.frame (which will</span></span>
<span id="cb98-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; be coerced internally to a matrix by the function model.matrix) containing</span></span>
<span id="cb98-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the data that will be used to generate the design matrix of cluster</span></span>
<span id="cb98-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; representatives. Must contain the same features (in the same</span></span>
<span id="cb98-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; number of columns) as the X matrix provided to css, and if the columns of</span></span>
<span id="cb98-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; newX are labeled, the names must match the variable names provided to css.</span></span>
<span id="cb98-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; newX may be omitted if train_inds were provided to css to set aside</span></span>
<span id="cb98-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; observations for model estimation. If this is the case, then when newX is</span></span>
<span id="cb98-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; omitted getCssDesign will return a design matrix of cluster representatives</span></span>
<span id="cb98-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; formed from the train_inds observations from the matrix X provided to css.</span></span>
<span id="cb98-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; (If no train_inds were provided to css, newX must be provided to</span></span>
<span id="cb98-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; getCssDesign.) Default is NA.</span></span>
<span id="cb98-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param weighting Character; determines how to calculate the weights to</span></span>
<span id="cb98-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; combine features from the selected clusters into weighted averages, called</span></span>
<span id="cb98-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; cluster representatives. Must be one of &quot;sparse&quot;, &quot;weighted_avg&quot;, or</span></span>
<span id="cb98-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; &quot;simple_avg&#39;. For &quot;sparse&quot;, all the weight is put on the most frequently</span></span>
<span id="cb98-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; selected individual cluster member (or divided equally among all the clusters</span></span>
<span id="cb98-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; that are tied for the top selection proportion if there is a tie). For</span></span>
<span id="cb98-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; &quot;weighted_avg&quot;, the weight used for each cluster member is calculated in</span></span>
<span id="cb98-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; proportion to the individual selection proportions of each feature. For</span></span>
<span id="cb98-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; &quot;simple_avg&quot;, each cluster member gets equal weight regardless of the</span></span>
<span id="cb98-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; individual feature selection proportions (that is, the cluster representative</span></span>
<span id="cb98-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; is just a simple average of all the cluster members). See Faletto and Bien</span></span>
<span id="cb98-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; (2022) for details. Default is &quot;weighted_avg&quot;.</span></span>
<span id="cb98-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param cutoff Numeric; getCssDesign will only include those clusters with</span></span>
<span id="cb98-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; selection proportions equal to at least cutoff. Must be between 0 and 1.</span></span>
<span id="cb98-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Default is 0 (in which case either all clusters are used, or max_num_clusts</span></span>
<span id="cb98-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; are used, if max_num_clusts is specified).</span></span>
<span id="cb98-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param min_num_clusts Integer or numeric; the minimum number of clusters to</span></span>
<span id="cb98-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; use regardless of cutoff. (That is, if the chosen cutoff returns fewer than</span></span>
<span id="cb98-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; min_num_clusts clusters, the cutoff will be increased until at least</span></span>
<span id="cb98-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; min_num_clusts clusters are selected.) Default is 1.</span></span>
<span id="cb98-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param max_num_clusts Integer or numeric; the maximum number of clusters to</span></span>
<span id="cb98-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; use regardless of cutoff. (That is, if the chosen cutoff returns more than</span></span>
<span id="cb98-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; max_num_clusts clusters, the cutoff will be decreased until at most</span></span>
<span id="cb98-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; max_num_clusts clusters are selected.) Default is NA (in which case</span></span>
<span id="cb98-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; max_num_clusts is ignored).</span></span>
<span id="cb98-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return A design matrix with either nrow(newX) (or length(train_inds), if</span></span>
<span id="cb98-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; train_inds was provided to css and newX was not provided to getCssDesign)</span></span>
<span id="cb98-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; observations and number of columns equal to the number of selected clusters,</span></span>
<span id="cb98-48"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; containing the cluster representatives for each cluster.</span></span>
<span id="cb98-49"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @author Gregory Faletto, Jacob Bien</span></span>
<span id="cb98-50"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @export</span></span>
<span id="cb98-51"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-51" aria-hidden="true" tabindex="-1"></a><span id='getCssDesign'>getCssDesign</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(css_results, <span class="at">newX=</span><span class="cn">NA</span>, <span class="at">weighting=</span><span class="st">&quot;weighted_avg&quot;</span>,</span>
<span id="cb98-52"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">cutoff=</span><span class="dv">0</span>, <span class="at">min_num_clusts=</span><span class="dv">1</span>, <span class="at">max_num_clusts=</span><span class="cn">NA</span>){</span>
<span id="cb98-53"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-53" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check inputs</span></span>
<span id="cb98-54"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">class</span>(css_results) <span class="sc">==</span> <span class="st">&quot;cssr&quot;</span>)</span>
<span id="cb98-55"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-56"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-56" aria-hidden="true" tabindex="-1"></a>    check_results <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkNewXProvided'>checkNewXProvided</a>(newX, css_results)</span>
<span id="cb98-57"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-58"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-58" aria-hidden="true" tabindex="-1"></a>    newX <span class="ot">&lt;-</span> check_results<span class="sc">$</span>newX</span>
<span id="cb98-59"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-59" aria-hidden="true" tabindex="-1"></a>    newXProvided <span class="ot">&lt;-</span> check_results<span class="sc">$</span>newXProvided</span>
<span id="cb98-60"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-61"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rm</span>(check_results)</span>
<span id="cb98-62"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-63"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-63" aria-hidden="true" tabindex="-1"></a>    n_train <span class="ot">&lt;-</span> <span class="fu">nrow</span>(newX)</span>
<span id="cb98-64"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-65"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-65" aria-hidden="true" tabindex="-1"></a>    results <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkXInputResults'>checkXInputResults</a>(newX, css_results<span class="sc">$</span>X)</span>
<span id="cb98-66"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-67"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-67" aria-hidden="true" tabindex="-1"></a>    newX <span class="ot">&lt;-</span> results<span class="sc">$</span>newx</span>
<span id="cb98-68"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-68" aria-hidden="true" tabindex="-1"></a>    feat_names <span class="ot">&lt;-</span> results<span class="sc">$</span>feat_names</span>
<span id="cb98-69"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-70"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rm</span>(results)</span>
<span id="cb98-71"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-72"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-72" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(newX)</span>
<span id="cb98-73"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-73" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ncol</span>(newX)</span>
<span id="cb98-74"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-75"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-75" aria-hidden="true" tabindex="-1"></a>    <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkCutoff'>checkCutoff</a>(cutoff)</span>
<span id="cb98-76"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-76" aria-hidden="true" tabindex="-1"></a>    <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkWeighting'>checkWeighting</a>(weighting)</span>
<span id="cb98-77"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-77" aria-hidden="true" tabindex="-1"></a>    <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkMinNumClusts'>checkMinNumClusts</a>(min_num_clusts, p, <span class="fu">length</span>(css_results<span class="sc">$</span>clusters))</span>
<span id="cb98-78"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-79"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-79" aria-hidden="true" tabindex="-1"></a>    max_num_clusts <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkMaxNumClusts'>checkMaxNumClusts</a>(max_num_clusts, min_num_clusts, p,</span>
<span id="cb98-80"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-80" aria-hidden="true" tabindex="-1"></a>        <span class="fu">length</span>(css_results<span class="sc">$</span>clusters))</span>
<span id="cb98-81"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-82"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-82" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Take provided training design matrix and testX and turn them into</span></span>
<span id="cb98-83"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-83" aria-hidden="true" tabindex="-1"></a>    <span class="co"># matrices of cluster representatives using information from css_results</span></span>
<span id="cb98-84"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-84" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(newXProvided){</span>
<span id="cb98-85"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-85" aria-hidden="true" tabindex="-1"></a>        newX_clusters <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#formCssDesign'>formCssDesign</a>(css_results, weighting, cutoff,</span>
<span id="cb98-86"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-86" aria-hidden="true" tabindex="-1"></a>            min_num_clusts, max_num_clusts, <span class="at">newx=</span>newX)</span>
<span id="cb98-87"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-87" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span>{</span>
<span id="cb98-88"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-88" aria-hidden="true" tabindex="-1"></a>        newX_clusters <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#formCssDesign'>formCssDesign</a>(css_results, weighting, cutoff,</span>
<span id="cb98-89"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-89" aria-hidden="true" tabindex="-1"></a>            min_num_clusts, max_num_clusts)</span>
<span id="cb98-90"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-90" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb98-91"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-92"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-92" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(newX_clusters)</span>
<span id="cb98-93"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb98-93" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>checkNewXProvided</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Helper function to confirm that the new X matrix provided to getCssDesign or</span></span>
<span id="cb99-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; getCssPreds matches the characteristics of the X that was provided to css.</span></span>
<span id="cb99-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb99-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param trainX A numeric matrix (preferably) or a data.frame (which will</span></span>
<span id="cb99-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; be coerced internally to a matrix by the function model.matrix). Must contain</span></span>
<span id="cb99-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb99-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the same features (in the same number of columns) as the X matrix provided to</span></span>
<span id="cb99-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb99-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; css, and if the columns of trainX are labeled, the names must match the</span></span>
<span id="cb99-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb99-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; variable names provided to css. trainX may be omitted if train_inds were</span></span>
<span id="cb99-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb99-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; provided to css to set aside observations.</span></span>
<span id="cb99-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb99-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param css_results An object of class &quot;cssr&quot; (the output of the function</span></span>
<span id="cb99-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb99-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; css).</span></span>
<span id="cb99-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb99-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return A named list with the following elements: \item{newX}{If trainX was</span></span>
<span id="cb99-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb99-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; provided, this is the provided trainX matrix, coerced from a data.frame to a</span></span>
<span id="cb99-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb99-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; matrix if the provided trainX was a data.frame. If trainX was not provided,</span></span>
<span id="cb99-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb99-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; this is a matrix made up of the training indices provided to css in the</span></span>
<span id="cb99-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb99-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; train_inds argument.} \item{newXProvided}{Logical; indicates whether a valid</span></span>
<span id="cb99-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb99-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; trainX input was provided.}</span></span>
<span id="cb99-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb99-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @author Gregory Faletto, Jacob Bien</span></span>
<span id="cb99-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb99-19" aria-hidden="true" tabindex="-1"></a><span id='checkNewXProvided'>checkNewXProvided</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(trainX, css_results){</span>
<span id="cb99-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb99-20" aria-hidden="true" tabindex="-1"></a>    newXProvided <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb99-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb99-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb99-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(trainX)) <span class="sc">&amp;</span> <span class="fu">length</span>(trainX) <span class="sc">&gt;</span> <span class="dv">1</span>){</span>
<span id="cb99-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb99-23" aria-hidden="true" tabindex="-1"></a>        newXProvided <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb99-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb99-24" aria-hidden="true" tabindex="-1"></a>        trainX <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkXInputResults'>checkXInputResults</a>(trainX, css_results<span class="sc">$</span>X)<span class="sc">$</span>newx</span>
<span id="cb99-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb99-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb99-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb99-26" aria-hidden="true" tabindex="-1"></a>        n_train <span class="ot">&lt;-</span> <span class="fu">nrow</span>(trainX)</span>
<span id="cb99-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb99-27" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(n_train <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb99-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb99-28" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span>{</span>
<span id="cb99-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb99-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="fu">length</span>(css_results<span class="sc">$</span>train_inds) <span class="sc">==</span> <span class="dv">0</span>){</span>
<span id="cb99-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb99-30" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stop</span>(<span class="st">&quot;css was not provided with indices to set aside for model training (train_inds), so must provide new X in order to generate a design matrix&quot;</span>)</span>
<span id="cb99-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb99-31" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb99-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb99-32" aria-hidden="true" tabindex="-1"></a>        trainX <span class="ot">&lt;-</span> css_results<span class="sc">$</span>X[css_results<span class="sc">$</span>train_inds, ]</span>
<span id="cb99-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb99-33" aria-hidden="true" tabindex="-1"></a>    } </span>
<span id="cb99-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb99-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.matrix</span>(trainX))</span>
<span id="cb99-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb99-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.numeric</span>(trainX) <span class="sc">|</span> <span class="fu">is.integer</span>(trainX))</span>
<span id="cb99-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb99-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(trainX)))</span>
<span id="cb99-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb99-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">ncol</span>(trainX) <span class="sc">&gt;=</span> <span class="dv">2</span>)</span>
<span id="cb99-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb99-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb99-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">newX=</span>trainX, <span class="at">newXProvided=</span>newXProvided))</span>
<span id="cb99-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb99-40" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>checkXInputResults</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Helper function to confirm that inputs to several functions are as expected,</span></span>
<span id="cb100-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; and modify inputs if needed</span></span>
<span id="cb100-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb100-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param newx A numeric matrix (preferably) or a data.frame (which will</span></span>
<span id="cb100-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; be coerced internally to a matrix by the function model.matrix) containing</span></span>
<span id="cb100-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the data that will be used to generate the design matrix of cluster</span></span>
<span id="cb100-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; representatives. Must contain the same features (in the same</span></span>
<span id="cb100-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; number of columns) as the X matrix provided to css, and if the columns of</span></span>
<span id="cb100-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; newX are labeled, the names must match the variable names provided to css.</span></span>
<span id="cb100-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param css_X The X matrix provided to css, as in the output of the css</span></span>
<span id="cb100-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; function (after having been coerced from a data.frame to a matrix by css if</span></span>
<span id="cb100-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; needed).</span></span>
<span id="cb100-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return A named list with the following elements. \item{feat_names}{A </span></span>
<span id="cb100-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; character vector containing the column names of newx (if the provided newx</span></span>
<span id="cb100-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; had column names). If the provided newx did not have column names, feat_names</span></span>
<span id="cb100-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; will be NA.} \item{newx}{The provided newx matrix, coerced from a data.frame</span></span>
<span id="cb100-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; to a matrix if the provided newx was a data.frame.}</span></span>
<span id="cb100-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @author Gregory Faletto, Jacob Bien</span></span>
<span id="cb100-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-19" aria-hidden="true" tabindex="-1"></a><span id='checkXInputResults'>checkXInputResults</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(newx, css_X){</span>
<span id="cb100-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if x is a matrix; if it&#39;s a data.frame, convert to matrix.</span></span>
<span id="cb100-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">is.data.frame</span>(newx)){</span>
<span id="cb100-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-23" aria-hidden="true" tabindex="-1"></a>        newx <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">model.matrix</span>(<span class="sc">~</span> ., newx)</span>
<span id="cb100-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-24" aria-hidden="true" tabindex="-1"></a>        newx <span class="ot">&lt;-</span> newx[, <span class="fu">colnames</span>(newx) <span class="sc">!=</span> <span class="st">&quot;(Intercept)&quot;</span>]</span>
<span id="cb100-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-25" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb100-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-27" aria-hidden="true" tabindex="-1"></a>    feat_names <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="cn">NA</span>)</span>
<span id="cb100-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(<span class="fu">colnames</span>(newx))){</span>
<span id="cb100-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-29" aria-hidden="true" tabindex="-1"></a>        feat_names <span class="ot">&lt;-</span> <span class="fu">colnames</span>(newx)</span>
<span id="cb100-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-30" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">identical</span>(feat_names, <span class="fu">colnames</span>(css_X)))</span>
<span id="cb100-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-31" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span>{</span>
<span id="cb100-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-32" aria-hidden="true" tabindex="-1"></a>        <span class="co"># In this case, newx has no column names, so same better be true of</span></span>
<span id="cb100-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-33" aria-hidden="true" tabindex="-1"></a>        <span class="co"># css_X</span></span>
<span id="cb100-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(<span class="fu">colnames</span>(css_X))){</span>
<span id="cb100-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-35" aria-hidden="true" tabindex="-1"></a>            <span class="fu">warning</span>(<span class="st">&quot;New X provided had no variable names (column names) even though the X provided to css did.&quot;</span>)</span>
<span id="cb100-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-36" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb100-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-37" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb100-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.matrix</span>(newx))</span>
<span id="cb100-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(newx)))</span>
<span id="cb100-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-42" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(newx)</span>
<span id="cb100-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-43" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ncol</span>(newx)</span>
<span id="cb100-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(p <span class="sc">&gt;=</span> <span class="dv">2</span>)</span>
<span id="cb100-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">length</span>(feat_names) <span class="sc">&gt;</span> <span class="dv">1</span>){</span>
<span id="cb100-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-46" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">length</span>(feat_names) <span class="sc">==</span> p)</span>
<span id="cb100-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-47" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="sc">!</span>(<span class="st">&quot;(Intercept)&quot;</span> <span class="sc">%in%</span> feat_names))</span>
<span id="cb100-48"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-48" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span>{</span>
<span id="cb100-49"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-49" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">is.na</span>(feat_names))</span>
<span id="cb100-50"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-50" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb100-51"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-52"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(newx) <span class="ot">&lt;-</span> <span class="fu">character</span>()</span>
<span id="cb100-53"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-54"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-54" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Confirm that newx matches css_results$X</span></span>
<span id="cb100-55"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(p <span class="sc">!=</span> <span class="fu">ncol</span>(css_X)){</span>
<span id="cb100-56"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-56" aria-hidden="true" tabindex="-1"></a>        err <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;Number of columns in newx must match number of columns from matrix provided to css. Number of columns in new provided X: &quot;</span>,</span>
<span id="cb100-57"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-57" aria-hidden="true" tabindex="-1"></a>            p, <span class="st">&quot;. Number of columns in matrix provided to css: &quot;</span>, <span class="fu">ncol</span>(css_X),</span>
<span id="cb100-58"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-58" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;.&quot;</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb100-59"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-59" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stop</span>(err)</span>
<span id="cb100-60"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-60" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb100-61"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-61" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">length</span>(feat_names) <span class="sc">!=</span> <span class="dv">1</span> <span class="sc">&amp;</span> <span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(feat_names))){</span>
<span id="cb100-62"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-62" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="sc">!</span><span class="fu">identical</span>(feat_names, <span class="fu">colnames</span>(css_X))){</span>
<span id="cb100-63"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-63" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stop</span>(<span class="st">&quot;Provided feature names for newx do not match feature names provided to css&quot;</span>)</span>
<span id="cb100-64"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-64" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb100-65"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-65" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb100-66"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-67"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-67" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">feat_names=</span>feat_names, <span class="at">newx=</span>newx))</span>
<span id="cb100-68"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb100-68" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Tests for checkXInputResults</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-1" aria-hidden="true" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">test_that</span>(<span class="st">&quot;checkXInputResults works&quot;</span>, {</span>
<span id="cb101-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">72617</span>)</span>
<span id="cb101-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-4" aria-hidden="true" tabindex="-1"></a>  x_select <span class="ot">&lt;-</span> <span class="fu">matrix</span>(stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">10</span><span class="sc">*</span><span class="dv">5</span>), <span class="at">nrow=</span><span class="dv">10</span>, <span class="at">ncol=</span><span class="dv">5</span>)</span>
<span id="cb101-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-5" aria-hidden="true" tabindex="-1"></a>  x_new <span class="ot">&lt;-</span> <span class="fu">matrix</span>(stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">8</span><span class="sc">*</span><span class="dv">5</span>), <span class="at">nrow=</span><span class="dv">8</span>, <span class="at">ncol=</span><span class="dv">5</span>)</span>
<span id="cb101-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-6" aria-hidden="true" tabindex="-1"></a>  y_select <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">10</span>)</span>
<span id="cb101-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-7" aria-hidden="true" tabindex="-1"></a>  y_new <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">8</span>)</span>
<span id="cb101-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-9" aria-hidden="true" tabindex="-1"></a>  good_clusters <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;red&quot;</span><span class="ot">=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="st">&quot;blue&quot;</span><span class="ot">=</span><span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="st">&quot;green&quot;</span><span class="ot">=</span><span class="dv">5</span>)</span>
<span id="cb101-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-11" aria-hidden="true" tabindex="-1"></a>  css_res <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x_select, <span class="at">y=</span>y_select, <span class="at">lambda=</span><span class="fl">0.01</span>, <span class="at">clusters=</span>good_clusters,</span>
<span id="cb101-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">B =</span> <span class="dv">10</span>)</span>
<span id="cb101-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb101-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-14" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkXInputResults'>checkXInputResults</a>(x_new, css_res<span class="sc">$</span>X)</span>
<span id="cb101-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-16" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res))</span>
<span id="cb101-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-17" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(res), <span class="fu">c</span>(<span class="st">&quot;feat_names&quot;</span>, <span class="st">&quot;newx&quot;</span>))</span>
<span id="cb101-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb101-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-19" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.character</span>(res<span class="sc">$</span>feat_names))</span>
<span id="cb101-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-20" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.na</span>(res<span class="sc">$</span>feat_names))</span>
<span id="cb101-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb101-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-22" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res<span class="sc">$</span>newx))</span>
<span id="cb101-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-23" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(res<span class="sc">$</span>newx))</span>
<span id="cb101-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-24" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(res<span class="sc">$</span>newx), <span class="dv">8</span>)</span>
<span id="cb101-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-25" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">ncol</span>(res<span class="sc">$</span>newx), <span class="dv">5</span>)</span>
<span id="cb101-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-26" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_null</span>(<span class="fu">colnames</span>(res<span class="sc">$</span>newx))</span>
<span id="cb101-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb101-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Try naming variables</span></span>
<span id="cb101-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb101-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(x_select) <span class="ot">&lt;-</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb101-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-31" aria-hidden="true" tabindex="-1"></a>  css_res_named <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x_select, <span class="at">y=</span>y_select, <span class="at">lambda=</span><span class="fl">0.01</span>,</span>
<span id="cb101-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-32" aria-hidden="true" tabindex="-1"></a>                       <span class="at">clusters=</span>good_clusters, <span class="at">B =</span> <span class="dv">10</span>)</span>
<span id="cb101-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb101-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Named variables for css matrix but not new one--should get a warning</span></span>
<span id="cb101-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-35" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_warning</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkXInputResults'>checkXInputResults</a>(x_new, css_res_named<span class="sc">$</span>X),</span>
<span id="cb101-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-36" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;New X provided had no variable names (column names) even though the X provided to css did.&quot;</span>,</span>
<span id="cb101-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-37" aria-hidden="true" tabindex="-1"></a>                           <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb101-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Try mismatching variable names</span></span>
<span id="cb101-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(x_new) <span class="ot">&lt;-</span> LETTERS[<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>]</span>
<span id="cb101-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-41" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkXInputResults'>checkXInputResults</a>(x_new, css_res_named<span class="sc">$</span>X),</span>
<span id="cb101-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-42" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;identical(feat_names, colnames(css_X)) is not TRUE&quot;</span>,</span>
<span id="cb101-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-43" aria-hidden="true" tabindex="-1"></a>                           <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb101-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb101-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(x_new) <span class="ot">&lt;-</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb101-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb101-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-47" aria-hidden="true" tabindex="-1"></a>  res_named <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkXInputResults'>checkXInputResults</a>(x_new, css_res_named<span class="sc">$</span>X)</span>
<span id="cb101-48"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb101-49"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-49" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res_named))</span>
<span id="cb101-50"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-50" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(res_named), <span class="fu">c</span>(<span class="st">&quot;feat_names&quot;</span>, <span class="st">&quot;newx&quot;</span>))</span>
<span id="cb101-51"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb101-52"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-52" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.character</span>(res_named<span class="sc">$</span>feat_names))</span>
<span id="cb101-53"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-53" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(res_named<span class="sc">$</span>feat_names, LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb101-54"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb101-55"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-55" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Try data.frame input to css and checkXInputResults</span></span>
<span id="cb101-56"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb101-57"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-57" aria-hidden="true" tabindex="-1"></a>  X_df <span class="ot">&lt;-</span> datasets<span class="sc">::</span>mtcars</span>
<span id="cb101-58"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-58" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb101-59"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-59" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(X_df)</span>
<span id="cb101-60"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-60" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">rnorm</span>(n)</span>
<span id="cb101-61"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-61" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb101-62"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-62" aria-hidden="true" tabindex="-1"></a>  selec_inds <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">round</span>(n<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb101-63"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-63" aria-hidden="true" tabindex="-1"></a>  fit_inds <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="dv">1</span><span class="sc">:</span>n, selec_inds)</span>
<span id="cb101-64"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-64" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb101-65"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-65" aria-hidden="true" tabindex="-1"></a>  css_res_df <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>X_df[selec_inds, ], <span class="at">y=</span>y[selec_inds], <span class="at">lambda=</span><span class="fl">0.01</span>, <span class="at">B =</span> <span class="dv">10</span>)</span>
<span id="cb101-66"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-66" aria-hidden="true" tabindex="-1"></a>  res_df <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkXInputResults'>checkXInputResults</a>(X_df[fit_inds, ], css_res_df<span class="sc">$</span>X)</span>
<span id="cb101-67"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-67" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb101-68"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-68" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res_df))</span>
<span id="cb101-69"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-69" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(res_df), <span class="fu">c</span>(<span class="st">&quot;feat_names&quot;</span>, <span class="st">&quot;newx&quot;</span>))</span>
<span id="cb101-70"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-70" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb101-71"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-71" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.character</span>(res_df<span class="sc">$</span>feat_names))</span>
<span id="cb101-72"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-72" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(res_df<span class="sc">$</span>feat_names, <span class="fu">colnames</span>(css_res_df<span class="sc">$</span>X))</span>
<span id="cb101-73"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-73" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(res_df<span class="sc">$</span>feat_names, <span class="fu">colnames</span>(X_df))</span>
<span id="cb101-74"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-75"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-75" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res_df<span class="sc">$</span>newx))</span>
<span id="cb101-76"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-76" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(res_df<span class="sc">$</span>newx))</span>
<span id="cb101-77"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-77" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_null</span>(<span class="fu">colnames</span>(res_df<span class="sc">$</span>newx))</span>
<span id="cb101-78"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-78" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">ncol</span>(res_df<span class="sc">$</span>newx), <span class="fu">ncol</span>(css_res_df<span class="sc">$</span>X))</span>
<span id="cb101-79"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-79" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb101-80"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-80" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Try again with X as a dataframe with factors (number of columns of final</span></span>
<span id="cb101-81"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-81" aria-hidden="true" tabindex="-1"></a>  <span class="co"># design matrix after one-hot encoding factors won&#39;t match number of columns</span></span>
<span id="cb101-82"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-82" aria-hidden="true" tabindex="-1"></a>  <span class="co"># of X_df)</span></span>
<span id="cb101-83"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-83" aria-hidden="true" tabindex="-1"></a>  X_df<span class="sc">$</span>cyl <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(X_df<span class="sc">$</span>cyl)</span>
<span id="cb101-84"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-84" aria-hidden="true" tabindex="-1"></a>  X_df<span class="sc">$</span>vs <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(X_df<span class="sc">$</span>vs)</span>
<span id="cb101-85"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-85" aria-hidden="true" tabindex="-1"></a>  X_df<span class="sc">$</span>am <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(X_df<span class="sc">$</span>am)</span>
<span id="cb101-86"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-86" aria-hidden="true" tabindex="-1"></a>  X_df<span class="sc">$</span>gear <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(X_df<span class="sc">$</span>gear)</span>
<span id="cb101-87"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-87" aria-hidden="true" tabindex="-1"></a>  X_df<span class="sc">$</span>carb <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(X_df<span class="sc">$</span>carb)</span>
<span id="cb101-88"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-88" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb101-89"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-89" aria-hidden="true" tabindex="-1"></a>  css_res_df <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>X_df[selec_inds, ], <span class="at">y=</span>y[selec_inds], <span class="at">lambda=</span><span class="fl">0.01</span>, <span class="at">B =</span> <span class="dv">10</span>)</span>
<span id="cb101-90"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-90" aria-hidden="true" tabindex="-1"></a>  res_df <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkXInputResults'>checkXInputResults</a>(X_df[fit_inds, ], css_res_df<span class="sc">$</span>X)</span>
<span id="cb101-91"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-92"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-92" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res_df))</span>
<span id="cb101-93"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-93" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(res_df), <span class="fu">c</span>(<span class="st">&quot;feat_names&quot;</span>, <span class="st">&quot;newx&quot;</span>))</span>
<span id="cb101-94"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-95"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-95" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.character</span>(res_df<span class="sc">$</span>feat_names))</span>
<span id="cb101-96"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-96" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(res_df<span class="sc">$</span>feat_names, <span class="fu">colnames</span>(css_res_df<span class="sc">$</span>X))</span>
<span id="cb101-97"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-97" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb101-98"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-98" aria-hidden="true" tabindex="-1"></a>  mat <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>( <span class="sc">~</span>., X_df)</span>
<span id="cb101-99"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-99" aria-hidden="true" tabindex="-1"></a>  mat <span class="ot">&lt;-</span> mat[, <span class="fu">colnames</span>(mat) <span class="sc">!=</span> <span class="st">&quot;(Intercept)&quot;</span>]</span>
<span id="cb101-100"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-100" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb101-101"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-101" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(res_df<span class="sc">$</span>feat_names, <span class="fu">colnames</span>(mat))</span>
<span id="cb101-102"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-103"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-103" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res_df<span class="sc">$</span>newx))</span>
<span id="cb101-104"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-104" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(res_df<span class="sc">$</span>newx))</span>
<span id="cb101-105"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-105" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_null</span>(<span class="fu">colnames</span>(res_df<span class="sc">$</span>newx))</span>
<span id="cb101-106"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-106" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">ncol</span>(res_df<span class="sc">$</span>newx), <span class="fu">ncol</span>(css_res_df<span class="sc">$</span>X))</span>
<span id="cb101-107"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb101-107" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## Test passed 🌈</code></pre>
<p>Tests for checkNewXProvided</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-1" aria-hidden="true" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">test_that</span>(<span class="st">&quot;checkNewXProvided works&quot;</span>, {</span>
<span id="cb103-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">2673</span>)</span>
<span id="cb103-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-4" aria-hidden="true" tabindex="-1"></a>  x_select <span class="ot">&lt;-</span> <span class="fu">matrix</span>(stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">10</span><span class="sc">*</span><span class="dv">5</span>), <span class="at">nrow=</span><span class="dv">10</span>, <span class="at">ncol=</span><span class="dv">5</span>)</span>
<span id="cb103-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-5" aria-hidden="true" tabindex="-1"></a>  x_new <span class="ot">&lt;-</span> <span class="fu">matrix</span>(stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">8</span><span class="sc">*</span><span class="dv">5</span>), <span class="at">nrow=</span><span class="dv">8</span>, <span class="at">ncol=</span><span class="dv">5</span>)</span>
<span id="cb103-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-6" aria-hidden="true" tabindex="-1"></a>  y_select <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">10</span>)</span>
<span id="cb103-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-7" aria-hidden="true" tabindex="-1"></a>  y_new <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">8</span>)</span>
<span id="cb103-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-9" aria-hidden="true" tabindex="-1"></a>  good_clusters <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;red&quot;</span><span class="ot">=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="st">&quot;blue&quot;</span><span class="ot">=</span><span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="st">&quot;green&quot;</span><span class="ot">=</span><span class="dv">5</span>)</span>
<span id="cb103-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-11" aria-hidden="true" tabindex="-1"></a>  css_res <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x_select, <span class="at">y=</span>y_select, <span class="at">lambda=</span><span class="fl">0.01</span>, <span class="at">clusters=</span>good_clusters,</span>
<span id="cb103-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">B =</span> <span class="dv">10</span>)</span>
<span id="cb103-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-14" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkNewXProvided'>checkNewXProvided</a>(x_new, css_res)</span>
<span id="cb103-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-16" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res))</span>
<span id="cb103-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-17" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(res), <span class="fu">c</span>(<span class="st">&quot;newX&quot;</span>, <span class="st">&quot;newXProvided&quot;</span>))</span>
<span id="cb103-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-19" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res<span class="sc">$</span>newX))</span>
<span id="cb103-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-20" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(res<span class="sc">$</span>newX))</span>
<span id="cb103-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-21" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(res<span class="sc">$</span>newX), <span class="dv">8</span>)</span>
<span id="cb103-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-22" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">ncol</span>(res<span class="sc">$</span>newX), <span class="dv">5</span>)</span>
<span id="cb103-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-23" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_null</span>(<span class="fu">colnames</span>(res<span class="sc">$</span>newX))</span>
<span id="cb103-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-25" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.logical</span>(res<span class="sc">$</span>newXProvided))</span>
<span id="cb103-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-26" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res<span class="sc">$</span>newXProvided), <span class="dv">1</span>)</span>
<span id="cb103-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-27" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="sc">!</span><span class="fu">is.na</span>(res<span class="sc">$</span>newXProvided))</span>
<span id="cb103-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-28" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(res<span class="sc">$</span>newXProvided)</span>
<span id="cb103-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add training indices</span></span>
<span id="cb103-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-31" aria-hidden="true" tabindex="-1"></a>  css_res_train <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x_select, <span class="at">y=</span>y_select, <span class="at">lambda=</span><span class="fl">0.01</span>,</span>
<span id="cb103-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-32" aria-hidden="true" tabindex="-1"></a>                       <span class="at">clusters=</span>good_clusters, <span class="at">B =</span> <span class="dv">10</span>, <span class="at">train_inds=</span><span class="dv">6</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb103-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Training indices should be ignored if new x is provided</span></span>
<span id="cb103-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-36" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkNewXProvided'>checkNewXProvided</a>(x_new, css_res_train)</span>
<span id="cb103-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-38" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res))</span>
<span id="cb103-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-39" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(res), <span class="fu">c</span>(<span class="st">&quot;newX&quot;</span>, <span class="st">&quot;newXProvided&quot;</span>))</span>
<span id="cb103-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-41" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">abs</span>(x_new <span class="sc">-</span> res<span class="sc">$</span>newX) <span class="sc">&lt;</span> <span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">9</span>)))</span>
<span id="cb103-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-42" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(res<span class="sc">$</span>newXProvided)</span>
<span id="cb103-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Things should still work if new x is not provided</span></span>
<span id="cb103-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-46" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkNewXProvided'>checkNewXProvided</a>(<span class="cn">NA</span>, css_res_train)</span>
<span id="cb103-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-48"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-48" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res))</span>
<span id="cb103-49"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-49" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(res), <span class="fu">c</span>(<span class="st">&quot;newX&quot;</span>, <span class="st">&quot;newXProvided&quot;</span>))</span>
<span id="cb103-50"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-51"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-51" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res<span class="sc">$</span>newX))</span>
<span id="cb103-52"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-52" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(res<span class="sc">$</span>newX))</span>
<span id="cb103-53"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-53" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(res<span class="sc">$</span>newX), <span class="dv">5</span>)</span>
<span id="cb103-54"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-54" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">ncol</span>(res<span class="sc">$</span>newX), <span class="dv">5</span>)</span>
<span id="cb103-55"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-55" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_null</span>(<span class="fu">colnames</span>(res<span class="sc">$</span>newX))</span>
<span id="cb103-56"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-57"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-57" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_false</span>(res<span class="sc">$</span>newXProvided)</span>
<span id="cb103-58"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-58" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-59"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-59" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Try not providing training indices and omitting newx--should get error</span></span>
<span id="cb103-60"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-60" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkNewXProvided'>checkNewXProvided</a>(<span class="cn">NA</span>, css_res),</span>
<span id="cb103-61"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-61" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;css was not provided with indices to set aside for model training (train_inds), so must provide new X in order to generate a design matrix&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb103-62"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-62" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-63"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-63" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Try naming variables</span></span>
<span id="cb103-64"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-65"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(x_select) <span class="ot">&lt;-</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb103-66"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-66" aria-hidden="true" tabindex="-1"></a>  css_res_named <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x_select, <span class="at">y=</span>y_select, <span class="at">lambda=</span><span class="fl">0.01</span>,</span>
<span id="cb103-67"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-67" aria-hidden="true" tabindex="-1"></a>                       <span class="at">clusters=</span>good_clusters, <span class="at">B =</span> <span class="dv">10</span>)</span>
<span id="cb103-68"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-69"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-69" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Named variables for css matrix but not new one--should get a warning</span></span>
<span id="cb103-70"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-70" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_warning</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkNewXProvided'>checkNewXProvided</a>(x_new, css_res_named),</span>
<span id="cb103-71"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-71" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;New X provided had no variable names (column names) even though the X provided to css did.&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb103-72"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-73"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-73" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Try mismatching variable names</span></span>
<span id="cb103-74"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(x_new) <span class="ot">&lt;-</span> LETTERS[<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>]</span>
<span id="cb103-75"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-75" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkNewXProvided'>checkNewXProvided</a>(x_new, css_res_named),</span>
<span id="cb103-76"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-76" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;identical(feat_names, colnames(css_X)) is not TRUE&quot;</span>,</span>
<span id="cb103-77"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-77" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb103-78"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-79"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(x_new) <span class="ot">&lt;-</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb103-80"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-81"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-81" aria-hidden="true" tabindex="-1"></a>  res_named <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkNewXProvided'>checkNewXProvided</a>(x_new, css_res_named)</span>
<span id="cb103-82"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-83"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-83" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res_named))</span>
<span id="cb103-84"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-84" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(res_named), <span class="fu">c</span>(<span class="st">&quot;newX&quot;</span>, <span class="st">&quot;newXProvided&quot;</span>))</span>
<span id="cb103-85"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-85" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-86"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-86" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">abs</span>(x_new <span class="sc">-</span> res_named<span class="sc">$</span>newX) <span class="sc">&lt;</span> <span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">9</span>)))</span>
<span id="cb103-87"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-87" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(res_named<span class="sc">$</span>newXProvided)</span>
<span id="cb103-88"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-89"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-89" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Try data.frame input to css and checkNewXProvided</span></span>
<span id="cb103-90"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-91"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-91" aria-hidden="true" tabindex="-1"></a>  X_df <span class="ot">&lt;-</span> datasets<span class="sc">::</span>mtcars</span>
<span id="cb103-92"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-93"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-93" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(X_df)</span>
<span id="cb103-94"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-94" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">rnorm</span>(n)</span>
<span id="cb103-95"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-96"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-96" aria-hidden="true" tabindex="-1"></a>  selec_inds <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">round</span>(n<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb103-97"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-97" aria-hidden="true" tabindex="-1"></a>  fit_inds <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="dv">1</span><span class="sc">:</span>n, selec_inds)</span>
<span id="cb103-98"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-99"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-99" aria-hidden="true" tabindex="-1"></a>  css_res_df <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>X_df[selec_inds, ], <span class="at">y=</span>y[selec_inds], <span class="at">lambda=</span><span class="fl">0.01</span>, <span class="at">B =</span> <span class="dv">10</span>)</span>
<span id="cb103-100"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-100" aria-hidden="true" tabindex="-1"></a>  res_df <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkNewXProvided'>checkNewXProvided</a>(X_df[fit_inds, ], css_res_df)</span>
<span id="cb103-101"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-102"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-102" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res_df))</span>
<span id="cb103-103"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-103" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(res_df), <span class="fu">c</span>(<span class="st">&quot;newX&quot;</span>, <span class="st">&quot;newXProvided&quot;</span>))</span>
<span id="cb103-104"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-104" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-105"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-105" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res_df<span class="sc">$</span>newX))</span>
<span id="cb103-106"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-106" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(res_df<span class="sc">$</span>newX))</span>
<span id="cb103-107"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-107" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(res_df<span class="sc">$</span>newX), <span class="fu">length</span>(fit_inds))</span>
<span id="cb103-108"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-108" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">ncol</span>(res_df<span class="sc">$</span>newX), <span class="fu">ncol</span>(css_res_df<span class="sc">$</span>X))</span>
<span id="cb103-109"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-109" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_null</span>(<span class="fu">colnames</span>(res_df<span class="sc">$</span>newX))</span>
<span id="cb103-110"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-110" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-111"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-111" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.logical</span>(res_df<span class="sc">$</span>newXProvided))</span>
<span id="cb103-112"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-112" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res_df<span class="sc">$</span>newXProvided), <span class="dv">1</span>)</span>
<span id="cb103-113"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-113" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="sc">!</span><span class="fu">is.na</span>(res_df<span class="sc">$</span>newXProvided))</span>
<span id="cb103-114"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-114" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(res_df<span class="sc">$</span>newXProvided)</span>
<span id="cb103-115"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-115" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-116"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-116" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Try again with X as a dataframe with factors (number of columns of final</span></span>
<span id="cb103-117"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-117" aria-hidden="true" tabindex="-1"></a>  <span class="co"># design matrix after one-hot encoding factors won&#39;t match number of columns</span></span>
<span id="cb103-118"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-118" aria-hidden="true" tabindex="-1"></a>  <span class="co"># of X_df)</span></span>
<span id="cb103-119"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-119" aria-hidden="true" tabindex="-1"></a>  X_df<span class="sc">$</span>cyl <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(X_df<span class="sc">$</span>cyl)</span>
<span id="cb103-120"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-120" aria-hidden="true" tabindex="-1"></a>  X_df<span class="sc">$</span>vs <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(X_df<span class="sc">$</span>vs)</span>
<span id="cb103-121"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-121" aria-hidden="true" tabindex="-1"></a>  X_df<span class="sc">$</span>am <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(X_df<span class="sc">$</span>am)</span>
<span id="cb103-122"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-122" aria-hidden="true" tabindex="-1"></a>  X_df<span class="sc">$</span>gear <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(X_df<span class="sc">$</span>gear)</span>
<span id="cb103-123"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-123" aria-hidden="true" tabindex="-1"></a>  X_df<span class="sc">$</span>carb <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(X_df<span class="sc">$</span>carb)</span>
<span id="cb103-124"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-125"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-125" aria-hidden="true" tabindex="-1"></a>  css_res_df <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>X_df[selec_inds, ], <span class="at">y=</span>y[selec_inds], <span class="at">lambda=</span><span class="fl">0.01</span>, <span class="at">B =</span> <span class="dv">10</span>)</span>
<span id="cb103-126"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-126" aria-hidden="true" tabindex="-1"></a>  res_df <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkNewXProvided'>checkNewXProvided</a>(X_df[fit_inds, ], css_res_df)</span>
<span id="cb103-127"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-128"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-128" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res_df))</span>
<span id="cb103-129"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-129" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(res_df), <span class="fu">c</span>(<span class="st">&quot;newX&quot;</span>, <span class="st">&quot;newXProvided&quot;</span>))</span>
<span id="cb103-130"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-130" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-131"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-131" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res_df<span class="sc">$</span>newX))</span>
<span id="cb103-132"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-132" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(res_df<span class="sc">$</span>newX))</span>
<span id="cb103-133"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-133" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(res_df<span class="sc">$</span>newX), <span class="fu">length</span>(fit_inds))</span>
<span id="cb103-134"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-134" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">ncol</span>(res_df<span class="sc">$</span>newX), <span class="fu">ncol</span>(css_res_df<span class="sc">$</span>X))</span>
<span id="cb103-135"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-135" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_null</span>(<span class="fu">colnames</span>(res_df<span class="sc">$</span>newX))</span>
<span id="cb103-136"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-136" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-137"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-137" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.logical</span>(res_df<span class="sc">$</span>newXProvided))</span>
<span id="cb103-138"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-138" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res_df<span class="sc">$</span>newXProvided), <span class="dv">1</span>)</span>
<span id="cb103-139"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-139" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="sc">!</span><span class="fu">is.na</span>(res_df<span class="sc">$</span>newXProvided))</span>
<span id="cb103-140"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-140" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(res_df<span class="sc">$</span>newXProvided)</span>
<span id="cb103-141"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-141" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-142"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb103-142" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## Test passed 😀</code></pre>
<p>formCssDesign:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Create design matrix of cluster representatives from matrix of raw features</span></span>
<span id="cb105-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; using results of css function</span></span>
<span id="cb105-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb105-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param css_results An object of class &quot;cssr&quot; (the output of the function</span></span>
<span id="cb105-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; css).</span></span>
<span id="cb105-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param weighting Character; determines how to calculate the weights to</span></span>
<span id="cb105-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; combine features from the selected clusters into weighted averages, called</span></span>
<span id="cb105-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; cluster representatives. Must be one of &quot;sparse&quot;, &quot;weighted_avg&quot;, or</span></span>
<span id="cb105-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; &quot;simple_avg&#39;. For &quot;sparse&quot;, all the weight is put on the most frequently</span></span>
<span id="cb105-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; selected individual cluster member (or divided equally among all the clusters</span></span>
<span id="cb105-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; that are tied for the top selection proportion if there is a tie). For</span></span>
<span id="cb105-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; &quot;weighted_avg&quot;, the weight used for each cluster member is calculated in</span></span>
<span id="cb105-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; proportion to the individual selection proportions of each feature. For</span></span>
<span id="cb105-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; &quot;simple_avg&quot;, each cluster member gets equal weight regardless of the</span></span>
<span id="cb105-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; individual feature selection proportions (that is, the cluster representative</span></span>
<span id="cb105-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; is just a simple average of all the cluster members). See Faletto and Bien</span></span>
<span id="cb105-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; (2022) for details. Default is &quot;weighted_avg&quot;.</span></span>
<span id="cb105-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param cutoff Numeric; css will return only those clusters with selection</span></span>
<span id="cb105-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; proportions equal to at least cutoff. Must be between 0 and 1. Default is 0</span></span>
<span id="cb105-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; (in which case all clusters are returned in decreasing order of selection</span></span>
<span id="cb105-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; proportion).</span></span>
<span id="cb105-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param min_num_clusts Integer or numeric; the minimum number of clusters to</span></span>
<span id="cb105-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; use regardless of cutoff. (That is, if the chosen cutoff returns fewer than</span></span>
<span id="cb105-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; min_num_clusts clusters, the cutoff will be increased until at least</span></span>
<span id="cb105-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; min_num_clusts clusters are selected.) Default is 1.</span></span>
<span id="cb105-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param max_num_clusts Integer or numeric; the maximum number of clusters to</span></span>
<span id="cb105-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; use regardless of cutoff. (That is, if the chosen cutoff returns more than</span></span>
<span id="cb105-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; max_num_clusts clusters, the cutoff will be decreased until at most</span></span>
<span id="cb105-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; max_num_clusts clusters are selected.) Default is NA (in which case</span></span>
<span id="cb105-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; max_num_clusts is ignored).</span></span>
<span id="cb105-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param newx A numeric matrix (preferably) or a data.frame (which will</span></span>
<span id="cb105-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; be coerced internally to a matrix by the function model.matrix) containing</span></span>
<span id="cb105-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the data that will be used to generate the design matrix of cluster</span></span>
<span id="cb105-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; representatives. Must contain the same features (in the same</span></span>
<span id="cb105-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; number of columns) as the X matrix provided to css, and if the columns of</span></span>
<span id="cb105-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; newx are labeled, the names must match the variable names provided to css.</span></span>
<span id="cb105-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; newx may be omitted if train_inds were provided to css to set aside</span></span>
<span id="cb105-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; observations for model estimation. If this is the case, then when newx is</span></span>
<span id="cb105-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; omitted formCssDesign will return a design matrix of cluster representatives</span></span>
<span id="cb105-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; formed from the train_inds observations from the matrix X provided to css.</span></span>
<span id="cb105-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; (If no train_inds were provided to css, newX must be provided to</span></span>
<span id="cb105-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; formCssDesign.) Default is NA.</span></span>
<span id="cb105-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return A design matrix with the same number of rows as newx (or the </span></span>
<span id="cb105-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; train_inds provided to css) where the columns are the constructed cluster</span></span>
<span id="cb105-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; representatives.</span></span>
<span id="cb105-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @author Gregory Faletto, Jacob Bien</span></span>
<span id="cb105-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @references Faletto, G., &amp; Bien, J. (2022). Cluster Stability Selection.</span></span>
<span id="cb105-48"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; \emph{arXiv preprint arXiv:2201.00494}.</span></span>
<span id="cb105-49"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; \url{https://arxiv.org/abs/2201.00494}.</span></span>
<span id="cb105-50"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-50" aria-hidden="true" tabindex="-1"></a><span id='formCssDesign'>formCssDesign</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(css_results, <span class="at">weighting=</span><span class="st">&quot;weighted_avg&quot;</span>, <span class="at">cutoff=</span><span class="dv">0</span>,</span>
<span id="cb105-51"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_num_clusts=</span><span class="dv">1</span>, <span class="at">max_num_clusts=</span><span class="cn">NA</span>, <span class="at">newx=</span><span class="cn">NA</span>){</span>
<span id="cb105-52"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-53"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-53" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check inputs</span></span>
<span id="cb105-54"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-54" aria-hidden="true" tabindex="-1"></a>    ret <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkFormCssDesignInputs'>checkFormCssDesignInputs</a>(css_results, weighting, cutoff,</span>
<span id="cb105-55"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-55" aria-hidden="true" tabindex="-1"></a>        min_num_clusts, max_num_clusts, newx)</span>
<span id="cb105-56"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-57"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-57" aria-hidden="true" tabindex="-1"></a>    newx <span class="ot">&lt;-</span> ret<span class="sc">$</span>newx</span>
<span id="cb105-58"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-58" aria-hidden="true" tabindex="-1"></a>    max_num_clusts <span class="ot">&lt;-</span> ret<span class="sc">$</span>max_num_clusts</span>
<span id="cb105-59"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-60"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rm</span>(ret)</span>
<span id="cb105-61"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-62"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-62" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(newx)</span>
<span id="cb105-63"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-63" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ncol</span>(newx)</span>
<span id="cb105-64"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-65"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-65" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get the names of the selected clusters and the weights for the features</span></span>
<span id="cb105-66"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-66" aria-hidden="true" tabindex="-1"></a>    <span class="co"># within each cluster, according to the provided weighting rule</span></span>
<span id="cb105-67"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-67" aria-hidden="true" tabindex="-1"></a>    weights <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getSelectedClusters'>getSelectedClusters</a>(css_results, weighting, cutoff,</span>
<span id="cb105-68"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-68" aria-hidden="true" tabindex="-1"></a>        min_num_clusts, max_num_clusts)<span class="sc">$</span>weights</span>
<span id="cb105-69"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-70"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-70" aria-hidden="true" tabindex="-1"></a>    n_sel_clusts <span class="ot">&lt;-</span> <span class="fu">length</span>(weights)</span>
<span id="cb105-71"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-72"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-72" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Form matrix of cluster representatives of selected clusters</span></span>
<span id="cb105-73"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-73" aria-hidden="true" tabindex="-1"></a>    X_clus_reps <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="fu">as.numeric</span>(<span class="cn">NA</span>), n<span class="sc">*</span>n_sel_clusts), <span class="at">nrow=</span>n,</span>
<span id="cb105-74"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-74" aria-hidden="true" tabindex="-1"></a>        <span class="at">ncol=</span>n_sel_clusts)</span>
<span id="cb105-75"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-75" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(X_clus_reps) <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">as.character</span>(<span class="cn">NA</span>), n_sel_clusts)</span>
<span id="cb105-76"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-77"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-77" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_sel_clusts){</span>
<span id="cb105-78"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-78" aria-hidden="true" tabindex="-1"></a>        clust_i_name <span class="ot">&lt;-</span> <span class="fu">names</span>(weights)[i]</span>
<span id="cb105-79"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-80"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-80" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">length</span>(clust_i_name) <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb105-81"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-81" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(clust_i_name <span class="sc">%in%</span> <span class="fu">names</span>(weights))</span>
<span id="cb105-82"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-83"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-83" aria-hidden="true" tabindex="-1"></a>        <span class="fu">colnames</span>(X_clus_reps)[i] <span class="ot">&lt;-</span> clust_i_name</span>
<span id="cb105-84"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-85"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-85" aria-hidden="true" tabindex="-1"></a>        clust_i <span class="ot">&lt;-</span> css_results<span class="sc">$</span>clusters[[clust_i_name]]</span>
<span id="cb105-86"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-87"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-87" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">length</span>(clust_i) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb105-88"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-88" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">all</span>(clust_i) <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span>p)</span>
<span id="cb105-89"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-90"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-90" aria-hidden="true" tabindex="-1"></a>        weights_i <span class="ot">&lt;-</span> weights[[clust_i_name]]</span>
<span id="cb105-91"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-92"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-92" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">length</span>(clust_i) <span class="sc">==</span> <span class="fu">length</span>(weights_i))</span>
<span id="cb105-93"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-94"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-94" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="fu">length</span>(weights_i) <span class="sc">&gt;</span> <span class="dv">1</span>){</span>
<span id="cb105-95"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-95" aria-hidden="true" tabindex="-1"></a>            X_clus_reps[, i] <span class="ot">&lt;-</span> newx[, clust_i] <span class="sc">%*%</span> weights_i</span>
<span id="cb105-96"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-96" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span>{</span>
<span id="cb105-97"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-97" aria-hidden="true" tabindex="-1"></a>            X_clus_reps[, i] <span class="ot">&lt;-</span> newx[, clust_i]<span class="sc">*</span>weights_i</span>
<span id="cb105-98"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-98" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb105-99"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-99" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb105-100"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-101"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-101" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check output</span></span>
<span id="cb105-102"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-102" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(X_clus_reps)))</span>
<span id="cb105-103"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-103" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">ncol</span>(X_clus_reps) <span class="sc">==</span> n_sel_clusts)</span>
<span id="cb105-104"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-104" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">nrow</span>(X_clus_reps) <span class="sc">==</span> n)</span>
<span id="cb105-105"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-106"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-106" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(X_clus_reps)</span>
<span id="cb105-107"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb105-107" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>checkFormCssDesignInputs:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Helper function to check that the inputs to formCssDesign are as expected</span></span>
<span id="cb106-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb106-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param css_results An object of class &quot;cssr&quot; (the output of the function</span></span>
<span id="cb106-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; css).</span></span>
<span id="cb106-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param weighting Character; determines how to calculate the weights to</span></span>
<span id="cb106-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; combine features from the selected clusters into weighted averages, called</span></span>
<span id="cb106-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; cluster representatives. Must be one of &quot;sparse&quot;, &quot;weighted_avg&quot;, or</span></span>
<span id="cb106-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; &quot;simple_avg&#39;.</span></span>
<span id="cb106-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param cutoff Numeric; css will return only those clusters with selection</span></span>
<span id="cb106-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; proportions equal to at least cutoff. Must be between 0 and 1.</span></span>
<span id="cb106-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param min_num_clusts Integer or numeric; the minimum number of clusters to</span></span>
<span id="cb106-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; use regardless of cutoff. (That is, if the chosen cutoff returns fewer than</span></span>
<span id="cb106-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; min_num_clusts clusters, the cutoff will be increased until at least</span></span>
<span id="cb106-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; min_num_clusts clusters are selected.)</span></span>
<span id="cb106-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param max_num_clusts Integer or numeric; the maximum number of clusters to</span></span>
<span id="cb106-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; use regardless of cutoff. (That is, if the chosen cutoff returns more than</span></span>
<span id="cb106-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; max_num_clusts clusters, the cutoff will be decreased until at most</span></span>
<span id="cb106-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; max_num_clusts clusters are selected.)</span></span>
<span id="cb106-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param newx A numeric matrix (preferably) or a data.frame (which will</span></span>
<span id="cb106-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; be coerced internally to a matrix by the function model.matrix) containing</span></span>
<span id="cb106-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the data that will be used to generate the design matrix of cluster</span></span>
<span id="cb106-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; representatives. Must contain the same features (in the same</span></span>
<span id="cb106-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; number of columns) as the X matrix provided to css, and if the columns of</span></span>
<span id="cb106-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; newx are labeled, the names must match the variable names provided to css.</span></span>
<span id="cb106-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; newx may be omitted if train_inds were provided to css to set aside</span></span>
<span id="cb106-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; observations for model estimation. If this is the case, then when newx is</span></span>
<span id="cb106-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; omitted formCssDesign will return a design matrix of cluster representatives</span></span>
<span id="cb106-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; formed from the train_inds observations from the matrix X provided to css.</span></span>
<span id="cb106-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; (If no train_inds were provided to css, newX must be provided to</span></span>
<span id="cb106-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; formCssDesign.)</span></span>
<span id="cb106-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return A named list with the following elements: \item{newx}{If newx was</span></span>
<span id="cb106-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; provided, the provided newx matrix, coerced from a data.frame to a matrix if</span></span>
<span id="cb106-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; needed. If newx was not provided, a matrix formed by the train_inds set</span></span>
<span id="cb106-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; aside in the original function call to css.} \item{max_num_clusts}{The</span></span>
<span id="cb106-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; provided max_num_clusts, coerced to an integer if needed, and coerced to be</span></span>
<span id="cb106-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; less than or equal to the total number of clusters.}</span></span>
<span id="cb106-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @author Gregory Faletto, Jacob Bien</span></span>
<span id="cb106-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-38" aria-hidden="true" tabindex="-1"></a><span id='checkFormCssDesignInputs'>checkFormCssDesignInputs</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(css_results, weighting, cutoff,</span>
<span id="cb106-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-39" aria-hidden="true" tabindex="-1"></a>    min_num_clusts, max_num_clusts, newx){    </span>
<span id="cb106-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">class</span>(css_results) <span class="sc">==</span> <span class="st">&quot;cssr&quot;</span>)</span>
<span id="cb106-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">length</span>(newx) <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb106-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="fu">is.na</span>(newx)){</span>
<span id="cb106-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-44" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span>(<span class="fu">length</span>(css_results<span class="sc">$</span>train_inds) <span class="sc">==</span> <span class="dv">0</span>){</span>
<span id="cb106-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-45" aria-hidden="true" tabindex="-1"></a>                <span class="fu">stop</span>(<span class="st">&quot;If css was not provided with indices to set aside for model training, then newx must be provided to formCssDesign&quot;</span>)</span>
<span id="cb106-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-46" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb106-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-47" aria-hidden="true" tabindex="-1"></a>            newx <span class="ot">&lt;-</span> css_results<span class="sc">$</span>X[css_results<span class="sc">$</span>train_inds, ]</span>
<span id="cb106-48"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-48" aria-hidden="true" tabindex="-1"></a>            <span class="co"># feat_names &lt;- colnames(newx)</span></span>
<span id="cb106-49"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-49" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span>{</span>
<span id="cb106-50"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-50" aria-hidden="true" tabindex="-1"></a>            results <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkXInputResults'>checkXInputResults</a>(newx, css_results<span class="sc">$</span>X)</span>
<span id="cb106-51"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-52"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-52" aria-hidden="true" tabindex="-1"></a>            newx <span class="ot">&lt;-</span> results<span class="sc">$</span>newx</span>
<span id="cb106-53"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-53" aria-hidden="true" tabindex="-1"></a>            <span class="co"># feat_names &lt;- results$feat_names</span></span>
<span id="cb106-54"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-55"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-55" aria-hidden="true" tabindex="-1"></a>            <span class="fu">rm</span>(results)</span>
<span id="cb106-56"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-56" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb106-57"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-57" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span>{</span>
<span id="cb106-58"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-58" aria-hidden="true" tabindex="-1"></a>        results <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkXInputResults'>checkXInputResults</a>(newx, css_results<span class="sc">$</span>X)</span>
<span id="cb106-59"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-60"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-60" aria-hidden="true" tabindex="-1"></a>        newx <span class="ot">&lt;-</span> results<span class="sc">$</span>newx</span>
<span id="cb106-61"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-61" aria-hidden="true" tabindex="-1"></a>        <span class="co"># feat_names &lt;- results$feat_names</span></span>
<span id="cb106-62"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-63"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-63" aria-hidden="true" tabindex="-1"></a>        <span class="fu">rm</span>(results)</span>
<span id="cb106-64"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-64" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb106-65"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-66"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-66" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ncol</span>(newx)</span>
<span id="cb106-67"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-68"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-68" aria-hidden="true" tabindex="-1"></a>    <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkCutoff'>checkCutoff</a>(cutoff)</span>
<span id="cb106-69"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-69" aria-hidden="true" tabindex="-1"></a>    <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkWeighting'>checkWeighting</a>(weighting)</span>
<span id="cb106-70"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-70" aria-hidden="true" tabindex="-1"></a>    <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkMinNumClusts'>checkMinNumClusts</a>(min_num_clusts, p, <span class="fu">length</span>(css_results<span class="sc">$</span>clusters))</span>
<span id="cb106-71"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-71" aria-hidden="true" tabindex="-1"></a>    max_num_clusts <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkMaxNumClusts'>checkMaxNumClusts</a>(max_num_clusts, min_num_clusts, p,</span>
<span id="cb106-72"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-72" aria-hidden="true" tabindex="-1"></a>        <span class="fu">length</span>(css_results<span class="sc">$</span>clusters))</span>
<span id="cb106-73"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-74"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">newx=</span>newx, <span class="at">max_num_clusts=</span>max_num_clusts))</span>
<span id="cb106-75"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb106-75" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Tests for checkFormCssDesignInputs</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-1" aria-hidden="true" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">test_that</span>(<span class="st">&quot;checkFormCssDesignInputs works&quot;</span>, {</span>
<span id="cb107-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">72617</span>)</span>
<span id="cb107-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-4" aria-hidden="true" tabindex="-1"></a>  x_select <span class="ot">&lt;-</span> <span class="fu">matrix</span>(stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">10</span><span class="sc">*</span><span class="dv">6</span>), <span class="at">nrow=</span><span class="dv">10</span>, <span class="at">ncol=</span><span class="dv">6</span>)</span>
<span id="cb107-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-5" aria-hidden="true" tabindex="-1"></a>  x_new <span class="ot">&lt;-</span> <span class="fu">matrix</span>(stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">8</span><span class="sc">*</span><span class="dv">6</span>), <span class="at">nrow=</span><span class="dv">8</span>, <span class="at">ncol=</span><span class="dv">6</span>)</span>
<span id="cb107-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-6" aria-hidden="true" tabindex="-1"></a>  y_select <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">10</span>)</span>
<span id="cb107-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-7" aria-hidden="true" tabindex="-1"></a>  y_new <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">8</span>)</span>
<span id="cb107-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-9" aria-hidden="true" tabindex="-1"></a>  good_clusters <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;red&quot;</span><span class="ot">=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="st">&quot;blue&quot;</span><span class="ot">=</span><span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="st">&quot;green&quot;</span><span class="ot">=</span><span class="dv">5</span>)</span>
<span id="cb107-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-11" aria-hidden="true" tabindex="-1"></a>  css_res <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x_select, <span class="at">y=</span>y_select, <span class="at">lambda=</span><span class="fl">0.01</span>, <span class="at">clusters=</span>good_clusters,</span>
<span id="cb107-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">B =</span> <span class="dv">10</span>)</span>
<span id="cb107-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-14" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkFormCssDesignInputs'>checkFormCssDesignInputs</a>(<span class="at">css_results=</span>css_res, <span class="at">weighting=</span><span class="st">&quot;sparse&quot;</span>,</span>
<span id="cb107-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-15" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">cutoff=</span><span class="fl">0.5</span>, <span class="at">min_num_clusts=</span><span class="dv">1</span>,</span>
<span id="cb107-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-16" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">max_num_clusts=</span><span class="cn">NA</span>, <span class="at">newx=</span>x_new)</span>
<span id="cb107-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-18" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res))</span>
<span id="cb107-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-19" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(res), <span class="fu">c</span>(<span class="st">&quot;newx&quot;</span>, <span class="st">&quot;max_num_clusts&quot;</span>))</span>
<span id="cb107-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-21" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res<span class="sc">$</span>newx))</span>
<span id="cb107-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-22" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(res<span class="sc">$</span>newx))</span>
<span id="cb107-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-23" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(res<span class="sc">$</span>newx), <span class="dv">8</span>)</span>
<span id="cb107-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-24" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">ncol</span>(res<span class="sc">$</span>newx), <span class="dv">6</span>)</span>
<span id="cb107-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-25" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_null</span>(<span class="fu">colnames</span>(res<span class="sc">$</span>newx))</span>
<span id="cb107-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-26" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">abs</span>(x_new <span class="sc">-</span> res<span class="sc">$</span>newX) <span class="sc">&lt;</span> <span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">9</span>)))</span>
<span id="cb107-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-28" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res<span class="sc">$</span>max_num_clusts), <span class="dv">1</span>)</span>
<span id="cb107-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-29" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.na</span>(res<span class="sc">$</span>max_num_clusts))</span>
<span id="cb107-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add training indices</span></span>
<span id="cb107-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-32" aria-hidden="true" tabindex="-1"></a>  css_res_train <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x_select, <span class="at">y=</span>y_select, <span class="at">lambda=</span><span class="fl">0.01</span>,</span>
<span id="cb107-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-33" aria-hidden="true" tabindex="-1"></a>                       <span class="at">clusters=</span>good_clusters, <span class="at">B=</span><span class="dv">10</span>, <span class="at">train_inds=</span><span class="dv">6</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb107-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Training indices should be ignored if new x is provided</span></span>
<span id="cb107-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-37" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkFormCssDesignInputs'>checkFormCssDesignInputs</a>(<span class="at">css_results=</span>css_res_train,</span>
<span id="cb107-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-38" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">weighting=</span><span class="st">&quot;weighted_avg&quot;</span>, <span class="at">cutoff=</span><span class="dv">0</span>,</span>
<span id="cb107-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-39" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">min_num_clusts=</span><span class="dv">2</span>, <span class="at">max_num_clusts=</span><span class="cn">NA</span>,</span>
<span id="cb107-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-40" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">newx=</span>x_new)</span>
<span id="cb107-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-42" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res))</span>
<span id="cb107-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-43" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(res), <span class="fu">c</span>(<span class="st">&quot;newx&quot;</span>, <span class="st">&quot;max_num_clusts&quot;</span>))</span>
<span id="cb107-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-45" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res<span class="sc">$</span>newx))</span>
<span id="cb107-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-46" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(res<span class="sc">$</span>newx))</span>
<span id="cb107-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-47" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(res<span class="sc">$</span>newx), <span class="dv">8</span>)</span>
<span id="cb107-48"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-48" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">ncol</span>(res<span class="sc">$</span>newx), <span class="dv">6</span>)</span>
<span id="cb107-49"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-49" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_null</span>(<span class="fu">colnames</span>(res<span class="sc">$</span>newx))</span>
<span id="cb107-50"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-50" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">abs</span>(x_new <span class="sc">-</span> res<span class="sc">$</span>newX) <span class="sc">&lt;</span> <span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">9</span>)))</span>
<span id="cb107-51"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-52"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-52" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Things should still work if new x is not provided</span></span>
<span id="cb107-53"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-54"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-54" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkFormCssDesignInputs'>checkFormCssDesignInputs</a>(<span class="at">css_results=</span>css_res_train, <span class="at">weighting=</span><span class="st">&quot;sparse&quot;</span>,</span>
<span id="cb107-55"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-55" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">cutoff=</span><span class="dv">1</span>, <span class="at">min_num_clusts=</span><span class="dv">3</span>,</span>
<span id="cb107-56"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-56" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">max_num_clusts=</span><span class="cn">NA</span>, <span class="at">newx=</span><span class="cn">NA</span>)</span>
<span id="cb107-57"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-58"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-58" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res))</span>
<span id="cb107-59"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-59" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(res), <span class="fu">c</span>(<span class="st">&quot;newx&quot;</span>, <span class="st">&quot;max_num_clusts&quot;</span>))</span>
<span id="cb107-60"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-61"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-61" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res<span class="sc">$</span>newx))</span>
<span id="cb107-62"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-62" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(res<span class="sc">$</span>newx))</span>
<span id="cb107-63"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-63" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(res<span class="sc">$</span>newx), <span class="fu">length</span>(<span class="dv">6</span><span class="sc">:</span><span class="dv">10</span>))</span>
<span id="cb107-64"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-64" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">ncol</span>(res<span class="sc">$</span>newx), <span class="dv">6</span>)</span>
<span id="cb107-65"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-65" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_null</span>(<span class="fu">colnames</span>(res<span class="sc">$</span>newx))</span>
<span id="cb107-66"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-66" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">abs</span>(x_select[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, ] <span class="sc">-</span> res<span class="sc">$</span>newX) <span class="sc">&lt;</span> <span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">9</span>)))</span>
<span id="cb107-67"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-67" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-68"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-68" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Try not providing training indices and omitting newx--should get error</span></span>
<span id="cb107-69"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-69" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkFormCssDesignInputs'>checkFormCssDesignInputs</a>(<span class="at">css_results=</span>css_res,</span>
<span id="cb107-70"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-70" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">weighting=</span><span class="st">&quot;sparse&quot;</span>,</span>
<span id="cb107-71"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-71" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cutoff=</span><span class="fl">0.5</span>, <span class="at">min_num_clusts=</span><span class="dv">1</span>,</span>
<span id="cb107-72"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-72" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">max_num_clusts=</span><span class="dv">5</span>, <span class="at">newx=</span><span class="cn">NA</span>),</span>
<span id="cb107-73"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-73" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;If css was not provided with indices to set aside for model training, then newx must be provided to formCssDesign&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb107-74"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-74" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-75"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-75" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Try naming variables</span></span>
<span id="cb107-76"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-77"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(x_select) <span class="ot">&lt;-</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span>
<span id="cb107-78"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-78" aria-hidden="true" tabindex="-1"></a>  css_res_named <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x_select, <span class="at">y=</span>y_select, <span class="at">lambda=</span><span class="fl">0.01</span>,</span>
<span id="cb107-79"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-79" aria-hidden="true" tabindex="-1"></a>                       <span class="at">clusters=</span>good_clusters, <span class="at">B =</span> <span class="dv">10</span>)</span>
<span id="cb107-80"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-81"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-81" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Named variables for css matrix but not new one--should get a warning</span></span>
<span id="cb107-82"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-82" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_warning</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkFormCssDesignInputs'>checkFormCssDesignInputs</a>(<span class="at">css_results=</span>css_res_named,</span>
<span id="cb107-83"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-83" aria-hidden="true" tabindex="-1"></a>                                                    <span class="at">weighting=</span><span class="st">&quot;simple_avg&quot;</span>,</span>
<span id="cb107-84"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-84" aria-hidden="true" tabindex="-1"></a>                                                    <span class="at">cutoff=</span><span class="fl">0.9</span>,</span>
<span id="cb107-85"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-85" aria-hidden="true" tabindex="-1"></a>                                                    <span class="at">min_num_clusts=</span><span class="dv">1</span>,</span>
<span id="cb107-86"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-86" aria-hidden="true" tabindex="-1"></a>                                                    <span class="at">max_num_clusts=</span><span class="dv">3</span>,</span>
<span id="cb107-87"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-87" aria-hidden="true" tabindex="-1"></a>                                                    <span class="at">newx=</span>x_new),</span>
<span id="cb107-88"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-88" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;New X provided had no variable names (column names) even though the X provided to css did.&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb107-89"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-90"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-90" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Try mismatching variable names</span></span>
<span id="cb107-91"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(x_new) <span class="ot">&lt;-</span> LETTERS[<span class="dv">2</span><span class="sc">:</span><span class="dv">7</span>]</span>
<span id="cb107-92"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-92" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkFormCssDesignInputs'>checkFormCssDesignInputs</a>(<span class="at">css_results=</span>css_res_named,</span>
<span id="cb107-93"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-93" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">weighting=</span><span class="st">&quot;weighted_avg&quot;</span>,</span>
<span id="cb107-94"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-94" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cutoff=</span><span class="fl">0.2</span>, <span class="at">min_num_clusts=</span><span class="dv">1</span>,</span>
<span id="cb107-95"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-95" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">max_num_clusts=</span><span class="dv">1</span>,</span>
<span id="cb107-96"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-96" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">newx=</span>x_new),</span>
<span id="cb107-97"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-97" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;identical(feat_names, colnames(css_X)) is not TRUE&quot;</span>,</span>
<span id="cb107-98"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-98" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb107-99"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-100"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(x_new) <span class="ot">&lt;-</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span>
<span id="cb107-101"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-102"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-102" aria-hidden="true" tabindex="-1"></a>  res_named <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkFormCssDesignInputs'>checkFormCssDesignInputs</a>(<span class="at">css_results=</span>css_res_named,</span>
<span id="cb107-103"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-103" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">weighting=</span><span class="st">&quot;sparse&quot;</span>, <span class="at">cutoff=</span><span class="fl">0.5</span>,</span>
<span id="cb107-104"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-104" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">min_num_clusts=</span><span class="dv">2</span>, <span class="at">max_num_clusts=</span><span class="cn">NA</span>,</span>
<span id="cb107-105"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-105" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">newx=</span>x_new)</span>
<span id="cb107-106"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-107"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-107" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res_named))</span>
<span id="cb107-108"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-108" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(res_named), <span class="fu">c</span>(<span class="st">&quot;newx&quot;</span>, <span class="st">&quot;max_num_clusts&quot;</span>))</span>
<span id="cb107-109"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-110"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-110" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res_named<span class="sc">$</span>newx))</span>
<span id="cb107-111"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-111" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(res_named<span class="sc">$</span>newx))</span>
<span id="cb107-112"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-112" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(res_named<span class="sc">$</span>newx), <span class="dv">8</span>)</span>
<span id="cb107-113"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-113" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">ncol</span>(res_named<span class="sc">$</span>newx), <span class="dv">6</span>)</span>
<span id="cb107-114"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-114" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_null</span>(<span class="fu">colnames</span>(res_named<span class="sc">$</span>newx))</span>
<span id="cb107-115"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-115" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">colnames</span>(css_res_named<span class="sc">$</span>X), LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>])</span>
<span id="cb107-116"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-116" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">abs</span>(x_new <span class="sc">-</span> res_named<span class="sc">$</span>newX) <span class="sc">&lt;</span> <span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">9</span>)))</span>
<span id="cb107-117"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-118"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-118" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Try data.frame input to css and checkFormCssDesignInputs</span></span>
<span id="cb107-119"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-120"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-120" aria-hidden="true" tabindex="-1"></a>  X_df <span class="ot">&lt;-</span> datasets<span class="sc">::</span>mtcars</span>
<span id="cb107-121"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-122"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-122" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(X_df)</span>
<span id="cb107-123"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-123" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">rnorm</span>(n)</span>
<span id="cb107-124"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-125"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-125" aria-hidden="true" tabindex="-1"></a>  selec_inds <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">round</span>(n<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb107-126"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-126" aria-hidden="true" tabindex="-1"></a>  fit_inds <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="dv">1</span><span class="sc">:</span>n, selec_inds)</span>
<span id="cb107-127"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-128"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-128" aria-hidden="true" tabindex="-1"></a>  css_res_df <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>X_df[selec_inds, ], <span class="at">y=</span>y[selec_inds], <span class="at">lambda=</span><span class="fl">0.01</span>, <span class="at">B =</span> <span class="dv">10</span>)</span>
<span id="cb107-129"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-129" aria-hidden="true" tabindex="-1"></a>  res_df <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkFormCssDesignInputs'>checkFormCssDesignInputs</a>(<span class="at">css_results=</span>css_res_df,</span>
<span id="cb107-130"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-130" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">weighting=</span><span class="st">&quot;simple_avg&quot;</span>, <span class="at">cutoff=</span><span class="fl">0.7</span>,</span>
<span id="cb107-131"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-131" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">min_num_clusts=</span><span class="dv">3</span>, <span class="at">max_num_clusts=</span><span class="cn">NA</span>,</span>
<span id="cb107-132"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-132" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">newx=</span>X_df[fit_inds, ])</span>
<span id="cb107-133"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-134"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-134" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res_df))</span>
<span id="cb107-135"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-135" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(res_df), <span class="fu">c</span>(<span class="st">&quot;newx&quot;</span>, <span class="st">&quot;max_num_clusts&quot;</span>))</span>
<span id="cb107-136"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-136" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-137"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-137" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res_df<span class="sc">$</span>newx))</span>
<span id="cb107-138"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-138" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(res_df<span class="sc">$</span>newx))</span>
<span id="cb107-139"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-139" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_null</span>(<span class="fu">colnames</span>(res_df<span class="sc">$</span>newx))</span>
<span id="cb107-140"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-140" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(res_df<span class="sc">$</span>newx), <span class="fu">length</span>(fit_inds))</span>
<span id="cb107-141"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-141" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">ncol</span>(res_df<span class="sc">$</span>newx), <span class="fu">ncol</span>(css_res_df<span class="sc">$</span>X))</span>
<span id="cb107-142"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-143"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-143" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Try again with X as a dataframe with factors (number of columns of final</span></span>
<span id="cb107-144"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-144" aria-hidden="true" tabindex="-1"></a>  <span class="co"># design matrix after one-hot encoding factors won&#39;t match number of columns</span></span>
<span id="cb107-145"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-145" aria-hidden="true" tabindex="-1"></a>  <span class="co"># of X_df)</span></span>
<span id="cb107-146"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-146" aria-hidden="true" tabindex="-1"></a>  X_df<span class="sc">$</span>cyl <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(X_df<span class="sc">$</span>cyl)</span>
<span id="cb107-147"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-147" aria-hidden="true" tabindex="-1"></a>  X_df<span class="sc">$</span>vs <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(X_df<span class="sc">$</span>vs)</span>
<span id="cb107-148"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-148" aria-hidden="true" tabindex="-1"></a>  X_df<span class="sc">$</span>am <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(X_df<span class="sc">$</span>am)</span>
<span id="cb107-149"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-149" aria-hidden="true" tabindex="-1"></a>  X_df<span class="sc">$</span>gear <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(X_df<span class="sc">$</span>gear)</span>
<span id="cb107-150"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-150" aria-hidden="true" tabindex="-1"></a>  X_df<span class="sc">$</span>carb <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(X_df<span class="sc">$</span>carb)</span>
<span id="cb107-151"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-152"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-152" aria-hidden="true" tabindex="-1"></a>  css_res_df <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>X_df[selec_inds, ], <span class="at">y=</span>y[selec_inds], <span class="at">lambda=</span><span class="fl">0.01</span>, <span class="at">B =</span> <span class="dv">10</span>)</span>
<span id="cb107-153"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-153" aria-hidden="true" tabindex="-1"></a>  res_df <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkFormCssDesignInputs'>checkFormCssDesignInputs</a>(<span class="at">css_results=</span>css_res_df,</span>
<span id="cb107-154"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-154" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">weighting=</span><span class="st">&quot;weighted_avg&quot;</span>, <span class="at">cutoff=</span><span class="fl">0.3</span>,</span>
<span id="cb107-155"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-155" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">min_num_clusts=</span><span class="dv">1</span>, <span class="at">max_num_clusts=</span><span class="dv">4</span>,</span>
<span id="cb107-156"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-156" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">newx=</span>X_df[fit_inds, ])</span>
<span id="cb107-157"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-158"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-158" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res_df))</span>
<span id="cb107-159"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-159" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(res_df), <span class="fu">c</span>(<span class="st">&quot;newx&quot;</span>, <span class="st">&quot;max_num_clusts&quot;</span>))</span>
<span id="cb107-160"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-160" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-161"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-161" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res_df<span class="sc">$</span>newx))</span>
<span id="cb107-162"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-162" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(res_df<span class="sc">$</span>newx))</span>
<span id="cb107-163"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-163" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_null</span>(<span class="fu">colnames</span>(res_df<span class="sc">$</span>newx))</span>
<span id="cb107-164"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-164" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(res_df<span class="sc">$</span>newx), <span class="fu">length</span>(fit_inds))</span>
<span id="cb107-165"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-165" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">ncol</span>(res_df<span class="sc">$</span>newx), <span class="fu">ncol</span>(css_res_df<span class="sc">$</span>X))</span>
<span id="cb107-166"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-166" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-167"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-167" aria-hidden="true" tabindex="-1"></a>  <span class="do">##### Try other bad inputs</span></span>
<span id="cb107-168"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-168" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-169"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(x_new) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb107-170"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-170" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-171"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-171" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkFormCssDesignInputs'>checkFormCssDesignInputs</a>(<span class="at">css_results=</span>css_res,</span>
<span id="cb107-172"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-172" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">weighting=</span><span class="st">&quot;weighted_avg&quot;</span>,</span>
<span id="cb107-173"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-173" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cutoff=</span><span class="sc">-</span><span class="fl">0.3</span>, <span class="at">min_num_clusts=</span><span class="dv">1</span>,</span>
<span id="cb107-174"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-174" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">max_num_clusts=</span><span class="dv">4</span>,</span>
<span id="cb107-175"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-175" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">newx=</span>x_new),</span>
<span id="cb107-176"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-176" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;cutoff &gt;= 0 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb107-177"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-178"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-178" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkFormCssDesignInputs'>checkFormCssDesignInputs</a>(<span class="at">css_results=</span>css_res,</span>
<span id="cb107-179"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-179" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">weighting=</span><span class="st">&quot;sparse&quot;</span>,</span>
<span id="cb107-180"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-180" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cutoff=</span><span class="st">&quot;0.5&quot;</span>,</span>
<span id="cb107-181"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-181" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">min_num_clusts=</span><span class="dv">1</span>,</span>
<span id="cb107-182"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-182" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">max_num_clusts=</span><span class="cn">NA</span>, <span class="at">newx=</span>x_new),</span>
<span id="cb107-183"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-183" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;is.numeric(cutoff) | is.integer(cutoff) is not TRUE&quot;</span>,</span>
<span id="cb107-184"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-184" aria-hidden="true" tabindex="-1"></a>                        <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb107-185"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-185" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-186"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-186" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkFormCssDesignInputs'>checkFormCssDesignInputs</a>(<span class="at">css_results=</span>css_res,</span>
<span id="cb107-187"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-187" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">weighting=</span><span class="st">&quot;sparse&quot;</span>,</span>
<span id="cb107-188"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-188" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cutoff=</span><span class="fu">as.numeric</span>(<span class="cn">NA</span>),</span>
<span id="cb107-189"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-189" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">min_num_clusts=</span><span class="dv">1</span>,</span>
<span id="cb107-190"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-190" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">max_num_clusts=</span><span class="cn">NA</span>,</span>
<span id="cb107-191"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-191" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">newx=</span>x_new),</span>
<span id="cb107-192"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-192" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;!is.na(cutoff) is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb107-193"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-193" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-194"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-194" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkFormCssDesignInputs'>checkFormCssDesignInputs</a>(<span class="at">css_results=</span>css_res,</span>
<span id="cb107-195"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-195" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">weighting=</span><span class="fu">c</span>(<span class="st">&quot;sparse&quot;</span>,</span>
<span id="cb107-196"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-196" aria-hidden="true" tabindex="-1"></a>                                                              <span class="st">&quot;simple_avg&quot;</span>),</span>
<span id="cb107-197"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-197" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cutoff=</span><span class="fl">0.2</span>,</span>
<span id="cb107-198"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-198" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">min_num_clusts=</span><span class="dv">1</span>,</span>
<span id="cb107-199"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-199" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">max_num_clusts=</span><span class="cn">NA</span>,</span>
<span id="cb107-200"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-200" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">newx=</span>x_new),</span>
<span id="cb107-201"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-201" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;length(weighting) == 1 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb107-202"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-202" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-203"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-203" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkFormCssDesignInputs'>checkFormCssDesignInputs</a>(<span class="at">css_results=</span>css_res,</span>
<span id="cb107-204"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-204" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">weighting=</span><span class="dv">1</span>,</span>
<span id="cb107-205"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-205" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cutoff=</span><span class="fl">0.2</span>,</span>
<span id="cb107-206"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-206" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">min_num_clusts=</span><span class="dv">1</span>,</span>
<span id="cb107-207"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-207" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">max_num_clusts=</span><span class="cn">NA</span>,</span>
<span id="cb107-208"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-208" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">newx=</span>x_new),</span>
<span id="cb107-209"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-209" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;Weighting must be a character&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb107-210"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-210" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-211"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-211" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkFormCssDesignInputs'>checkFormCssDesignInputs</a>(<span class="at">css_results=</span>css_res,</span>
<span id="cb107-212"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-212" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">weighting=</span><span class="st">&quot;spasre&quot;</span>,</span>
<span id="cb107-213"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-213" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cutoff=</span><span class="fl">0.2</span>,</span>
<span id="cb107-214"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-214" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">min_num_clusts=</span><span class="dv">1</span>,</span>
<span id="cb107-215"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-215" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">max_num_clusts=</span><span class="cn">NA</span>,</span>
<span id="cb107-216"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-216" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">newx=</span>x_new),</span>
<span id="cb107-217"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-217" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;Weighting must be a character and one of sparse, simple_avg, or weighted_avg&quot;</span>,</span>
<span id="cb107-218"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-218" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb107-219"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-219" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-220"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-220" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkFormCssDesignInputs'>checkFormCssDesignInputs</a>(<span class="at">css_results=</span>css_res,</span>
<span id="cb107-221"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-221" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">weighting=</span><span class="st">&quot;weighted_avg&quot;</span>,</span>
<span id="cb107-222"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-222" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cutoff=</span><span class="fl">0.2</span>,</span>
<span id="cb107-223"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-223" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">min_num_clusts=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb107-224"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-224" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">max_num_clusts=</span><span class="cn">NA</span>,</span>
<span id="cb107-225"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-225" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">newx=</span>x_new),</span>
<span id="cb107-226"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-226" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;length(min_num_clusts) == 1 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb107-227"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-227" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-228"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-228" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkFormCssDesignInputs'>checkFormCssDesignInputs</a>(<span class="at">css_results=</span>css_res,</span>
<span id="cb107-229"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-229" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">weighting=</span><span class="st">&quot;weighted_avg&quot;</span>,</span>
<span id="cb107-230"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-230" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cutoff=</span><span class="fl">0.2</span>,</span>
<span id="cb107-231"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-231" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">min_num_clusts=</span><span class="st">&quot;3&quot;</span>,</span>
<span id="cb107-232"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-232" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">max_num_clusts=</span><span class="cn">NA</span>,</span>
<span id="cb107-233"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-233" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">newx=</span>x_new),</span>
<span id="cb107-234"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-234" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;is.numeric(min_num_clusts) | is.integer(min_num_clusts) is not TRUE&quot;</span>,</span>
<span id="cb107-235"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-235" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb107-236"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-237"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-237" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkFormCssDesignInputs'>checkFormCssDesignInputs</a>(<span class="at">css_results=</span>css_res,</span>
<span id="cb107-238"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-238" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">weighting=</span><span class="st">&quot;weighted_avg&quot;</span>,</span>
<span id="cb107-239"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-239" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cutoff=</span><span class="fl">0.2</span>,</span>
<span id="cb107-240"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-240" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">min_num_clusts=</span><span class="dv">0</span>,</span>
<span id="cb107-241"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-241" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">max_num_clusts=</span><span class="cn">NA</span>,</span>
<span id="cb107-242"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-242" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">newx=</span>x_new),</span>
<span id="cb107-243"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-243" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;min_num_clusts &gt;= 1 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb107-244"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-245"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-245" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkFormCssDesignInputs'>checkFormCssDesignInputs</a>(<span class="at">css_results=</span>css_res,</span>
<span id="cb107-246"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-246" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">weighting=</span><span class="st">&quot;weighted_avg&quot;</span>,</span>
<span id="cb107-247"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-247" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cutoff=</span><span class="fl">0.2</span>,</span>
<span id="cb107-248"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-248" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">min_num_clusts=</span><span class="dv">6</span>,</span>
<span id="cb107-249"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-249" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">max_num_clusts=</span><span class="cn">NA</span>,</span>
<span id="cb107-250"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-250" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">newx=</span>x_new),</span>
<span id="cb107-251"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-251" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;min_num_clusts &lt;= n_clusters is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb107-252"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-252" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-253"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-253" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-254"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-254" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkFormCssDesignInputs'>checkFormCssDesignInputs</a>(<span class="at">css_results=</span>css_res,</span>
<span id="cb107-255"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-255" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">weighting=</span><span class="st">&quot;weighted_avg&quot;</span>,</span>
<span id="cb107-256"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-256" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cutoff=</span><span class="fl">0.2</span>,</span>
<span id="cb107-257"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-257" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">min_num_clusts=</span><span class="dv">1</span>,</span>
<span id="cb107-258"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-258" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">max_num_clusts=</span><span class="st">&quot;4&quot;</span>,</span>
<span id="cb107-259"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-259" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">newx=</span>x_new),</span>
<span id="cb107-260"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-260" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;is.numeric(max_num_clusts) | is.integer(max_num_clusts) is not TRUE&quot;</span>,</span>
<span id="cb107-261"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-261" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb107-262"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-262" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-263"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-263" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkFormCssDesignInputs'>checkFormCssDesignInputs</a>(<span class="at">css_results=</span>css_res,</span>
<span id="cb107-264"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-264" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">weighting=</span><span class="st">&quot;weighted_avg&quot;</span>,</span>
<span id="cb107-265"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-265" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cutoff=</span><span class="fl">0.2</span>,</span>
<span id="cb107-266"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-266" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">min_num_clusts=</span><span class="dv">1</span>,</span>
<span id="cb107-267"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-267" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">max_num_clusts=</span><span class="fl">3.5</span>,</span>
<span id="cb107-268"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-268" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">newx=</span>x_new),</span>
<span id="cb107-269"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-269" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;max_num_clusts == round(max_num_clusts) is not TRUE&quot;</span>,</span>
<span id="cb107-270"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-270" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb107-271"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-271" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-272"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-272" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkFormCssDesignInputs'>checkFormCssDesignInputs</a>(<span class="at">css_results=</span>css_res,</span>
<span id="cb107-273"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-273" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">weighting=</span><span class="st">&quot;weighted_avg&quot;</span>,</span>
<span id="cb107-274"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-274" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cutoff=</span><span class="fl">0.2</span>,</span>
<span id="cb107-275"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-275" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">min_num_clusts=</span><span class="dv">2</span>,</span>
<span id="cb107-276"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-276" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">max_num_clusts=</span><span class="dv">1</span>,</span>
<span id="cb107-277"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-277" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">newx=</span>x_new),</span>
<span id="cb107-278"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-278" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;max_num_clusts &gt;= min_num_clusts is not TRUE&quot;</span>,</span>
<span id="cb107-279"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-279" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb107-280"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-281"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-281" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkFormCssDesignInputs'>checkFormCssDesignInputs</a>(<span class="at">css_results=</span>css_res,</span>
<span id="cb107-282"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-282" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">weighting=</span><span class="st">&quot;weighted_avg&quot;</span>,</span>
<span id="cb107-283"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-283" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cutoff=</span><span class="fl">0.2</span>,</span>
<span id="cb107-284"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-284" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">min_num_clusts=</span><span class="dv">2</span>,</span>
<span id="cb107-285"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-285" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">max_num_clusts=</span><span class="dv">8</span>,</span>
<span id="cb107-286"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-286" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">newx=</span>x_new),</span>
<span id="cb107-287"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-287" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;max_num_clusts &lt;= p is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb107-288"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-289"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-289" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-290"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb107-290" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## Test passed 🥇</code></pre>
<p>Tests for formCssDesign</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-1" aria-hidden="true" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">test_that</span>(<span class="st">&quot;formCssDesign works&quot;</span>, {</span>
<span id="cb109-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">17230</span>)</span>
<span id="cb109-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-4" aria-hidden="true" tabindex="-1"></a>  x_select <span class="ot">&lt;-</span> <span class="fu">matrix</span>(stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">10</span><span class="sc">*</span><span class="dv">6</span>), <span class="at">nrow=</span><span class="dv">10</span>, <span class="at">ncol=</span><span class="dv">6</span>)</span>
<span id="cb109-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-5" aria-hidden="true" tabindex="-1"></a>  x_new <span class="ot">&lt;-</span> <span class="fu">matrix</span>(stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">8</span><span class="sc">*</span><span class="dv">6</span>), <span class="at">nrow=</span><span class="dv">8</span>, <span class="at">ncol=</span><span class="dv">6</span>)</span>
<span id="cb109-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-6" aria-hidden="true" tabindex="-1"></a>  y_select <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">10</span>)</span>
<span id="cb109-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-7" aria-hidden="true" tabindex="-1"></a>  y_new <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">8</span>)</span>
<span id="cb109-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-9" aria-hidden="true" tabindex="-1"></a>  good_clusters <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;red&quot;</span><span class="ot">=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="st">&quot;blue&quot;</span><span class="ot">=</span><span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="st">&quot;green&quot;</span><span class="ot">=</span><span class="dv">5</span>)</span>
<span id="cb109-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-11" aria-hidden="true" tabindex="-1"></a>  css_res <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x_select, <span class="at">y=</span>y_select, <span class="at">lambda=</span><span class="fl">0.01</span>, <span class="at">clusters=</span>good_clusters,</span>
<span id="cb109-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">B =</span> <span class="dv">10</span>)</span>
<span id="cb109-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb109-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-14" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#formCssDesign'>formCssDesign</a>(css_res, <span class="at">newx=</span>x_new)</span>
<span id="cb109-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-16" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(res))</span>
<span id="cb109-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-17" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res))</span>
<span id="cb109-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-18" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(res), <span class="dv">8</span>)</span>
<span id="cb109-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-19" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">ncol</span>(res), <span class="fu">length</span>(css_res<span class="sc">$</span>clusters))</span>
<span id="cb109-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-20" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">colnames</span>(res) <span class="sc">%in%</span> <span class="fu">names</span>(css_res<span class="sc">$</span>clusters)))</span>
<span id="cb109-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-21" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">names</span>(css_res<span class="sc">$</span>clusters) <span class="sc">%in%</span> <span class="fu">colnames</span>(res)))</span>
<span id="cb109-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb109-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add training indices</span></span>
<span id="cb109-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-24" aria-hidden="true" tabindex="-1"></a>  css_res_train <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x_select, <span class="at">y=</span>y_select, <span class="at">lambda=</span><span class="fl">0.01</span>,</span>
<span id="cb109-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-25" aria-hidden="true" tabindex="-1"></a>                       <span class="at">clusters=</span>good_clusters, <span class="at">B=</span><span class="dv">10</span>, <span class="at">train_inds=</span><span class="dv">6</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb109-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Training indices should be ignored if new x is provided</span></span>
<span id="cb109-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-29" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#formCssDesign'>formCssDesign</a>(<span class="at">css_results=</span>css_res_train, <span class="at">weighting=</span><span class="st">&quot;weighted_avg&quot;</span>,</span>
<span id="cb109-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-30" aria-hidden="true" tabindex="-1"></a>                       <span class="at">cutoff=</span><span class="dv">0</span>, <span class="at">min_num_clusts=</span><span class="dv">2</span>, <span class="at">max_num_clusts=</span><span class="cn">NA</span>,</span>
<span id="cb109-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-31" aria-hidden="true" tabindex="-1"></a>                       <span class="at">newx=</span>x_new)</span>
<span id="cb109-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-33" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(res))</span>
<span id="cb109-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-34" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res))</span>
<span id="cb109-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-35" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(res), <span class="dv">8</span>)</span>
<span id="cb109-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-36" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">ncol</span>(res), <span class="fu">length</span>(css_res_train<span class="sc">$</span>clusters))</span>
<span id="cb109-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-37" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">colnames</span>(res) <span class="sc">%in%</span> <span class="fu">names</span>(css_res_train<span class="sc">$</span>clusters)))</span>
<span id="cb109-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-38" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">names</span>(css_res_train<span class="sc">$</span>clusters) <span class="sc">%in%</span> <span class="fu">colnames</span>(res)))</span>
<span id="cb109-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Things should still work if new x is not provided</span></span>
<span id="cb109-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-42" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#formCssDesign'>formCssDesign</a>(<span class="at">css_results=</span>css_res_train, <span class="at">weighting=</span><span class="st">&quot;weighted_avg&quot;</span>,</span>
<span id="cb109-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-43" aria-hidden="true" tabindex="-1"></a>                       <span class="at">cutoff=</span><span class="dv">0</span>, <span class="at">min_num_clusts=</span><span class="dv">2</span>, <span class="at">max_num_clusts=</span><span class="cn">NA</span>)</span>
<span id="cb109-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-45" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(res))</span>
<span id="cb109-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-46" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res))</span>
<span id="cb109-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-47" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(res), <span class="dv">5</span>)</span>
<span id="cb109-48"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-48" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">ncol</span>(res), <span class="fu">length</span>(css_res_train<span class="sc">$</span>clusters))</span>
<span id="cb109-49"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-49" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">colnames</span>(res) <span class="sc">%in%</span> <span class="fu">names</span>(css_res_train<span class="sc">$</span>clusters)))</span>
<span id="cb109-50"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-50" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">names</span>(css_res_train<span class="sc">$</span>clusters) <span class="sc">%in%</span> <span class="fu">colnames</span>(res)))</span>
<span id="cb109-51"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-52"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-52" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Try not providing training indices and omitting newx--should get error</span></span>
<span id="cb109-53"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-53" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#formCssDesign'>formCssDesign</a>(<span class="at">css_results=</span>css_res, <span class="at">weighting=</span><span class="st">&quot;sparse&quot;</span>,</span>
<span id="cb109-54"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-54" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">cutoff=</span><span class="fl">0.5</span>, <span class="at">min_num_clusts=</span><span class="dv">1</span>,</span>
<span id="cb109-55"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-55" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">max_num_clusts=</span><span class="dv">5</span>, <span class="at">newx=</span><span class="cn">NA</span>),</span>
<span id="cb109-56"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-56" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;If css was not provided with indices to set aside for model training, then newx must be provided to formCssDesign&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb109-57"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-58"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Try naming variables</span></span>
<span id="cb109-59"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-60"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(x_select) <span class="ot">&lt;-</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span>
<span id="cb109-61"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-61" aria-hidden="true" tabindex="-1"></a>  css_res_named <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x_select, <span class="at">y=</span>y_select, <span class="at">lambda=</span><span class="fl">0.01</span>,</span>
<span id="cb109-62"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-62" aria-hidden="true" tabindex="-1"></a>                       <span class="at">clusters=</span>good_clusters, <span class="at">B =</span> <span class="dv">10</span>)</span>
<span id="cb109-63"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-64"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-64" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Named variables for css matrix but not new one--should get a warning</span></span>
<span id="cb109-65"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-65" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_warning</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#formCssDesign'>formCssDesign</a>(<span class="at">css_results=</span>css_res_named,</span>
<span id="cb109-66"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-66" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">weighting=</span><span class="st">&quot;simple_avg&quot;</span>, <span class="at">cutoff=</span><span class="fl">0.9</span>,</span>
<span id="cb109-67"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-67" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">min_num_clusts=</span><span class="dv">1</span>, <span class="at">max_num_clusts=</span><span class="dv">3</span>,</span>
<span id="cb109-68"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-68" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">newx=</span>x_new),</span>
<span id="cb109-69"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-69" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;New X provided had no variable names (column names) even though the X provided to css did.&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb109-70"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-71"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-71" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Try mismatching variable names</span></span>
<span id="cb109-72"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(x_new) <span class="ot">&lt;-</span> LETTERS[<span class="dv">2</span><span class="sc">:</span><span class="dv">7</span>]</span>
<span id="cb109-73"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-73" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#formCssDesign'>formCssDesign</a>(<span class="at">css_results=</span>css_res_named,</span>
<span id="cb109-74"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-74" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">weighting=</span><span class="st">&quot;weighted_avg&quot;</span>, <span class="at">cutoff=</span><span class="fl">0.2</span>,</span>
<span id="cb109-75"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-75" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">min_num_clusts=</span><span class="dv">1</span>, <span class="at">max_num_clusts=</span><span class="dv">1</span>,</span>
<span id="cb109-76"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-76" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">newx=</span>x_new),</span>
<span id="cb109-77"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-77" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;identical(feat_names, colnames(css_X)) is not TRUE&quot;</span>,</span>
<span id="cb109-78"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-78" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb109-79"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-80"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(x_new) <span class="ot">&lt;-</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span>
<span id="cb109-81"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-82"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-82" aria-hidden="true" tabindex="-1"></a>  res_named <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#formCssDesign'>formCssDesign</a>(<span class="at">css_results=</span>css_res_named,</span>
<span id="cb109-83"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-83" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">weighting=</span><span class="st">&quot;sparse&quot;</span>, <span class="at">cutoff=</span><span class="fl">0.5</span>,</span>
<span id="cb109-84"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-84" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">min_num_clusts=</span><span class="dv">2</span>, <span class="at">max_num_clusts=</span><span class="cn">NA</span>,</span>
<span id="cb109-85"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-85" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">newx=</span>x_new)</span>
<span id="cb109-86"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-86" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb109-87"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-87" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(res_named))</span>
<span id="cb109-88"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-88" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res_named))</span>
<span id="cb109-89"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-89" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(res_named), <span class="dv">8</span>)</span>
<span id="cb109-90"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-90" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">ncol</span>(res_named) <span class="sc">&lt;=</span> <span class="fu">length</span>(css_res_named<span class="sc">$</span>clusters))</span>
<span id="cb109-91"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-91" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">colnames</span>(res_named) <span class="sc">%in%</span> <span class="fu">names</span>(css_res_named<span class="sc">$</span>clusters)))</span>
<span id="cb109-92"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-93"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-93" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Try data.frame input to css and formCssDesign</span></span>
<span id="cb109-94"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-95"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-95" aria-hidden="true" tabindex="-1"></a>  X_df <span class="ot">&lt;-</span> datasets<span class="sc">::</span>mtcars</span>
<span id="cb109-96"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-97"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-97" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(X_df)</span>
<span id="cb109-98"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-98" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">rnorm</span>(n)</span>
<span id="cb109-99"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-100"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-100" aria-hidden="true" tabindex="-1"></a>  selec_inds <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">round</span>(n<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb109-101"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-101" aria-hidden="true" tabindex="-1"></a>  fit_inds <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="dv">1</span><span class="sc">:</span>n, selec_inds)</span>
<span id="cb109-102"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-103"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-103" aria-hidden="true" tabindex="-1"></a>  css_res_df <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>X_df[selec_inds, ], <span class="at">y=</span>y[selec_inds], <span class="at">lambda=</span><span class="fl">0.01</span>, <span class="at">B =</span> <span class="dv">10</span>)</span>
<span id="cb109-104"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-104" aria-hidden="true" tabindex="-1"></a>  res_df <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#formCssDesign'>formCssDesign</a>(<span class="at">css_results=</span>css_res_df, <span class="at">weighting=</span><span class="st">&quot;simple_avg&quot;</span>,</span>
<span id="cb109-105"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-105" aria-hidden="true" tabindex="-1"></a>                          <span class="at">cutoff=</span><span class="fl">0.7</span>, <span class="at">min_num_clusts=</span><span class="dv">3</span>, <span class="at">max_num_clusts=</span><span class="cn">NA</span>,</span>
<span id="cb109-106"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-106" aria-hidden="true" tabindex="-1"></a>                          <span class="at">newx=</span>X_df[fit_inds, ])</span>
<span id="cb109-107"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-108"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-108" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(res_df))</span>
<span id="cb109-109"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-109" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res_df))</span>
<span id="cb109-110"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-110" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(res_df), <span class="fu">length</span>(fit_inds))</span>
<span id="cb109-111"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-111" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">ncol</span>(res_df) <span class="sc">&lt;=</span> <span class="fu">length</span>(css_res_df<span class="sc">$</span>clusters))</span>
<span id="cb109-112"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-112" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">colnames</span>(res_df) <span class="sc">%in%</span> <span class="fu">names</span>(css_res_df<span class="sc">$</span>clusters)))</span>
<span id="cb109-113"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-114"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-114" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Try again with X as a dataframe with factors (number of columns of final</span></span>
<span id="cb109-115"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-115" aria-hidden="true" tabindex="-1"></a>  <span class="co"># design matrix after one-hot encoding factors won&#39;t match number of columns</span></span>
<span id="cb109-116"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-116" aria-hidden="true" tabindex="-1"></a>  <span class="co"># of X_df)</span></span>
<span id="cb109-117"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-117" aria-hidden="true" tabindex="-1"></a>  X_df<span class="sc">$</span>cyl <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(X_df<span class="sc">$</span>cyl)</span>
<span id="cb109-118"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-118" aria-hidden="true" tabindex="-1"></a>  X_df<span class="sc">$</span>vs <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(X_df<span class="sc">$</span>vs)</span>
<span id="cb109-119"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-119" aria-hidden="true" tabindex="-1"></a>  X_df<span class="sc">$</span>am <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(X_df<span class="sc">$</span>am)</span>
<span id="cb109-120"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-120" aria-hidden="true" tabindex="-1"></a>  X_df<span class="sc">$</span>gear <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(X_df<span class="sc">$</span>gear)</span>
<span id="cb109-121"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-121" aria-hidden="true" tabindex="-1"></a>  X_df<span class="sc">$</span>carb <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(X_df<span class="sc">$</span>carb)</span>
<span id="cb109-122"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-123"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-123" aria-hidden="true" tabindex="-1"></a>  css_res_df <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>X_df[selec_inds, ], <span class="at">y=</span>y[selec_inds], <span class="at">lambda=</span><span class="fl">0.01</span>, <span class="at">B =</span> <span class="dv">10</span>)</span>
<span id="cb109-124"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-124" aria-hidden="true" tabindex="-1"></a>  res_df <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#formCssDesign'>formCssDesign</a>(<span class="at">css_results=</span>css_res_df, <span class="at">weighting=</span><span class="st">&quot;weighted_avg&quot;</span>,</span>
<span id="cb109-125"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-125" aria-hidden="true" tabindex="-1"></a>                          <span class="at">cutoff=</span><span class="fl">0.3</span>, <span class="at">min_num_clusts=</span><span class="dv">1</span>, <span class="at">max_num_clusts=</span><span class="dv">4</span>,</span>
<span id="cb109-126"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-126" aria-hidden="true" tabindex="-1"></a>                          <span class="at">newx=</span>X_df[fit_inds, ])</span>
<span id="cb109-127"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-128"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-128" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(res_df))</span>
<span id="cb109-129"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-129" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res_df))</span>
<span id="cb109-130"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-130" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(res_df), <span class="fu">length</span>(fit_inds))</span>
<span id="cb109-131"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-131" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">ncol</span>(res_df) <span class="sc">&lt;=</span> <span class="fu">length</span>(css_res_df<span class="sc">$</span>clusters))</span>
<span id="cb109-132"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-132" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">colnames</span>(res_df) <span class="sc">%in%</span> <span class="fu">names</span>(css_res_df<span class="sc">$</span>clusters)))</span>
<span id="cb109-133"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-134"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-134" aria-hidden="true" tabindex="-1"></a>  <span class="do">##### Try other bad inputs</span></span>
<span id="cb109-135"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-136"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(x_new) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb109-137"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-138"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-138" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#formCssDesign'>formCssDesign</a>(<span class="at">css_results=</span>css_res, <span class="at">cutoff=</span><span class="sc">-</span><span class="fl">0.3</span>,</span>
<span id="cb109-139"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-139" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">newx=</span>x_new), <span class="st">&quot;cutoff &gt;= 0 is not TRUE&quot;</span>,</span>
<span id="cb109-140"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-140" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb109-141"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-142"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-142" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#formCssDesign'>formCssDesign</a>(<span class="at">css_results=</span>css_res, <span class="at">cutoff=</span><span class="st">&quot;0.5&quot;</span>,</span>
<span id="cb109-143"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-143" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">newx=</span>x_new),</span>
<span id="cb109-144"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-144" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;is.numeric(cutoff) | is.integer(cutoff) is not TRUE&quot;</span>,</span>
<span id="cb109-145"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-145" aria-hidden="true" tabindex="-1"></a>                        <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb109-146"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-147"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-147" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#formCssDesign'>formCssDesign</a>(<span class="at">css_results=</span>css_res,</span>
<span id="cb109-148"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-148" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">cutoff=</span><span class="fu">as.numeric</span>(<span class="cn">NA</span>), <span class="at">newx=</span>x_new),</span>
<span id="cb109-149"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-149" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;!is.na(cutoff) is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb109-150"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-151"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-151" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#formCssDesign'>formCssDesign</a>(<span class="at">css_results=</span>css_res,</span>
<span id="cb109-152"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-152" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">weighting=</span><span class="fu">c</span>(<span class="st">&quot;sparse&quot;</span>, <span class="st">&quot;simple_avg&quot;</span>),</span>
<span id="cb109-153"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-153" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">newx=</span>x_new),</span>
<span id="cb109-154"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-154" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;length(weighting) == 1 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb109-155"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-156"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-156" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#formCssDesign'>formCssDesign</a>(<span class="at">css_results=</span>css_res, <span class="at">weighting=</span><span class="dv">1</span>,</span>
<span id="cb109-157"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-157" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">newx=</span>x_new),</span>
<span id="cb109-158"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-158" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;Weighting must be a character&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb109-159"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-160"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-160" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#formCssDesign'>formCssDesign</a>(<span class="at">css_results=</span>css_res, <span class="at">weighting=</span><span class="st">&quot;spasre&quot;</span>,</span>
<span id="cb109-161"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-161" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">newx=</span>x_new),</span>
<span id="cb109-162"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-162" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;Weighting must be a character and one of sparse, simple_avg, or weighted_avg&quot;</span>,</span>
<span id="cb109-163"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-163" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb109-164"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-165"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-165" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#formCssDesign'>formCssDesign</a>(<span class="at">css_results=</span>css_res,</span>
<span id="cb109-166"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-166" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">min_num_clusts=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">newx=</span>x_new),</span>
<span id="cb109-167"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-167" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;length(min_num_clusts) == 1 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb109-168"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-169"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-169" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#formCssDesign'>formCssDesign</a>(<span class="at">css_results=</span>css_res, <span class="at">min_num_clusts=</span><span class="st">&quot;3&quot;</span>,</span>
<span id="cb109-170"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-170" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">newx=</span>x_new),</span>
<span id="cb109-171"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-171" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;is.numeric(min_num_clusts) | is.integer(min_num_clusts) is not TRUE&quot;</span>,</span>
<span id="cb109-172"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-172" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb109-173"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-174"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-174" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#formCssDesign'>formCssDesign</a>(<span class="at">css_results=</span>css_res, <span class="at">min_num_clusts=</span><span class="dv">0</span>,</span>
<span id="cb109-175"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-175" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">newx=</span>x_new),</span>
<span id="cb109-176"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-176" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;min_num_clusts &gt;= 1 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb109-177"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-178"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-178" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#formCssDesign'>formCssDesign</a>(<span class="at">css_results=</span>css_res, <span class="at">min_num_clusts=</span><span class="dv">6</span>,</span>
<span id="cb109-179"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-179" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">newx=</span>x_new),</span>
<span id="cb109-180"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-180" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;min_num_clusts &lt;= n_clusters is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb109-181"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-182"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-183"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-183" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#formCssDesign'>formCssDesign</a>(<span class="at">css_results=</span>css_res, <span class="at">max_num_clusts=</span><span class="st">&quot;4&quot;</span>,</span>
<span id="cb109-184"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-184" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">newx=</span>x_new),</span>
<span id="cb109-185"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-185" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;is.numeric(max_num_clusts) | is.integer(max_num_clusts) is not TRUE&quot;</span>,</span>
<span id="cb109-186"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-186" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb109-187"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-188"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-188" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#formCssDesign'>formCssDesign</a>(<span class="at">css_results=</span>css_res, <span class="at">max_num_clusts=</span><span class="fl">3.5</span>,</span>
<span id="cb109-189"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-189" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">newx=</span>x_new),</span>
<span id="cb109-190"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-190" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;max_num_clusts == round(max_num_clusts) is not TRUE&quot;</span>,</span>
<span id="cb109-191"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-191" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb109-192"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-193"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-193" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#formCssDesign'>formCssDesign</a>(<span class="at">css_results=</span>css_res, <span class="at">min_num_clusts=</span><span class="dv">2</span>,</span>
<span id="cb109-194"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-194" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">max_num_clusts=</span><span class="dv">1</span>, <span class="at">newx=</span>x_new),</span>
<span id="cb109-195"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-195" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;max_num_clusts &gt;= min_num_clusts is not TRUE&quot;</span>,</span>
<span id="cb109-196"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-196" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb109-197"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-198"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-198" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#formCssDesign'>formCssDesign</a>(<span class="at">css_results=</span>css_res, <span class="at">max_num_clusts=</span><span class="dv">8</span>,</span>
<span id="cb109-199"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-199" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">newx=</span>x_new),</span>
<span id="cb109-200"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-200" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;max_num_clusts &lt;= p is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb109-201"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-202"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-202" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb109-203"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb109-203" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## Test passed 🥇</code></pre>
<p>Finally, tests for getCssDesign</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-1" aria-hidden="true" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">test_that</span>(<span class="st">&quot;getCssDesign works&quot;</span>, {</span>
<span id="cb111-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">23170</span>)</span>
<span id="cb111-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-4" aria-hidden="true" tabindex="-1"></a>  x_select <span class="ot">&lt;-</span> <span class="fu">matrix</span>(stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">10</span><span class="sc">*</span><span class="dv">6</span>), <span class="at">nrow=</span><span class="dv">10</span>, <span class="at">ncol=</span><span class="dv">6</span>)</span>
<span id="cb111-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-5" aria-hidden="true" tabindex="-1"></a>  x_new <span class="ot">&lt;-</span> <span class="fu">matrix</span>(stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">8</span><span class="sc">*</span><span class="dv">6</span>), <span class="at">nrow=</span><span class="dv">8</span>, <span class="at">ncol=</span><span class="dv">6</span>)</span>
<span id="cb111-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-6" aria-hidden="true" tabindex="-1"></a>  y_select <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">10</span>)</span>
<span id="cb111-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-7" aria-hidden="true" tabindex="-1"></a>  y_new <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">8</span>)</span>
<span id="cb111-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-9" aria-hidden="true" tabindex="-1"></a>  good_clusters <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;red&quot;</span><span class="ot">=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="st">&quot;blue&quot;</span><span class="ot">=</span><span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="st">&quot;green&quot;</span><span class="ot">=</span><span class="dv">5</span>)</span>
<span id="cb111-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-11" aria-hidden="true" tabindex="-1"></a>  css_res <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x_select, <span class="at">y=</span>y_select, <span class="at">lambda=</span><span class="fl">0.01</span>, <span class="at">clusters=</span>good_clusters,</span>
<span id="cb111-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">B =</span> <span class="dv">10</span>)</span>
<span id="cb111-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-14" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssDesign'>getCssDesign</a>(css_res, <span class="at">newX=</span>x_new)</span>
<span id="cb111-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-16" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(res))</span>
<span id="cb111-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-17" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res))</span>
<span id="cb111-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-18" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(res), <span class="dv">8</span>)</span>
<span id="cb111-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-19" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">ncol</span>(res), <span class="fu">length</span>(css_res<span class="sc">$</span>clusters))</span>
<span id="cb111-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-20" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">colnames</span>(res) <span class="sc">%in%</span> <span class="fu">names</span>(css_res<span class="sc">$</span>clusters)))</span>
<span id="cb111-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-21" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">names</span>(css_res<span class="sc">$</span>clusters) <span class="sc">%in%</span> <span class="fu">colnames</span>(res)))</span>
<span id="cb111-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb111-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add training indices</span></span>
<span id="cb111-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-24" aria-hidden="true" tabindex="-1"></a>  css_res_train <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x_select, <span class="at">y=</span>y_select, <span class="at">lambda=</span><span class="fl">0.01</span>,</span>
<span id="cb111-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-25" aria-hidden="true" tabindex="-1"></a>                       <span class="at">clusters=</span>good_clusters, <span class="at">B=</span><span class="dv">10</span>, <span class="at">train_inds=</span><span class="dv">6</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb111-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Training indices should be ignored if new x is provided</span></span>
<span id="cb111-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-29" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssDesign'>getCssDesign</a>(<span class="at">css_results=</span>css_res_train, <span class="at">weighting=</span><span class="st">&quot;weighted_avg&quot;</span>,</span>
<span id="cb111-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-30" aria-hidden="true" tabindex="-1"></a>                      <span class="at">min_num_clusts=</span><span class="dv">2</span>, <span class="at">newX=</span>x_new)</span>
<span id="cb111-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-32" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(res))</span>
<span id="cb111-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-33" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res))</span>
<span id="cb111-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-34" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(res), <span class="dv">8</span>)</span>
<span id="cb111-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-35" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">ncol</span>(res), <span class="fu">length</span>(css_res_train<span class="sc">$</span>clusters))</span>
<span id="cb111-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-36" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">colnames</span>(res) <span class="sc">%in%</span> <span class="fu">names</span>(css_res_train<span class="sc">$</span>clusters)))</span>
<span id="cb111-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-37" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">names</span>(css_res_train<span class="sc">$</span>clusters) <span class="sc">%in%</span> <span class="fu">colnames</span>(res)))</span>
<span id="cb111-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Things should still work if new x is not provided</span></span>
<span id="cb111-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-41" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssDesign'>getCssDesign</a>(<span class="at">css_results=</span>css_res_train, <span class="at">min_num_clusts=</span><span class="dv">2</span>)</span>
<span id="cb111-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-43" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(res))</span>
<span id="cb111-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-44" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res))</span>
<span id="cb111-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-45" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(res), <span class="dv">5</span>)</span>
<span id="cb111-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-46" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">ncol</span>(res), <span class="fu">length</span>(css_res_train<span class="sc">$</span>clusters))</span>
<span id="cb111-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-47" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">colnames</span>(res) <span class="sc">%in%</span> <span class="fu">names</span>(css_res_train<span class="sc">$</span>clusters)))</span>
<span id="cb111-48"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-48" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">names</span>(css_res_train<span class="sc">$</span>clusters) <span class="sc">%in%</span> <span class="fu">colnames</span>(res)))</span>
<span id="cb111-49"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-50"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Try not providing training indices and omitting newX--should get error</span></span>
<span id="cb111-51"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-51" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssDesign'>getCssDesign</a>(<span class="at">css_results=</span>css_res, <span class="at">weighting=</span><span class="st">&quot;sparse&quot;</span>,</span>
<span id="cb111-52"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-52" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">cutoff=</span><span class="fl">0.5</span>, <span class="at">min_num_clusts=</span><span class="dv">1</span>,</span>
<span id="cb111-53"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-53" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">max_num_clusts=</span><span class="dv">5</span>, <span class="at">newX=</span><span class="cn">NA</span>),</span>
<span id="cb111-54"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-54" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;css was not provided with indices to set aside for model training (train_inds), so must provide new X in order to generate a design matrix&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb111-55"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-56"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-56" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Try naming variables</span></span>
<span id="cb111-57"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-58"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(x_select) <span class="ot">&lt;-</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span>
<span id="cb111-59"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-59" aria-hidden="true" tabindex="-1"></a>  css_res_named <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x_select, <span class="at">y=</span>y_select, <span class="at">lambda=</span><span class="fl">0.01</span>,</span>
<span id="cb111-60"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-60" aria-hidden="true" tabindex="-1"></a>                       <span class="at">clusters=</span>good_clusters, <span class="at">B =</span> <span class="dv">10</span>)</span>
<span id="cb111-61"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-62"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-62" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Named variables for css matrix but not new one--should get a warning</span></span>
<span id="cb111-63"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-63" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_warning</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssDesign'>getCssDesign</a>(<span class="at">css_results=</span>css_res_named,</span>
<span id="cb111-64"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-64" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">weighting=</span><span class="st">&quot;simple_avg&quot;</span>, <span class="at">cutoff=</span><span class="fl">0.9</span>,</span>
<span id="cb111-65"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-65" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">min_num_clusts=</span><span class="dv">1</span>, <span class="at">max_num_clusts=</span><span class="dv">3</span>,</span>
<span id="cb111-66"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-66" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">newX=</span>x_new),</span>
<span id="cb111-67"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-67" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;New X provided had no variable names (column names) even though the X provided to css did.&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb111-68"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-69"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-69" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Try mismatching variable names</span></span>
<span id="cb111-70"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(x_new) <span class="ot">&lt;-</span> LETTERS[<span class="dv">2</span><span class="sc">:</span><span class="dv">7</span>]</span>
<span id="cb111-71"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-71" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssDesign'>getCssDesign</a>(<span class="at">css_results=</span>css_res_named,</span>
<span id="cb111-72"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-72" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">weighting=</span><span class="st">&quot;weighted_avg&quot;</span>, <span class="at">cutoff=</span><span class="fl">0.2</span>,</span>
<span id="cb111-73"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-73" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">min_num_clusts=</span><span class="dv">1</span>, <span class="at">max_num_clusts=</span><span class="dv">1</span>,</span>
<span id="cb111-74"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-74" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">newX=</span>x_new),</span>
<span id="cb111-75"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-75" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;identical(feat_names, colnames(css_X)) is not TRUE&quot;</span>,</span>
<span id="cb111-76"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-76" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb111-77"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-78"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(x_new) <span class="ot">&lt;-</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span>
<span id="cb111-79"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-80"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-80" aria-hidden="true" tabindex="-1"></a>  res_named <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssDesign'>getCssDesign</a>(<span class="at">css_results=</span>css_res_named, <span class="at">weighting=</span><span class="st">&quot;sparse&quot;</span>,</span>
<span id="cb111-81"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-81" aria-hidden="true" tabindex="-1"></a>                            <span class="at">cutoff=</span><span class="fl">0.5</span>, <span class="at">min_num_clusts=</span><span class="dv">2</span>, <span class="at">max_num_clusts=</span><span class="cn">NA</span>,</span>
<span id="cb111-82"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-82" aria-hidden="true" tabindex="-1"></a>                            <span class="at">newX=</span>x_new)</span>
<span id="cb111-83"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-84"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-84" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(res_named))</span>
<span id="cb111-85"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-85" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res_named))</span>
<span id="cb111-86"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-86" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(res_named), <span class="dv">8</span>)</span>
<span id="cb111-87"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-87" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">ncol</span>(res_named) <span class="sc">&lt;=</span> <span class="fu">length</span>(css_res_named<span class="sc">$</span>clusters))</span>
<span id="cb111-88"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-88" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">colnames</span>(res_named) <span class="sc">%in%</span> <span class="fu">names</span>(css_res_named<span class="sc">$</span>clusters)))</span>
<span id="cb111-89"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-90"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-90" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Try data.frame input to css and getCssDesign</span></span>
<span id="cb111-91"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-92"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-92" aria-hidden="true" tabindex="-1"></a>  X_df <span class="ot">&lt;-</span> datasets<span class="sc">::</span>mtcars</span>
<span id="cb111-93"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-94"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-94" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(X_df)</span>
<span id="cb111-95"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-95" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">rnorm</span>(n)</span>
<span id="cb111-96"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-97"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-97" aria-hidden="true" tabindex="-1"></a>  selec_inds <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">round</span>(n<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb111-98"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-98" aria-hidden="true" tabindex="-1"></a>  fit_inds <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="dv">1</span><span class="sc">:</span>n, selec_inds)</span>
<span id="cb111-99"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-100"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-100" aria-hidden="true" tabindex="-1"></a>  css_res_df <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>X_df[selec_inds, ], <span class="at">y=</span>y[selec_inds], <span class="at">lambda=</span><span class="fl">0.01</span>, <span class="at">B =</span> <span class="dv">10</span>)</span>
<span id="cb111-101"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-101" aria-hidden="true" tabindex="-1"></a>  res_df <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssDesign'>getCssDesign</a>(<span class="at">css_results=</span>css_res_df, <span class="at">weighting=</span><span class="st">&quot;simple_avg&quot;</span>,</span>
<span id="cb111-102"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-102" aria-hidden="true" tabindex="-1"></a>                          <span class="at">cutoff=</span><span class="fl">0.7</span>, <span class="at">min_num_clusts=</span><span class="dv">3</span>, <span class="at">max_num_clusts=</span><span class="cn">NA</span>,</span>
<span id="cb111-103"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-103" aria-hidden="true" tabindex="-1"></a>                          <span class="at">newX=</span>X_df[fit_inds, ])</span>
<span id="cb111-104"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-105"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-105" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(res_df))</span>
<span id="cb111-106"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-106" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res_df))</span>
<span id="cb111-107"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-107" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(res_df), <span class="fu">length</span>(fit_inds))</span>
<span id="cb111-108"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-108" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">ncol</span>(res_df) <span class="sc">&lt;=</span> <span class="fu">length</span>(css_res_df<span class="sc">$</span>clusters))</span>
<span id="cb111-109"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-109" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">colnames</span>(res_df) <span class="sc">%in%</span> <span class="fu">names</span>(css_res_df<span class="sc">$</span>clusters)))</span>
<span id="cb111-110"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-111"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-111" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Try again with X as a dataframe with factors (number of columns of final</span></span>
<span id="cb111-112"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-112" aria-hidden="true" tabindex="-1"></a>  <span class="co"># design matrix after one-hot encoding factors won&#39;t match number of columns</span></span>
<span id="cb111-113"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-113" aria-hidden="true" tabindex="-1"></a>  <span class="co"># of X_df)</span></span>
<span id="cb111-114"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-114" aria-hidden="true" tabindex="-1"></a>  X_df<span class="sc">$</span>cyl <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(X_df<span class="sc">$</span>cyl)</span>
<span id="cb111-115"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-115" aria-hidden="true" tabindex="-1"></a>  X_df<span class="sc">$</span>vs <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(X_df<span class="sc">$</span>vs)</span>
<span id="cb111-116"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-116" aria-hidden="true" tabindex="-1"></a>  X_df<span class="sc">$</span>am <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(X_df<span class="sc">$</span>am)</span>
<span id="cb111-117"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-117" aria-hidden="true" tabindex="-1"></a>  X_df<span class="sc">$</span>gear <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(X_df<span class="sc">$</span>gear)</span>
<span id="cb111-118"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-118" aria-hidden="true" tabindex="-1"></a>  X_df<span class="sc">$</span>carb <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(X_df<span class="sc">$</span>carb)</span>
<span id="cb111-119"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-120"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-120" aria-hidden="true" tabindex="-1"></a>  css_res_df <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>X_df[selec_inds, ], <span class="at">y=</span>y[selec_inds], <span class="at">lambda=</span><span class="fl">0.01</span>, <span class="at">B =</span> <span class="dv">10</span>)</span>
<span id="cb111-121"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-121" aria-hidden="true" tabindex="-1"></a>  res_df <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssDesign'>getCssDesign</a>(<span class="at">css_results=</span>css_res_df, <span class="at">weighting=</span><span class="st">&quot;weighted_avg&quot;</span>,</span>
<span id="cb111-122"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-122" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cutoff=</span><span class="fl">0.3</span>, <span class="at">min_num_clusts=</span><span class="dv">1</span>, <span class="at">max_num_clusts=</span><span class="dv">4</span>,</span>
<span id="cb111-123"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-123" aria-hidden="true" tabindex="-1"></a>                         <span class="at">newX=</span>X_df[fit_inds, ])</span>
<span id="cb111-124"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-125"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-125" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(res_df))</span>
<span id="cb111-126"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-126" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res_df))</span>
<span id="cb111-127"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-127" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(res_df), <span class="fu">length</span>(fit_inds))</span>
<span id="cb111-128"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-128" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">ncol</span>(res_df) <span class="sc">&lt;=</span> <span class="fu">length</span>(css_res_df<span class="sc">$</span>clusters))</span>
<span id="cb111-129"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-129" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">colnames</span>(res_df) <span class="sc">%in%</span> <span class="fu">names</span>(css_res_df<span class="sc">$</span>clusters)))</span>
<span id="cb111-130"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-131"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-131" aria-hidden="true" tabindex="-1"></a>  <span class="do">##### Try other bad inputs</span></span>
<span id="cb111-132"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-133"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(x_new) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb111-134"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-135"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-135" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssDesign'>getCssDesign</a>(<span class="at">css_results=</span>css_res, <span class="at">cutoff=</span><span class="sc">-</span><span class="fl">0.3</span>,</span>
<span id="cb111-136"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-136" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">newX=</span>x_new), <span class="st">&quot;cutoff &gt;= 0 is not TRUE&quot;</span>,</span>
<span id="cb111-137"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-137" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb111-138"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-139"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-139" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssDesign'>getCssDesign</a>(<span class="at">css_results=</span>css_res, <span class="at">cutoff=</span><span class="st">&quot;0.5&quot;</span>,</span>
<span id="cb111-140"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-140" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">newX=</span>x_new),</span>
<span id="cb111-141"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-141" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;is.numeric(cutoff) | is.integer(cutoff) is not TRUE&quot;</span>,</span>
<span id="cb111-142"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-142" aria-hidden="true" tabindex="-1"></a>                        <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb111-143"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-144"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-144" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssDesign'>getCssDesign</a>(<span class="at">css_results=</span>css_res,</span>
<span id="cb111-145"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-145" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">cutoff=</span><span class="fu">as.numeric</span>(<span class="cn">NA</span>), <span class="at">newX=</span>x_new),</span>
<span id="cb111-146"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-146" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;!is.na(cutoff) is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb111-147"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-148"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-148" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssDesign'>getCssDesign</a>(<span class="at">css_results=</span>css_res,</span>
<span id="cb111-149"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-149" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">weighting=</span><span class="fu">c</span>(<span class="st">&quot;sparse&quot;</span>, <span class="st">&quot;simple_avg&quot;</span>),</span>
<span id="cb111-150"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-150" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">newX=</span>x_new),</span>
<span id="cb111-151"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-151" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;length(weighting) == 1 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb111-152"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-153"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-153" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssDesign'>getCssDesign</a>(<span class="at">css_results=</span>css_res, <span class="at">weighting=</span><span class="dv">1</span>,</span>
<span id="cb111-154"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-154" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">newX=</span>x_new),</span>
<span id="cb111-155"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-155" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;Weighting must be a character&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb111-156"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-157"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-157" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssDesign'>getCssDesign</a>(<span class="at">css_results=</span>css_res, <span class="at">weighting=</span><span class="st">&quot;spasre&quot;</span>,</span>
<span id="cb111-158"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-158" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">newX=</span>x_new),</span>
<span id="cb111-159"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-159" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;Weighting must be a character and one of sparse, simple_avg, or weighted_avg&quot;</span>,</span>
<span id="cb111-160"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-160" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb111-161"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-162"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-162" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssDesign'>getCssDesign</a>(<span class="at">css_results=</span>css_res,</span>
<span id="cb111-163"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-163" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">min_num_clusts=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">newX=</span>x_new),</span>
<span id="cb111-164"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-164" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;length(min_num_clusts) == 1 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb111-165"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-166"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-166" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssDesign'>getCssDesign</a>(<span class="at">css_results=</span>css_res, <span class="at">min_num_clusts=</span><span class="st">&quot;3&quot;</span>,</span>
<span id="cb111-167"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-167" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">newX=</span>x_new),</span>
<span id="cb111-168"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-168" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;is.numeric(min_num_clusts) | is.integer(min_num_clusts) is not TRUE&quot;</span>,</span>
<span id="cb111-169"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-169" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb111-170"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-171"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-171" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssDesign'>getCssDesign</a>(<span class="at">css_results=</span>css_res, <span class="at">min_num_clusts=</span><span class="dv">0</span>,</span>
<span id="cb111-172"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-172" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">newX=</span>x_new),</span>
<span id="cb111-173"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-173" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;min_num_clusts &gt;= 1 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb111-174"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-175"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-175" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssDesign'>getCssDesign</a>(<span class="at">css_results=</span>css_res, <span class="at">min_num_clusts=</span><span class="dv">6</span>,</span>
<span id="cb111-176"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-176" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">newX=</span>x_new),</span>
<span id="cb111-177"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-177" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;min_num_clusts &lt;= n_clusters is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb111-178"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-179"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-180"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-180" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssDesign'>getCssDesign</a>(<span class="at">css_results=</span>css_res, <span class="at">max_num_clusts=</span><span class="st">&quot;4&quot;</span>,</span>
<span id="cb111-181"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-181" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">newX=</span>x_new),</span>
<span id="cb111-182"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-182" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;is.numeric(max_num_clusts) | is.integer(max_num_clusts) is not TRUE&quot;</span>,</span>
<span id="cb111-183"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-183" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb111-184"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-185"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-185" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssDesign'>getCssDesign</a>(<span class="at">css_results=</span>css_res, <span class="at">max_num_clusts=</span><span class="fl">3.5</span>,</span>
<span id="cb111-186"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-186" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">newX=</span>x_new),</span>
<span id="cb111-187"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-187" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;max_num_clusts == round(max_num_clusts) is not TRUE&quot;</span>,</span>
<span id="cb111-188"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-188" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb111-189"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-190"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-190" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssDesign'>getCssDesign</a>(<span class="at">css_results=</span>css_res, <span class="at">min_num_clusts=</span><span class="dv">2</span>,</span>
<span id="cb111-191"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-191" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">max_num_clusts=</span><span class="dv">1</span>, <span class="at">newX=</span>x_new),</span>
<span id="cb111-192"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-192" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;max_num_clusts &gt;= min_num_clusts is not TRUE&quot;</span>,</span>
<span id="cb111-193"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-193" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb111-194"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-195"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-195" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssDesign'>getCssDesign</a>(<span class="at">css_results=</span>css_res, <span class="at">max_num_clusts=</span><span class="dv">8</span>,</span>
<span id="cb111-196"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-196" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">newX=</span>x_new),</span>
<span id="cb111-197"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-197" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;max_num_clusts &lt;= p is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb111-198"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-199"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-199" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb111-200"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb111-200" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## ── Warning (&#39;&lt;text&gt;:63&#39;): getCssDesign works ───────────────────────────────────
## New X provided had no variable names (column names) even though the X provided to css did.
## Backtrace:
##  1. testthat::expect_warning(...)
##  7. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssDesign'>getCssDesign</a>(...)
##  8. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkXInputResults'>checkXInputResults</a>(newX, css_results$X)
## 
## ── Warning (&#39;&lt;text&gt;:63&#39;): getCssDesign works ───────────────────────────────────
## New X provided had no variable names (column names) even though the X provided to css did.
## Backtrace:
##   1. testthat::expect_warning(...)
##   7. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssDesign'>getCssDesign</a>(...)
##   8. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#formCssDesign'>formCssDesign</a>(...)
##   9. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkFormCssDesignInputs'>checkFormCssDesignInputs</a>(...)
##  10. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkXInputResults'>checkXInputResults</a>(newx, css_results$X)
## 
## ── Warning (&#39;&lt;text&gt;:80&#39;): getCssDesign works ───────────────────────────────────
## New X provided had no variable names (column names) even though the X provided to css did.
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssDesign'>getCssDesign</a>(...)
##  2. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkXInputResults'>checkXInputResults</a>(newX, css_results$X)
## 
## ── Warning (&#39;&lt;text&gt;:80&#39;): getCssDesign works ───────────────────────────────────
## New X provided had no variable names (column names) even though the X provided to css did.
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssDesign'>getCssDesign</a>(...)
##  2. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#formCssDesign'>formCssDesign</a>(...)
##  3. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkFormCssDesignInputs'>checkFormCssDesignInputs</a>(...)
##  4. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkXInputResults'>checkXInputResults</a>(newx, css_results$X)
## 
## ── Warning (&#39;&lt;text&gt;:101&#39;): getCssDesign works ──────────────────────────────────
## New X provided had no variable names (column names) even though the X provided to css did.
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssDesign'>getCssDesign</a>(...)
##  2. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkXInputResults'>checkXInputResults</a>(newX, css_results$X)
## 
## ── Warning (&#39;&lt;text&gt;:101&#39;): getCssDesign works ──────────────────────────────────
## New X provided had no variable names (column names) even though the X provided to css did.
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssDesign'>getCssDesign</a>(...)
##  2. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#formCssDesign'>formCssDesign</a>(...)
##  3. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkFormCssDesignInputs'>checkFormCssDesignInputs</a>(...)
##  4. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkXInputResults'>checkXInputResults</a>(newx, css_results$X)
## 
## ── Warning (&#39;&lt;text&gt;:121&#39;): getCssDesign works ──────────────────────────────────
## New X provided had no variable names (column names) even though the X provided to css did.
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssDesign'>getCssDesign</a>(...)
##  2. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkXInputResults'>checkXInputResults</a>(newX, css_results$X)
## 
## ── Warning (&#39;&lt;text&gt;:121&#39;): getCssDesign works ──────────────────────────────────
## New X provided had no variable names (column names) even though the X provided to css did.
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssDesign'>getCssDesign</a>(...)
##  2. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#formCssDesign'>formCssDesign</a>(...)
##  3. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkFormCssDesignInputs'>checkFormCssDesignInputs</a>(...)
##  4. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkXInputResults'>checkXInputResults</a>(newx, css_results$X)</code></pre>
<p>getCssPreds</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Fit model and generate predictions from new data</span></span>
<span id="cb113-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb113-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Generate predictions on test data using cluster stability-selected model.</span></span>
<span id="cb113-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param css_results An object of class &quot;cssr&quot; (the output of the function</span></span>
<span id="cb113-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; css).</span></span>
<span id="cb113-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param testX A numeric matrix (preferably) or a data.frame (which will</span></span>
<span id="cb113-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; be coerced internally to a matrix by the function model.matrix) containing</span></span>
<span id="cb113-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the data that will be used to generate predictions. Must contain the same</span></span>
<span id="cb113-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; features (in the same number of columns) as the matrix provided to css, and</span></span>
<span id="cb113-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; if the columns of testX are labeled, the names must match the variable names</span></span>
<span id="cb113-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; provided to css.</span></span>
<span id="cb113-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param weighting Character; determines how to calculate the weights to</span></span>
<span id="cb113-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; combine features from the selected clusters into weighted averages, called</span></span>
<span id="cb113-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; cluster representatives. Must be one of &quot;sparse&quot;, &quot;weighted_avg&quot;, or</span></span>
<span id="cb113-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; &quot;simple_avg&#39;. For &quot;sparse&quot;, all the weight is put on the most frequently</span></span>
<span id="cb113-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; selected individual cluster member (or divided equally among all the clusters</span></span>
<span id="cb113-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; that are tied for the top selection proportion if there is a tie). For</span></span>
<span id="cb113-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; &quot;weighted_avg&quot;, the weight used for each cluster member is calculated in</span></span>
<span id="cb113-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; proportion to the individual selection proportions of each feature. For</span></span>
<span id="cb113-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; &quot;simple_avg&quot;, each cluster member gets equal weight regardless of the</span></span>
<span id="cb113-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; individual feature selection proportions (that is, the cluster representative</span></span>
<span id="cb113-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; is just a simple average of all the cluster members). See Faletto and Bien</span></span>
<span id="cb113-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; (2022) for details. Default is &quot;weighted_avg&quot;.</span></span>
<span id="cb113-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param cutoff Numeric; getCssPreds will make use only of those clusters with</span></span>
<span id="cb113-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; selection proportions equal to at least cutoff. Must be between 0 and 1.</span></span>
<span id="cb113-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Default is 0 (in which case either all clusters are used, or max_num_clusts</span></span>
<span id="cb113-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; are used, if max_num_clusts is specified).</span></span>
<span id="cb113-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param min_num_clusts Integer or numeric; the minimum number of clusters to</span></span>
<span id="cb113-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; use regardless of cutoff. (That is, if the chosen cutoff returns fewer than</span></span>
<span id="cb113-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; min_num_clusts clusters, the cutoff will be increased until at least</span></span>
<span id="cb113-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; min_num_clusts clusters are selected.) Default is 1.</span></span>
<span id="cb113-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param max_num_clusts Integer or numeric; the maximum number of clusters to</span></span>
<span id="cb113-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; use regardless of cutoff. (That is, if the chosen cutoff returns more than</span></span>
<span id="cb113-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; max_num_clusts clusters, the cutoff will be decreased until at most</span></span>
<span id="cb113-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; max_num_clusts clusters are selected.) Default is NA (in which case</span></span>
<span id="cb113-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; max_num_clusts is ignored).</span></span>
<span id="cb113-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param trainX A numeric matrix (preferably) or a data.frame (which will</span></span>
<span id="cb113-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; be coerced internally to a matrix by the function model.matrix) containing</span></span>
<span id="cb113-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the data that will be used to estimate the linear model from the selected</span></span>
<span id="cb113-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; clusters. trainX is only necessary to provide if no train_inds were</span></span>
<span id="cb113-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; designated in the css function call to set aside observations for model</span></span>
<span id="cb113-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; estimation (though even if train_inds was provided, trainX and trianY will be</span></span>
<span id="cb113-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; used for model estimation if they are both provided to getCssPreds). Must </span></span>
<span id="cb113-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; contain the same features (in the same number of columns) as the matrix </span></span>
<span id="cb113-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; provided to css, and if the columns of trainX are labeled, the names must</span></span>
<span id="cb113-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; match the variable names provided to css. Default is NA (in which case</span></span>
<span id="cb113-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; getCssPreds uses the observations from the train_inds that were provided to</span></span>
<span id="cb113-48"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; css to estimate a linear model).</span></span>
<span id="cb113-49"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param trainY The response corresponding to trainX. Must be a real-valued</span></span>
<span id="cb113-50"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; response (unlike in the general css setup) because predictions will be</span></span>
<span id="cb113-51"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; generated by an ordinary least squares model. Must have the same length as</span></span>
<span id="cb113-52"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the number of rows of trainX. Like trainX, only needs to be provided if no</span></span>
<span id="cb113-53"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; observations were set aside for model estimation by the parameter train_inds</span></span>
<span id="cb113-54"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; in the css function call. Default is NA (in which case getCssPreds uses the</span></span>
<span id="cb113-55"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; observations from the train_inds that were provided to css).</span></span>
<span id="cb113-56"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return A vector of predictions corresponding to the observations from testX.</span></span>
<span id="cb113-57"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @author Gregory Faletto, Jacob Bien</span></span>
<span id="cb113-58"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @references Faletto, G., &amp; Bien, J. (2022). Cluster Stability Selection.</span></span>
<span id="cb113-59"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; \emph{arXiv preprint arXiv:2201.00494}.</span></span>
<span id="cb113-60"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; \url{https://arxiv.org/abs/2201.00494}.</span></span>
<span id="cb113-61"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @export</span></span>
<span id="cb113-62"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-62" aria-hidden="true" tabindex="-1"></a><span id='getCssPreds'>getCssPreds</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(css_results, testX, <span class="at">weighting=</span><span class="st">&quot;weighted_avg&quot;</span>, <span class="at">cutoff=</span><span class="dv">0</span>,</span>
<span id="cb113-63"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_num_clusts=</span><span class="dv">1</span>, <span class="at">max_num_clusts=</span><span class="cn">NA</span>, <span class="at">trainX=</span><span class="cn">NA</span>, <span class="at">trainY=</span><span class="cn">NA</span>){</span>
<span id="cb113-64"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-64" aria-hidden="true" tabindex="-1"></a>    <span class="co"># </span><span class="al">TODO</span><span class="co">(gregfaletto) Consider adding an argument for a user-provided prediction</span></span>
<span id="cb113-65"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-65" aria-hidden="true" tabindex="-1"></a>    <span class="co"># function in order to allow for more general kinds of predictions than</span></span>
<span id="cb113-66"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-66" aria-hidden="true" tabindex="-1"></a>    <span class="co"># OLS.</span></span>
<span id="cb113-67"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-68"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-68" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check inputs</span></span>
<span id="cb113-69"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-69" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb113-70"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-70" aria-hidden="true" tabindex="-1"></a>    check_list <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGetCssPredsInputs'>checkGetCssPredsInputs</a>(css_results, testX, weighting, cutoff,</span>
<span id="cb113-71"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-71" aria-hidden="true" tabindex="-1"></a>        min_num_clusts, max_num_clusts, trainX, trainY)</span>
<span id="cb113-72"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-73"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-73" aria-hidden="true" tabindex="-1"></a>    trainXProvided <span class="ot">&lt;-</span> check_list<span class="sc">$</span>trainXProvided</span>
<span id="cb113-74"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-74" aria-hidden="true" tabindex="-1"></a>    trainX <span class="ot">&lt;-</span> check_list<span class="sc">$</span>trainX</span>
<span id="cb113-75"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-75" aria-hidden="true" tabindex="-1"></a>    testX <span class="ot">&lt;-</span> check_list<span class="sc">$</span>testX</span>
<span id="cb113-76"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-76" aria-hidden="true" tabindex="-1"></a>    feat_names <span class="ot">&lt;-</span> check_list<span class="sc">$</span>feat_names</span>
<span id="cb113-77"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-77" aria-hidden="true" tabindex="-1"></a>    max_num_clusts <span class="ot">&lt;-</span> check_list<span class="sc">$</span>max_num_clusts</span>
<span id="cb113-78"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-79"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-79" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rm</span>(check_list)</span>
<span id="cb113-80"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-81"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-81" aria-hidden="true" tabindex="-1"></a>    n_train <span class="ot">&lt;-</span> <span class="fu">nrow</span>(trainX)</span>
<span id="cb113-82"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-82" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(testX)</span>
<span id="cb113-83"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-83" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ncol</span>(testX)</span>
<span id="cb113-84"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-85"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-85" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Take provided training design matrix and testX and turn them into</span></span>
<span id="cb113-86"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-86" aria-hidden="true" tabindex="-1"></a>    <span class="co"># matrices of cluster representatives using information from css_results</span></span>
<span id="cb113-87"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-87" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(trainXProvided){</span>
<span id="cb113-88"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-88" aria-hidden="true" tabindex="-1"></a>        train_X_clusters <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#formCssDesign'>formCssDesign</a>(css_results, weighting, cutoff,</span>
<span id="cb113-89"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-89" aria-hidden="true" tabindex="-1"></a>            min_num_clusts, max_num_clusts, <span class="at">newx=</span>trainX)</span>
<span id="cb113-90"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-90" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.numeric</span>(trainY) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.integer</span>(trainY)){</span>
<span id="cb113-91"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-91" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stop</span>(<span class="st">&quot;The provided trainY must be real-valued, because predictions will be generated by ordinary least squares regression.&quot;</span>)</span>
<span id="cb113-92"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-92" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb113-93"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-93" aria-hidden="true" tabindex="-1"></a>        y_train <span class="ot">&lt;-</span> trainY</span>
<span id="cb113-94"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-94" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span>{</span>
<span id="cb113-95"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-95" aria-hidden="true" tabindex="-1"></a>        train_X_clusters <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#formCssDesign'>formCssDesign</a>(css_results, weighting, cutoff,</span>
<span id="cb113-96"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-96" aria-hidden="true" tabindex="-1"></a>            min_num_clusts, max_num_clusts)</span>
<span id="cb113-97"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-97" aria-hidden="true" tabindex="-1"></a>        y_train <span class="ot">&lt;-</span> css_results<span class="sc">$</span>y[css_results<span class="sc">$</span>train_inds]</span>
<span id="cb113-98"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-98" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.numeric</span>(y_train) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.integer</span>(y_train)){</span>
<span id="cb113-99"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-99" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stop</span>(<span class="st">&quot;Can&#39;t generated predictions from the data that was provided to css because the provided y was not real-valued (getCssPreds generated predictions using ordinary least squares regression).&quot;</span>)</span>
<span id="cb113-100"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-100" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb113-101"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-101" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb113-102"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-103"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-103" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(y_train) <span class="sc">==</span> <span class="fu">nrow</span>(train_X_clusters))</span>
<span id="cb113-104"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-105"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-105" aria-hidden="true" tabindex="-1"></a>    testX_clusters <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#formCssDesign'>formCssDesign</a>(css_results, weighting, cutoff,</span>
<span id="cb113-106"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-106" aria-hidden="true" tabindex="-1"></a>        min_num_clusts, max_num_clusts, <span class="at">newx=</span>testX)</span>
<span id="cb113-107"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-108"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-108" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">ncol</span>(testX_clusters) <span class="sc">==</span> <span class="fu">ncol</span>(train_X_clusters))</span>
<span id="cb113-109"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-110"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-110" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get names for clusters</span></span>
<span id="cb113-111"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-111" aria-hidden="true" tabindex="-1"></a>    clust_X_names <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;c_fit_&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(testX_clusters), <span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb113-112"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-112" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(<span class="fu">colnames</span>(train_X_clusters))){</span>
<span id="cb113-113"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-113" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">identical</span>(<span class="fu">colnames</span>(train_X_clusters), <span class="fu">colnames</span>(testX_clusters)))</span>
<span id="cb113-114"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-114" aria-hidden="true" tabindex="-1"></a>        clust_X_names <span class="ot">&lt;-</span> <span class="fu">colnames</span>(train_X_clusters)</span>
<span id="cb113-115"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-115" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb113-116"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-117"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-117" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fit linear model on training data via OLS</span></span>
<span id="cb113-118"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-118" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">nrow</span>(train_X_clusters) <span class="sc">&lt;</span> <span class="fu">ncol</span>(train_X_clusters)){</span>
<span id="cb113-119"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-119" aria-hidden="true" tabindex="-1"></a>        err_mess <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;css not provided with enough indices to fit OLS model for predictions (number of training indices: &quot;</span>,</span>
<span id="cb113-120"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-120" aria-hidden="true" tabindex="-1"></a>            <span class="fu">nrow</span>(train_X_clusters), <span class="st">&quot;, number of clusters: &quot;</span>,</span>
<span id="cb113-121"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-121" aria-hidden="true" tabindex="-1"></a>            <span class="fu">ncol</span>(train_X_clusters),</span>
<span id="cb113-122"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-122" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;). Try reducing number of clusters by increasing cutoff, or re-run css with a larger number of training indices.&quot;</span>,</span>
<span id="cb113-123"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-123" aria-hidden="true" tabindex="-1"></a>            <span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb113-124"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-124" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stop</span>(err_mess)</span>
<span id="cb113-125"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-125" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb113-126"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-127"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-127" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">y=</span>y_train, train_X_clusters)</span>
<span id="cb113-128"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-128" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(df)[<span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(df)] <span class="ot">&lt;-</span> clust_X_names</span>
<span id="cb113-129"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-129" aria-hidden="true" tabindex="-1"></a>    model <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">lm</span>(y <span class="sc">~</span>., <span class="at">data=</span>df)</span>
<span id="cb113-130"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-131"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-131" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use fitted model to generate predictions on testX</span></span>
<span id="cb113-132"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-132" aria-hidden="true" tabindex="-1"></a>    df_test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(testX_clusters)</span>
<span id="cb113-133"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-133" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(df_test) <span class="ot">&lt;-</span> clust_X_names</span>
<span id="cb113-134"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-134" aria-hidden="true" tabindex="-1"></a>    predictions <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">predict.lm</span>(model, <span class="at">newdata=</span>df_test)</span>
<span id="cb113-135"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-135" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(predictions) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb113-136"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-137"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-137" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check output</span></span>
<span id="cb113-138"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-138" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.numeric</span>(predictions) <span class="sc">|</span> <span class="fu">is.integer</span>(predictions))</span>
<span id="cb113-139"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-139" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(predictions) <span class="sc">==</span> n)</span>
<span id="cb113-140"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-140" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(predictions)))</span>
<span id="cb113-141"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-142"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-142" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(predictions)</span>
<span id="cb113-143"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb113-143" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>checkGetCssPredsInputs:</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Helper function to confirm that inputs to the function getCssPreds are as</span></span>
<span id="cb114-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; expected, and modify inputs if needed.</span></span>
<span id="cb114-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb114-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param css_results An object of class &quot;cssr&quot; (the output of the function</span></span>
<span id="cb114-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; css).</span></span>
<span id="cb114-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param testX A numeric matrix (preferably) or a data.frame (which will</span></span>
<span id="cb114-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; be coerced internally to a matrix by the function model.matrix) containing</span></span>
<span id="cb114-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the data that will be used to generate predictions. Must contain the same</span></span>
<span id="cb114-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; features (in the same number of columns) as the matrix provided to css.</span></span>
<span id="cb114-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param weighting Character; determines how to calculate the weights to</span></span>
<span id="cb114-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; combine features from the selected clusters into weighted averages, called</span></span>
<span id="cb114-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; cluster representatives. Must be one of &quot;sparse&quot;, &quot;weighted_avg&quot;, or</span></span>
<span id="cb114-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; &quot;simple_avg&#39;. For &quot;sparse&quot;, all the weight is put on the most frequently</span></span>
<span id="cb114-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; selected individual cluster member (or divided equally among all the clusters</span></span>
<span id="cb114-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; that are tied for the top selection proportion if there is a tie). For</span></span>
<span id="cb114-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; &quot;weighted_avg&quot;, the weight used for each cluster member is calculated in</span></span>
<span id="cb114-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; proportion to the individual selection proportions of each feature. For</span></span>
<span id="cb114-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; &quot;simple_avg&quot;, each cluster member gets equal weight regardless of the</span></span>
<span id="cb114-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; individual feature selection proportions (that is, the cluster representative</span></span>
<span id="cb114-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; is just a simple average of all the cluster members). See Faletto and Bien</span></span>
<span id="cb114-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; (2022) for details. Default is &quot;weighted_avg&quot;.</span></span>
<span id="cb114-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param cutoff Numeric; getCssPreds will make use only of those clusters with</span></span>
<span id="cb114-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; selection proportions equal to at least cutoff. Must be between 0 and 1.</span></span>
<span id="cb114-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Default is 0 (in which case either all clusters are used, or max_num_clusts</span></span>
<span id="cb114-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; are used, if max_num_clusts is specified).</span></span>
<span id="cb114-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param min_num_clusts Integer or numeric; the minimum number of clusters to</span></span>
<span id="cb114-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; use regardless of cutoff. (That is, if the chosen cutoff returns fewer than</span></span>
<span id="cb114-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; min_num_clusts clusters, the cutoff will be increased until at least</span></span>
<span id="cb114-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; min_num_clusts clusters are selected.) Default is 1.</span></span>
<span id="cb114-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param max_num_clusts Integer or numeric; the maximum number of clusters to</span></span>
<span id="cb114-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; use regardless of cutoff. (That is, if the chosen cutoff returns more than</span></span>
<span id="cb114-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; max_num_clusts clusters, the cutoff will be decreased until at most</span></span>
<span id="cb114-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; max_num_clusts clusters are selected.) Default is NA (in which case</span></span>
<span id="cb114-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; max_num_clusts is ignored).</span></span>
<span id="cb114-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param trainX A numeric matrix (preferably) or a data.frame (which will</span></span>
<span id="cb114-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; be coerced internally to a matrix by the function model.matrix) containing</span></span>
<span id="cb114-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the data that will be used to estimate the linear model from the selected</span></span>
<span id="cb114-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; clusters. trainX is only necessary to provide if no train_inds were</span></span>
<span id="cb114-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; designated in the css function call to set aside observations for model</span></span>
<span id="cb114-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; estimation (though even if train_inds was provided, trainX and trianY will be</span></span>
<span id="cb114-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; used for model estimation if they are both provided to getCssPreds). Must </span></span>
<span id="cb114-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; contain the same features (in the same number of columns) as the matrix </span></span>
<span id="cb114-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; provided to css, and if the columns of trainX are labeled, the names must</span></span>
<span id="cb114-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; match the variable names provided to css. Default is NA (in which case</span></span>
<span id="cb114-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; getCssPreds uses the observations from the train_inds that were provided to</span></span>
<span id="cb114-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; css to estimate a linear model).</span></span>
<span id="cb114-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param trainY The response corresponding to trainX. Must be a real-valued</span></span>
<span id="cb114-48"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; response (unlike in the general css setup) because predictions will be</span></span>
<span id="cb114-49"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; generated by an ordinary least squares model. Must have the same length as</span></span>
<span id="cb114-50"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the number of rows of trainX. Like trainX, only needs to be provided if no</span></span>
<span id="cb114-51"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; observations were set aside for model estimation by the parameter train_inds</span></span>
<span id="cb114-52"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; in the css function call. Default is NA (in which case getCssPreds uses the</span></span>
<span id="cb114-53"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; observations from the train_inds that were provided to css).</span></span>
<span id="cb114-54"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return A named list with the following elements: \item{trainXProvided}{</span></span>
<span id="cb114-55"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Logical; indicates whether a valid trainX input was provided.} \item{trainX}{</span></span>
<span id="cb114-56"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; The provided trainX matrix, coerced from a data.frame to a matrix if the</span></span>
<span id="cb114-57"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; provided trainX was a data.frame. (If a valid trainX was not provided, this</span></span>
<span id="cb114-58"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; output simply passes whatever was provided as trainX.)} \item{testX}{The</span></span>
<span id="cb114-59"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; provided testX matrix, coerced from a data.frame to a matrix if the provided</span></span>
<span id="cb114-60"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; testX was a data.frame.} \item{feat_names}{A character vector containing the</span></span>
<span id="cb114-61"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; column names of testX (if the provided testX had column names). If the</span></span>
<span id="cb114-62"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; provided testX did not have column names, feat_names will be NA.}</span></span>
<span id="cb114-63"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; \item{max_num_clusts}{The provided max_num_clusts, coerced to an integer if</span></span>
<span id="cb114-64"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; needed, and coerced to be less than or equal to the total number of clusters</span></span>
<span id="cb114-65"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; from the output of css_results.}</span></span>
<span id="cb114-66"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @author Gregory Faletto, Jacob Bien</span></span>
<span id="cb114-67"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-67" aria-hidden="true" tabindex="-1"></a><span id='checkGetCssPredsInputs'>checkGetCssPredsInputs</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(css_results, testX, weighting, cutoff,</span>
<span id="cb114-68"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-68" aria-hidden="true" tabindex="-1"></a>    min_num_clusts, max_num_clusts, trainX, trainY){</span>
<span id="cb114-69"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-69" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check inputs</span></span>
<span id="cb114-70"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">class</span>(css_results) <span class="sc">==</span> <span class="st">&quot;cssr&quot;</span>)</span>
<span id="cb114-71"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-72"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-72" aria-hidden="true" tabindex="-1"></a>    check_results <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkNewXProvided'>checkNewXProvided</a>(trainX, css_results)</span>
<span id="cb114-73"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-74"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-74" aria-hidden="true" tabindex="-1"></a>    trainX <span class="ot">&lt;-</span> check_results<span class="sc">$</span>newX</span>
<span id="cb114-75"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-75" aria-hidden="true" tabindex="-1"></a>    trainXProvided <span class="ot">&lt;-</span> check_results<span class="sc">$</span>newXProvided</span>
<span id="cb114-76"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-77"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-77" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rm</span>(check_results)</span>
<span id="cb114-78"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-79"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-79" aria-hidden="true" tabindex="-1"></a>    n_train <span class="ot">&lt;-</span> <span class="fu">nrow</span>(trainX)</span>
<span id="cb114-80"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-81"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-81" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(trainXProvided){</span>
<span id="cb114-82"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-82" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(trainY)) <span class="sc">&amp;</span> <span class="fu">length</span>(trainY) <span class="sc">&gt;</span> <span class="dv">1</span>){</span>
<span id="cb114-83"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-83" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stopifnot</span>(<span class="fu">is.numeric</span>(trainY))</span>
<span id="cb114-84"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-84" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stopifnot</span>(n_train <span class="sc">==</span> <span class="fu">length</span>(trainY))</span>
<span id="cb114-85"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-85" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span>{</span>
<span id="cb114-86"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-86" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span>(<span class="fu">length</span>(css_results<span class="sc">$</span>train_inds) <span class="sc">==</span> <span class="dv">0</span>){</span>
<span id="cb114-87"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-87" aria-hidden="true" tabindex="-1"></a>                <span class="fu">stop</span>(<span class="st">&quot;css was not provided with indices to set aside for model training (train_inds), so must provide both trainX and trainY in order to generate predictions&quot;</span>)</span>
<span id="cb114-88"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-88" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb114-89"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-89" aria-hidden="true" tabindex="-1"></a>            trainXProvided <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb114-90"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-90" aria-hidden="true" tabindex="-1"></a>            <span class="fu">warning</span>(<span class="st">&quot;trainX provided but no trainY provided; instead, training model using the train_inds observations provided to css to set aside for model training.&quot;</span>)</span>
<span id="cb114-91"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-91" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb114-92"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-92" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span>{</span>
<span id="cb114-93"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-93" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="fu">length</span>(css_results<span class="sc">$</span>train_inds) <span class="sc">==</span> <span class="dv">0</span>){</span>
<span id="cb114-94"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-94" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stop</span>(<span class="st">&quot;css was not provided with indices to set aside for model training (train_inds), so must provide both trainX and trainY in order to generate predictions&quot;</span>)</span>
<span id="cb114-95"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-95" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb114-96"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-96" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(trainY)) <span class="sc">&amp;</span> <span class="fu">length</span>(trainY) <span class="sc">&gt;</span> <span class="dv">1</span>){</span>
<span id="cb114-97"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-97" aria-hidden="true" tabindex="-1"></a>            <span class="fu">warning</span>(<span class="st">&quot;trainY provided but no trainX provided; instead, training model using the train_inds observations provided to css to set aside for model training.&quot;</span>)</span>
<span id="cb114-98"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-98" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb114-99"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-99" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb114-100"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-101"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-101" aria-hidden="true" tabindex="-1"></a>    results <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkXInputResults'>checkXInputResults</a>(testX, css_results<span class="sc">$</span>X)</span>
<span id="cb114-102"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-103"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-103" aria-hidden="true" tabindex="-1"></a>    testX <span class="ot">&lt;-</span> results<span class="sc">$</span>newx</span>
<span id="cb114-104"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-104" aria-hidden="true" tabindex="-1"></a>    feat_names <span class="ot">&lt;-</span> results<span class="sc">$</span>feat_names</span>
<span id="cb114-105"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-106"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-106" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(feat_names))){</span>
<span id="cb114-107"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-107" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">length</span>(feat_names) <span class="sc">==</span> <span class="fu">ncol</span>(testX))</span>
<span id="cb114-108"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-108" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="sc">!</span>(<span class="st">&quot;(Intercept)&quot;</span> <span class="sc">%in%</span> feat_names))</span>
<span id="cb114-109"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-109" aria-hidden="true" tabindex="-1"></a>        <span class="fu">colnames</span>(testX) <span class="ot">&lt;-</span> feat_names</span>
<span id="cb114-110"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-110" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb114-111"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-112"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-112" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rm</span>(results)</span>
<span id="cb114-113"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-114"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-114" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(testX)</span>
<span id="cb114-115"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-115" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ncol</span>(testX)</span>
<span id="cb114-116"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-117"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-117" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(n <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb114-118"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-118" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(p <span class="sc">==</span> <span class="fu">ncol</span>(trainX))</span>
<span id="cb114-119"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-119" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(<span class="fu">colnames</span>(trainX)) <span class="sc">&amp;</span> <span class="fu">is.null</span>(<span class="fu">colnames</span>(testX))){</span>
<span id="cb114-120"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-120" aria-hidden="true" tabindex="-1"></a>        <span class="fu">warning</span>(<span class="st">&quot;Column names were provided for trainX but not for testX (are you sure they both contain identical features in the same order?)&quot;</span>)</span>
<span id="cb114-121"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-121" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb114-122"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-122" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">is.null</span>(<span class="fu">colnames</span>(trainX)) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.null</span>(<span class="fu">colnames</span>(testX))){</span>
<span id="cb114-123"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-123" aria-hidden="true" tabindex="-1"></a>        <span class="fu">warning</span>(<span class="st">&quot;Column names were provided for testX but not for trainX (are you sure they both contain identical features in the same order?)&quot;</span>)</span>
<span id="cb114-124"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-124" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb114-125"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-125" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(<span class="fu">colnames</span>(trainX)) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.null</span>(<span class="fu">colnames</span>(testX))){</span>
<span id="cb114-126"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-126" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">all</span>(<span class="fu">colnames</span>(trainX) <span class="sc">==</span> <span class="fu">colnames</span>(testX)))</span>
<span id="cb114-127"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-127" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb114-128"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-129"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-129" aria-hidden="true" tabindex="-1"></a>    <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkCutoff'>checkCutoff</a>(cutoff)</span>
<span id="cb114-130"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-130" aria-hidden="true" tabindex="-1"></a>    <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkWeighting'>checkWeighting</a>(weighting)</span>
<span id="cb114-131"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-131" aria-hidden="true" tabindex="-1"></a>    <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkMinNumClusts'>checkMinNumClusts</a>(min_num_clusts, p, <span class="fu">length</span>(css_results<span class="sc">$</span>clusters))</span>
<span id="cb114-132"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-132" aria-hidden="true" tabindex="-1"></a>    max_num_clusts <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkMaxNumClusts'>checkMaxNumClusts</a>(max_num_clusts, min_num_clusts, p,</span>
<span id="cb114-133"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-133" aria-hidden="true" tabindex="-1"></a>        <span class="fu">length</span>(css_results<span class="sc">$</span>clusters))</span>
<span id="cb114-134"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-135"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-135" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">trainXProvided=</span>trainXProvided, <span class="at">trainX=</span>trainX, <span class="at">testX=</span>testX,</span>
<span id="cb114-136"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-136" aria-hidden="true" tabindex="-1"></a>        <span class="at">feat_names=</span>feat_names, <span class="at">max_num_clusts=</span>max_num_clusts))</span>
<span id="cb114-137"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-138"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb114-138" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Tests for checkGetCssPredsInputs</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-1" aria-hidden="true" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">test_that</span>(<span class="st">&quot;checkGetCssPredsInputs works&quot;</span>, {</span>
<span id="cb115-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">17081</span>)</span>
<span id="cb115-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-4" aria-hidden="true" tabindex="-1"></a>  x_select <span class="ot">&lt;-</span> <span class="fu">matrix</span>(stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">10</span><span class="sc">*</span><span class="dv">6</span>), <span class="at">nrow=</span><span class="dv">10</span>, <span class="at">ncol=</span><span class="dv">6</span>)</span>
<span id="cb115-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-5" aria-hidden="true" tabindex="-1"></a>  x_train <span class="ot">&lt;-</span> <span class="fu">matrix</span>(stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">8</span><span class="sc">*</span><span class="dv">6</span>), <span class="at">nrow=</span><span class="dv">8</span>, <span class="at">ncol=</span><span class="dv">6</span>)</span>
<span id="cb115-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-6" aria-hidden="true" tabindex="-1"></a>  x_pred <span class="ot">&lt;-</span> <span class="fu">matrix</span>(stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">7</span><span class="sc">*</span><span class="dv">6</span>), <span class="at">nrow=</span><span class="dv">7</span>, <span class="at">ncol=</span><span class="dv">6</span>)</span>
<span id="cb115-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-7" aria-hidden="true" tabindex="-1"></a>  y_select <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">10</span>)</span>
<span id="cb115-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-8" aria-hidden="true" tabindex="-1"></a>  y_train <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">8</span>)</span>
<span id="cb115-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-10" aria-hidden="true" tabindex="-1"></a>  good_clusters <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;red&quot;</span><span class="ot">=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="st">&quot;blue&quot;</span><span class="ot">=</span><span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="st">&quot;green&quot;</span><span class="ot">=</span><span class="dv">5</span>)</span>
<span id="cb115-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-12" aria-hidden="true" tabindex="-1"></a>  css_res <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x_select, <span class="at">y=</span>y_select, <span class="at">lambda=</span><span class="fl">0.01</span>, <span class="at">clusters=</span>good_clusters,</span>
<span id="cb115-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-13" aria-hidden="true" tabindex="-1"></a>                 <span class="at">B =</span> <span class="dv">10</span>)</span>
<span id="cb115-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-15" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGetCssPredsInputs'>checkGetCssPredsInputs</a>(css_res, <span class="at">testX=</span>x_pred, <span class="at">weighting=</span><span class="st">&quot;simple_avg&quot;</span>,</span>
<span id="cb115-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-16" aria-hidden="true" tabindex="-1"></a>                                <span class="at">cutoff=</span><span class="fl">0.05</span>, <span class="at">min_num_clusts=</span><span class="dv">1</span>,</span>
<span id="cb115-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-17" aria-hidden="true" tabindex="-1"></a>                                <span class="at">max_num_clusts=</span><span class="cn">NA</span>, <span class="at">trainX=</span>x_train,</span>
<span id="cb115-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-18" aria-hidden="true" tabindex="-1"></a>                                <span class="at">trainY=</span>y_train)</span>
<span id="cb115-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-20" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res))</span>
<span id="cb115-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-21" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(res), <span class="fu">c</span>(<span class="st">&quot;trainXProvided&quot;</span>, <span class="st">&quot;trainX&quot;</span>, <span class="st">&quot;testX&quot;</span>,</span>
<span id="cb115-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-22" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">&quot;feat_names&quot;</span>, <span class="st">&quot;max_num_clusts&quot;</span>))</span>
<span id="cb115-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-24" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="sc">!</span><span class="fu">is.na</span>(res<span class="sc">$</span>trainXProvided))</span>
<span id="cb115-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-25" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res<span class="sc">$</span>trainXProvided), <span class="dv">1</span>)</span>
<span id="cb115-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-26" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.logical</span>(res<span class="sc">$</span>trainXProvided))</span>
<span id="cb115-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-27" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(res<span class="sc">$</span>trainXProvided)</span>
<span id="cb115-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-29" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(res<span class="sc">$</span>trainX)))</span>
<span id="cb115-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-30" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(res<span class="sc">$</span>trainX))</span>
<span id="cb115-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-31" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res<span class="sc">$</span>trainX))</span>
<span id="cb115-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-32" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(res<span class="sc">$</span>trainX), <span class="dv">8</span>)</span>
<span id="cb115-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-33" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">ncol</span>(res<span class="sc">$</span>trainX), <span class="dv">6</span>)</span>
<span id="cb115-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-34" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">abs</span>(x_train <span class="sc">-</span> res<span class="sc">$</span>trainX) <span class="sc">&lt;</span> <span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">9</span>)))</span>
<span id="cb115-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-36" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(res<span class="sc">$</span>testX)))</span>
<span id="cb115-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-37" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(res<span class="sc">$</span>testX))</span>
<span id="cb115-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-38" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res<span class="sc">$</span>testX))</span>
<span id="cb115-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-39" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(res<span class="sc">$</span>testX), <span class="dv">7</span>)</span>
<span id="cb115-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-40" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">ncol</span>(res<span class="sc">$</span>testX), <span class="dv">6</span>)</span>
<span id="cb115-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-41" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">abs</span>(x_pred <span class="sc">-</span> res<span class="sc">$</span>testX) <span class="sc">&lt;</span> <span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">9</span>)))</span>
<span id="cb115-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-43" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.character</span>(res<span class="sc">$</span>feat_names))</span>
<span id="cb115-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-44" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.na</span>(res<span class="sc">$</span>feat_names))</span>
<span id="cb115-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-46" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.na</span>(res<span class="sc">$</span>max_num_clusts))</span>
<span id="cb115-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-47" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>max_num_clusts) <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb115-48"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-49"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-49" aria-hidden="true" tabindex="-1"></a>  <span class="do">##### Try other bad inputs</span></span>
<span id="cb115-50"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-51"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-51" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGetCssPredsInputs'>checkGetCssPredsInputs</a>(css_res, <span class="at">testX=</span>x_pred,</span>
<span id="cb115-52"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-52" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">weighting=</span><span class="st">&quot;weighted_avg&quot;</span>,</span>
<span id="cb115-53"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-53" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">cutoff=</span><span class="sc">-</span><span class="fl">0.5</span>, <span class="at">min_num_clusts=</span><span class="dv">1</span>,</span>
<span id="cb115-54"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-54" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">max_num_clusts=</span><span class="cn">NA</span>,</span>
<span id="cb115-55"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-55" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">trainX=</span>x_train, <span class="at">trainY=</span>y_train),</span>
<span id="cb115-56"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-56" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;cutoff &gt;= 0 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb115-57"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-58"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-58" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGetCssPredsInputs'>checkGetCssPredsInputs</a>(css_res, <span class="at">testX=</span>x_pred,</span>
<span id="cb115-59"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-59" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">weighting=</span><span class="st">&quot;sparse&quot;</span>,</span>
<span id="cb115-60"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-60" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">cutoff=</span><span class="st">&quot;0.3&quot;</span>, <span class="at">min_num_clusts=</span><span class="dv">1</span>,</span>
<span id="cb115-61"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-61" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">max_num_clusts=</span><span class="cn">NA</span>,</span>
<span id="cb115-62"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-62" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">trainX=</span>x_train, <span class="at">trainY=</span>y_train),</span>
<span id="cb115-63"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-63" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;is.numeric(cutoff) | is.integer(cutoff) is not TRUE&quot;</span>,</span>
<span id="cb115-64"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-64" aria-hidden="true" tabindex="-1"></a>                        <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb115-65"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-66"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-66" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGetCssPredsInputs'>checkGetCssPredsInputs</a>(css_res, <span class="at">testX=</span>x_pred,</span>
<span id="cb115-67"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-67" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">weighting=</span><span class="st">&quot;sparse&quot;</span>,</span>
<span id="cb115-68"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-68" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">cutoff=</span><span class="fu">as.numeric</span>(<span class="cn">NA</span>),</span>
<span id="cb115-69"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-69" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">min_num_clusts=</span><span class="dv">1</span>,</span>
<span id="cb115-70"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-70" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">max_num_clusts=</span><span class="cn">NA</span>,</span>
<span id="cb115-71"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-71" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">trainX=</span>x_train, <span class="at">trainY=</span>y_train),</span>
<span id="cb115-72"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-72" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;!is.na(cutoff) is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb115-73"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-74"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-74" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGetCssPredsInputs'>checkGetCssPredsInputs</a>(css_res, <span class="at">testX=</span>x_pred,</span>
<span id="cb115-75"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-75" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">weighting=</span><span class="fu">c</span>(<span class="st">&quot;sparse&quot;</span>,</span>
<span id="cb115-76"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-76" aria-hidden="true" tabindex="-1"></a>                                                            <span class="st">&quot;simple_avg&quot;</span>),</span>
<span id="cb115-77"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-77" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">cutoff=</span><span class="fl">0.1</span>,</span>
<span id="cb115-78"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-78" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">min_num_clusts=</span><span class="dv">1</span>,</span>
<span id="cb115-79"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-79" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">max_num_clusts=</span><span class="cn">NA</span>,</span>
<span id="cb115-80"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-80" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">trainX=</span>x_train, <span class="at">trainY=</span>y_train),</span>
<span id="cb115-81"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-81" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;length(weighting) == 1 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb115-82"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-83"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-83" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGetCssPredsInputs'>checkGetCssPredsInputs</a>(css_res, <span class="at">testX=</span>x_pred,</span>
<span id="cb115-84"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-84" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">weighting=</span><span class="dv">2</span>, <span class="at">cutoff=</span><span class="fl">0.1</span>,</span>
<span id="cb115-85"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-85" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">min_num_clusts=</span><span class="dv">1</span>,</span>
<span id="cb115-86"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-86" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">max_num_clusts=</span><span class="cn">NA</span>,</span>
<span id="cb115-87"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-87" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">trainX=</span>x_train, <span class="at">trainY=</span>y_train),</span>
<span id="cb115-88"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-88" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;Weighting must be a character&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb115-89"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-90"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-90" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGetCssPredsInputs'>checkGetCssPredsInputs</a>(css_res, <span class="at">testX=</span>x_pred,</span>
<span id="cb115-91"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-91" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">weighting=</span><span class="st">&quot;spasre&quot;</span>, <span class="at">cutoff=</span><span class="fl">0.1</span>,</span>
<span id="cb115-92"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-92" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">min_num_clusts=</span><span class="dv">1</span>,</span>
<span id="cb115-93"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-93" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">max_num_clusts=</span><span class="cn">NA</span>,</span>
<span id="cb115-94"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-94" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">trainX=</span>x_train, <span class="at">trainY=</span>y_train),</span>
<span id="cb115-95"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-95" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;Weighting must be a character and one of sparse, simple_avg, or weighted_avg&quot;</span>,</span>
<span id="cb115-96"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-96" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb115-97"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-98"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-98" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGetCssPredsInputs'>checkGetCssPredsInputs</a>(css_res, <span class="at">testX=</span>x_pred,</span>
<span id="cb115-99"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-99" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">weighting=</span><span class="st">&quot;sparse&quot;</span>, <span class="at">cutoff=</span><span class="fl">0.1</span>,</span>
<span id="cb115-100"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-100" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">min_num_clusts=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb115-101"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-101" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">max_num_clusts=</span><span class="cn">NA</span>,</span>
<span id="cb115-102"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-102" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">trainX=</span>x_train, <span class="at">trainY=</span>y_train),</span>
<span id="cb115-103"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-103" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;length(min_num_clusts) == 1 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb115-104"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-105"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-105" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGetCssPredsInputs'>checkGetCssPredsInputs</a>(css_res, <span class="at">testX=</span>x_pred,</span>
<span id="cb115-106"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-106" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">weighting=</span><span class="st">&quot;weighted_avg&quot;</span>,</span>
<span id="cb115-107"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-107" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">cutoff=</span><span class="fl">0.1</span>, <span class="at">min_num_clusts=</span><span class="st">&quot;2&quot;</span>,</span>
<span id="cb115-108"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-108" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">max_num_clusts=</span><span class="cn">NA</span>,</span>
<span id="cb115-109"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-109" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">trainX=</span>x_train, <span class="at">trainY=</span>y_train),</span>
<span id="cb115-110"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-110" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;is.numeric(min_num_clusts) | is.integer(min_num_clusts) is not TRUE&quot;</span>,</span>
<span id="cb115-111"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-111" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb115-112"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-113"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-113" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGetCssPredsInputs'>checkGetCssPredsInputs</a>(css_res, <span class="at">testX=</span>x_pred,</span>
<span id="cb115-114"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-114" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">weighting=</span><span class="st">&quot;simple_avg&quot;</span>,</span>
<span id="cb115-115"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-115" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">cutoff=</span><span class="fl">0.1</span>, <span class="at">min_num_clusts=</span><span class="dv">0</span>,</span>
<span id="cb115-116"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-116" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">max_num_clusts=</span><span class="cn">NA</span>,</span>
<span id="cb115-117"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-117" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">trainX=</span>x_train, <span class="at">trainY=</span>y_train),</span>
<span id="cb115-118"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-118" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;min_num_clusts &gt;= 1 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb115-119"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-120"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-120" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGetCssPredsInputs'>checkGetCssPredsInputs</a>(css_res, <span class="at">testX=</span>x_pred,</span>
<span id="cb115-121"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-121" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">weighting=</span><span class="st">&quot;weighted_avg&quot;</span>,</span>
<span id="cb115-122"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-122" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">cutoff=</span><span class="fl">0.1</span>, <span class="at">min_num_clusts=</span><span class="dv">10</span>,</span>
<span id="cb115-123"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-123" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">max_num_clusts=</span><span class="cn">NA</span>,</span>
<span id="cb115-124"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-124" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">trainX=</span>x_train, <span class="at">trainY=</span>y_train),</span>
<span id="cb115-125"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-125" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;min_num_clusts &lt;= p is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb115-126"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-127"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-128"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-128" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGetCssPredsInputs'>checkGetCssPredsInputs</a>(css_res, <span class="at">testX=</span>x_pred,</span>
<span id="cb115-129"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-129" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">weighting=</span><span class="st">&quot;simple_avg&quot;</span>,</span>
<span id="cb115-130"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-130" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">cutoff=</span><span class="fl">0.1</span>, <span class="at">min_num_clusts=</span><span class="dv">1</span>,</span>
<span id="cb115-131"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-131" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">max_num_clusts=</span><span class="st">&quot;5&quot;</span>,</span>
<span id="cb115-132"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-132" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">trainX=</span>x_train, <span class="at">trainY=</span>y_train),</span>
<span id="cb115-133"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-133" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;is.numeric(max_num_clusts) | is.integer(max_num_clusts) is not TRUE&quot;</span>,</span>
<span id="cb115-134"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-134" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb115-135"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-136"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-136" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGetCssPredsInputs'>checkGetCssPredsInputs</a>(css_res, <span class="at">testX=</span>x_pred,</span>
<span id="cb115-137"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-137" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">weighting=</span><span class="st">&quot;sparse&quot;</span>,</span>
<span id="cb115-138"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-138" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">cutoff=</span><span class="fl">0.1</span>, <span class="at">min_num_clusts=</span><span class="dv">1</span>,</span>
<span id="cb115-139"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-139" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">max_num_clusts=</span><span class="fl">4.5</span>,</span>
<span id="cb115-140"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-140" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">trainX=</span>x_train, <span class="at">trainY=</span>y_train),</span>
<span id="cb115-141"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-141" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;max_num_clusts == round(max_num_clusts) is not TRUE&quot;</span>,</span>
<span id="cb115-142"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-142" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb115-143"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-144"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-144" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGetCssPredsInputs'>checkGetCssPredsInputs</a>(css_res, <span class="at">testX=</span>x_pred,</span>
<span id="cb115-145"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-145" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">weighting=</span><span class="st">&quot;sparse&quot;</span>,</span>
<span id="cb115-146"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-146" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">cutoff=</span><span class="fl">0.1</span>, <span class="at">min_num_clusts=</span><span class="dv">3</span>,</span>
<span id="cb115-147"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-147" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">max_num_clusts=</span><span class="dv">2</span>,</span>
<span id="cb115-148"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-148" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">trainX=</span>x_train, <span class="at">trainY=</span>y_train),</span>
<span id="cb115-149"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-149" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;max_num_clusts &gt;= min_num_clusts is not TRUE&quot;</span>,</span>
<span id="cb115-150"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-150" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb115-151"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-152"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-152" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGetCssPredsInputs'>checkGetCssPredsInputs</a>(css_res, <span class="at">testX=</span>x_pred,</span>
<span id="cb115-153"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-153" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">weighting=</span><span class="st">&quot;sparse&quot;</span>,</span>
<span id="cb115-154"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-154" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">cutoff=</span><span class="fl">0.1</span>, <span class="at">min_num_clusts=</span><span class="dv">1</span>,</span>
<span id="cb115-155"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-155" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">max_num_clusts=</span><span class="dv">10</span>,</span>
<span id="cb115-156"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-156" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">trainX=</span>x_train, <span class="at">trainY=</span>y_train),</span>
<span id="cb115-157"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-157" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;max_num_clusts &lt;= p is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb115-158"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-159"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-159" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add training indices</span></span>
<span id="cb115-160"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-160" aria-hidden="true" tabindex="-1"></a>  css_res_train <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x_select, <span class="at">y=</span>y_select, <span class="at">lambda=</span><span class="fl">0.01</span>,</span>
<span id="cb115-161"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-161" aria-hidden="true" tabindex="-1"></a>                       <span class="at">clusters=</span>good_clusters, <span class="at">B=</span><span class="dv">10</span>, <span class="at">train_inds=</span><span class="dv">6</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb115-162"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-163"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-163" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Training indices should be ignored if new x is provided</span></span>
<span id="cb115-164"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-165"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-165" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGetCssPredsInputs'>checkGetCssPredsInputs</a>(css_res_train, <span class="at">testX=</span>x_pred,</span>
<span id="cb115-166"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-166" aria-hidden="true" tabindex="-1"></a>                                <span class="at">weighting=</span><span class="st">&quot;weighted_avg&quot;</span>,</span>
<span id="cb115-167"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-167" aria-hidden="true" tabindex="-1"></a>                                <span class="at">cutoff=</span><span class="dv">0</span>, <span class="at">min_num_clusts=</span><span class="dv">1</span>,</span>
<span id="cb115-168"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-168" aria-hidden="true" tabindex="-1"></a>                                <span class="at">max_num_clusts=</span><span class="cn">NA</span>, <span class="at">trainX=</span>x_train,</span>
<span id="cb115-169"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-169" aria-hidden="true" tabindex="-1"></a>                                <span class="at">trainY=</span>y_train)</span>
<span id="cb115-170"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-171"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-171" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res))</span>
<span id="cb115-172"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-172" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(res), <span class="fu">c</span>(<span class="st">&quot;trainXProvided&quot;</span>, <span class="st">&quot;trainX&quot;</span>, <span class="st">&quot;testX&quot;</span>,</span>
<span id="cb115-173"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-173" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">&quot;feat_names&quot;</span>, <span class="st">&quot;max_num_clusts&quot;</span>))</span>
<span id="cb115-174"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-175"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-175" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="sc">!</span><span class="fu">is.na</span>(res<span class="sc">$</span>trainXProvided))</span>
<span id="cb115-176"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-176" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res<span class="sc">$</span>trainXProvided), <span class="dv">1</span>)</span>
<span id="cb115-177"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-177" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.logical</span>(res<span class="sc">$</span>trainXProvided))</span>
<span id="cb115-178"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-178" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(res<span class="sc">$</span>trainXProvided)</span>
<span id="cb115-179"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-180"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-180" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(res<span class="sc">$</span>trainX)))</span>
<span id="cb115-181"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-181" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(res<span class="sc">$</span>trainX))</span>
<span id="cb115-182"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-182" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res<span class="sc">$</span>trainX))</span>
<span id="cb115-183"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-183" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(res<span class="sc">$</span>trainX), <span class="dv">8</span>)</span>
<span id="cb115-184"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-184" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">ncol</span>(res<span class="sc">$</span>trainX), <span class="dv">6</span>)</span>
<span id="cb115-185"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-185" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">abs</span>(x_train <span class="sc">-</span> res<span class="sc">$</span>trainX) <span class="sc">&lt;</span> <span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">9</span>)))</span>
<span id="cb115-186"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-187"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-187" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(res<span class="sc">$</span>testX)))</span>
<span id="cb115-188"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-188" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(res<span class="sc">$</span>testX))</span>
<span id="cb115-189"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-189" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res<span class="sc">$</span>testX))</span>
<span id="cb115-190"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-190" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(res<span class="sc">$</span>testX), <span class="dv">7</span>)</span>
<span id="cb115-191"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-191" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">ncol</span>(res<span class="sc">$</span>testX), <span class="dv">6</span>)</span>
<span id="cb115-192"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-192" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">abs</span>(x_pred <span class="sc">-</span> res<span class="sc">$</span>testX) <span class="sc">&lt;</span> <span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">9</span>)))</span>
<span id="cb115-193"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-194"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-194" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.character</span>(res<span class="sc">$</span>feat_names))</span>
<span id="cb115-195"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-195" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.na</span>(res<span class="sc">$</span>feat_names))</span>
<span id="cb115-196"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-197"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-197" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.na</span>(res<span class="sc">$</span>max_num_clusts))</span>
<span id="cb115-198"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-198" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>max_num_clusts) <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb115-199"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-200"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-200" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Things should still work if new x is not provided</span></span>
<span id="cb115-201"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-201" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-202"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-202" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGetCssPredsInputs'>checkGetCssPredsInputs</a>(css_res_train, <span class="at">testX=</span>x_pred,</span>
<span id="cb115-203"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-203" aria-hidden="true" tabindex="-1"></a>                                <span class="at">weighting=</span><span class="st">&quot;weighted_avg&quot;</span>,</span>
<span id="cb115-204"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-204" aria-hidden="true" tabindex="-1"></a>                                <span class="at">cutoff=</span><span class="dv">0</span>, <span class="at">min_num_clusts=</span><span class="dv">1</span>,</span>
<span id="cb115-205"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-205" aria-hidden="true" tabindex="-1"></a>                                <span class="at">max_num_clusts=</span><span class="cn">NA</span>, <span class="at">trainX=</span><span class="cn">NA</span>, <span class="at">trainY=</span><span class="cn">NA</span>)</span>
<span id="cb115-206"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-207"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-207" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res))</span>
<span id="cb115-208"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-208" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(res), <span class="fu">c</span>(<span class="st">&quot;trainXProvided&quot;</span>, <span class="st">&quot;trainX&quot;</span>, <span class="st">&quot;testX&quot;</span>,</span>
<span id="cb115-209"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-209" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">&quot;feat_names&quot;</span>, <span class="st">&quot;max_num_clusts&quot;</span>))</span>
<span id="cb115-210"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-211"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-211" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="sc">!</span><span class="fu">is.na</span>(res<span class="sc">$</span>trainXProvided))</span>
<span id="cb115-212"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-212" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res<span class="sc">$</span>trainXProvided), <span class="dv">1</span>)</span>
<span id="cb115-213"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-213" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.logical</span>(res<span class="sc">$</span>trainXProvided))</span>
<span id="cb115-214"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-214" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="sc">!</span>res<span class="sc">$</span>trainXProvided)</span>
<span id="cb115-215"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-216"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-216" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(res<span class="sc">$</span>trainX)))</span>
<span id="cb115-217"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-217" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(res<span class="sc">$</span>trainX))</span>
<span id="cb115-218"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-218" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res<span class="sc">$</span>trainX))</span>
<span id="cb115-219"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-219" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(res<span class="sc">$</span>trainX), <span class="dv">5</span>)</span>
<span id="cb115-220"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-220" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">ncol</span>(res<span class="sc">$</span>trainX), <span class="dv">6</span>)</span>
<span id="cb115-221"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-221" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">abs</span>(x_select[<span class="dv">6</span><span class="sc">:</span><span class="dv">10</span>, ] <span class="sc">-</span> res<span class="sc">$</span>trainX) <span class="sc">&lt;</span> <span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">9</span>)))</span>
<span id="cb115-222"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-223"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-223" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(res<span class="sc">$</span>testX)))</span>
<span id="cb115-224"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-224" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(res<span class="sc">$</span>testX))</span>
<span id="cb115-225"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-225" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res<span class="sc">$</span>testX))</span>
<span id="cb115-226"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-226" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(res<span class="sc">$</span>testX), <span class="dv">7</span>)</span>
<span id="cb115-227"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-227" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">ncol</span>(res<span class="sc">$</span>testX), <span class="dv">6</span>)</span>
<span id="cb115-228"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-228" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">abs</span>(x_pred <span class="sc">-</span> res<span class="sc">$</span>testX) <span class="sc">&lt;</span> <span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">9</span>)))</span>
<span id="cb115-229"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-230"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-230" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.character</span>(res<span class="sc">$</span>feat_names))</span>
<span id="cb115-231"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-231" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.na</span>(res<span class="sc">$</span>feat_names))</span>
<span id="cb115-232"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-233"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-233" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.na</span>(res<span class="sc">$</span>max_num_clusts))</span>
<span id="cb115-234"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-234" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>max_num_clusts) <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb115-235"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-236"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-237"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-237" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Try not providing training indices and omitting newX--should get error</span></span>
<span id="cb115-238"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-238" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGetCssPredsInputs'>checkGetCssPredsInputs</a>(css_res, <span class="at">testX=</span>x_pred,</span>
<span id="cb115-239"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-239" aria-hidden="true" tabindex="-1"></a>                                <span class="at">weighting=</span><span class="st">&quot;sparse&quot;</span>,</span>
<span id="cb115-240"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-240" aria-hidden="true" tabindex="-1"></a>                                <span class="at">cutoff=</span><span class="dv">0</span>, <span class="at">min_num_clusts=</span><span class="dv">1</span>,</span>
<span id="cb115-241"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-241" aria-hidden="true" tabindex="-1"></a>                                <span class="at">max_num_clusts=</span><span class="cn">NA</span>, <span class="at">trainX=</span><span class="cn">NA</span>, <span class="at">trainY=</span><span class="cn">NA</span>),</span>
<span id="cb115-242"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-242" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;css was not provided with indices to set aside for model training (train_inds), so must provide new X in order to generate a design matrix&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb115-243"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-244"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-244" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Try naming variables</span></span>
<span id="cb115-245"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-246"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-246" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(x_select) <span class="ot">&lt;-</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span>
<span id="cb115-247"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-247" aria-hidden="true" tabindex="-1"></a>  css_res_named <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x_select, <span class="at">y=</span>y_select, <span class="at">lambda=</span><span class="fl">0.01</span>,</span>
<span id="cb115-248"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-248" aria-hidden="true" tabindex="-1"></a>                       <span class="at">clusters=</span>good_clusters, <span class="at">B =</span> <span class="dv">10</span>)</span>
<span id="cb115-249"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-250"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-250" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Named variables for css matrix but not new one--should get a warning</span></span>
<span id="cb115-251"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-251" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_warning</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGetCssPredsInputs'>checkGetCssPredsInputs</a>(css_res_named, <span class="at">testX=</span>x_pred,</span>
<span id="cb115-252"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-252" aria-hidden="true" tabindex="-1"></a>                                <span class="at">weighting=</span><span class="st">&quot;simple_avg&quot;</span>, <span class="at">cutoff=</span><span class="dv">0</span>,</span>
<span id="cb115-253"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-253" aria-hidden="true" tabindex="-1"></a>                                <span class="at">min_num_clusts=</span><span class="dv">1</span>, <span class="at">max_num_clusts=</span><span class="cn">NA</span>,</span>
<span id="cb115-254"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-254" aria-hidden="true" tabindex="-1"></a>                                <span class="at">trainX=</span>x_train, <span class="at">trainY=</span>y_train),</span>
<span id="cb115-255"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-255" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;New X provided had no variable names (column names) even though the X provided to css did.&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb115-256"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-257"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-257" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Try mismatching variable names</span></span>
<span id="cb115-258"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-258" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(x_train) <span class="ot">&lt;-</span> LETTERS[<span class="dv">2</span><span class="sc">:</span><span class="dv">7</span>]</span>
<span id="cb115-259"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-259" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(x_pred) <span class="ot">&lt;-</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span>
<span id="cb115-260"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-260" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGetCssPredsInputs'>checkGetCssPredsInputs</a>(css_res_named, <span class="at">testX=</span>x_pred,</span>
<span id="cb115-261"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-261" aria-hidden="true" tabindex="-1"></a>                                <span class="at">weighting=</span><span class="st">&quot;weighted_avg&quot;</span>, <span class="at">cutoff=</span><span class="dv">0</span>,</span>
<span id="cb115-262"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-262" aria-hidden="true" tabindex="-1"></a>                                <span class="at">min_num_clusts=</span><span class="dv">1</span>, <span class="at">max_num_clusts=</span><span class="cn">NA</span>,</span>
<span id="cb115-263"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-263" aria-hidden="true" tabindex="-1"></a>                                <span class="at">trainX=</span>x_train, <span class="at">trainY=</span>y_train),</span>
<span id="cb115-264"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-264" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;identical(feat_names, colnames(css_X)) is not TRUE&quot;</span>,</span>
<span id="cb115-265"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-265" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb115-266"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-267"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(x_train) <span class="ot">&lt;-</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span>
<span id="cb115-268"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(x_pred) <span class="ot">&lt;-</span> LETTERS[<span class="dv">2</span><span class="sc">:</span><span class="dv">7</span>]</span>
<span id="cb115-269"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-269" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGetCssPredsInputs'>checkGetCssPredsInputs</a>(css_res_named, <span class="at">testX=</span>x_pred,</span>
<span id="cb115-270"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-270" aria-hidden="true" tabindex="-1"></a>                                <span class="at">weighting=</span><span class="st">&quot;sparse&quot;</span>, <span class="at">cutoff=</span><span class="dv">0</span>,</span>
<span id="cb115-271"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-271" aria-hidden="true" tabindex="-1"></a>                                <span class="at">min_num_clusts=</span><span class="dv">1</span>, <span class="at">max_num_clusts=</span><span class="cn">NA</span>,</span>
<span id="cb115-272"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-272" aria-hidden="true" tabindex="-1"></a>                                <span class="at">trainX=</span>x_train, <span class="at">trainY=</span>y_train),</span>
<span id="cb115-273"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-273" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;identical(feat_names, colnames(css_X)) is not TRUE&quot;</span>,</span>
<span id="cb115-274"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-274" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb115-275"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-276"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-276" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(x_pred) <span class="ot">&lt;-</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span>
<span id="cb115-277"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-278"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-278" aria-hidden="true" tabindex="-1"></a>  res_named <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGetCssPredsInputs'>checkGetCssPredsInputs</a>(css_res_named, <span class="at">testX=</span>x_pred,</span>
<span id="cb115-279"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-279" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">weighting=</span><span class="st">&quot;simple_avg&quot;</span>, <span class="at">cutoff=</span><span class="dv">0</span>,</span>
<span id="cb115-280"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-280" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">min_num_clusts=</span><span class="dv">1</span>, <span class="at">max_num_clusts=</span><span class="cn">NA</span>,</span>
<span id="cb115-281"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-281" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">trainX=</span>x_train, <span class="at">trainY=</span>y_train)</span>
<span id="cb115-282"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-283"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-283" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res_named))</span>
<span id="cb115-284"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-284" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(res_named), <span class="fu">c</span>(<span class="st">&quot;trainXProvided&quot;</span>, <span class="st">&quot;trainX&quot;</span>, <span class="st">&quot;testX&quot;</span>,</span>
<span id="cb115-285"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-285" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">&quot;feat_names&quot;</span>, <span class="st">&quot;max_num_clusts&quot;</span>))</span>
<span id="cb115-286"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-287"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-287" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(res_named<span class="sc">$</span>trainX)))</span>
<span id="cb115-288"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-288" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(res_named<span class="sc">$</span>trainX))</span>
<span id="cb115-289"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-289" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res_named<span class="sc">$</span>trainX))</span>
<span id="cb115-290"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-290" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(res_named<span class="sc">$</span>trainX), <span class="dv">8</span>)</span>
<span id="cb115-291"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-291" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">ncol</span>(res_named<span class="sc">$</span>trainX), <span class="dv">6</span>)</span>
<span id="cb115-292"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-292" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">abs</span>(x_train <span class="sc">-</span> res_named<span class="sc">$</span>trainX) <span class="sc">&lt;</span> <span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">9</span>)))</span>
<span id="cb115-293"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-293" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-294"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-294" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.character</span>(res_named<span class="sc">$</span>feat_names))</span>
<span id="cb115-295"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-295" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(res_named<span class="sc">$</span>feat_names, LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>])</span>
<span id="cb115-296"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-297"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-297" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Try data.frame input to css and checkGetCssPredsInputs</span></span>
<span id="cb115-298"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-299"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-299" aria-hidden="true" tabindex="-1"></a>  X_df <span class="ot">&lt;-</span> datasets<span class="sc">::</span>mtcars</span>
<span id="cb115-300"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-301"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-301" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(X_df)</span>
<span id="cb115-302"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-302" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">rnorm</span>(n)</span>
<span id="cb115-303"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-304"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-304" aria-hidden="true" tabindex="-1"></a>  selec_inds <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">round</span>(n<span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb115-305"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-305" aria-hidden="true" tabindex="-1"></a>  train_inds <span class="ot">&lt;-</span> (<span class="fu">max</span>(selec_inds) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">round</span>(n<span class="sc">/</span><span class="dv">3</span>))</span>
<span id="cb115-306"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-306" aria-hidden="true" tabindex="-1"></a>  test_inds <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="fu">c</span>(selec_inds, train_inds))</span>
<span id="cb115-307"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-308"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-308" aria-hidden="true" tabindex="-1"></a>  css_res_df <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>X_df[<span class="fu">c</span>(selec_inds, train_inds), ],</span>
<span id="cb115-309"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-309" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y=</span>y[<span class="fu">c</span>(selec_inds, train_inds)], <span class="at">lambda=</span><span class="fl">0.01</span>, <span class="at">B =</span> <span class="dv">10</span>,</span>
<span id="cb115-310"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-310" aria-hidden="true" tabindex="-1"></a>                    <span class="at">train_inds=</span>train_inds)</span>
<span id="cb115-311"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-311" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-312"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-312" aria-hidden="true" tabindex="-1"></a>  res_df <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGetCssPredsInputs'>checkGetCssPredsInputs</a>(css_res_df, <span class="at">testX=</span>X_df[test_inds, ],</span>
<span id="cb115-313"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-313" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">weighting=</span><span class="st">&quot;sparse&quot;</span>, <span class="at">cutoff=</span><span class="dv">0</span>,</span>
<span id="cb115-314"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-314" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">min_num_clusts=</span><span class="dv">1</span>, <span class="at">max_num_clusts=</span><span class="cn">NA</span>,</span>
<span id="cb115-315"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-315" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">trainX=</span><span class="cn">NA</span>, <span class="at">trainY=</span><span class="cn">NA</span>)</span>
<span id="cb115-316"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-316" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-317"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-317" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res_df))</span>
<span id="cb115-318"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-318" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(res_df), <span class="fu">c</span>(<span class="st">&quot;trainXProvided&quot;</span>, <span class="st">&quot;trainX&quot;</span>,</span>
<span id="cb115-319"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-319" aria-hidden="true" tabindex="-1"></a>                                              <span class="st">&quot;testX&quot;</span>,<span class="st">&quot;feat_names&quot;</span>,</span>
<span id="cb115-320"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-320" aria-hidden="true" tabindex="-1"></a>                                              <span class="st">&quot;max_num_clusts&quot;</span>))</span>
<span id="cb115-321"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-321" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-322"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-322" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(res_df<span class="sc">$</span>trainX)))</span>
<span id="cb115-323"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-323" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(res_df<span class="sc">$</span>trainX))</span>
<span id="cb115-324"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-324" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res_df<span class="sc">$</span>trainX))</span>
<span id="cb115-325"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-325" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(res_df<span class="sc">$</span>trainX), <span class="fu">length</span>(train_inds))</span>
<span id="cb115-326"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-326" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-327"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-327" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>(<span class="fu">nrow</span>(css_res_df<span class="sc">$</span>X) <span class="sc">&gt;=</span> <span class="fu">max</span>(train_inds))</span>
<span id="cb115-328"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-328" aria-hidden="true" tabindex="-1"></a>  train_mat <span class="ot">&lt;-</span> css_res_df<span class="sc">$</span>X[train_inds, ]</span>
<span id="cb115-329"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-330"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-330" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">ncol</span>(res_df<span class="sc">$</span>trainX), <span class="fu">ncol</span>(train_mat))</span>
<span id="cb115-331"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-331" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">abs</span>(train_mat <span class="sc">-</span> res_df<span class="sc">$</span>trainX) <span class="sc">&lt;</span> <span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">9</span>)))</span>
<span id="cb115-332"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-332" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">colnames</span>(res_df<span class="sc">$</span>trainX), <span class="fu">colnames</span>(train_mat))</span>
<span id="cb115-333"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-334"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-334" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(res_df<span class="sc">$</span>testX)))</span>
<span id="cb115-335"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-335" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(res_df<span class="sc">$</span>testX))</span>
<span id="cb115-336"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-336" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res_df<span class="sc">$</span>testX))</span>
<span id="cb115-337"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-337" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(res_df<span class="sc">$</span>testX), <span class="fu">length</span>(test_inds))</span>
<span id="cb115-338"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-338" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-339"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-339" aria-hidden="true" tabindex="-1"></a>  test_mat <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">model.matrix</span>(<span class="sc">~</span> ., X_df[test_inds, ])</span>
<span id="cb115-340"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-340" aria-hidden="true" tabindex="-1"></a>  test_mat <span class="ot">&lt;-</span> test_mat[, <span class="fu">colnames</span>(test_mat) <span class="sc">!=</span> <span class="st">&quot;(Intercept)&quot;</span>]</span>
<span id="cb115-341"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-341" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-342"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-342" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">ncol</span>(res_df<span class="sc">$</span>testX), <span class="fu">ncol</span>(test_mat))</span>
<span id="cb115-343"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-343" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">abs</span>(test_mat <span class="sc">-</span> res_df<span class="sc">$</span>testX) <span class="sc">&lt;</span> <span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">9</span>)))</span>
<span id="cb115-344"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-344" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">colnames</span>(res_df<span class="sc">$</span>testX), <span class="fu">colnames</span>(test_mat))</span>
<span id="cb115-345"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-345" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">colnames</span>(res_df<span class="sc">$</span>testX), <span class="fu">colnames</span>(res_df<span class="sc">$</span>trainX))</span>
<span id="cb115-346"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-347"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-347" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Try again with X as a dataframe with factors (number of columns of final</span></span>
<span id="cb115-348"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-348" aria-hidden="true" tabindex="-1"></a>  <span class="co"># design matrix after one-hot encoding factors won&#39;t match number of columns</span></span>
<span id="cb115-349"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-349" aria-hidden="true" tabindex="-1"></a>  <span class="co"># of X_df)</span></span>
<span id="cb115-350"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-350" aria-hidden="true" tabindex="-1"></a>  X_df<span class="sc">$</span>cyl <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(X_df<span class="sc">$</span>cyl)</span>
<span id="cb115-351"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-351" aria-hidden="true" tabindex="-1"></a>  X_df<span class="sc">$</span>vs <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(X_df<span class="sc">$</span>vs)</span>
<span id="cb115-352"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-352" aria-hidden="true" tabindex="-1"></a>  X_df<span class="sc">$</span>am <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(X_df<span class="sc">$</span>am)</span>
<span id="cb115-353"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-353" aria-hidden="true" tabindex="-1"></a>  X_df<span class="sc">$</span>gear <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(X_df<span class="sc">$</span>gear)</span>
<span id="cb115-354"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-354" aria-hidden="true" tabindex="-1"></a>  X_df<span class="sc">$</span>carb <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(X_df<span class="sc">$</span>carb)</span>
<span id="cb115-355"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-356"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-356" aria-hidden="true" tabindex="-1"></a>  css_res_df <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>X_df[selec_inds, ], <span class="at">y=</span>y[selec_inds], <span class="at">lambda=</span><span class="fl">0.01</span>, <span class="at">B =</span> <span class="dv">10</span>)</span>
<span id="cb115-357"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-357" aria-hidden="true" tabindex="-1"></a>  res_df <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGetCssPredsInputs'>checkGetCssPredsInputs</a>(css_res_df, <span class="at">testX=</span>X_df[test_inds, ],</span>
<span id="cb115-358"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-358" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">weighting=</span><span class="st">&quot;simple_avg&quot;</span>, <span class="at">cutoff=</span><span class="fl">0.3</span>,</span>
<span id="cb115-359"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-359" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">min_num_clusts=</span><span class="dv">1</span>, <span class="at">max_num_clusts=</span><span class="dv">4</span>,</span>
<span id="cb115-360"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-360" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">trainX=</span>X_df[train_inds, ],</span>
<span id="cb115-361"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-361" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">trainY=</span>y[train_inds])</span>
<span id="cb115-362"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-362" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-363"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-363" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res_df))</span>
<span id="cb115-364"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-364" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(res_df), <span class="fu">c</span>(<span class="st">&quot;trainXProvided&quot;</span>, <span class="st">&quot;trainX&quot;</span>,</span>
<span id="cb115-365"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-365" aria-hidden="true" tabindex="-1"></a>                                              <span class="st">&quot;testX&quot;</span>,<span class="st">&quot;feat_names&quot;</span>,</span>
<span id="cb115-366"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-366" aria-hidden="true" tabindex="-1"></a>                                              <span class="st">&quot;max_num_clusts&quot;</span>))</span>
<span id="cb115-367"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-367" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-368"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-368" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(res_df<span class="sc">$</span>trainX)))</span>
<span id="cb115-369"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-369" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(res_df<span class="sc">$</span>trainX))</span>
<span id="cb115-370"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-370" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res_df<span class="sc">$</span>trainX))</span>
<span id="cb115-371"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-371" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(res_df<span class="sc">$</span>trainX), <span class="fu">length</span>(train_inds))</span>
<span id="cb115-372"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-372" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-373"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-373" aria-hidden="true" tabindex="-1"></a>  train_mat <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">model.matrix</span>(<span class="sc">~</span> ., X_df[train_inds, ])</span>
<span id="cb115-374"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-374" aria-hidden="true" tabindex="-1"></a>  train_mat <span class="ot">&lt;-</span> train_mat[, <span class="fu">colnames</span>(train_mat) <span class="sc">!=</span> <span class="st">&quot;(Intercept)&quot;</span>]</span>
<span id="cb115-375"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-376"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-376" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">ncol</span>(res_df<span class="sc">$</span>trainX), <span class="fu">ncol</span>(train_mat))</span>
<span id="cb115-377"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-377" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">abs</span>(train_mat <span class="sc">-</span> res_df<span class="sc">$</span>trainX) <span class="sc">&lt;</span> <span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">9</span>)))</span>
<span id="cb115-378"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-379"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-379" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(res_df<span class="sc">$</span>testX)))</span>
<span id="cb115-380"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-380" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(res_df<span class="sc">$</span>testX))</span>
<span id="cb115-381"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-381" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res_df<span class="sc">$</span>testX))</span>
<span id="cb115-382"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-382" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(res_df<span class="sc">$</span>testX), <span class="fu">length</span>(test_inds))</span>
<span id="cb115-383"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-383" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-384"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-384" aria-hidden="true" tabindex="-1"></a>  test_mat <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">model.matrix</span>(<span class="sc">~</span> ., X_df[test_inds, ])</span>
<span id="cb115-385"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-385" aria-hidden="true" tabindex="-1"></a>  test_mat <span class="ot">&lt;-</span> test_mat[, <span class="fu">colnames</span>(test_mat) <span class="sc">!=</span> <span class="st">&quot;(Intercept)&quot;</span>]</span>
<span id="cb115-386"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-386" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-387"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-387" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">ncol</span>(res_df<span class="sc">$</span>testX), <span class="fu">ncol</span>(test_mat))</span>
<span id="cb115-388"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-388" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">abs</span>(test_mat <span class="sc">-</span> res_df<span class="sc">$</span>testX) <span class="sc">&lt;</span> <span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">9</span>)))</span>
<span id="cb115-389"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-390"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-390" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-391"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb115-391" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## ── Warning (&#39;&lt;text&gt;:251&#39;): checkGetCssPredsInputs works ────────────────────────
## New X provided had no variable names (column names) even though the X provided to css did.
## Backtrace:
##  1. testthat::expect_warning(...)
##  7. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGetCssPredsInputs'>checkGetCssPredsInputs</a>(...)
##  8. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkXInputResults'>checkXInputResults</a>(testX, css_results$X)
## 
## ── Warning (&#39;&lt;text&gt;:278&#39;): checkGetCssPredsInputs works ────────────────────────
## Column names were provided for testX but not for trainX (are you sure they both contain identical features in the same order?)
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGetCssPredsInputs'>checkGetCssPredsInputs</a>(...)
## 
## ── Warning (&#39;&lt;text&gt;:357&#39;): checkGetCssPredsInputs works ────────────────────────
## Column names were provided for testX but not for trainX (are you sure they both contain identical features in the same order?)
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGetCssPredsInputs'>checkGetCssPredsInputs</a>(...)</code></pre>
<p>Finally, tests for getCssPreds</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-1" aria-hidden="true" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">test_that</span>(<span class="st">&quot;getCssPreds works&quot;</span>, {</span>
<span id="cb117-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">70811</span>)</span>
<span id="cb117-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-4" aria-hidden="true" tabindex="-1"></a>  x_select <span class="ot">&lt;-</span> <span class="fu">matrix</span>(stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">10</span><span class="sc">*</span><span class="dv">6</span>), <span class="at">nrow=</span><span class="dv">10</span>, <span class="at">ncol=</span><span class="dv">6</span>)</span>
<span id="cb117-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-5" aria-hidden="true" tabindex="-1"></a>  x_train <span class="ot">&lt;-</span> <span class="fu">matrix</span>(stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">8</span><span class="sc">*</span><span class="dv">6</span>), <span class="at">nrow=</span><span class="dv">8</span>, <span class="at">ncol=</span><span class="dv">6</span>)</span>
<span id="cb117-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-6" aria-hidden="true" tabindex="-1"></a>  x_pred <span class="ot">&lt;-</span> <span class="fu">matrix</span>(stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">7</span><span class="sc">*</span><span class="dv">6</span>), <span class="at">nrow=</span><span class="dv">7</span>, <span class="at">ncol=</span><span class="dv">6</span>)</span>
<span id="cb117-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-7" aria-hidden="true" tabindex="-1"></a>  y_select <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">10</span>)</span>
<span id="cb117-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-8" aria-hidden="true" tabindex="-1"></a>  y_train <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">8</span>)</span>
<span id="cb117-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-10" aria-hidden="true" tabindex="-1"></a>  good_clusters <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;red&quot;</span><span class="ot">=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="st">&quot;blue&quot;</span><span class="ot">=</span><span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="st">&quot;green&quot;</span><span class="ot">=</span><span class="dv">5</span>)</span>
<span id="cb117-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-12" aria-hidden="true" tabindex="-1"></a>  css_res <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x_select, <span class="at">y=</span>y_select, <span class="at">lambda=</span><span class="fl">0.01</span>, <span class="at">clusters=</span>good_clusters,</span>
<span id="cb117-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-13" aria-hidden="true" tabindex="-1"></a>                 <span class="at">B =</span> <span class="dv">10</span>)</span>
<span id="cb117-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-15" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssPreds'>getCssPreds</a>(css_res, <span class="at">testX=</span>x_pred, <span class="at">trainX=</span>x_train, <span class="at">trainY=</span>y_train)</span>
<span id="cb117-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-17" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(res)))</span>
<span id="cb117-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-18" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res))</span>
<span id="cb117-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-19" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), <span class="dv">7</span>)</span>
<span id="cb117-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb117-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-21" aria-hidden="true" tabindex="-1"></a>  <span class="do">##### Try other bad inputs</span></span>
<span id="cb117-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-23" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssPreds'>getCssPreds</a>(css_res, <span class="at">testX=</span>x_pred, <span class="at">cutoff=</span><span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb117-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-24" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">trainX=</span>x_train, <span class="at">trainY=</span>y_train),</span>
<span id="cb117-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-25" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;cutoff &gt;= 0 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb117-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-27" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssPreds'>getCssPreds</a>(css_res, <span class="at">testX=</span>x_pred, <span class="at">cutoff=</span><span class="st">&quot;0.3&quot;</span>,</span>
<span id="cb117-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-28" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">trainX=</span>x_train, <span class="at">trainY=</span>y_train),</span>
<span id="cb117-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-29" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;is.numeric(cutoff) | is.integer(cutoff) is not TRUE&quot;</span>,</span>
<span id="cb117-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-30" aria-hidden="true" tabindex="-1"></a>                        <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb117-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-32" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssPreds'>getCssPreds</a>(css_res, <span class="at">testX=</span>x_pred,</span>
<span id="cb117-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-33" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">cutoff=</span><span class="fu">as.numeric</span>(<span class="cn">NA</span>), <span class="at">trainX=</span>x_train,</span>
<span id="cb117-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-34" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">trainY=</span>y_train),</span>
<span id="cb117-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-35" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;!is.na(cutoff) is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb117-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-37" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssPreds'>getCssPreds</a>(css_res, <span class="at">testX=</span>x_pred,</span>
<span id="cb117-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-38" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">weighting=</span><span class="fu">c</span>(<span class="st">&quot;sparse&quot;</span>, <span class="st">&quot;simple_avg&quot;</span>),</span>
<span id="cb117-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-39" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">trainX=</span>x_train, <span class="at">trainY=</span>y_train),</span>
<span id="cb117-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-40" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;length(weighting) == 1 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb117-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-42" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssPreds'>getCssPreds</a>(css_res, <span class="at">testX=</span>x_pred, <span class="at">weighting=</span><span class="dv">2</span>,</span>
<span id="cb117-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-43" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">trainX=</span>x_train, <span class="at">trainY=</span>y_train),</span>
<span id="cb117-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-44" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;Weighting must be a character&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb117-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-46" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssPreds'>getCssPreds</a>(css_res, <span class="at">testX=</span>x_pred, <span class="at">weighting=</span><span class="st">&quot;spasre&quot;</span>,</span>
<span id="cb117-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-47" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">trainX=</span>x_train, <span class="at">trainY=</span>y_train),</span>
<span id="cb117-48"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-48" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;Weighting must be a character and one of sparse, simple_avg, or weighted_avg&quot;</span>,</span>
<span id="cb117-49"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-49" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb117-50"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-51"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-51" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssPreds'>getCssPreds</a>(css_res, <span class="at">testX=</span>x_pred,</span>
<span id="cb117-52"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-52" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">min_num_clusts=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">trainX=</span>x_train,</span>
<span id="cb117-53"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-53" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">trainY=</span>y_train),</span>
<span id="cb117-54"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-54" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;length(min_num_clusts) == 1 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb117-55"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-56"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-56" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssPreds'>getCssPreds</a>(css_res, <span class="at">testX=</span>x_pred, <span class="at">min_num_clusts=</span><span class="st">&quot;2&quot;</span>,</span>
<span id="cb117-57"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-57" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">trainX=</span>x_train, <span class="at">trainY=</span>y_train),</span>
<span id="cb117-58"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-58" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;is.numeric(min_num_clusts) | is.integer(min_num_clusts) is not TRUE&quot;</span>,</span>
<span id="cb117-59"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-59" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb117-60"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-61"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-61" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssPreds'>getCssPreds</a>(css_res, <span class="at">testX=</span>x_pred, <span class="at">min_num_clusts=</span><span class="dv">0</span>,</span>
<span id="cb117-62"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-62" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">trainX=</span>x_train, <span class="at">trainY=</span>y_train),</span>
<span id="cb117-63"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-63" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;min_num_clusts &gt;= 1 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb117-64"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-65"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-65" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssPreds'>getCssPreds</a>(css_res, <span class="at">testX=</span>x_pred, <span class="at">min_num_clusts=</span><span class="dv">10</span>,</span>
<span id="cb117-66"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-66" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">trainX=</span>x_train, <span class="at">trainY=</span>y_train),</span>
<span id="cb117-67"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-67" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;min_num_clusts &lt;= p is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb117-68"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-69"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-70"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-70" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssPreds'>getCssPreds</a>(css_res, <span class="at">testX=</span>x_pred, <span class="at">max_num_clusts=</span><span class="st">&quot;5&quot;</span>,</span>
<span id="cb117-71"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-71" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">trainX=</span>x_train, <span class="at">trainY=</span>y_train),</span>
<span id="cb117-72"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-72" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;is.numeric(max_num_clusts) | is.integer(max_num_clusts) is not TRUE&quot;</span>,</span>
<span id="cb117-73"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-73" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb117-74"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-75"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-75" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssPreds'>getCssPreds</a>(css_res, <span class="at">testX=</span>x_pred, <span class="at">max_num_clusts=</span><span class="fl">4.5</span>,</span>
<span id="cb117-76"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-76" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">trainX=</span>x_train, <span class="at">trainY=</span>y_train),</span>
<span id="cb117-77"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-77" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;max_num_clusts == round(max_num_clusts) is not TRUE&quot;</span>,</span>
<span id="cb117-78"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-78" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb117-79"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-80"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-80" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssPreds'>getCssPreds</a>(css_res, <span class="at">testX=</span>x_pred, <span class="at">min_num_clusts=</span><span class="dv">3</span>,</span>
<span id="cb117-81"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-81" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">max_num_clusts=</span><span class="dv">2</span>, <span class="at">trainX=</span>x_train,</span>
<span id="cb117-82"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-82" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">trainY=</span>y_train),</span>
<span id="cb117-83"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-83" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;max_num_clusts &gt;= min_num_clusts is not TRUE&quot;</span>,</span>
<span id="cb117-84"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-84" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb117-85"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-86"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-86" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssPreds'>getCssPreds</a>(css_res, <span class="at">testX=</span>x_pred, <span class="at">max_num_clusts=</span><span class="dv">10</span>,</span>
<span id="cb117-87"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-87" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">trainX=</span>x_train, <span class="at">trainY=</span>y_train),</span>
<span id="cb117-88"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-88" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;max_num_clusts &lt;= p is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb117-89"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-90"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-90" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add training indices</span></span>
<span id="cb117-91"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-91" aria-hidden="true" tabindex="-1"></a>  css_res_train <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x_select, <span class="at">y=</span>y_select, <span class="at">lambda=</span><span class="fl">0.01</span>,</span>
<span id="cb117-92"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-92" aria-hidden="true" tabindex="-1"></a>                       <span class="at">clusters=</span>good_clusters, <span class="at">B=</span><span class="dv">10</span>, <span class="at">train_inds=</span><span class="dv">6</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb117-93"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-94"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-94" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Training indices should be ignored if new x is provided</span></span>
<span id="cb117-95"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-96"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-96" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssPreds'>getCssPreds</a>(css_res_train, <span class="at">testX=</span>x_pred, <span class="at">trainX=</span>x_train,</span>
<span id="cb117-97"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-97" aria-hidden="true" tabindex="-1"></a>                     <span class="at">trainY=</span>y_train)</span>
<span id="cb117-98"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-99"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-99" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(res)))</span>
<span id="cb117-100"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-100" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res))</span>
<span id="cb117-101"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-101" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), <span class="dv">7</span>)</span>
<span id="cb117-102"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-102" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb117-103"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-103" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Things should still work if new x is not provided</span></span>
<span id="cb117-104"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-105"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-105" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssPreds'>getCssPreds</a>(css_res_train, <span class="at">testX=</span>x_pred)</span>
<span id="cb117-106"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-106" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb117-107"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-107" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(res)))</span>
<span id="cb117-108"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-108" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res))</span>
<span id="cb117-109"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-109" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), <span class="dv">7</span>)</span>
<span id="cb117-110"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-111"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-111" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Try not providing training indices and omitting newX--should get error</span></span>
<span id="cb117-112"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-112" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssPreds'>getCssPreds</a>(css_res, <span class="at">testX=</span>x_pred),</span>
<span id="cb117-113"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-113" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;css was not provided with indices to set aside for model training (train_inds), so must provide new X in order to generate a design matrix&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb117-114"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-115"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-115" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Try naming variables</span></span>
<span id="cb117-116"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-117"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(x_select) <span class="ot">&lt;-</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span>
<span id="cb117-118"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-118" aria-hidden="true" tabindex="-1"></a>  css_res_named <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x_select, <span class="at">y=</span>y_select, <span class="at">lambda=</span><span class="fl">0.01</span>,</span>
<span id="cb117-119"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-119" aria-hidden="true" tabindex="-1"></a>                       <span class="at">clusters=</span>good_clusters, <span class="at">B =</span> <span class="dv">10</span>)</span>
<span id="cb117-120"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-121"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-121" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Named variables for css matrix but not new one--should get a warning</span></span>
<span id="cb117-122"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-122" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_warning</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssPreds'>getCssPreds</a>(css_res_named, <span class="at">testX=</span>x_pred,</span>
<span id="cb117-123"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-123" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">trainX=</span>x_train, <span class="at">trainY=</span>y_train),</span>
<span id="cb117-124"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-124" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;New X provided had no variable names (column names) even though the X provided to css did.&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb117-125"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-126"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-126" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Try mismatching variable names</span></span>
<span id="cb117-127"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(x_train) <span class="ot">&lt;-</span> LETTERS[<span class="dv">2</span><span class="sc">:</span><span class="dv">7</span>]</span>
<span id="cb117-128"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(x_pred) <span class="ot">&lt;-</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span>
<span id="cb117-129"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-129" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssPreds'>getCssPreds</a>(css_res_named, <span class="at">testX=</span>x_pred,</span>
<span id="cb117-130"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-130" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">trainX=</span>x_train, <span class="at">trainY=</span>y_train),</span>
<span id="cb117-131"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-131" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;identical(feat_names, colnames(css_X)) is not TRUE&quot;</span>,</span>
<span id="cb117-132"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-132" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb117-133"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-134"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(x_train) <span class="ot">&lt;-</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span>
<span id="cb117-135"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(x_pred) <span class="ot">&lt;-</span> LETTERS[<span class="dv">2</span><span class="sc">:</span><span class="dv">7</span>]</span>
<span id="cb117-136"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-136" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssPreds'>getCssPreds</a>(css_res_named, <span class="at">testX=</span>x_pred,</span>
<span id="cb117-137"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-137" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">trainX=</span>x_train, <span class="at">trainY=</span>y_train),</span>
<span id="cb117-138"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-138" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;identical(feat_names, colnames(css_X)) is not TRUE&quot;</span>,</span>
<span id="cb117-139"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-139" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb117-140"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-141"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(x_pred) <span class="ot">&lt;-</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span>
<span id="cb117-142"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-143"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-143" aria-hidden="true" tabindex="-1"></a>  res_named <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssPreds'>getCssPreds</a>(css_res_named, <span class="at">testX=</span>x_pred, <span class="at">trainX=</span>x_train,</span>
<span id="cb117-144"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-144" aria-hidden="true" tabindex="-1"></a>                           <span class="at">trainY=</span>y_train)</span>
<span id="cb117-145"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-145" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb117-146"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-146" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(res)))</span>
<span id="cb117-147"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-147" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res))</span>
<span id="cb117-148"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-148" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), <span class="dv">7</span>)</span>
<span id="cb117-149"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-150"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-150" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Try data.frame input to css and getCssPreds</span></span>
<span id="cb117-151"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-152"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-152" aria-hidden="true" tabindex="-1"></a>  X_df <span class="ot">&lt;-</span> datasets<span class="sc">::</span>mtcars</span>
<span id="cb117-153"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-154"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-154" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(X_df)</span>
<span id="cb117-155"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-155" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">rnorm</span>(n)</span>
<span id="cb117-156"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-157"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-157" aria-hidden="true" tabindex="-1"></a>  selec_inds <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">round</span>(n<span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb117-158"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-158" aria-hidden="true" tabindex="-1"></a>  train_inds <span class="ot">&lt;-</span> (<span class="fu">max</span>(selec_inds) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(<span class="fu">max</span>(selec_inds) <span class="sc">+</span> <span class="dv">17</span>)</span>
<span id="cb117-159"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-159" aria-hidden="true" tabindex="-1"></a>  test_inds <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="fu">c</span>(selec_inds, train_inds))</span>
<span id="cb117-160"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-161"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-161" aria-hidden="true" tabindex="-1"></a>  css_res_df <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>X_df[<span class="fu">c</span>(selec_inds, train_inds), ],</span>
<span id="cb117-162"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-162" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y=</span>y[<span class="fu">c</span>(selec_inds, train_inds)], <span class="at">lambda=</span><span class="fl">0.01</span>, <span class="at">B =</span> <span class="dv">10</span>,</span>
<span id="cb117-163"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-163" aria-hidden="true" tabindex="-1"></a>                    <span class="at">train_inds=</span>train_inds)</span>
<span id="cb117-164"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-165"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-165" aria-hidden="true" tabindex="-1"></a>  res_df <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssPreds'>getCssPreds</a>(css_res_df, <span class="at">testX=</span>X_df[test_inds, ])</span>
<span id="cb117-166"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-167"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-167" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(res_df)))</span>
<span id="cb117-168"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-168" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res_df))</span>
<span id="cb117-169"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-169" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res_df), <span class="fu">length</span>(test_inds))</span>
<span id="cb117-170"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-170" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb117-171"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-171" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Try again with X as a dataframe with factors (number of columns of final</span></span>
<span id="cb117-172"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-172" aria-hidden="true" tabindex="-1"></a>  <span class="co"># design matrix after one-hot encoding factors won&#39;t match number of columns</span></span>
<span id="cb117-173"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-173" aria-hidden="true" tabindex="-1"></a>  <span class="co"># of X_df)</span></span>
<span id="cb117-174"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-174" aria-hidden="true" tabindex="-1"></a>  X_df<span class="sc">$</span>cyl <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(X_df<span class="sc">$</span>cyl)</span>
<span id="cb117-175"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-175" aria-hidden="true" tabindex="-1"></a>  X_df<span class="sc">$</span>vs <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(X_df<span class="sc">$</span>vs)</span>
<span id="cb117-176"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-176" aria-hidden="true" tabindex="-1"></a>  X_df<span class="sc">$</span>am <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(X_df<span class="sc">$</span>am)</span>
<span id="cb117-177"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-177" aria-hidden="true" tabindex="-1"></a>  X_df<span class="sc">$</span>gear <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(X_df<span class="sc">$</span>gear)</span>
<span id="cb117-178"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-178" aria-hidden="true" tabindex="-1"></a>  X_df<span class="sc">$</span>carb <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(X_df<span class="sc">$</span>carb)</span>
<span id="cb117-179"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-180"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-180" aria-hidden="true" tabindex="-1"></a>  css_res_df <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>X_df[selec_inds, ], <span class="at">y=</span>y[selec_inds], <span class="at">lambda=</span><span class="fl">0.01</span>, <span class="at">B =</span> <span class="dv">10</span>)</span>
<span id="cb117-181"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-181" aria-hidden="true" tabindex="-1"></a>  res_df <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssPreds'>getCssPreds</a>(css_res_df, <span class="at">testX=</span>X_df[test_inds, ],</span>
<span id="cb117-182"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-182" aria-hidden="true" tabindex="-1"></a>                        <span class="at">trainX=</span>X_df[train_inds, ], <span class="at">trainY=</span>y[train_inds])</span>
<span id="cb117-183"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-183" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb117-184"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-184" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span><span class="al">TODO</span><span class="co">(gregfaletto): known issue--the above code produces the following</span></span>
<span id="cb117-185"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-185" aria-hidden="true" tabindex="-1"></a>  <span class="co"># undesired warnings:</span></span>
<span id="cb117-186"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-186" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 1: In <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGetCssPredsInputs'>checkGetCssPredsInputs</a>(css_results, testX, weighting, cutoff,  :</span></span>
<span id="cb117-187"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-187" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Column names were provided for testX but not for trainX (are you sure they both contain identical features in the same order?)</span></span>
<span id="cb117-188"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-188" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2: In <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkXInputResults'>checkXInputResults</a>(newx, css_results$X) :</span></span>
<span id="cb117-189"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-189" aria-hidden="true" tabindex="-1"></a>  <span class="co"># New X provided had no variable names (column names) even though the X provided to css did.</span></span>
<span id="cb117-190"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-191"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-191" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(res_df)))</span>
<span id="cb117-192"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-192" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res_df))</span>
<span id="cb117-193"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-193" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res_df), <span class="fu">length</span>(test_inds))</span>
<span id="cb117-194"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-195"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb117-195" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## ── Warning (&#39;&lt;text&gt;:122&#39;): getCssPreds works ───────────────────────────────────
## New X provided had no variable names (column names) even though the X provided to css did.
## Backtrace:
##  1. testthat::expect_warning(...)
##  7. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssPreds'>getCssPreds</a>(...)
##  8. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGetCssPredsInputs'>checkGetCssPredsInputs</a>(...)
##  9. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkXInputResults'>checkXInputResults</a>(testX, css_results$X)
## 
## ── Warning (&#39;&lt;text&gt;:122&#39;): getCssPreds works ───────────────────────────────────
## New X provided had no variable names (column names) even though the X provided to css did.
## Backtrace:
##   1. testthat::expect_warning(...)
##   7. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssPreds'>getCssPreds</a>(...)
##   8. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#formCssDesign'>formCssDesign</a>(...)
##   9. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkFormCssDesignInputs'>checkFormCssDesignInputs</a>(...)
##  10. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkXInputResults'>checkXInputResults</a>(newx, css_results$X)
## 
## ── Warning (&#39;&lt;text&gt;:122&#39;): getCssPreds works ───────────────────────────────────
## New X provided had no variable names (column names) even though the X provided to css did.
## Backtrace:
##   1. testthat::expect_warning(...)
##   7. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssPreds'>getCssPreds</a>(...)
##   8. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#formCssDesign'>formCssDesign</a>(...)
##   9. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkFormCssDesignInputs'>checkFormCssDesignInputs</a>(...)
##  10. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkXInputResults'>checkXInputResults</a>(newx, css_results$X)
## 
## ── Warning (&#39;&lt;text&gt;:143&#39;): getCssPreds works ───────────────────────────────────
## Column names were provided for testX but not for trainX (are you sure they both contain identical features in the same order?)
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssPreds'>getCssPreds</a>(...)
##  2. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGetCssPredsInputs'>checkGetCssPredsInputs</a>(...)
## 
## ── Warning (&#39;&lt;text&gt;:143&#39;): getCssPreds works ───────────────────────────────────
## New X provided had no variable names (column names) even though the X provided to css did.
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssPreds'>getCssPreds</a>(...)
##  2. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#formCssDesign'>formCssDesign</a>(...)
##  3. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkFormCssDesignInputs'>checkFormCssDesignInputs</a>(...)
##  4. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkXInputResults'>checkXInputResults</a>(newx, css_results$X)
## 
## ── Warning (&#39;&lt;text&gt;:181&#39;): getCssPreds works ───────────────────────────────────
## Column names were provided for testX but not for trainX (are you sure they both contain identical features in the same order?)
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssPreds'>getCssPreds</a>(...)
##  2. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGetCssPredsInputs'>checkGetCssPredsInputs</a>(...)
## 
## ── Warning (&#39;&lt;text&gt;:181&#39;): getCssPreds works ───────────────────────────────────
## New X provided had no variable names (column names) even though the X provided to css did.
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssPreds'>getCssPreds</a>(...)
##  2. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#formCssDesign'>formCssDesign</a>(...)
##  3. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkFormCssDesignInputs'>checkFormCssDesignInputs</a>(...)
##  4. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkXInputResults'>checkXInputResults</a>(newx, css_results$X)
## 
## ── Warning (&#39;&lt;text&gt;:181&#39;): getCssPreds works ───────────────────────────────────
## prediction from a rank-deficient fit may be misleading
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssPreds'>getCssPreds</a>(...)
##  2. stats::predict.lm(model, newdata = df_test)</code></pre>
</div>
<div id="other-useful-functions" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Other useful functions<a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#other-useful-functions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The following are some other functions that are useful for specific tasks.</p>
<ul>
<li><p>genClusteredData generates jointly Gaussian data sets that include clusters of features that are correlated with a latent feature (the latent features themselves are also provided).</p></li>
<li><p>getLassoLambda uses a data set to choose a good value of lambda for subsamples of size n/2 (as in cluster stability selection) by cross-validation.</p></li>
<li><p>getModelSize estimates the best size for a lasso model on a provided data set.</p></li>
<li><p>printCssDf converts the output of the css function (an object of class cssr) to a data.frame that is ready to be printed. We provide end-user access to printCssDf because this data.frame itself may be useful as an object that summarizes the output from css.</p></li>
<li><p>print.cssr is the print function for objects of class cssr.</p></li>
<li><p>genClusteredData</p>
<ul>
<li>checkGenClusteredDataInputs checks that the inputs to genClusteredData are as expected.</li>
<li>makeCovarianceMatrix generates a covariance matrix for a jointly Gaussian random variable with distribution matching the provided inputs.</li>
<li>makeCoefficients generates a coefficient vector for the response according to the provided inputs.</li>
<li>Finally, genMuXZSd draws a random Z (matrix of latent variables), X (observed matrix, containing, in general, features correlated with latent features, directly observed features that are associated with y, and noise features), conditional means mu, and observed responses y.</li>
</ul></li>
<li><p>getLassoLambda</p></li>
<li><p>getModelSize</p></li>
<li><p>printCssDf</p>
<ul>
<li>getSelectionPrototypes identifies the prototypes from selected clusters (the feature in each cluster that is most correlated with the response)</li>
</ul></li>
<li><p>print.cssr</p></li>
</ul>
<p>genClusteredData</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Generate randomly sampled data including noisy observations of latent</span></span>
<span id="cb119-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; variables</span></span>
<span id="cb119-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb119-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; </span><span class="al">TODO</span><span class="co">(gregfaletto) change cluster_size into a vector of sizes (maybe also</span></span>
<span id="cb119-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; deprecate n_clusters as an input, since this would be inferred by the length</span></span>
<span id="cb119-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; of cluster_sizes?)</span></span>
<span id="cb119-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Generate a data set including latent features Z, observed features X (which</span></span>
<span id="cb119-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; may include noisy or noiseless observations of the latent features in Z),</span></span>
<span id="cb119-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; an observed response y which is a linear model of features from Z and X as</span></span>
<span id="cb119-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; well as independent mean zero noise, and mu (the responses from y without</span></span>
<span id="cb119-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the added noise). Data is generated in the same way as in the simulations</span></span>
<span id="cb119-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; from Faletto and Bien (2022).</span></span>
<span id="cb119-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param n Integer or numeric; the number of observations to generate. (The</span></span>
<span id="cb119-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; generated X and Z will have n rows, and the generated y and mu will have</span></span>
<span id="cb119-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; length n.)</span></span>
<span id="cb119-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param p Integer or numeric; the number of features to generate. The</span></span>
<span id="cb119-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; generated X will have p columns.</span></span>
<span id="cb119-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param k_unclustered Integer or numeric; the number of features in X that</span></span>
<span id="cb119-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; will have nonzero coefficients in the true model for y among those features </span></span>
<span id="cb119-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; not generated from the n_clusters latent variables (called &quot;weak signal&quot; </span></span>
<span id="cb119-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; features in the simulations from Faletto and Bien 2022). The coefficients on</span></span>
<span id="cb119-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; these features will be determined by beta_unclustered.</span></span>
<span id="cb119-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param cluster_size Integer or numeric; for each of the n_clusters latent</span></span>
<span id="cb119-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; variables, X will contain cluster_size noisy proxies that are correlated with</span></span>
<span id="cb119-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the latent variable.</span></span>
<span id="cb119-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param n_clusters Integer or numeric; the number of latent variables to</span></span>
<span id="cb119-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; generate, each of which will be associated with an observed cluster in X.</span></span>
<span id="cb119-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Must be at least 1. Default is 1.</span></span>
<span id="cb119-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param sig_clusters Integer or numeric; the number of generated latent</span></span>
<span id="cb119-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; features that will have nonzero coefficients in the true model for y (all of</span></span>
<span id="cb119-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; them will have coefficient beta_latent). Must be less than or equal to</span></span>
<span id="cb119-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; n_clusters. Default is 1.</span></span>
<span id="cb119-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param rho Integer or numeric; the covariance of the proxies in each cluster</span></span>
<span id="cb119-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; with the latent variable (and each other). Note that the correlation between</span></span>
<span id="cb119-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the features in the cluster will be rho/var. Can&#39;t equal 0. Default is 0.9.</span></span>
<span id="cb119-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param var Integer or numeric; the variance of all of the observed features</span></span>
<span id="cb119-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; in X (both the proxies for the latent variables and the k_unclustered other</span></span>
<span id="cb119-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; features). Can&#39;t equal 0. Default is 1.</span></span>
<span id="cb119-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param beta_latent Integer or numeric; the coefficient used for all</span></span>
<span id="cb119-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; sig_clusters latent variables that have nonzero coefficients in the true</span></span>
<span id="cb119-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; model for y. Can&#39;t equal 0. Default is 1.5.</span></span>
<span id="cb119-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param beta_unclustered Integer or numeric; the maximum coefficient in the</span></span>
<span id="cb119-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; model for y among the k_unclustered features in X not generated from the</span></span>
<span id="cb119-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; latent variables. The coefficients of the features will be</span></span>
<span id="cb119-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; beta_unclustered/sqrt(1:k_unclustered). Can&#39;t equal 0. Default is 1.</span></span>
<span id="cb119-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param snr Integer or numeric; the signal-to-noise ratio of the response</span></span>
<span id="cb119-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; y. If sigma_eps_sq is not specified, the variance of the noise in y will be</span></span>
<span id="cb119-48"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; calculated using the formula sigma_eps_sq = sum(mu^2)/(n * snr). Only one of</span></span>
<span id="cb119-49"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; snr and sigma_eps_sq must be specified. Default is NA.</span></span>
<span id="cb119-50"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param sigma_eps_sq Integer or numeric; the variance on the noise added</span></span>
<span id="cb119-51"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; to y. Only one of snr and sigma_eps_sq must be specified. Default is NA.</span></span>
<span id="cb119-52"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return A list of the following elements. \item{X}{An n x p numeric matrix of</span></span>
<span id="cb119-53"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; n observations from a p-dimensional multivariate normal distribution</span></span>
<span id="cb119-54"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; generated using the specified parameters. The first n_clusters times</span></span>
<span id="cb119-55"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; cluster_size features will be the clusters of features correlated with the</span></span>
<span id="cb119-56"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; n_clusters latent variables. The next k_unclustered features will be the</span></span>
<span id="cb119-57"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; &quot;weak signal&quot; features, and the remaining p - n_clusters*cluster_size -</span></span>
<span id="cb119-58"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; k_unclustered features will be the unclustered noise features.} \item{y}{A</span></span>
<span id="cb119-59"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; length n numeric vector; the response generated from X, the latent features</span></span>
<span id="cb119-60"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; from Z, and the coefficient vector, along with additive noise.} \item{Z}{The</span></span>
<span id="cb119-61"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; latent features; either a numeric vector (if n_clusters &gt; 1) or a numeric</span></span>
<span id="cb119-62"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; matrix (if n_clusters &gt; 1). Note that (X, Z) is multivariate Gaussian.}</span></span>
<span id="cb119-63"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; item{mu}{A length `n` numeric vector; the expected response given X, Z, and</span></span>
<span id="cb119-64"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the true coefficient vector (equal to y minus the added noise).}</span></span>
<span id="cb119-65"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @author Gregory Faletto, Jacob Bien</span></span>
<span id="cb119-66"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @references Faletto, G., &amp; Bien, J. (2022). Cluster Stability Selection.</span></span>
<span id="cb119-67"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; \emph{arXiv preprint arXiv:2201.00494}.</span></span>
<span id="cb119-68"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; \url{https://arxiv.org/abs/2201.00494}.</span></span>
<span id="cb119-69"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-69" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @export</span></span>
<span id="cb119-70"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-70" aria-hidden="true" tabindex="-1"></a><span id='genClusteredData'>genClusteredData</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(n, p, k_unclustered, cluster_size, <span class="at">n_clusters=</span><span class="dv">1</span>,</span>
<span id="cb119-71"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">sig_clusters=</span><span class="dv">1</span>, <span class="at">rho=</span><span class="fl">0.9</span>, <span class="at">var=</span><span class="dv">1</span>, <span class="at">beta_latent=</span><span class="fl">1.5</span>, <span class="at">beta_unclustered=</span><span class="dv">1</span>,</span>
<span id="cb119-72"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">snr=</span><span class="fu">as.numeric</span>(<span class="cn">NA</span>), <span class="at">sigma_eps_sq=</span><span class="fu">as.numeric</span>(<span class="cn">NA</span>)){</span>
<span id="cb119-73"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-74"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-74" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check inputs</span></span>
<span id="cb119-75"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-75" aria-hidden="true" tabindex="-1"></a>    <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGenClusteredDataInputs'>checkGenClusteredDataInputs</a>(p, k_unclustered, cluster_size, n_clusters,</span>
<span id="cb119-76"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-76" aria-hidden="true" tabindex="-1"></a>        sig_clusters, rho, var, beta_latent, beta_unclustered, snr,</span>
<span id="cb119-77"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-77" aria-hidden="true" tabindex="-1"></a>        sigma_eps_sq)</span>
<span id="cb119-78"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-79"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-79" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Generate covariance matrix (latent features are mixed in matrix, so each</span></span>
<span id="cb119-80"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-80" aria-hidden="true" tabindex="-1"></a>    <span class="co"># cluster will be of size cluster_size + 1)</span></span>
<span id="cb119-81"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-81" aria-hidden="true" tabindex="-1"></a>    Sigma <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#makeCovarianceMatrix'>makeCovarianceMatrix</a>(<span class="at">p=</span>p <span class="sc">+</span> n_clusters, <span class="at">nblocks=</span>n_clusters,</span>
<span id="cb119-82"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-82" aria-hidden="true" tabindex="-1"></a>        <span class="at">block_size=</span>cluster_size <span class="sc">+</span> <span class="dv">1</span>, <span class="at">rho=</span>rho, <span class="at">var=</span>var)</span>
<span id="cb119-83"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-84"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-84" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Generate coefficients</span></span>
<span id="cb119-85"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-85" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Note that beta has length p + sig_clusters</span></span>
<span id="cb119-86"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-86" aria-hidden="true" tabindex="-1"></a>    coefs <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#makeCoefficients'>makeCoefficients</a>(<span class="at">p=</span>p <span class="sc">+</span> n_clusters, <span class="at">k_unblocked=</span>k_unclustered,</span>
<span id="cb119-87"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-87" aria-hidden="true" tabindex="-1"></a>        <span class="at">beta_low=</span>beta_unclustered, <span class="at">beta_high=</span>beta_latent, <span class="at">nblocks=</span>n_clusters,</span>
<span id="cb119-88"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-88" aria-hidden="true" tabindex="-1"></a>        <span class="at">sig_blocks=</span>sig_clusters, <span class="at">block_size=</span>cluster_size <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb119-89"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-90"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-90" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Generate mu, X, z, sd, y</span></span>
<span id="cb119-91"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-91" aria-hidden="true" tabindex="-1"></a>    gen_mu_x_z_sd_res <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#genMuXZSd'>genMuXZSd</a>(<span class="at">n=</span>n, <span class="at">p=</span>p, <span class="at">beta=</span>coefs<span class="sc">$</span>beta, <span class="at">Sigma=</span>Sigma,</span>
<span id="cb119-92"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-92" aria-hidden="true" tabindex="-1"></a>        <span class="at">blocked_dgp_vars=</span>coefs<span class="sc">$</span>blocked_dgp_vars, <span class="at">latent_vars=</span>coefs<span class="sc">$</span>latent_vars, </span>
<span id="cb119-93"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-93" aria-hidden="true" tabindex="-1"></a>        <span class="at">block_size=</span>cluster_size, <span class="at">n_blocks=</span>n_clusters, <span class="at">snr=</span>snr,</span>
<span id="cb119-94"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-94" aria-hidden="true" tabindex="-1"></a>        <span class="at">sigma_eps_sq=</span>sigma_eps_sq)</span>
<span id="cb119-95"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-96"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-96" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> gen_mu_x_z_sd_res<span class="sc">$</span>mu</span>
<span id="cb119-97"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-97" aria-hidden="true" tabindex="-1"></a>    sd <span class="ot">&lt;-</span> gen_mu_x_z_sd_res<span class="sc">$</span>sd</span>
<span id="cb119-98"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-99"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-99" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> mu <span class="sc">+</span> sd <span class="sc">*</span> stats<span class="sc">::</span><span class="fu">rnorm</span>(n)</span>
<span id="cb119-100"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-101"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-101" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">X=</span>gen_mu_x_z_sd_res<span class="sc">$</span>X, <span class="at">y=</span>y, <span class="at">Z=</span>gen_mu_x_z_sd_res<span class="sc">$</span>z, <span class="at">mu=</span>mu))</span>
<span id="cb119-102"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb119-102" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>checkGenClusteredDataInputs ## NEED TO START WITH ROXYGEN FORMATTING</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; </span><span class="al">TODO</span><span class="co">(gregfaletto) fix this description!!!</span></span>
<span id="cb120-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Check inputs to genClusteredData</span></span>
<span id="cb120-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb120-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Generate a data set including latent features Z, observed features X (which</span></span>
<span id="cb120-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; may include noisy or noiseless observations of the latent features in Z),</span></span>
<span id="cb120-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; an observed response y which is a linear model of features from Z and X as</span></span>
<span id="cb120-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; well as independent mean zero noise, and mu (the responses from y without</span></span>
<span id="cb120-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the added noise). Data is generated in the same way as in the simulations</span></span>
<span id="cb120-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; from Faletto and Bien (2022).</span></span>
<span id="cb120-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param p Integer or numeric; the number of features to generate. The</span></span>
<span id="cb120-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; generated X will have p columns.</span></span>
<span id="cb120-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param k_unclustered Integer or numeric; the number of features in X that</span></span>
<span id="cb120-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; will have nonzero coefficients in the true model for y among those features </span></span>
<span id="cb120-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; not generated from the n_clusters latent variables (called &quot;weak signal&quot; </span></span>
<span id="cb120-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; features in the simulations from Faletto and Bien 2022). The coefficients on</span></span>
<span id="cb120-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; these features will be determined by beta_unclustered.</span></span>
<span id="cb120-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param cluster_size Integer or numeric; for each of the n_clusters latent</span></span>
<span id="cb120-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; variables, X will contain cluster_size noisy proxies that are correlated with</span></span>
<span id="cb120-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the latent variable.</span></span>
<span id="cb120-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param n_clusters Integer or numeric; the number of latent variables to</span></span>
<span id="cb120-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; generate, each of which will be associated with an observed cluster in X.</span></span>
<span id="cb120-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Must be at least 1. Default is 1.</span></span>
<span id="cb120-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param sig_clusters Integer or numeric; the number of generated latent</span></span>
<span id="cb120-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; features that will have nonzero coefficients in the true model for y (all of</span></span>
<span id="cb120-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; them will have coefficient beta_latent). Must be less than or equal to</span></span>
<span id="cb120-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; n_clusters. Default is 1.</span></span>
<span id="cb120-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param rho Integer or numeric; the covariance of the proxies in each cluster</span></span>
<span id="cb120-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; with the latent variable (and each other). Note that the correlation between</span></span>
<span id="cb120-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the features in the cluster will be rho/var. Can&#39;t equal 0. Default is 0.9.</span></span>
<span id="cb120-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param var Integer or numeric; the variance of all of the observed features</span></span>
<span id="cb120-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; in X (both the proxies for the latent variables and the k_unclustered other</span></span>
<span id="cb120-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; features). Can&#39;t equal 0. Default is 1.</span></span>
<span id="cb120-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param beta_latent Integer or numeric; the coefficient used for all</span></span>
<span id="cb120-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; sig_clusters latent variables that have nonzero coefficients in the true</span></span>
<span id="cb120-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; model for y. Can&#39;t equal 0. Default is 1.5.</span></span>
<span id="cb120-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param beta_unclustered Integer or numeric; the maximum coefficient in the</span></span>
<span id="cb120-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; model for y among the k_unclustered features in X not generated from the</span></span>
<span id="cb120-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; latent variables. The coefficients of the features will be</span></span>
<span id="cb120-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; beta_unclustered/sqrt(1:k_unclustered). Can&#39;t equal 0. Default is 1.</span></span>
<span id="cb120-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param snr Integer or numeric; the signal-to-noise ratio of the response</span></span>
<span id="cb120-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; y. If sigma_eps_sq is not specified, the variance of the noise in y will be</span></span>
<span id="cb120-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; calculated using the formula sigma_eps_sq = sum(mu^2)/(n * snr). Only one of</span></span>
<span id="cb120-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; snr and sigma_eps_sq must be specified. Default is NA.</span></span>
<span id="cb120-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param sigma_eps_sq Integer or numeric; the variance on the noise added</span></span>
<span id="cb120-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; to y. Only one of snr and sigma_eps_sq must be specified. Default is NA.</span></span>
<span id="cb120-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return A list of the following elements. \item{X}{An n x p numeric matrix of</span></span>
<span id="cb120-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; n observations from a p-dimensional multivariate normal distribution</span></span>
<span id="cb120-48"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; generated using the specified parameters. The first n_clusters times</span></span>
<span id="cb120-49"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; cluster_size features will be the clusters of features correlated with the</span></span>
<span id="cb120-50"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; n_clusters latent variables. The next k_unclustered features will be the</span></span>
<span id="cb120-51"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; &quot;weak signal&quot; features, and the remaining p - n_clusters*cluster_size -</span></span>
<span id="cb120-52"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; k_unclustered features will be the unclustered noise features.} \item{y}{A</span></span>
<span id="cb120-53"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; length n numeric vector; the response generated from X, the latent features</span></span>
<span id="cb120-54"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; from Z, and the coefficient vector, along with additive noise.} \item{Z}{The</span></span>
<span id="cb120-55"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; latent features; either a numeric vector (if n_clusters &gt; 1) or a numeric</span></span>
<span id="cb120-56"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; matrix (if n_clusters &gt; 1). Note that (X, Z) is multivariate Gaussian.}</span></span>
<span id="cb120-57"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; item{mu}{A length `n` numeric vector; the expected response given X, Z, and</span></span>
<span id="cb120-58"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the true coefficient vector (equal to y minus the added noise).}</span></span>
<span id="cb120-59"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @author Gregory Faletto, Jacob Bien</span></span>
<span id="cb120-60"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-60" aria-hidden="true" tabindex="-1"></a><span id='checkGenClusteredDataInputs'>checkGenClusteredDataInputs</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(p, k_unclustered, cluster_size,</span>
<span id="cb120-61"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-61" aria-hidden="true" tabindex="-1"></a>    n_clusters, sig_clusters, rho, var, beta_latent, beta_unclustered, snr,</span>
<span id="cb120-62"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-62" aria-hidden="true" tabindex="-1"></a>    sigma_eps_sq){</span>
<span id="cb120-63"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-64"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.numeric</span>(sig_clusters) <span class="sc">|</span> <span class="fu">is.integer</span>(sig_clusters))</span>
<span id="cb120-65"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(sig_clusters <span class="sc">&lt;=</span> n_clusters)</span>
<span id="cb120-66"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-66" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(sig_clusters <span class="sc">&gt;=</span> <span class="dv">0</span>)</span>
<span id="cb120-67"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-67" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(sig_clusters <span class="sc">==</span> <span class="fu">round</span>(sig_clusters))</span>
<span id="cb120-68"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-68" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb120-69"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-69" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.numeric</span>(n_clusters) <span class="sc">|</span> <span class="fu">is.integer</span>(n_clusters))</span>
<span id="cb120-70"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(n_clusters <span class="sc">==</span> <span class="fu">round</span>(n_clusters))</span>
<span id="cb120-71"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-71" aria-hidden="true" tabindex="-1"></a>    <span class="co"># </span><span class="al">TODO</span><span class="co">(gregfaletto): is it easy to remove the requirement that n_clusters is</span></span>
<span id="cb120-72"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-72" aria-hidden="true" tabindex="-1"></a>    <span class="co"># at least 1 (so that it&#39;s possible to generate data with no latent </span></span>
<span id="cb120-73"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-73" aria-hidden="true" tabindex="-1"></a>    <span class="co"># features)? If so, should only check that cluster_size &gt;= 1 if n_clusters</span></span>
<span id="cb120-74"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-74" aria-hidden="true" tabindex="-1"></a>    <span class="co"># &gt;= 1, and in makeCovarianceMatrix function only need block_size &gt;= 1</span></span>
<span id="cb120-75"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-75" aria-hidden="true" tabindex="-1"></a>    <span class="co"># rather than 2.</span></span>
<span id="cb120-76"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-76" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(n_clusters <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb120-77"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-78"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-78" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(cluster_size <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb120-79"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-80"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-80" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">abs</span>(rho) <span class="sc">&lt;=</span> <span class="fu">abs</span>(var))</span>
<span id="cb120-81"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-81" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(rho <span class="sc">!=</span> <span class="dv">0</span>)</span>
<span id="cb120-82"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-82" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(var <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb120-83"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-84"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-84" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(beta_latent <span class="sc">!=</span> <span class="dv">0</span>)</span>
<span id="cb120-85"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-85" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(beta_unclustered <span class="sc">!=</span> <span class="dv">0</span>)</span>
<span id="cb120-86"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-87"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.numeric</span>(k_unclustered) <span class="sc">|</span> <span class="fu">is.integer</span>(k_unclustered))</span>
<span id="cb120-88"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-88" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(k_unclustered <span class="sc">&gt;=</span> <span class="dv">0</span>)</span>
<span id="cb120-89"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-89" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(k_unclustered <span class="sc">==</span> <span class="fu">round</span>(k_unclustered))</span>
<span id="cb120-90"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-90" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb120-91"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(p <span class="sc">&gt;=</span> n_clusters<span class="sc">*</span>cluster_size <span class="sc">+</span> k_unclustered)</span>
<span id="cb120-92"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-93"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-93" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Same as make_sparse_blocked_linear_model_random, but ith coefficient</span></span>
<span id="cb120-94"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-94" aria-hidden="true" tabindex="-1"></a>    <span class="co"># of weak signal features is beta_unclustered/sqrt(i) in order to have</span></span>
<span id="cb120-95"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-95" aria-hidden="true" tabindex="-1"></a>    <span class="co"># a definitive ranking of weak signal features.</span></span>
<span id="cb120-96"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-96" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">is.na</span>(snr) <span class="sc">&amp;</span> <span class="fu">is.na</span>(sigma_eps_sq)){</span>
<span id="cb120-97"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-97" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stop</span>(<span class="st">&quot;Must specify one of snr or sigma_eps_sq&quot;</span>)</span>
<span id="cb120-98"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-98" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb120-99"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-99" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb120-100"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-100" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.na</span>(snr)){</span>
<span id="cb120-101"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-101" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(snr <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb120-102"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-102" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb120-103"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-103" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.na</span>(sigma_eps_sq)){</span>
<span id="cb120-104"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-104" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(sigma_eps_sq <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb120-105"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-105" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb120-106"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb120-106" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Tests for checkGenClusteredDataInputs</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-1" aria-hidden="true" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">test_that</span>(<span class="st">&quot;checkGenClusteredDataInputs works&quot;</span>, {</span>
<span id="cb121-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">7612</span>)</span>
<span id="cb121-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Should get no error</span></span>
<span id="cb121-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-5" aria-hidden="true" tabindex="-1"></a>  <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGenClusteredDataInputs'>checkGenClusteredDataInputs</a>(<span class="at">p=</span><span class="dv">19</span>, <span class="at">k_unclustered=</span><span class="dv">2</span>, <span class="at">cluster_size=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">3</span>,</span>
<span id="cb121-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sig_clusters=</span><span class="dv">2</span>, <span class="at">rho=</span>.<span class="dv">8</span>, <span class="at">var=</span><span class="fl">1.1</span>, <span class="at">beta_latent=</span><span class="fl">1.5</span>,</span>
<span id="cb121-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">beta_unclustered=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">snr=</span><span class="cn">NA</span>, <span class="at">sigma_eps_sq=</span>.<span class="dv">5</span>)</span>
<span id="cb121-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb121-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-9" aria-hidden="true" tabindex="-1"></a>  <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGenClusteredDataInputs'>checkGenClusteredDataInputs</a>(<span class="at">p=</span><span class="dv">19</span>, <span class="at">k_unclustered=</span><span class="dv">2</span>, <span class="at">cluster_size=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">3</span>,</span>
<span id="cb121-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-10" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sig_clusters=</span><span class="dv">2</span>, <span class="at">rho=</span>.<span class="dv">8</span>, <span class="at">var=</span><span class="fl">1.1</span>, <span class="at">beta_latent=</span><span class="fl">1.5</span>,</span>
<span id="cb121-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-11" aria-hidden="true" tabindex="-1"></a>                           <span class="at">beta_unclustered=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">snr=</span><span class="dv">1</span>, <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>)</span>
<span id="cb121-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb121-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sig_clusters</span></span>
<span id="cb121-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-14" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGenClusteredDataInputs'>checkGenClusteredDataInputs</a>(<span class="at">p=</span><span class="dv">19</span>, <span class="at">k_unclustered=</span><span class="dv">2</span>,</span>
<span id="cb121-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-15" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cluster_size=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">3</span>,</span>
<span id="cb121-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-16" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sig_clusters=</span><span class="st">&quot;2&quot;</span>, <span class="at">rho=</span>.<span class="dv">8</span>,</span>
<span id="cb121-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-17" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">var=</span><span class="fl">1.1</span>, <span class="at">beta_latent=</span><span class="fl">1.5</span>,</span>
<span id="cb121-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-18" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">beta_unclustered=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">snr=</span><span class="dv">1</span>,</span>
<span id="cb121-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-19" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>),</span>
<span id="cb121-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-20" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;is.numeric(sig_clusters) | is.integer(sig_clusters) is not TRUE&quot;</span>,</span>
<span id="cb121-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-21" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb121-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb121-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-23" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGenClusteredDataInputs'>checkGenClusteredDataInputs</a>(<span class="at">p=</span><span class="dv">19</span>, <span class="at">k_unclustered=</span><span class="dv">2</span>,</span>
<span id="cb121-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-24" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cluster_size=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">3</span>,</span>
<span id="cb121-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-25" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sig_clusters=</span><span class="dv">4</span>, <span class="at">rho=</span>.<span class="dv">8</span>,</span>
<span id="cb121-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-26" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">var=</span><span class="fl">1.1</span>, <span class="at">beta_latent=</span><span class="fl">1.5</span>,</span>
<span id="cb121-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-27" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">beta_unclustered=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">snr=</span><span class="dv">1</span>,</span>
<span id="cb121-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-28" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>),</span>
<span id="cb121-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-29" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;sig_clusters &lt;= n_clusters is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb121-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb121-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-31" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGenClusteredDataInputs'>checkGenClusteredDataInputs</a>(<span class="at">p=</span><span class="dv">19</span>, <span class="at">k_unclustered=</span><span class="dv">2</span>,</span>
<span id="cb121-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-32" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cluster_size=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">3</span>,</span>
<span id="cb121-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-33" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sig_clusters=</span><span class="sc">-</span><span class="dv">1</span>, <span class="at">rho=</span>.<span class="dv">8</span>,</span>
<span id="cb121-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-34" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">var=</span><span class="fl">1.1</span>, <span class="at">beta_latent=</span><span class="fl">1.5</span>,</span>
<span id="cb121-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-35" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">beta_unclustered=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">snr=</span><span class="dv">1</span>,</span>
<span id="cb121-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-36" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>),</span>
<span id="cb121-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-37" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;sig_clusters &gt;= 0 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb121-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb121-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-39" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGenClusteredDataInputs'>checkGenClusteredDataInputs</a>(<span class="at">p=</span><span class="dv">19</span>, <span class="at">k_unclustered=</span><span class="dv">2</span>,</span>
<span id="cb121-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-40" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cluster_size=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">3</span>,</span>
<span id="cb121-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-41" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sig_clusters=</span>.<span class="dv">6</span>, <span class="at">rho=</span>.<span class="dv">8</span>,</span>
<span id="cb121-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-42" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">var=</span><span class="fl">1.1</span>, <span class="at">beta_latent=</span><span class="fl">1.5</span>,</span>
<span id="cb121-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-43" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">beta_unclustered=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">snr=</span><span class="dv">1</span>,</span>
<span id="cb121-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-44" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>),</span>
<span id="cb121-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-45" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;sig_clusters == round(sig_clusters) is not TRUE&quot;</span>,</span>
<span id="cb121-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-46" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb121-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb121-48"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb121-49"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># n_clusters</span></span>
<span id="cb121-50"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-50" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGenClusteredDataInputs'>checkGenClusteredDataInputs</a>(<span class="at">p=</span><span class="dv">19</span>, <span class="at">k_unclustered=</span><span class="dv">2</span>,</span>
<span id="cb121-51"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-51" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cluster_size=</span><span class="dv">5</span>,</span>
<span id="cb121-52"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-52" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">n_clusters=</span><span class="st">&quot;3&quot;</span>,</span>
<span id="cb121-53"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-53" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sig_clusters=</span><span class="dv">2</span>, <span class="at">rho=</span>.<span class="dv">8</span>,</span>
<span id="cb121-54"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-54" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">var=</span><span class="fl">1.1</span>, <span class="at">beta_latent=</span><span class="fl">1.5</span>,</span>
<span id="cb121-55"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-55" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">beta_unclustered=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">snr=</span><span class="dv">1</span>,</span>
<span id="cb121-56"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-56" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>),</span>
<span id="cb121-57"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-57" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;is.numeric(n_clusters) | is.integer(n_clusters) is not TRUE&quot;</span>,</span>
<span id="cb121-58"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-58" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb121-59"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb121-60"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-60" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGenClusteredDataInputs'>checkGenClusteredDataInputs</a>(<span class="at">p=</span><span class="dv">19</span>, <span class="at">k_unclustered=</span><span class="dv">2</span>,</span>
<span id="cb121-61"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-61" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cluster_size=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="fl">3.2</span>,</span>
<span id="cb121-62"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-62" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sig_clusters=</span><span class="dv">2</span>, <span class="at">rho=</span>.<span class="dv">8</span>,</span>
<span id="cb121-63"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-63" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">var=</span><span class="fl">1.1</span>, <span class="at">beta_latent=</span><span class="fl">1.5</span>,</span>
<span id="cb121-64"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-64" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">beta_unclustered=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">snr=</span><span class="dv">1</span>,</span>
<span id="cb121-65"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-65" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>),</span>
<span id="cb121-66"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-66" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;n_clusters == round(n_clusters) is not TRUE&quot;</span>,</span>
<span id="cb121-67"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-67" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb121-68"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-68" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb121-69"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-69" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGenClusteredDataInputs'>checkGenClusteredDataInputs</a>(<span class="at">p=</span><span class="dv">19</span>, <span class="at">k_unclustered=</span><span class="dv">2</span>,</span>
<span id="cb121-70"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-70" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cluster_size=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">0</span>,</span>
<span id="cb121-71"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-71" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sig_clusters=</span><span class="dv">0</span>, <span class="at">rho=</span>.<span class="dv">8</span>,</span>
<span id="cb121-72"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-72" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">var=</span><span class="fl">1.1</span>, <span class="at">beta_latent=</span><span class="fl">1.5</span>,</span>
<span id="cb121-73"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-73" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">beta_unclustered=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">snr=</span><span class="dv">1</span>,</span>
<span id="cb121-74"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-74" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>),</span>
<span id="cb121-75"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-75" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;n_clusters &gt;= 1 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb121-76"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-76" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb121-77"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-77" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGenClusteredDataInputs'>checkGenClusteredDataInputs</a>(<span class="at">p=</span><span class="dv">19</span>, <span class="at">k_unclustered=</span><span class="dv">2</span>,</span>
<span id="cb121-78"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-78" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cluster_size=</span>.<span class="dv">3</span>, <span class="at">n_clusters=</span><span class="dv">3</span>,</span>
<span id="cb121-79"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-79" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sig_clusters=</span><span class="dv">2</span>, <span class="at">rho=</span>.<span class="dv">8</span>,</span>
<span id="cb121-80"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-80" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">var=</span><span class="fl">1.1</span>, <span class="at">beta_latent=</span><span class="fl">1.5</span>,</span>
<span id="cb121-81"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-81" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">beta_unclustered=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">snr=</span><span class="dv">1</span>,</span>
<span id="cb121-82"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-82" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>),</span>
<span id="cb121-83"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-83" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;cluster_size &gt;= 1 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb121-84"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-84" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb121-85"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-85" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGenClusteredDataInputs'>checkGenClusteredDataInputs</a>(<span class="at">p=</span><span class="dv">16</span>, <span class="at">k_unclustered=</span><span class="dv">2</span>,</span>
<span id="cb121-86"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-86" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cluster_size=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">3</span>,</span>
<span id="cb121-87"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-87" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sig_clusters=</span><span class="dv">2</span>, <span class="at">rho=</span>.<span class="dv">8</span>,</span>
<span id="cb121-88"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-88" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">var=</span><span class="fl">1.1</span>, <span class="at">beta_latent=</span><span class="fl">1.5</span>,</span>
<span id="cb121-89"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-89" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">beta_unclustered=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">snr=</span><span class="dv">1</span>,</span>
<span id="cb121-90"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-90" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>),</span>
<span id="cb121-91"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-91" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;p &gt;= n_clusters * cluster_size + k_unclustered is not TRUE&quot;</span>,</span>
<span id="cb121-92"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-92" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb121-93"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-93" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb121-94"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-94" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGenClusteredDataInputs'>checkGenClusteredDataInputs</a>(<span class="at">p=</span><span class="dv">19</span>, <span class="at">k_unclustered=</span><span class="dv">2</span>,</span>
<span id="cb121-95"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-95" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cluster_size=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">3</span>,</span>
<span id="cb121-96"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-96" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sig_clusters=</span><span class="dv">2</span>, <span class="at">rho=</span><span class="dv">8</span>,</span>
<span id="cb121-97"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-97" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">var=</span><span class="fl">1.1</span>, <span class="at">beta_latent=</span><span class="fl">1.5</span>,</span>
<span id="cb121-98"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-98" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">beta_unclustered=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">snr=</span><span class="dv">1</span>,</span>
<span id="cb121-99"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-99" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>),</span>
<span id="cb121-100"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-100" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;abs(rho) &lt;= abs(var) is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb121-101"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-101" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb121-102"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-102" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGenClusteredDataInputs'>checkGenClusteredDataInputs</a>(<span class="at">p=</span><span class="dv">19</span>, <span class="at">k_unclustered=</span><span class="dv">2</span>,</span>
<span id="cb121-103"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-103" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cluster_size=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">3</span>,</span>
<span id="cb121-104"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-104" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sig_clusters=</span><span class="dv">2</span>, <span class="at">rho=</span><span class="dv">0</span>,</span>
<span id="cb121-105"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-105" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">var=</span><span class="fl">1.1</span>, <span class="at">beta_latent=</span><span class="fl">1.5</span>,</span>
<span id="cb121-106"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-106" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">beta_unclustered=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">snr=</span><span class="dv">1</span>,</span>
<span id="cb121-107"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-107" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>),</span>
<span id="cb121-108"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-108" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;rho != 0 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb121-109"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-109" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb121-110"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-110" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGenClusteredDataInputs'>checkGenClusteredDataInputs</a>(<span class="at">p=</span><span class="dv">19</span>, <span class="at">k_unclustered=</span><span class="dv">2</span>,</span>
<span id="cb121-111"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-111" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cluster_size=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">3</span>,</span>
<span id="cb121-112"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-112" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sig_clusters=</span><span class="dv">2</span>, <span class="at">rho=</span><span class="fl">0.8</span>,</span>
<span id="cb121-113"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-113" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">var=</span><span class="sc">-</span><span class="fl">1.1</span>, <span class="at">beta_latent=</span><span class="fl">1.5</span>,</span>
<span id="cb121-114"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-114" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">beta_unclustered=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">snr=</span><span class="dv">1</span>,</span>
<span id="cb121-115"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-115" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>),</span>
<span id="cb121-116"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-116" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;var &gt; 0 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb121-117"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-117" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb121-118"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-118" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGenClusteredDataInputs'>checkGenClusteredDataInputs</a>(<span class="at">p=</span><span class="dv">19</span>, <span class="at">k_unclustered=</span><span class="dv">2</span>,</span>
<span id="cb121-119"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-119" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cluster_size=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">3</span>,</span>
<span id="cb121-120"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-120" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sig_clusters=</span><span class="dv">2</span>, <span class="at">rho=</span><span class="fl">0.8</span>,</span>
<span id="cb121-121"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-121" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">var=</span><span class="fl">1.1</span>, <span class="at">beta_latent=</span><span class="dv">0</span>,</span>
<span id="cb121-122"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-122" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">beta_unclustered=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">snr=</span><span class="dv">1</span>,</span>
<span id="cb121-123"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-123" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>),</span>
<span id="cb121-124"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-124" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;beta_latent != 0 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb121-125"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-125" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb121-126"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-126" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGenClusteredDataInputs'>checkGenClusteredDataInputs</a>(<span class="at">p=</span><span class="dv">19</span>, <span class="at">k_unclustered=</span><span class="dv">2</span>,</span>
<span id="cb121-127"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-127" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cluster_size=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">3</span>,</span>
<span id="cb121-128"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-128" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sig_clusters=</span><span class="dv">2</span>, <span class="at">rho=</span><span class="fl">0.8</span>,</span>
<span id="cb121-129"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-129" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">var=</span><span class="fl">1.1</span>, <span class="at">beta_latent=</span><span class="fl">1.5</span>,</span>
<span id="cb121-130"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-130" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">beta_unclustered=</span><span class="dv">0</span>, <span class="at">snr=</span><span class="dv">1</span>,</span>
<span id="cb121-131"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-131" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>),</span>
<span id="cb121-132"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-132" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;beta_unclustered != 0 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb121-133"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-133" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb121-134"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-134" aria-hidden="true" tabindex="-1"></a>  <span class="co"># k_unclustered</span></span>
<span id="cb121-135"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-135" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGenClusteredDataInputs'>checkGenClusteredDataInputs</a>(<span class="at">p=</span><span class="dv">19</span>, <span class="at">k_unclustered=</span><span class="st">&quot;2&quot;</span>,</span>
<span id="cb121-136"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-136" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cluster_size=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">3</span>,</span>
<span id="cb121-137"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-137" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sig_clusters=</span><span class="dv">2</span>, <span class="at">rho=</span><span class="fl">0.8</span>,</span>
<span id="cb121-138"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-138" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">var=</span><span class="fl">1.1</span>, <span class="at">beta_latent=</span><span class="fl">1.5</span>,</span>
<span id="cb121-139"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-139" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">beta_unclustered=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">snr=</span><span class="dv">1</span>,</span>
<span id="cb121-140"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-140" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>),</span>
<span id="cb121-141"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-141" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;is.numeric(k_unclustered) | is.integer(k_unclustered) is not TRUE&quot;</span>,</span>
<span id="cb121-142"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-142" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb121-143"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-144"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-144" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGenClusteredDataInputs'>checkGenClusteredDataInputs</a>(<span class="at">p=</span><span class="dv">19</span>, <span class="at">k_unclustered=</span><span class="sc">-</span><span class="dv">2</span>,</span>
<span id="cb121-145"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-145" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cluster_size=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">3</span>,</span>
<span id="cb121-146"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-146" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sig_clusters=</span><span class="dv">2</span>, <span class="at">rho=</span><span class="fl">0.8</span>,</span>
<span id="cb121-147"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-147" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">var=</span><span class="fl">1.1</span>, <span class="at">beta_latent=</span><span class="fl">1.5</span>,</span>
<span id="cb121-148"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-148" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">beta_unclustered=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">snr=</span><span class="dv">1</span>,</span>
<span id="cb121-149"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-149" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>),</span>
<span id="cb121-150"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-150" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;k_unclustered &gt;= 0 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb121-151"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-152"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-152" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGenClusteredDataInputs'>checkGenClusteredDataInputs</a>(<span class="at">p=</span><span class="dv">19</span>, <span class="at">k_unclustered=</span>.<span class="dv">2</span>,</span>
<span id="cb121-153"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-153" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cluster_size=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">3</span>,</span>
<span id="cb121-154"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-154" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sig_clusters=</span><span class="dv">2</span>, <span class="at">rho=</span><span class="fl">0.8</span>,</span>
<span id="cb121-155"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-155" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">var=</span><span class="fl">1.1</span>, <span class="at">beta_latent=</span><span class="fl">1.5</span>,</span>
<span id="cb121-156"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-156" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">beta_unclustered=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">snr=</span><span class="dv">1</span>,</span>
<span id="cb121-157"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-157" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>),</span>
<span id="cb121-158"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-158" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;k_unclustered == round(k_unclustered) is not TRUE&quot;</span>,</span>
<span id="cb121-159"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-159" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb121-160"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-160" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb121-161"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-161" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGenClusteredDataInputs'>checkGenClusteredDataInputs</a>(<span class="at">p=</span><span class="dv">19</span>, <span class="at">k_unclustered=</span><span class="dv">2</span>,</span>
<span id="cb121-162"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-162" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cluster_size=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">3</span>,</span>
<span id="cb121-163"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-163" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sig_clusters=</span><span class="dv">2</span>, <span class="at">rho=</span><span class="fl">0.8</span>,</span>
<span id="cb121-164"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-164" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">var=</span><span class="fl">1.1</span>, <span class="at">beta_latent=</span><span class="fl">1.5</span>,</span>
<span id="cb121-165"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-165" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">beta_unclustered=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">snr=</span><span class="cn">NA</span>,</span>
<span id="cb121-166"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-166" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>),</span>
<span id="cb121-167"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-167" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;Must specify one of snr or sigma_eps_sq&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb121-168"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-169"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-169" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGenClusteredDataInputs'>checkGenClusteredDataInputs</a>(<span class="at">p=</span><span class="dv">19</span>, <span class="at">k_unclustered=</span><span class="dv">2</span>,</span>
<span id="cb121-170"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-170" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cluster_size=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">3</span>,</span>
<span id="cb121-171"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-171" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sig_clusters=</span><span class="dv">2</span>, <span class="at">rho=</span><span class="fl">0.8</span>,</span>
<span id="cb121-172"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-172" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">var=</span><span class="fl">1.1</span>, <span class="at">beta_latent=</span><span class="fl">1.5</span>,</span>
<span id="cb121-173"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-173" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">beta_unclustered=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">snr=</span><span class="sc">-</span>.<span class="dv">2</span>,</span>
<span id="cb121-174"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-174" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>),</span>
<span id="cb121-175"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-175" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;snr &gt; 0 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb121-176"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-177"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-177" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkGenClusteredDataInputs'>checkGenClusteredDataInputs</a>(<span class="at">p=</span><span class="dv">19</span>, <span class="at">k_unclustered=</span><span class="dv">2</span>,</span>
<span id="cb121-178"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-178" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cluster_size=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">3</span>,</span>
<span id="cb121-179"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-179" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sig_clusters=</span><span class="dv">2</span>, <span class="at">rho=</span><span class="fl">0.8</span>,</span>
<span id="cb121-180"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-180" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">var=</span><span class="fl">1.1</span>, <span class="at">beta_latent=</span><span class="fl">1.5</span>,</span>
<span id="cb121-181"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-181" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">beta_unclustered=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">snr=</span><span class="cn">NA</span>,</span>
<span id="cb121-182"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-182" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sigma_eps_sq=</span><span class="sc">-</span>.<span class="dv">3</span>),</span>
<span id="cb121-183"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-183" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;sigma_eps_sq &gt; 0 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb121-184"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-184" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb121-185"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb121-185" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## Test passed 😀</code></pre>
<p>makeCovarianceMatrix</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Generate covariance matrix for simulated clustered data</span></span>
<span id="cb123-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb123-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param p Integer or numeric; the total number of features in the covariance</span></span>
<span id="cb123-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; matrix to be created, including latent features, the associated noisy proxies</span></span>
<span id="cb123-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; with each latent feature, and other (weak signal and noise) features.</span></span>
<span id="cb123-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param n_blocks Integer or numeric; the number of latent variables in the</span></span>
<span id="cb123-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; data, each of which is associated with an observed cluster in X. Must be at</span></span>
<span id="cb123-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; least 1.</span></span>
<span id="cb123-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param block_size Integer or numeric; for each of the n_blocks latent</span></span>
<span id="cb123-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; variables, the covariance matrix will include the original latent feature</span></span>
<span id="cb123-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; plus block_size - 1 noisy proxies that are correlated with the latent</span></span>
<span id="cb123-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; variable.</span></span>
<span id="cb123-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param rho Integer or numeric; the covariance of the proxies in each cluster</span></span>
<span id="cb123-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; with the latent variable (and each other). Note that the correlation between</span></span>
<span id="cb123-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the features in the cluster will be rho/var. rho cannot equal 0.</span></span>
<span id="cb123-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param var Integer or numeric; the variance of all of the observed features</span></span>
<span id="cb123-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; in X (both the proxies for the latent variables and the k_unclustered other</span></span>
<span id="cb123-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; features). var cannot equal 0.</span></span>
<span id="cb123-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return A `p` x `p` numeric matrix representing the covariance matrix for</span></span>
<span id="cb123-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the latent features, the associated proxies, and the remaining features. All</span></span>
<span id="cb123-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; features not in a block will be independent from each other and the blocks</span></span>
<span id="cb123-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; and have variance var.</span></span>
<span id="cb123-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @author Gregory Faletto, Jacob Bien</span></span>
<span id="cb123-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-24" aria-hidden="true" tabindex="-1"></a><span id='makeCovarianceMatrix'>makeCovarianceMatrix</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(p, nblocks, block_size, rho, var) {</span>
<span id="cb123-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check inputs</span></span>
<span id="cb123-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(nblocks <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb123-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(rho <span class="sc">!=</span> <span class="dv">0</span>)</span>
<span id="cb123-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(var <span class="sc">!=</span> <span class="dv">0</span>)</span>
<span id="cb123-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">abs</span>(rho) <span class="sc">&lt;=</span> <span class="fu">abs</span>(var))</span>
<span id="cb123-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(block_size <span class="sc">&gt;=</span> <span class="dv">2</span>)</span>
<span id="cb123-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(p <span class="sc">&gt;=</span> nblocks<span class="sc">*</span>block_size)</span>
<span id="cb123-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># start with p x p identity matrix</span></span>
<span id="cb123-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-35" aria-hidden="true" tabindex="-1"></a>    Sigma <span class="ot">&lt;-</span> var<span class="sc">*</span><span class="fu">diag</span>(p)</span>
<span id="cb123-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># create matrix with nblocks rows, each containing a vector of</span></span>
<span id="cb123-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># indices of highly correlated features</span></span>
<span id="cb123-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-39" aria-hidden="true" tabindex="-1"></a>    block_feats <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">seq</span>(nblocks<span class="sc">*</span>block_size), <span class="at">nrow=</span>nblocks, <span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb123-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(<span class="fu">unique</span>(block_feats)) <span class="sc">==</span> <span class="fu">length</span>(block_feats))</span>
<span id="cb123-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-43" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add covariances of highly correlated features to sigma</span></span>
<span id="cb123-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nblocks){</span>
<span id="cb123-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(block_size <span class="sc">-</span> <span class="dv">1</span>)){</span>
<span id="cb123-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-46" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span>(k <span class="cf">in</span> (j<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>block_size){</span>
<span id="cb123-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-47" aria-hidden="true" tabindex="-1"></a>                feat_1 <span class="ot">&lt;-</span> block_feats[i, j]</span>
<span id="cb123-48"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-48" aria-hidden="true" tabindex="-1"></a>                feat_2 <span class="ot">&lt;-</span> block_feats[i, k]</span>
<span id="cb123-49"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-49" aria-hidden="true" tabindex="-1"></a>                Sigma[feat_1, feat_2] <span class="ot">&lt;-</span> rho</span>
<span id="cb123-50"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-50" aria-hidden="true" tabindex="-1"></a>                Sigma[feat_2, feat_1] <span class="ot">&lt;-</span> rho</span>
<span id="cb123-51"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-51" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb123-52"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-52" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb123-53"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-53" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb123-54"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.numeric</span>(Sigma))</span>
<span id="cb123-55"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.matrix</span>(Sigma))</span>
<span id="cb123-56"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">nrow</span>(Sigma) <span class="sc">==</span> p <span class="sc">&amp;</span> <span class="fu">ncol</span>(Sigma) <span class="sc">==</span> p)</span>
<span id="cb123-57"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">all</span>(Sigma <span class="sc">==</span> <span class="fu">t</span>(Sigma)))</span>
<span id="cb123-58"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-59"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(Sigma)</span>
<span id="cb123-60"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb123-60" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Tests for makeCovarianceMatrix</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb124-1" aria-hidden="true" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">test_that</span>(<span class="st">&quot;makeCovarianceMatrix works&quot;</span>, {</span>
<span id="cb124-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb124-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">7612</span>)</span>
<span id="cb124-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb124-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb124-4" aria-hidden="true" tabindex="-1"></a>  ret <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#makeCovarianceMatrix'>makeCovarianceMatrix</a>(<span class="at">p=</span><span class="dv">8</span>, <span class="at">nblocks=</span><span class="dv">2</span>, <span class="at">block_size=</span><span class="dv">3</span>, <span class="at">rho=</span><span class="fl">0.8</span>, <span class="at">var=</span><span class="dv">2</span>)</span>
<span id="cb124-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb124-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb124-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb124-6" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(ret))</span>
<span id="cb124-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb124-7" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(ret))</span>
<span id="cb124-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb124-8" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(ret), <span class="dv">8</span>)</span>
<span id="cb124-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb124-9" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">ncol</span>(ret), <span class="dv">8</span>)</span>
<span id="cb124-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb124-10" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(ret <span class="sc">==</span> <span class="fu">t</span>(ret)))</span>
<span id="cb124-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb124-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Test on-diagonal and off-diagonal entries to see if they are as expected</span></span>
<span id="cb124-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb124-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># (only need to check top half of matrix; we already confirmed the matrix is</span></span>
<span id="cb124-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb124-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># symmetric)</span></span>
<span id="cb124-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb124-14" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">diag</span>(ret) <span class="sc">==</span> <span class="dv">2</span>))</span>
<span id="cb124-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb124-15" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(ret[<span class="dv">1</span>, <span class="dv">2</span>], <span class="fl">0.8</span>)</span>
<span id="cb124-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb124-16" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(ret[<span class="dv">1</span>, <span class="dv">3</span>], <span class="fl">0.8</span>)</span>
<span id="cb124-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb124-17" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(ret[<span class="dv">2</span>, <span class="dv">3</span>], <span class="fl">0.8</span>)</span>
<span id="cb124-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb124-18" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(ret[<span class="dv">4</span>, <span class="dv">5</span>], <span class="fl">0.8</span>)</span>
<span id="cb124-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb124-19" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(ret[<span class="dv">4</span>, <span class="dv">6</span>], <span class="fl">0.8</span>)</span>
<span id="cb124-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb124-20" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(ret[<span class="dv">5</span>, <span class="dv">6</span>], <span class="fl">0.8</span>)</span>
<span id="cb124-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb124-21" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(ret[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">4</span><span class="sc">:</span><span class="dv">8</span>] <span class="sc">==</span> <span class="dv">0</span>))</span>
<span id="cb124-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb124-22" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(ret[<span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">7</span><span class="sc">:</span><span class="dv">8</span>)] <span class="sc">==</span> <span class="dv">0</span>))</span>
<span id="cb124-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb124-23" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(ret[<span class="dv">7</span>, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="dv">8</span>)] <span class="sc">==</span> <span class="dv">0</span>))</span>
<span id="cb124-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb124-24" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(ret[<span class="dv">8</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>] <span class="sc">==</span> <span class="dv">0</span>))</span>
<span id="cb124-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb124-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb124-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb124-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Bad inputs</span></span>
<span id="cb124-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb124-27" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#makeCovarianceMatrix'>makeCovarianceMatrix</a>(<span class="at">p=</span><span class="dv">8</span>, <span class="at">nblocks=</span><span class="dv">2</span>, <span class="at">block_size=</span><span class="dv">3</span>,</span>
<span id="cb124-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb124-28" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">rho=</span><span class="fl">0.8</span>, <span class="at">var=</span>.<span class="dv">2</span>),</span>
<span id="cb124-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb124-29" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;abs(rho) &lt;= abs(var) is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb124-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb124-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb124-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb124-31" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#makeCovarianceMatrix'>makeCovarianceMatrix</a>(<span class="at">p=</span><span class="dv">8</span>, <span class="at">nblocks=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">block_size=</span><span class="dv">3</span>,</span>
<span id="cb124-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb124-32" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">rho=</span><span class="fl">0.8</span>, <span class="at">var=</span><span class="dv">2</span>),</span>
<span id="cb124-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb124-33" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;nblocks &gt;= 1 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb124-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb124-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb124-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb124-35" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#makeCovarianceMatrix'>makeCovarianceMatrix</a>(<span class="at">p=</span><span class="dv">8</span>, <span class="at">nblocks=</span><span class="dv">2</span>, <span class="at">block_size=</span><span class="dv">3</span>,</span>
<span id="cb124-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb124-36" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">rho=</span><span class="dv">0</span>, <span class="at">var=</span><span class="dv">2</span>),</span>
<span id="cb124-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb124-37" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;rho != 0 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb124-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb124-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb124-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb124-39" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#makeCovarianceMatrix'>makeCovarianceMatrix</a>(<span class="at">p=</span><span class="dv">8</span>, <span class="at">nblocks=</span><span class="dv">2</span>, <span class="at">block_size=</span><span class="dv">3</span>,</span>
<span id="cb124-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb124-40" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">rho=</span><span class="fl">0.9</span>, <span class="at">var=</span><span class="dv">0</span>),</span>
<span id="cb124-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb124-41" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;var != 0 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb124-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb124-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb124-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb124-43" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#makeCovarianceMatrix'>makeCovarianceMatrix</a>(<span class="at">p=</span><span class="dv">5</span>, <span class="at">nblocks=</span><span class="dv">2</span>, <span class="at">block_size=</span><span class="dv">3</span>,</span>
<span id="cb124-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb124-44" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">rho=</span><span class="fl">0.8</span>, <span class="at">var=</span><span class="dv">2</span>),</span>
<span id="cb124-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb124-45" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;p &gt;= nblocks * block_size is not TRUE&quot;</span>,</span>
<span id="cb124-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb124-46" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb124-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb124-47" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## Test passed 😀</code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Generated coefficients for y in latent variable model</span></span>
<span id="cb126-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb126-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param p Integer or numeric; the number of features that will be observed in</span></span>
<span id="cb126-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; x plus the number of latent variables (each corresponding to a cluster).</span></span>
<span id="cb126-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param k_unblocked Integer or numeric; the number of features in X that</span></span>
<span id="cb126-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; will have nonzero coefficients in the true model for y among those features </span></span>
<span id="cb126-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; not generated from the n_clusters latent variables (called &quot;weak signal&quot; </span></span>
<span id="cb126-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; features in the simulations from Faletto and Bien 2022). The coefficients on</span></span>
<span id="cb126-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; these features will be determined by beta_low.</span></span>
<span id="cb126-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param beta_low Integer or numeric; the maximum coefficient in the</span></span>
<span id="cb126-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; model for y among the k_unblocked features in X not generated from the</span></span>
<span id="cb126-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; latent variables. The coefficients of the features will be</span></span>
<span id="cb126-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; beta_low/sqrt(1:k_unblocked).</span></span>
<span id="cb126-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param beta_high Integer or numeric; the coefficient used for all</span></span>
<span id="cb126-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; sig_blocks latent variables that have nonzero coefficients in the true</span></span>
<span id="cb126-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; model for y.</span></span>
<span id="cb126-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param nblocks Integer or numeric; the number of latent variables that were</span></span>
<span id="cb126-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; generated, each of which will be associated with an observed cluster in X.</span></span>
<span id="cb126-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param sig_blocks Integer or numeric; the number of generated latent</span></span>
<span id="cb126-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; features that will have nonzero coefficients in the true model for y (all of</span></span>
<span id="cb126-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; them will have coefficient beta_latent). In particular, the first sig_blocks</span></span>
<span id="cb126-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; latent variables will have coefficient beta_latent, and the remaining nblocks</span></span>
<span id="cb126-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; - sig_blocks features will have coefficient 0. Must be less than or equal to</span></span>
<span id="cb126-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; n_clusters.</span></span>
<span id="cb126-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param block_size Integer or numeric; for each of the n_blocks latent</span></span>
<span id="cb126-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; variables, the covariance matrix will include the original latent feature</span></span>
<span id="cb126-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; plus block_size - 1 noisy proxies that are correlated with the latent</span></span>
<span id="cb126-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; variable.</span></span>
<span id="cb126-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return A named list with the following elements: \item{beta}{A vector of</span></span>
<span id="cb126-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; length `p` containing the coefficients for the true model for y. All entries</span></span>
<span id="cb126-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; will equal 0 except for the sig_blocks latent variables that will have</span></span>
<span id="cb126-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; coefficient beta_high and the k_unblocked independent features with</span></span>
<span id="cb126-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; coefficient determined by beta_low.} \item{blocked_dgp_vars}{An integer</span></span>
<span id="cb126-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; vector of length sig_blocks containing the indices of the features</span></span>
<span id="cb126-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; corresponding to the latent features that will have nonzero coefficient</span></span>
<span id="cb126-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; beta_high in the true model for y.} \item{sig_unblocked_vars}{An integer</span></span>
<span id="cb126-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; vector of length k_unblocked containing the indices of the observed features</span></span>
<span id="cb126-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; that are independent of the blocked features and have coefficient beta_low in</span></span>
<span id="cb126-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the true model for y. If k_unblocked = 0, this will just be NA.}</span></span>
<span id="cb126-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; \item{insig_blocked_vars}{An integer vector containing the indices of the</span></span>
<span id="cb126-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; features corresponding to the latent features that will have coefficient 0 in</span></span>
<span id="cb126-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the true model for y. If nblocks=0, this will just be NA.}</span></span>
<span id="cb126-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; \item{latent_vars}{An integer vector of length nblocks containing the indices</span></span>
<span id="cb126-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; of all of the latent features.}</span></span>
<span id="cb126-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @author Gregory Faletto, Jacob Bien</span></span>
<span id="cb126-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @references Faletto, G., &amp; Bien, J. (2022). Cluster Stability Selection.</span></span>
<span id="cb126-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; \emph{arXiv preprint arXiv:2201.00494}.</span></span>
<span id="cb126-48"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; \url{https://arxiv.org/abs/2201.00494}.</span></span>
<span id="cb126-49"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-49" aria-hidden="true" tabindex="-1"></a><span id='makeCoefficients'>makeCoefficients</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(p, k_unblocked, beta_low, beta_high, nblocks,</span>
<span id="cb126-50"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-50" aria-hidden="true" tabindex="-1"></a>    sig_blocks, block_size){</span>
<span id="cb126-51"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-52"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-52" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check inputs</span></span>
<span id="cb126-53"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(k_unblocked <span class="sc">&gt;=</span> <span class="dv">0</span>)</span>
<span id="cb126-54"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(sig_blocks <span class="sc">&lt;=</span> nblocks)</span>
<span id="cb126-55"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(p <span class="sc">&gt;=</span> nblocks<span class="sc">*</span>block_size <span class="sc">+</span> k_unblocked)</span>
<span id="cb126-56"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(sig_blocks <span class="sc">&gt;=</span> <span class="dv">0</span>)</span>
<span id="cb126-57"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-58"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-58" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize beta</span></span>
<span id="cb126-59"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-59" aria-hidden="true" tabindex="-1"></a>    beta <span class="ot">&lt;-</span> <span class="fu">numeric</span>(p)</span>
<span id="cb126-60"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-61"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-61" aria-hidden="true" tabindex="-1"></a>    <span class="co"># identify indices of first coefficient in each significant block (these</span></span>
<span id="cb126-62"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-62" aria-hidden="true" tabindex="-1"></a>    <span class="co"># features will have coefficient beta_high)</span></span>
<span id="cb126-63"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-63" aria-hidden="true" tabindex="-1"></a>    latent_vars <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb126-64"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-64" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(nblocks <span class="sc">&gt;=</span> <span class="dv">1</span>){</span>
<span id="cb126-65"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-65" aria-hidden="true" tabindex="-1"></a>        latent_vars <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(((<span class="dv">0</span><span class="sc">:</span>(nblocks <span class="sc">-</span> <span class="dv">1</span>))<span class="sc">*</span>block_size <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb126-66"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-67"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-67" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">all</span>(latent_vars) <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span>p)</span>
<span id="cb126-68"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-68" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">all</span>(latent_vars) <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span>(block_size<span class="sc">*</span>nblocks))</span>
<span id="cb126-69"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-69" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">length</span>(<span class="fu">unique</span>(latent_vars)) <span class="sc">==</span> nblocks)</span>
<span id="cb126-70"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-70" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">length</span>(latent_vars) <span class="sc">==</span> nblocks)</span>
<span id="cb126-71"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-71" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb126-72"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-73"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-73" aria-hidden="true" tabindex="-1"></a>    blocked_dgp_vars <span class="ot">&lt;-</span> latent_vars[<span class="dv">1</span><span class="sc">:</span>sig_blocks]</span>
<span id="cb126-74"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-75"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-75" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(sig_blocks <span class="sc">==</span> <span class="fu">length</span>(blocked_dgp_vars))</span>
<span id="cb126-76"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-76" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb126-77"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-77" aria-hidden="true" tabindex="-1"></a>    beta[blocked_dgp_vars] <span class="ot">&lt;-</span> beta_high</span>
<span id="cb126-78"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-79"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-79" aria-hidden="true" tabindex="-1"></a>    <span class="co"># identify remaining coefficients in blocks (which ought to be set to 0)</span></span>
<span id="cb126-80"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-80" aria-hidden="true" tabindex="-1"></a>    insig_blocked_vars <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb126-81"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-82"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-82" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(nblocks <span class="sc">&gt;=</span> <span class="dv">1</span>){</span>
<span id="cb126-83"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-83" aria-hidden="true" tabindex="-1"></a>        insig_blocked_vars <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="dv">1</span><span class="sc">:</span>(block_size<span class="sc">*</span>nblocks), blocked_dgp_vars)</span>
<span id="cb126-84"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-84" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">all</span>(beta[insig_blocked_vars] <span class="sc">==</span> <span class="dv">0</span>))</span>
<span id="cb126-85"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-85" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb126-86"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-86" aria-hidden="true" tabindex="-1"></a>    <span class="co"># find significant unblocked variables (if applicable) and fill in</span></span>
<span id="cb126-87"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-87" aria-hidden="true" tabindex="-1"></a>    <span class="co"># coefficients</span></span>
<span id="cb126-88"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-88" aria-hidden="true" tabindex="-1"></a>    sig_unblocked_vars <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb126-89"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-90"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-90" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(k_unblocked <span class="sc">&gt;</span> <span class="dv">0</span>){</span>
<span id="cb126-91"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-91" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Range of weak signal coefficients</span></span>
<span id="cb126-92"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-92" aria-hidden="true" tabindex="-1"></a>        beta_lows <span class="ot">&lt;-</span> beta_low<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">:</span>k_unblocked)</span>
<span id="cb126-93"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-93" aria-hidden="true" tabindex="-1"></a>        sig_unblocked_vars <span class="ot">&lt;-</span> (nblocks<span class="sc">*</span>block_size <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span></span>
<span id="cb126-94"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-94" aria-hidden="true" tabindex="-1"></a>            (nblocks<span class="sc">*</span>block_size <span class="sc">+</span> k_unblocked)</span>
<span id="cb126-95"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-95" aria-hidden="true" tabindex="-1"></a>        sig_unblocked_vars <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(sig_unblocked_vars)</span>
<span id="cb126-96"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-97"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-97" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">length</span>(sig_unblocked_vars) <span class="sc">==</span> k_unblocked)</span>
<span id="cb126-98"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-98" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">length</span>(<span class="fu">unique</span>(sig_unblocked_vars)) <span class="sc">==</span> k_unblocked)</span>
<span id="cb126-99"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-99" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">all</span>(sig_unblocked_vars) <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span>p)</span>
<span id="cb126-100"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-101"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-101" aria-hidden="true" tabindex="-1"></a>        beta[sig_unblocked_vars] <span class="ot">&lt;-</span> beta_lows</span>
<span id="cb126-102"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-102" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb126-103"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-104"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-104" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(<span class="fu">intersect</span>(blocked_dgp_vars, sig_unblocked_vars)) <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb126-105"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-105" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(<span class="fu">intersect</span>(sig_unblocked_vars, insig_blocked_vars)) <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb126-106"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-106" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(<span class="fu">intersect</span>(blocked_dgp_vars, insig_blocked_vars)) <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb126-107"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-108"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-108" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(insig_blocked_vars) <span class="sc">+</span> <span class="fu">length</span>(blocked_dgp_vars) <span class="sc">==</span></span>
<span id="cb126-109"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-109" aria-hidden="true" tabindex="-1"></a>        nblocks<span class="sc">*</span>block_size)</span>
<span id="cb126-110"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-111"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-111" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(sig_blocks <span class="sc">+</span> <span class="fu">length</span>(insig_blocked_vars) <span class="sc">+</span> k_unblocked <span class="sc">&lt;=</span> p)</span>
<span id="cb126-112"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-113"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-113" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">sum</span>(beta <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">==</span> sig_blocks <span class="sc">+</span> k_unblocked)</span>
<span id="cb126-114"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-114" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.numeric</span>(beta) <span class="sc">|</span> <span class="fu">is.integer</span>(beta))</span>
<span id="cb126-115"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-116"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-116" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">beta=</span>beta, <span class="at">blocked_dgp_vars=</span>blocked_dgp_vars,</span>
<span id="cb126-117"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-117" aria-hidden="true" tabindex="-1"></a>        <span class="at">sig_unblocked_vars=</span>sig_unblocked_vars,</span>
<span id="cb126-118"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-118" aria-hidden="true" tabindex="-1"></a>        <span class="at">insig_blocked_vars=</span>insig_blocked_vars, <span class="at">latent_vars=</span>latent_vars))</span>
<span id="cb126-119"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb126-119" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Tests for makeCoefficients</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-1" aria-hidden="true" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">test_that</span>(<span class="st">&quot;makeCoefficients works&quot;</span>, {</span>
<span id="cb127-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">5722</span>)</span>
<span id="cb127-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-4" aria-hidden="true" tabindex="-1"></a>  ret <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#makeCoefficients'>makeCoefficients</a>(<span class="at">p=</span><span class="dv">9</span><span class="sc">+</span><span class="dv">2</span>, <span class="at">k_unblocked=</span><span class="dv">2</span>, <span class="at">beta_low=</span>.<span class="dv">9</span>, <span class="at">beta_high=</span><span class="sc">-</span><span class="dv">2</span>,</span>
<span id="cb127-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">nblocks=</span><span class="dv">2</span>, <span class="at">sig_blocks=</span><span class="dv">1</span>, <span class="at">block_size=</span><span class="dv">3</span>)</span>
<span id="cb127-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb127-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-7" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(ret))</span>
<span id="cb127-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-8" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(ret), <span class="fu">c</span>(<span class="st">&quot;beta&quot;</span>, <span class="st">&quot;blocked_dgp_vars&quot;</span>,</span>
<span id="cb127-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-9" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">&quot;sig_unblocked_vars&quot;</span>,</span>
<span id="cb127-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-10" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">&quot;insig_blocked_vars&quot;</span>, <span class="st">&quot;latent_vars&quot;</span>))</span>
<span id="cb127-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb127-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-12" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(ret<span class="sc">$</span>beta))</span>
<span id="cb127-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-13" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(ret<span class="sc">$</span>beta), <span class="dv">9</span> <span class="sc">+</span> <span class="dv">2</span>)</span>
<span id="cb127-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-14" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">sum</span>(ret<span class="sc">$</span>beta <span class="sc">==</span> <span class="dv">0</span>), <span class="dv">9</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">-</span> <span class="dv">3</span>)</span>
<span id="cb127-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Checking structure</span></span>
<span id="cb127-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-16" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(ret<span class="sc">$</span>beta[<span class="dv">1</span>], <span class="sc">-</span><span class="dv">2</span>)</span>
<span id="cb127-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-17" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(ret<span class="sc">$</span>beta[<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>] <span class="sc">==</span> <span class="dv">0</span>))</span>
<span id="cb127-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-18" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(ret<span class="sc">$</span>beta[<span class="dv">7</span><span class="sc">:</span><span class="dv">8</span>] <span class="sc">==</span> <span class="fu">c</span>(.<span class="dv">9</span>, .<span class="dv">9</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span>))))</span>
<span id="cb127-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-19" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(ret<span class="sc">$</span>beta[<span class="dv">9</span><span class="sc">:</span><span class="dv">11</span>] <span class="sc">==</span> <span class="dv">0</span>))</span>
<span id="cb127-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb127-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-21" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.integer</span>(ret<span class="sc">$</span>blocked_dgp_vars) <span class="sc">|</span> <span class="fu">is.numeric</span>(ret<span class="sc">$</span>blocked_dgp_vars))</span>
<span id="cb127-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-22" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(ret<span class="sc">$</span>blocked_dgp_vars, <span class="dv">1</span>)</span>
<span id="cb127-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb127-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-24" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(ret<span class="sc">$</span>sig_unblocked_vars, <span class="dv">7</span><span class="sc">:</span><span class="dv">8</span>)</span>
<span id="cb127-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-26" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(ret<span class="sc">$</span>insig_blocked_vars, <span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb127-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb127-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-28" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(ret<span class="sc">$</span>latent_vars, <span class="fu">c</span>(1L, 4L))</span>
<span id="cb127-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb127-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Bad inputs</span></span>
<span id="cb127-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-31" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#makeCoefficients'>makeCoefficients</a>(<span class="at">p=</span><span class="dv">9</span><span class="sc">+</span><span class="dv">2</span>, <span class="at">k_unblocked=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">beta_low=</span>.<span class="dv">9</span>,</span>
<span id="cb127-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-32" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">beta_high=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">nblocks=</span><span class="dv">2</span>, <span class="at">sig_blocks=</span><span class="dv">1</span>,</span>
<span id="cb127-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-33" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">block_size=</span><span class="dv">3</span>),</span>
<span id="cb127-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-34" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;k_unblocked &gt;= 0 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb127-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb127-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-36" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#makeCoefficients'>makeCoefficients</a>(<span class="at">p=</span><span class="dv">9</span><span class="sc">+</span><span class="dv">2</span>, <span class="at">k_unblocked=</span><span class="dv">2</span>, <span class="at">beta_low=</span>.<span class="dv">9</span>,</span>
<span id="cb127-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-37" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">beta_high=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">nblocks=</span><span class="dv">2</span>, <span class="at">sig_blocks=</span><span class="dv">3</span>,</span>
<span id="cb127-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-38" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">block_size=</span><span class="dv">3</span>),</span>
<span id="cb127-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-39" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;sig_blocks &lt;= nblocks is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb127-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb127-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-41" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#makeCoefficients'>makeCoefficients</a>(<span class="at">p=</span><span class="dv">7</span>, <span class="at">k_unblocked=</span><span class="dv">2</span>, <span class="at">beta_low=</span>.<span class="dv">9</span>,</span>
<span id="cb127-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-42" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">beta_high=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">nblocks=</span><span class="dv">2</span>, <span class="at">sig_blocks=</span><span class="dv">1</span>,</span>
<span id="cb127-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-43" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">block_size=</span><span class="dv">3</span>),</span>
<span id="cb127-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-44" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;p &gt;= nblocks * block_size + k_unblocked is not TRUE&quot;</span>,</span>
<span id="cb127-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-45" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb127-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb127-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-47" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#makeCoefficients'>makeCoefficients</a>(<span class="at">p=</span><span class="dv">9</span><span class="sc">+</span><span class="dv">2</span>, <span class="at">k_unblocked=</span><span class="dv">2</span>, <span class="at">beta_low=</span>.<span class="dv">9</span>,</span>
<span id="cb127-48"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-48" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">beta_high=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">nblocks=</span><span class="dv">2</span>,</span>
<span id="cb127-49"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-49" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">sig_blocks=</span><span class="sc">-</span><span class="dv">1</span>, <span class="at">block_size=</span><span class="dv">3</span>),</span>
<span id="cb127-50"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-50" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;sig_blocks &gt;= 0 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb127-51"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-52"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb127-52" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## Test passed 😸</code></pre>
<p>genMuXZSd</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Generate observed and latent variables along with conditional mean</span></span>
<span id="cb129-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb129-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param n Integer or numeric; the number of observations to generate. (The</span></span>
<span id="cb129-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; generated X and Z will have n rows, and the generated y and mu will have</span></span>
<span id="cb129-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; length n.)</span></span>
<span id="cb129-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param p Integer or numeric; the number of observed features (the generated X</span></span>
<span id="cb129-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; will have p columns).</span></span>
<span id="cb129-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param beta A numeric or integer vector of length `p` + sig_blocks containing</span></span>
<span id="cb129-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the coefficients for the true model for y.</span></span>
<span id="cb129-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param Sigma A (`p` + n_blocks) x (`p` + n_blocks) numeric matrix</span></span>
<span id="cb129-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; representing the covariance matrix for the latent features, the associated</span></span>
<span id="cb129-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; proxies, and the remaining features.</span></span>
<span id="cb129-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param blocked_dgp_vars An integer vector of length sig_blocks containing the</span></span>
<span id="cb129-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; indices of the features corresponding to the latent features that have</span></span>
<span id="cb129-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; nonzero coefficient beta_high in the true model for y.</span></span>
<span id="cb129-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param latent_vars An integer vector of length n_blocks containing the</span></span>
<span id="cb129-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; indices of all of the latent features.</span></span>
<span id="cb129-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param block_size Integer or numeric; for each of the n_blocks latent</span></span>
<span id="cb129-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; variables, X will contain block_size noisy proxies that are correlated with</span></span>
<span id="cb129-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the latent variable.</span></span>
<span id="cb129-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param n_blocks Integer or numeric; the number of latent variables to</span></span>
<span id="cb129-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; generate, each of which will be associated with an observed cluster in X.</span></span>
<span id="cb129-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Must be at least 1. Default is 1.</span></span>
<span id="cb129-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param snr Integer or numeric; the signal-to-noise ratio of the response</span></span>
<span id="cb129-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; y. If sigma_eps_sq is not specified, the variance of the noise in y will be</span></span>
<span id="cb129-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; calculated using the formula sigma_eps_sq = sum(mu^2)/(n * snr). Only one of</span></span>
<span id="cb129-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; snr and sigma_eps_sq must be specified. Default is NA.</span></span>
<span id="cb129-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param sigma_eps_sq Integer or numeric; the variance on the noise added</span></span>
<span id="cb129-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; to y. Only one of snr and sigma_eps_sq must be specified. Default is NA.</span></span>
<span id="cb129-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return A named list with the following elements: \item{X}{An `n` x `p`</span></span>
<span id="cb129-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; numeric matrix containing the observed proxies for the latent variables as</span></span>
<span id="cb129-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; well as the observed unblocked (iid) variables.} \item{mu}{A length `n`</span></span>
<span id="cb129-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; numeric vector; the expected response given X, Z, and the true</span></span>
<span id="cb129-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; coefficient vector (equal to y minus the added noise).} \item{z}{An `n` x</span></span>
<span id="cb129-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; n_blocks numeric matrix containing the n_blocks latent variables. Note that</span></span>
<span id="cb129-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; (X, z) is multivariate Gaussian.} \item{sd}{Numeric; the standard deviation</span></span>
<span id="cb129-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; of the noise added to mu to get y (calculated either from snr or</span></span>
<span id="cb129-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; sigma_eps_sq).}</span></span>
<span id="cb129-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @author Gregory Faletto, Jacob Bien</span></span>
<span id="cb129-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-40" aria-hidden="true" tabindex="-1"></a><span id='genMuXZSd'>genMuXZSd</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(n, p, beta, Sigma, blocked_dgp_vars,</span>
<span id="cb129-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-41" aria-hidden="true" tabindex="-1"></a>    latent_vars, block_size, <span class="at">n_blocks=</span><span class="dv">1</span>, <span class="at">snr=</span><span class="cn">NA</span>, <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>){</span>
<span id="cb129-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-42" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check inputs</span></span>
<span id="cb129-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(blocked_dgp_vars) <span class="sc">&lt;=</span> n_blocks)</span>
<span id="cb129-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">nrow</span>(Sigma) <span class="sc">==</span> p <span class="sc">+</span> n_blocks)</span>
<span id="cb129-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">ncol</span>(Sigma) <span class="sc">==</span> p <span class="sc">+</span> n_blocks)</span>
<span id="cb129-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb129-48"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">any</span>(<span class="sc">!</span><span class="fu">is.na</span>(sigma_eps_sq))){</span>
<span id="cb129-49"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-49" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">is.numeric</span>(sigma_eps_sq) <span class="sc">|</span> <span class="fu">is.integer</span>(sigma_eps_sq))</span>
<span id="cb129-50"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-50" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">length</span>(sigma_eps_sq) <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb129-51"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-51" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(sigma_eps_sq <span class="sc">&gt;=</span> <span class="dv">0</span>)</span>
<span id="cb129-52"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-52" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span>{</span>
<span id="cb129-53"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="fu">any</span>(<span class="fu">is.na</span>(snr))){</span>
<span id="cb129-54"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-54" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stop</span>(<span class="st">&quot;Must provide one of snr or sigma_eps_sq&quot;</span>)</span>
<span id="cb129-55"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-55" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb129-56"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-56" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">is.numeric</span>(snr) <span class="sc">|</span> <span class="fu">is.integer</span>(snr))</span>
<span id="cb129-57"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-57" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">length</span>(snr) <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb129-58"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-58" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(snr <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb129-59"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-59" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb129-60"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-61"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(beta) <span class="sc">==</span> p <span class="sc">+</span> n_blocks)</span>
<span id="cb129-62"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">all</span>(beta[blocked_dgp_vars] <span class="sc">!=</span> <span class="dv">0</span>))</span>
<span id="cb129-63"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-64"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(latent_vars) <span class="sc">==</span> n_blocks)</span>
<span id="cb129-65"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-66"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-66" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">mvrnorm</span>(<span class="at">n=</span>n, <span class="at">mu=</span><span class="fu">rep</span>(<span class="dv">0</span>, p <span class="sc">+</span> n_blocks), <span class="at">Sigma=</span>Sigma)</span>
<span id="cb129-67"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-68"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(beta) <span class="sc">==</span> <span class="fu">ncol</span>(x))</span>
<span id="cb129-69"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-70"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-70" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(x <span class="sc">%*%</span> beta)</span>
<span id="cb129-71"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-72"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-72" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove true blocked signal feature from each block from x now that I&#39;ve</span></span>
<span id="cb129-73"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-73" aria-hidden="true" tabindex="-1"></a>    <span class="co"># generated mu</span></span>
<span id="cb129-74"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-74" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(n_blocks <span class="sc">&gt;</span> <span class="dv">0</span>){</span>
<span id="cb129-75"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-75" aria-hidden="true" tabindex="-1"></a>        z <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">as.numeric</span>(<span class="cn">NA</span>), <span class="at">nrow=</span>n, <span class="at">ncol=</span>n_blocks)</span>
<span id="cb129-76"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-76" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">length</span>(latent_vars) <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb129-77"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-77" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span>{</span>
<span id="cb129-78"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-78" aria-hidden="true" tabindex="-1"></a>        z <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb129-79"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-79" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">length</span>(latent_vars) <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb129-80"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-80" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb129-81"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-81" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb129-82"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-82" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">length</span>(latent_vars) <span class="sc">&gt;</span> <span class="dv">0</span>){</span>
<span id="cb129-83"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-83" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="fu">length</span>(latent_vars) <span class="sc">&gt;</span> <span class="dv">0</span>){</span>
<span id="cb129-84"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-84" aria-hidden="true" tabindex="-1"></a>        z[, <span class="dv">1</span><span class="sc">:</span>n_blocks] <span class="ot">&lt;-</span> x[, latent_vars]</span>
<span id="cb129-85"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-85" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb129-86"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-86" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb129-87"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-87" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb129-88"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-88" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> x[, <span class="fu">setdiff</span>(<span class="dv">1</span><span class="sc">:</span>(p <span class="sc">+</span> n_blocks), latent_vars)]</span>
<span id="cb129-89"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-90"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-90" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If SNR is null, use sigma_eps_sq</span></span>
<span id="cb129-91"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-91" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.na</span>(sigma_eps_sq)){</span>
<span id="cb129-92"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-92" aria-hidden="true" tabindex="-1"></a>        sd <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(sigma_eps_sq)</span>
<span id="cb129-93"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-93" aria-hidden="true" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb129-94"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-94" aria-hidden="true" tabindex="-1"></a>        sd <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(mu<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (n <span class="sc">*</span> snr)) <span class="co"># taking snr = ||mu||^2 /(n * sigma^2)</span></span>
<span id="cb129-95"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-95" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb129-96"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-97"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-97" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check output</span></span>
<span id="cb129-98"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-99"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-99" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(mu) <span class="sc">==</span> n)</span>
<span id="cb129-100"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-101"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-101" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">nrow</span>(x) <span class="sc">==</span> n)</span>
<span id="cb129-102"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-102" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">ncol</span>(x) <span class="sc">==</span> p)</span>
<span id="cb129-103"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-104"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-104" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">any</span>(<span class="sc">!</span><span class="fu">is.na</span>(z))){</span>
<span id="cb129-105"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-105" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">nrow</span>(z) <span class="sc">==</span> n)</span>
<span id="cb129-106"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-106" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">ncol</span>(z) <span class="sc">==</span> n_blocks)</span>
<span id="cb129-107"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-107" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb129-108"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-109"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-109" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.numeric</span>(sd) <span class="sc">|</span> <span class="fu">is.integer</span>(sd))</span>
<span id="cb129-110"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-110" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(sd) <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb129-111"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-111" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="sc">!</span><span class="fu">is.na</span>(sd))</span>
<span id="cb129-112"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-112" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(sd <span class="sc">&gt;=</span> <span class="dv">0</span>)</span>
<span id="cb129-113"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-114"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-114" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">X=</span>x, <span class="at">mu=</span>mu, <span class="at">z=</span>z, <span class="at">sd=</span>sd))</span>
<span id="cb129-115"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb129-115" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Tests for genMuXZSd</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-1" aria-hidden="true" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">test_that</span>(<span class="st">&quot;genMuXZSd works&quot;</span>, {</span>
<span id="cb130-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">61232</span>)</span>
<span id="cb130-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb130-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-4" aria-hidden="true" tabindex="-1"></a>  Sigma <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#makeCovarianceMatrix'>makeCovarianceMatrix</a>(<span class="at">p=</span><span class="dv">9</span><span class="sc">+</span><span class="dv">2</span>, <span class="at">nblocks=</span><span class="dv">2</span>, <span class="at">block_size=</span><span class="dv">3</span><span class="sc">+</span><span class="dv">1</span>, <span class="at">rho=</span><span class="fl">0.2499</span>,</span>
<span id="cb130-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-5" aria-hidden="true" tabindex="-1"></a>                                <span class="at">var=</span>.<span class="dv">25</span>)</span>
<span id="cb130-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-7" aria-hidden="true" tabindex="-1"></a>  coefs <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#makeCoefficients'>makeCoefficients</a>(<span class="at">p=</span><span class="dv">9</span><span class="sc">+</span><span class="dv">2</span>, <span class="at">k_unblocked=</span><span class="dv">2</span>, <span class="at">beta_low=</span>.<span class="dv">9</span>, <span class="at">beta_high=</span><span class="sc">-</span><span class="dv">2</span>,</span>
<span id="cb130-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-8" aria-hidden="true" tabindex="-1"></a>                            <span class="at">nblocks=</span><span class="dv">2</span>, <span class="at">sig_blocks=</span><span class="dv">1</span>, <span class="at">block_size=</span><span class="dv">3</span><span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb130-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-10" aria-hidden="true" tabindex="-1"></a>  ret <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#genMuXZSd'>genMuXZSd</a>(<span class="at">n=</span><span class="dv">25</span>, <span class="at">p=</span><span class="dv">9</span>, <span class="at">beta=</span>coefs<span class="sc">$</span>beta, <span class="at">Sigma=</span>Sigma,</span>
<span id="cb130-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">blocked_dgp_vars=</span>coefs<span class="sc">$</span>blocked_dgp_vars,</span>
<span id="cb130-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">latent_vars=</span>coefs<span class="sc">$</span>latent_vars, <span class="at">n_blocks=</span><span class="dv">2</span>, <span class="at">block_size=</span><span class="dv">3</span>,</span>
<span id="cb130-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">snr=</span><span class="cn">NA</span>, <span class="at">sigma_eps_sq=</span><span class="fl">1.2</span>)</span>
<span id="cb130-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb130-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-15" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(ret))</span>
<span id="cb130-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-16" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(ret), <span class="fu">c</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;mu&quot;</span>, <span class="st">&quot;z&quot;</span>, <span class="st">&quot;sd&quot;</span>))</span>
<span id="cb130-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb130-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-18" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(ret<span class="sc">$</span>X))</span>
<span id="cb130-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-19" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(ret<span class="sc">$</span>X))</span>
<span id="cb130-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-20" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(ret<span class="sc">$</span>X), <span class="dv">25</span>)</span>
<span id="cb130-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-21" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">ncol</span>(ret<span class="sc">$</span>X), <span class="dv">9</span>)</span>
<span id="cb130-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># X is Gaussian with mean 0 and variance 1/4; expect all observations to lie</span></span>
<span id="cb130-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># within 5 standard deviations of mean</span></span>
<span id="cb130-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-24" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">abs</span>(ret<span class="sc">$</span>X) <span class="sc">&lt;</span> <span class="dv">5</span><span class="sc">*</span><span class="fu">sqrt</span>(<span class="fl">0.25</span>)))</span>
<span id="cb130-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb130-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Test that clusters are correlated--within-cluster correlation should be</span></span>
<span id="cb130-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># high, correlation with other features should be low</span></span>
<span id="cb130-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-28" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">min</span>(<span class="fu">cor</span>(ret<span class="sc">$</span>X[, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])) <span class="sc">&gt;</span> .<span class="dv">9</span>)</span>
<span id="cb130-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-29" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">max</span>(<span class="fu">abs</span>(<span class="fu">cor</span>(ret<span class="sc">$</span>X[, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], ret<span class="sc">$</span>X[, <span class="dv">4</span><span class="sc">:</span><span class="dv">9</span>]))) <span class="sc">&lt;</span> .<span class="dv">6</span>)</span>
<span id="cb130-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-31" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">min</span>(<span class="fu">cor</span>(ret<span class="sc">$</span>X[, <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>])) <span class="sc">&gt;</span> .<span class="dv">9</span>)</span>
<span id="cb130-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-32" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">max</span>(<span class="fu">abs</span>(<span class="fu">cor</span>(ret<span class="sc">$</span>X[, <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>],</span>
<span id="cb130-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-33" aria-hidden="true" tabindex="-1"></a>                                    ret<span class="sc">$</span>X[, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">7</span><span class="sc">:</span><span class="dv">9</span>)]))) <span class="sc">&lt;</span> .<span class="dv">6</span>)</span>
<span id="cb130-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-35" aria-hidden="true" tabindex="-1"></a>  cor_indeps <span class="ot">&lt;-</span> <span class="fu">cor</span>(ret<span class="sc">$</span>X[, <span class="dv">7</span><span class="sc">:</span><span class="dv">9</span>])</span>
<span id="cb130-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-36" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">max</span>(<span class="fu">abs</span>(cor_indeps[<span class="fu">lower.tri</span>(cor_indeps)])) <span class="sc">&lt;</span> .<span class="dv">6</span>)</span>
<span id="cb130-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-39" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(ret<span class="sc">$</span>mu))</span>
<span id="cb130-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-40" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(ret<span class="sc">$</span>mu), <span class="dv">25</span>)</span>
<span id="cb130-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-42" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(ret<span class="sc">$</span>z))</span>
<span id="cb130-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-43" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(ret<span class="sc">$</span>z))</span>
<span id="cb130-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-44" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(ret<span class="sc">$</span>z), <span class="dv">25</span>)</span>
<span id="cb130-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-45" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">ncol</span>(ret<span class="sc">$</span>z), <span class="dv">2</span>)</span>
<span id="cb130-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-47" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(ret<span class="sc">$</span>sd))</span>
<span id="cb130-48"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-48" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(ret<span class="sc">$</span>sd, <span class="fu">sqrt</span>(<span class="fl">1.2</span>))</span>
<span id="cb130-49"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb130-50"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Specify SNR instead of sd</span></span>
<span id="cb130-51"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb130-52"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-52" aria-hidden="true" tabindex="-1"></a>  ret <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#genMuXZSd'>genMuXZSd</a>(<span class="at">n=</span><span class="dv">5</span>, <span class="at">p=</span><span class="dv">9</span>, <span class="at">beta=</span>coefs<span class="sc">$</span>beta, <span class="at">Sigma=</span>Sigma,</span>
<span id="cb130-53"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-53" aria-hidden="true" tabindex="-1"></a>                   <span class="at">blocked_dgp_vars=</span>coefs<span class="sc">$</span>blocked_dgp_vars,</span>
<span id="cb130-54"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-54" aria-hidden="true" tabindex="-1"></a>                   <span class="at">latent_vars=</span>coefs<span class="sc">$</span>latent_vars, <span class="at">n_blocks=</span><span class="dv">2</span>, <span class="at">block_size=</span><span class="dv">3</span>,</span>
<span id="cb130-55"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-55" aria-hidden="true" tabindex="-1"></a>                   <span class="at">snr=</span><span class="dv">1</span>, <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>)</span>
<span id="cb130-56"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb130-57"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-57" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(ret))</span>
<span id="cb130-58"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-58" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(ret), <span class="fu">c</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;mu&quot;</span>, <span class="st">&quot;z&quot;</span>, <span class="st">&quot;sd&quot;</span>))</span>
<span id="cb130-59"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb130-60"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-60" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(ret<span class="sc">$</span>X))</span>
<span id="cb130-61"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-61" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(ret<span class="sc">$</span>X))</span>
<span id="cb130-62"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-62" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(ret<span class="sc">$</span>X), <span class="dv">5</span>)</span>
<span id="cb130-63"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-63" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">ncol</span>(ret<span class="sc">$</span>X), <span class="dv">9</span>)</span>
<span id="cb130-64"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-65"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-65" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(ret<span class="sc">$</span>mu))</span>
<span id="cb130-66"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-66" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(ret<span class="sc">$</span>mu), <span class="dv">5</span>)</span>
<span id="cb130-67"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-68"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-68" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(ret<span class="sc">$</span>z))</span>
<span id="cb130-69"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-69" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(ret<span class="sc">$</span>z))</span>
<span id="cb130-70"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-70" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(ret<span class="sc">$</span>z), <span class="dv">5</span>)</span>
<span id="cb130-71"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-71" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">ncol</span>(ret<span class="sc">$</span>z), <span class="dv">2</span>)</span>
<span id="cb130-72"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-73"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-73" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(ret<span class="sc">$</span>sd))</span>
<span id="cb130-74"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-74" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(ret<span class="sc">$</span>sd <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb130-75"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-76"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-76" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Try a single latent variable (z should be a one-column matrix)</span></span>
<span id="cb130-77"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-78"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-78" aria-hidden="true" tabindex="-1"></a>  Sigma <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#makeCovarianceMatrix'>makeCovarianceMatrix</a>(<span class="at">p=</span><span class="dv">9</span><span class="sc">+</span><span class="dv">1</span>, <span class="at">nblocks=</span><span class="dv">1</span>, <span class="at">block_size=</span><span class="dv">3</span>, <span class="at">rho=</span><span class="fl">0.8</span>, <span class="at">var=</span><span class="dv">2</span>)</span>
<span id="cb130-79"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-80"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-80" aria-hidden="true" tabindex="-1"></a>  coefs <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#makeCoefficients'>makeCoefficients</a>(<span class="at">p=</span><span class="dv">9</span><span class="sc">+</span><span class="dv">1</span>, <span class="at">k_unblocked=</span><span class="dv">2</span>, <span class="at">beta_low=</span>.<span class="dv">9</span>, <span class="at">beta_high=</span><span class="sc">-</span><span class="dv">2</span>,</span>
<span id="cb130-81"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-81" aria-hidden="true" tabindex="-1"></a>                            <span class="at">nblocks=</span><span class="dv">1</span>, <span class="at">sig_blocks=</span><span class="dv">1</span>, <span class="at">block_size=</span><span class="dv">3</span>)</span>
<span id="cb130-82"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-83"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-83" aria-hidden="true" tabindex="-1"></a>  ret <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#genMuXZSd'>genMuXZSd</a>(<span class="at">n=</span><span class="dv">5</span>, <span class="at">p=</span><span class="dv">9</span>, <span class="at">beta=</span>coefs<span class="sc">$</span>beta, <span class="at">Sigma=</span>Sigma,</span>
<span id="cb130-84"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-84" aria-hidden="true" tabindex="-1"></a>                   <span class="at">blocked_dgp_vars=</span>coefs<span class="sc">$</span>blocked_dgp_vars,</span>
<span id="cb130-85"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-85" aria-hidden="true" tabindex="-1"></a>                   <span class="at">latent_vars=</span>coefs<span class="sc">$</span>latent_vars, <span class="at">n_blocks=</span><span class="dv">1</span>, <span class="at">block_size=</span><span class="dv">3</span>,</span>
<span id="cb130-86"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-86" aria-hidden="true" tabindex="-1"></a>                   <span class="at">snr=</span><span class="cn">NA</span>, <span class="at">sigma_eps_sq=</span><span class="fl">1.2</span>)</span>
<span id="cb130-87"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-88"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-88" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(ret))</span>
<span id="cb130-89"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-89" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(ret), <span class="fu">c</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;mu&quot;</span>, <span class="st">&quot;z&quot;</span>, <span class="st">&quot;sd&quot;</span>))</span>
<span id="cb130-90"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-91"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-91" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(ret<span class="sc">$</span>z))</span>
<span id="cb130-92"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-92" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(ret<span class="sc">$</span>z))</span>
<span id="cb130-93"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-93" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(ret<span class="sc">$</span>z), <span class="dv">5</span>)</span>
<span id="cb130-94"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-94" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">ncol</span>(ret<span class="sc">$</span>z), <span class="dv">1</span>)</span>
<span id="cb130-95"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-95" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb130-96"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-96" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Bad inputs</span></span>
<span id="cb130-97"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-97" aria-hidden="true" tabindex="-1"></a>  Sigma <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#makeCovarianceMatrix'>makeCovarianceMatrix</a>(<span class="at">p=</span><span class="dv">9</span><span class="sc">+</span><span class="dv">2</span>, <span class="at">nblocks=</span><span class="dv">2</span>, <span class="at">block_size=</span><span class="dv">3</span>, <span class="at">rho=</span><span class="fl">0.8</span>, <span class="at">var=</span><span class="dv">2</span>)</span>
<span id="cb130-98"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-99"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-99" aria-hidden="true" tabindex="-1"></a>  coefs <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#makeCoefficients'>makeCoefficients</a>(<span class="at">p=</span><span class="dv">9</span><span class="sc">+</span><span class="dv">2</span>, <span class="at">k_unblocked=</span><span class="dv">2</span>, <span class="at">beta_low=</span>.<span class="dv">9</span>, <span class="at">beta_high=</span><span class="sc">-</span><span class="dv">2</span>,</span>
<span id="cb130-100"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-100" aria-hidden="true" tabindex="-1"></a>                            <span class="at">nblocks=</span><span class="dv">2</span>, <span class="at">sig_blocks=</span><span class="dv">1</span>, <span class="at">block_size=</span><span class="dv">3</span>)</span>
<span id="cb130-101"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-102"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-102" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#genMuXZSd'>genMuXZSd</a>(<span class="at">n=</span><span class="dv">5</span>, <span class="at">p=</span><span class="dv">9</span>, <span class="at">beta=</span>coefs<span class="sc">$</span>beta, <span class="at">Sigma=</span>Sigma,</span>
<span id="cb130-103"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-103" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">blocked_dgp_vars=</span>coefs<span class="sc">$</span>blocked_dgp_vars,</span>
<span id="cb130-104"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-104" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">latent_vars=</span>coefs<span class="sc">$</span>latent_vars, <span class="at">n_blocks=</span><span class="dv">0</span>,</span>
<span id="cb130-105"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-105" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">block_size=</span><span class="dv">3</span>, <span class="at">snr=</span><span class="cn">NA</span>, <span class="at">sigma_eps_sq=</span><span class="fl">1.2</span>),</span>
<span id="cb130-106"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-106" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;length(blocked_dgp_vars) &lt;= n_blocks is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb130-107"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-108"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-108" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#genMuXZSd'>genMuXZSd</a>(<span class="at">n=</span><span class="dv">5</span>, <span class="at">p=</span><span class="dv">9</span>, <span class="at">beta=</span>coefs<span class="sc">$</span>beta, <span class="at">Sigma=</span>Sigma,</span>
<span id="cb130-109"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-109" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">blocked_dgp_vars=</span>coefs<span class="sc">$</span>blocked_dgp_vars,</span>
<span id="cb130-110"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-110" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">latent_vars=</span>coefs<span class="sc">$</span>latent_vars, <span class="at">n_blocks=</span><span class="dv">1</span>,</span>
<span id="cb130-111"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-111" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">block_size=</span><span class="dv">3</span>, <span class="at">snr=</span><span class="cn">NA</span>, <span class="at">sigma_eps_sq=</span><span class="fl">1.2</span>),</span>
<span id="cb130-112"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-112" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;nrow(Sigma) == p + n_blocks is not TRUE&quot;</span>,</span>
<span id="cb130-113"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-113" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb130-114"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-114" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb130-115"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-115" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#genMuXZSd'>genMuXZSd</a>(<span class="at">n=</span><span class="dv">5</span>, <span class="at">p=</span><span class="dv">9</span>, <span class="at">beta=</span>coefs<span class="sc">$</span>beta, <span class="at">Sigma=</span>Sigma,</span>
<span id="cb130-116"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-116" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">blocked_dgp_vars=</span>coefs<span class="sc">$</span>blocked_dgp_vars,</span>
<span id="cb130-117"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-117" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">latent_vars=</span>coefs<span class="sc">$</span>latent_vars, <span class="at">n_blocks=</span><span class="dv">2</span>,</span>
<span id="cb130-118"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-118" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">block_size=</span><span class="dv">3</span>, <span class="at">snr=</span><span class="cn">NA</span>, <span class="at">sigma_eps_sq=</span><span class="st">&quot;1.2&quot;</span>),</span>
<span id="cb130-119"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-119" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;is.numeric(sigma_eps_sq) | is.integer(sigma_eps_sq) is not TRUE&quot;</span>,</span>
<span id="cb130-120"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-120" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb130-121"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-121" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb130-122"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-122" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#genMuXZSd'>genMuXZSd</a>(<span class="at">n=</span><span class="dv">5</span>, <span class="at">p=</span><span class="dv">9</span>, <span class="at">beta=</span>coefs<span class="sc">$</span>beta, <span class="at">Sigma=</span>Sigma,</span>
<span id="cb130-123"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-123" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">blocked_dgp_vars=</span>coefs<span class="sc">$</span>blocked_dgp_vars,</span>
<span id="cb130-124"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-124" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">latent_vars=</span>coefs<span class="sc">$</span>latent_vars, <span class="at">n_blocks=</span><span class="dv">2</span>,</span>
<span id="cb130-125"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-125" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">block_size=</span><span class="dv">3</span>, <span class="at">snr=</span><span class="cn">NA</span>, <span class="at">sigma_eps_sq=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>),</span>
<span id="cb130-126"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-126" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;length(sigma_eps_sq) == 1 is not TRUE&quot;</span>,</span>
<span id="cb130-127"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-127" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb130-128"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-128" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb130-129"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-129" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#genMuXZSd'>genMuXZSd</a>(<span class="at">n=</span><span class="dv">5</span>, <span class="at">p=</span><span class="dv">9</span>, <span class="at">beta=</span>coefs<span class="sc">$</span>beta, <span class="at">Sigma=</span>Sigma,</span>
<span id="cb130-130"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-130" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">blocked_dgp_vars=</span>coefs<span class="sc">$</span>blocked_dgp_vars,</span>
<span id="cb130-131"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-131" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">latent_vars=</span>coefs<span class="sc">$</span>latent_vars, <span class="at">n_blocks=</span><span class="dv">2</span>,</span>
<span id="cb130-132"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-132" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">block_size=</span><span class="dv">3</span>, <span class="at">snr=</span><span class="cn">NA</span>, <span class="at">sigma_eps_sq=</span><span class="sc">-</span><span class="dv">1</span>),</span>
<span id="cb130-133"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-133" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;sigma_eps_sq &gt;= 0 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb130-134"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-134" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb130-135"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-135" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#genMuXZSd'>genMuXZSd</a>(<span class="at">n=</span><span class="dv">5</span>, <span class="at">p=</span><span class="dv">9</span>, <span class="at">beta=</span>coefs<span class="sc">$</span>beta, <span class="at">Sigma=</span>Sigma,</span>
<span id="cb130-136"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-136" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">blocked_dgp_vars=</span>coefs<span class="sc">$</span>blocked_dgp_vars,</span>
<span id="cb130-137"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-137" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">latent_vars=</span>coefs<span class="sc">$</span>latent_vars, <span class="at">n_blocks=</span><span class="dv">2</span>,</span>
<span id="cb130-138"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-138" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">block_size=</span><span class="dv">3</span>, <span class="at">snr=</span><span class="cn">NA</span>, <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>),</span>
<span id="cb130-139"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-139" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;Must provide one of snr or sigma_eps_sq&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb130-140"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-140" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb130-141"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-141" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#genMuXZSd'>genMuXZSd</a>(<span class="at">n=</span><span class="dv">5</span>, <span class="at">p=</span><span class="dv">9</span>, <span class="at">beta=</span>coefs<span class="sc">$</span>beta, <span class="at">Sigma=</span>Sigma,</span>
<span id="cb130-142"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-142" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">blocked_dgp_vars=</span>coefs<span class="sc">$</span>blocked_dgp_vars,</span>
<span id="cb130-143"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-143" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">latent_vars=</span>coefs<span class="sc">$</span>latent_vars, <span class="at">n_blocks=</span><span class="dv">2</span>,</span>
<span id="cb130-144"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-144" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">block_size=</span><span class="dv">3</span>, <span class="at">snr=</span><span class="st">&quot;1&quot;</span>, <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>),</span>
<span id="cb130-145"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-145" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;is.numeric(snr) | is.integer(snr) is not TRUE&quot;</span>,</span>
<span id="cb130-146"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-146" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb130-147"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-147" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb130-148"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-148" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#genMuXZSd'>genMuXZSd</a>(<span class="at">n=</span><span class="dv">5</span>, <span class="at">p=</span><span class="dv">9</span>, <span class="at">beta=</span>coefs<span class="sc">$</span>beta, <span class="at">Sigma=</span>Sigma,</span>
<span id="cb130-149"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-149" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">blocked_dgp_vars=</span>coefs<span class="sc">$</span>blocked_dgp_vars,</span>
<span id="cb130-150"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-150" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">latent_vars=</span>coefs<span class="sc">$</span>latent_vars, <span class="at">n_blocks=</span><span class="dv">2</span>,</span>
<span id="cb130-151"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-151" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">block_size=</span><span class="dv">3</span>, <span class="at">snr=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>),</span>
<span id="cb130-152"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-152" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;length(snr) == 1 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb130-153"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-153" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb130-154"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-154" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#genMuXZSd'>genMuXZSd</a>(<span class="at">n=</span><span class="dv">5</span>, <span class="at">p=</span><span class="dv">9</span>, <span class="at">beta=</span>coefs<span class="sc">$</span>beta, <span class="at">Sigma=</span>Sigma,</span>
<span id="cb130-155"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-155" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">blocked_dgp_vars=</span>coefs<span class="sc">$</span>blocked_dgp_vars,</span>
<span id="cb130-156"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-156" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">latent_vars=</span>coefs<span class="sc">$</span>latent_vars, <span class="at">n_blocks=</span><span class="dv">2</span>,</span>
<span id="cb130-157"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-157" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">block_size=</span><span class="dv">3</span>, <span class="at">snr=</span><span class="sc">-</span><span class="dv">1</span>, <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>),</span>
<span id="cb130-158"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-158" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;snr &gt; 0 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb130-159"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-159" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb130-160"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-160" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#genMuXZSd'>genMuXZSd</a>(<span class="at">n=</span><span class="dv">5</span>, <span class="at">p=</span><span class="dv">9</span>, <span class="at">beta=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>, <span class="at">Sigma=</span>Sigma,</span>
<span id="cb130-161"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-161" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">blocked_dgp_vars=</span>coefs<span class="sc">$</span>blocked_dgp_vars,</span>
<span id="cb130-162"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-162" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">latent_vars=</span>coefs<span class="sc">$</span>latent_vars, <span class="at">n_blocks=</span><span class="dv">2</span>,</span>
<span id="cb130-163"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-163" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">block_size=</span><span class="dv">3</span>, <span class="at">snr=</span><span class="dv">1</span>, <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>),</span>
<span id="cb130-164"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-164" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;length(beta) == p + n_blocks is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb130-165"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-165" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb130-166"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-166" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#genMuXZSd'>genMuXZSd</a>(<span class="at">n=</span><span class="dv">5</span>, <span class="at">p=</span><span class="dv">9</span>, <span class="at">beta=</span><span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">9</span> <span class="sc">+</span> <span class="dv">2</span>), <span class="at">Sigma=</span>Sigma,</span>
<span id="cb130-167"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-167" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">blocked_dgp_vars=</span>coefs<span class="sc">$</span>blocked_dgp_vars,</span>
<span id="cb130-168"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-168" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">latent_vars=</span>coefs<span class="sc">$</span>latent_vars, <span class="at">n_blocks=</span><span class="dv">2</span>,</span>
<span id="cb130-169"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-169" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">block_size=</span><span class="dv">3</span>, <span class="at">snr=</span><span class="dv">1</span>, <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>),</span>
<span id="cb130-170"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-170" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;all(beta[blocked_dgp_vars] != 0) is not TRUE&quot;</span>,</span>
<span id="cb130-171"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-171" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb130-172"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-172" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb130-173"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-173" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#genMuXZSd'>genMuXZSd</a>(<span class="at">n=</span><span class="dv">5</span>, <span class="at">p=</span><span class="dv">9</span>, <span class="at">beta=</span>coefs<span class="sc">$</span>beta, <span class="at">Sigma=</span>Sigma,</span>
<span id="cb130-174"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-174" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">blocked_dgp_vars=</span>coefs<span class="sc">$</span>blocked_dgp_vars,</span>
<span id="cb130-175"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-175" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">latent_vars=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">n_blocks=</span><span class="dv">2</span>,</span>
<span id="cb130-176"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-176" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">block_size=</span><span class="dv">3</span>, <span class="at">snr=</span><span class="dv">1</span>, <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>),</span>
<span id="cb130-177"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-177" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;length(latent_vars) == n_blocks is not TRUE&quot;</span>,</span>
<span id="cb130-178"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-178" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb130-179"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-180"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb130-180" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## Test passed 🥇</code></pre>
<p>Finally, tests for genClusteredData</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-1" aria-hidden="true" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">test_that</span>(<span class="st">&quot;genClusteredData works&quot;</span>, {</span>
<span id="cb132-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">23478</span>)</span>
<span id="cb132-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-4" aria-hidden="true" tabindex="-1"></a>  ret <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#genClusteredData'>genClusteredData</a>(<span class="at">n=</span><span class="dv">25</span>, <span class="at">p=</span><span class="dv">19</span>, <span class="at">k_unclustered=</span><span class="dv">2</span>, <span class="at">cluster_size=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">3</span>,</span>
<span id="cb132-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">sig_clusters=</span><span class="dv">2</span>, <span class="at">rho=</span><span class="fl">3.99</span>, <span class="at">var=</span><span class="dv">4</span>, <span class="at">beta_latent=</span><span class="fl">1.5</span>,</span>
<span id="cb132-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">beta_unclustered=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">snr=</span><span class="cn">NA</span>, <span class="at">sigma_eps_sq=</span>.<span class="dv">5</span>)</span>
<span id="cb132-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb132-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-8" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(ret))</span>
<span id="cb132-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-9" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(ret), <span class="fu">c</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;y&quot;</span>, <span class="st">&quot;Z&quot;</span>, <span class="st">&quot;mu&quot;</span>))</span>
<span id="cb132-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb132-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-11" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(ret<span class="sc">$</span>X))</span>
<span id="cb132-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-12" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(ret<span class="sc">$</span>X))</span>
<span id="cb132-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-13" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">ncol</span>(ret<span class="sc">$</span>X), <span class="dv">19</span>)</span>
<span id="cb132-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-14" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(ret<span class="sc">$</span>X), <span class="dv">25</span>)</span>
<span id="cb132-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># X is Gaussian with mean 0 and variance 4; expect all observations to lie</span></span>
<span id="cb132-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># within 5 standard deviations of mean</span></span>
<span id="cb132-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-17" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">abs</span>(ret<span class="sc">$</span>X) <span class="sc">&lt;</span> <span class="dv">5</span><span class="sc">*</span><span class="dv">2</span>))</span>
<span id="cb132-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Test that clusters are correlated--within-cluster correlation should be</span></span>
<span id="cb132-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># high, correlation with other features should be low</span></span>
<span id="cb132-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-20" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">min</span>(<span class="fu">cor</span>(ret<span class="sc">$</span>X[, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])) <span class="sc">&gt;</span> .<span class="dv">9</span>)</span>
<span id="cb132-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-21" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">max</span>(<span class="fu">abs</span>(<span class="fu">cor</span>(ret<span class="sc">$</span>X[, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], ret<span class="sc">$</span>X[, <span class="dv">6</span><span class="sc">:</span><span class="dv">19</span>]))) <span class="sc">&lt;</span> .<span class="dv">6</span>)</span>
<span id="cb132-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb132-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-23" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">min</span>(<span class="fu">cor</span>(ret<span class="sc">$</span>X[, <span class="dv">6</span><span class="sc">:</span><span class="dv">10</span>])) <span class="sc">&gt;</span> .<span class="dv">9</span>)</span>
<span id="cb132-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-24" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">max</span>(<span class="fu">abs</span>(<span class="fu">cor</span>(ret<span class="sc">$</span>X[, <span class="dv">6</span><span class="sc">:</span><span class="dv">10</span>],</span>
<span id="cb132-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-25" aria-hidden="true" tabindex="-1"></a>                                    ret<span class="sc">$</span>X[, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">11</span><span class="sc">:</span><span class="dv">19</span>)]))) <span class="sc">&lt;</span> .<span class="dv">6</span>)</span>
<span id="cb132-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb132-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-27" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">min</span>(<span class="fu">cor</span>(ret<span class="sc">$</span>X[, <span class="dv">11</span><span class="sc">:</span><span class="dv">15</span>])) <span class="sc">&gt;</span> .<span class="dv">9</span>)</span>
<span id="cb132-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-28" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">max</span>(<span class="fu">abs</span>(<span class="fu">cor</span>(ret<span class="sc">$</span>X[, <span class="dv">11</span><span class="sc">:</span><span class="dv">15</span>],</span>
<span id="cb132-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-29" aria-hidden="true" tabindex="-1"></a>                                    ret<span class="sc">$</span>X[, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">16</span><span class="sc">:</span><span class="dv">19</span>)]))) <span class="sc">&lt;</span> .<span class="dv">6</span>)</span>
<span id="cb132-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-31" aria-hidden="true" tabindex="-1"></a>  cor_indeps <span class="ot">&lt;-</span> <span class="fu">cor</span>(ret<span class="sc">$</span>X[, <span class="dv">16</span><span class="sc">:</span><span class="dv">19</span>])</span>
<span id="cb132-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-32" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">max</span>(<span class="fu">abs</span>(cor_indeps[<span class="fu">lower.tri</span>(cor_indeps)])) <span class="sc">&lt;</span> .<span class="dv">6</span>)</span>
<span id="cb132-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-34" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(ret<span class="sc">$</span>y))</span>
<span id="cb132-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-35" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(ret<span class="sc">$</span>y), <span class="dv">25</span>)</span>
<span id="cb132-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-37" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(ret<span class="sc">$</span>Z))</span>
<span id="cb132-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-38" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(ret<span class="sc">$</span>Z))</span>
<span id="cb132-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-39" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(ret<span class="sc">$</span>Z), <span class="dv">25</span>)</span>
<span id="cb132-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-40" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">ncol</span>(ret<span class="sc">$</span>Z), <span class="dv">3</span>)</span>
<span id="cb132-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-42" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(ret<span class="sc">$</span>mu))</span>
<span id="cb132-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-43" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(ret<span class="sc">$</span>mu), <span class="dv">25</span>)</span>
<span id="cb132-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Because y is Gaussian with mean mu and standard deviation .5 conditional on</span></span>
<span id="cb132-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># mu, expect all observations to lie within 5 sds of mu</span></span>
<span id="cb132-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-46" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">abs</span>(ret<span class="sc">$</span>y <span class="sc">-</span> ret<span class="sc">$</span>mu) <span class="sc">&lt;</span> <span class="dv">5</span><span class="sc">*</span>.<span class="dv">5</span>))</span>
<span id="cb132-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-48"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Specify SNR instead of sigma_eps_sq</span></span>
<span id="cb132-49"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-49" aria-hidden="true" tabindex="-1"></a>  ret <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#genClusteredData'>genClusteredData</a>(<span class="at">n=</span><span class="dv">5</span>, <span class="at">p=</span><span class="dv">19</span>, <span class="at">k_unclustered=</span><span class="dv">2</span>, <span class="at">cluster_size=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">3</span>,</span>
<span id="cb132-50"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-50" aria-hidden="true" tabindex="-1"></a>                       <span class="at">sig_clusters=</span><span class="dv">2</span>, <span class="at">rho=</span>.<span class="dv">8</span>, <span class="at">var=</span><span class="fl">1.1</span>, <span class="at">beta_latent=</span><span class="fl">1.5</span>,</span>
<span id="cb132-51"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-51" aria-hidden="true" tabindex="-1"></a>                       <span class="at">beta_unclustered=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">snr=</span><span class="dv">1</span>, <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>)</span>
<span id="cb132-52"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb132-53"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-53" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(ret))</span>
<span id="cb132-54"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-54" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(ret), <span class="fu">c</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;y&quot;</span>, <span class="st">&quot;Z&quot;</span>, <span class="st">&quot;mu&quot;</span>))</span>
<span id="cb132-55"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb132-56"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-56" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If sigma_eps_sq is specified, snr should be ignored. (Set an SNR that</span></span>
<span id="cb132-57"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-57" aria-hidden="true" tabindex="-1"></a>  <span class="co"># implies a very large noise variance to test this)</span></span>
<span id="cb132-58"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-58" aria-hidden="true" tabindex="-1"></a>  ret <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#genClusteredData'>genClusteredData</a>(<span class="at">n=</span><span class="dv">5</span>, <span class="at">p=</span><span class="dv">19</span>, <span class="at">k_unclustered=</span><span class="dv">2</span>, <span class="at">cluster_size=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">3</span>,</span>
<span id="cb132-59"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-59" aria-hidden="true" tabindex="-1"></a>                <span class="at">sig_clusters=</span><span class="dv">2</span>, <span class="at">rho=</span>.<span class="dv">8</span>, <span class="at">var=</span><span class="dv">4</span>, <span class="at">beta_latent=</span><span class="fl">1.5</span>,</span>
<span id="cb132-60"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-60" aria-hidden="true" tabindex="-1"></a>                <span class="at">beta_unclustered=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">snr=</span>.<span class="dv">01</span>, <span class="at">sigma_eps_sq=</span>.<span class="dv">25</span>)</span>
<span id="cb132-61"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-61" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb132-62"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-62" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(ret))</span>
<span id="cb132-63"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-63" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(ret), <span class="fu">c</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;y&quot;</span>, <span class="st">&quot;Z&quot;</span>, <span class="st">&quot;mu&quot;</span>))</span>
<span id="cb132-64"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-64" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb132-65"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-65" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Because y is Gaussian with mean mu and standard deviation .5 conditional on</span></span>
<span id="cb132-66"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-66" aria-hidden="true" tabindex="-1"></a>  <span class="co"># mu, expect all observations to lie within 5 sds of mu</span></span>
<span id="cb132-67"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-67" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">abs</span>(ret<span class="sc">$</span>y <span class="sc">-</span> ret<span class="sc">$</span>mu) <span class="sc">&lt;</span> <span class="dv">5</span><span class="sc">*</span>.<span class="dv">25</span>))</span>
<span id="cb132-68"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-68" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb132-69"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-69" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Try a single latent variable (z should be a one-column matrix)</span></span>
<span id="cb132-70"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-70" aria-hidden="true" tabindex="-1"></a>  ret <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#genClusteredData'>genClusteredData</a>(<span class="at">n=</span><span class="dv">5</span>, <span class="at">p=</span><span class="dv">19</span>, <span class="at">k_unclustered=</span><span class="dv">2</span>, <span class="at">cluster_size=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">1</span>,</span>
<span id="cb132-71"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-71" aria-hidden="true" tabindex="-1"></a>                <span class="at">sig_clusters=</span><span class="dv">1</span>, <span class="at">rho=</span>.<span class="dv">8</span>, <span class="at">var=</span><span class="dv">4</span>, <span class="at">beta_latent=</span><span class="fl">1.5</span>,</span>
<span id="cb132-72"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-72" aria-hidden="true" tabindex="-1"></a>                <span class="at">beta_unclustered=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">snr=</span><span class="cn">NA</span>, <span class="at">sigma_eps_sq=</span>.<span class="dv">5</span>)</span>
<span id="cb132-73"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-73" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb132-74"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-74" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(ret))</span>
<span id="cb132-75"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-75" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(ret), <span class="fu">c</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;y&quot;</span>, <span class="st">&quot;Z&quot;</span>, <span class="st">&quot;mu&quot;</span>))</span>
<span id="cb132-76"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-77"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-77" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(ret<span class="sc">$</span>Z))</span>
<span id="cb132-78"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-78" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.matrix</span>(ret<span class="sc">$</span>Z))</span>
<span id="cb132-79"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-79" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(ret<span class="sc">$</span>Z), <span class="dv">5</span>)</span>
<span id="cb132-80"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-80" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">ncol</span>(ret<span class="sc">$</span>Z), <span class="dv">1</span>)</span>
<span id="cb132-81"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-81" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb132-82"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-82" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Bad inputs</span></span>
<span id="cb132-83"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-83" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#genClusteredData'>genClusteredData</a>(<span class="at">n=</span><span class="dv">5</span>, <span class="at">p=</span><span class="dv">19</span>, <span class="at">k_unclustered=</span><span class="dv">2</span>,</span>
<span id="cb132-84"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-84" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">cluster_size=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">3</span>,</span>
<span id="cb132-85"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-85" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">sig_clusters=</span><span class="st">&quot;2&quot;</span>, <span class="at">rho=</span>.<span class="dv">8</span>, <span class="at">var=</span><span class="fl">1.1</span>,</span>
<span id="cb132-86"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-86" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">beta_latent=</span><span class="fl">1.5</span>, <span class="at">beta_unclustered=</span><span class="sc">-</span><span class="dv">2</span>,</span>
<span id="cb132-87"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-87" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">snr=</span><span class="dv">1</span>, <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>),</span>
<span id="cb132-88"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-88" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;is.numeric(sig_clusters) | is.integer(sig_clusters) is not TRUE&quot;</span>,</span>
<span id="cb132-89"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-89" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb132-90"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-90" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb132-91"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-91" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#genClusteredData'>genClusteredData</a>(<span class="at">n=</span><span class="dv">5</span>, <span class="at">p=</span><span class="dv">19</span>, <span class="at">k_unclustered=</span><span class="dv">2</span>,</span>
<span id="cb132-92"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-92" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cluster_size=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">3</span>,</span>
<span id="cb132-93"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-93" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sig_clusters=</span><span class="dv">4</span>, <span class="at">rho=</span>.<span class="dv">8</span>,</span>
<span id="cb132-94"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-94" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">var=</span><span class="fl">1.1</span>, <span class="at">beta_latent=</span><span class="fl">1.5</span>,</span>
<span id="cb132-95"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-95" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">beta_unclustered=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">snr=</span><span class="dv">1</span>,</span>
<span id="cb132-96"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-96" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>),</span>
<span id="cb132-97"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-97" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;sig_clusters &lt;= n_clusters is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb132-98"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-99"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-99" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#genClusteredData'>genClusteredData</a>(<span class="at">n=</span><span class="dv">5</span>, <span class="at">p=</span><span class="dv">19</span>, <span class="at">k_unclustered=</span><span class="dv">2</span>,</span>
<span id="cb132-100"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-100" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cluster_size=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">3</span>,</span>
<span id="cb132-101"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-101" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sig_clusters=</span><span class="sc">-</span><span class="dv">1</span>, <span class="at">rho=</span>.<span class="dv">8</span>,</span>
<span id="cb132-102"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-102" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">var=</span><span class="fl">1.1</span>, <span class="at">beta_latent=</span><span class="fl">1.5</span>,</span>
<span id="cb132-103"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-103" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">beta_unclustered=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">snr=</span><span class="dv">1</span>,</span>
<span id="cb132-104"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-104" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>),</span>
<span id="cb132-105"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-105" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;sig_clusters &gt;= 0 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb132-106"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-107"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-107" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#genClusteredData'>genClusteredData</a>(<span class="at">n=</span><span class="dv">5</span>, <span class="at">p=</span><span class="dv">19</span>, <span class="at">k_unclustered=</span><span class="dv">2</span>,</span>
<span id="cb132-108"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-108" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cluster_size=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">3</span>,</span>
<span id="cb132-109"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-109" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sig_clusters=</span>.<span class="dv">6</span>, <span class="at">rho=</span>.<span class="dv">8</span>,</span>
<span id="cb132-110"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-110" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">var=</span><span class="fl">1.1</span>, <span class="at">beta_latent=</span><span class="fl">1.5</span>,</span>
<span id="cb132-111"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-111" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">beta_unclustered=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">snr=</span><span class="dv">1</span>,</span>
<span id="cb132-112"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-112" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>),</span>
<span id="cb132-113"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-113" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;sig_clusters == round(sig_clusters) is not TRUE&quot;</span>,</span>
<span id="cb132-114"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-114" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb132-115"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-116"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-117"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-117" aria-hidden="true" tabindex="-1"></a>  <span class="co"># n_clusters</span></span>
<span id="cb132-118"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-118" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#genClusteredData'>genClusteredData</a>(<span class="at">n=</span><span class="dv">5</span>, <span class="at">p=</span><span class="dv">19</span>, <span class="at">k_unclustered=</span><span class="dv">2</span>,</span>
<span id="cb132-119"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-119" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cluster_size=</span><span class="dv">5</span>,</span>
<span id="cb132-120"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-120" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">n_clusters=</span><span class="st">&quot;3&quot;</span>,</span>
<span id="cb132-121"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-121" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sig_clusters=</span><span class="dv">2</span>, <span class="at">rho=</span>.<span class="dv">8</span>,</span>
<span id="cb132-122"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-122" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">var=</span><span class="fl">1.1</span>, <span class="at">beta_latent=</span><span class="fl">1.5</span>,</span>
<span id="cb132-123"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-123" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">beta_unclustered=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">snr=</span><span class="dv">1</span>,</span>
<span id="cb132-124"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-124" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>),</span>
<span id="cb132-125"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-125" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;is.numeric(n_clusters) | is.integer(n_clusters) is not TRUE&quot;</span>,</span>
<span id="cb132-126"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-126" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb132-127"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-128"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-128" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#genClusteredData'>genClusteredData</a>(<span class="at">n=</span><span class="dv">5</span>, <span class="at">p=</span><span class="dv">19</span>, <span class="at">k_unclustered=</span><span class="dv">2</span>,</span>
<span id="cb132-129"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-129" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cluster_size=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="fl">3.2</span>,</span>
<span id="cb132-130"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-130" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sig_clusters=</span><span class="dv">2</span>, <span class="at">rho=</span>.<span class="dv">8</span>,</span>
<span id="cb132-131"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-131" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">var=</span><span class="fl">1.1</span>, <span class="at">beta_latent=</span><span class="fl">1.5</span>,</span>
<span id="cb132-132"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-132" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">beta_unclustered=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">snr=</span><span class="dv">1</span>,</span>
<span id="cb132-133"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-133" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>),</span>
<span id="cb132-134"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-134" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;n_clusters == round(n_clusters) is not TRUE&quot;</span>,</span>
<span id="cb132-135"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-135" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb132-136"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-137"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-137" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#genClusteredData'>genClusteredData</a>(<span class="at">n=</span><span class="dv">5</span>, <span class="at">p=</span><span class="dv">19</span>, <span class="at">k_unclustered=</span><span class="dv">2</span>,</span>
<span id="cb132-138"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-138" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cluster_size=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">0</span>,</span>
<span id="cb132-139"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-139" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sig_clusters=</span><span class="dv">0</span>, <span class="at">rho=</span>.<span class="dv">8</span>,</span>
<span id="cb132-140"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-140" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">var=</span><span class="fl">1.1</span>, <span class="at">beta_latent=</span><span class="fl">1.5</span>,</span>
<span id="cb132-141"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-141" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">beta_unclustered=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">snr=</span><span class="dv">1</span>,</span>
<span id="cb132-142"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-142" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>),</span>
<span id="cb132-143"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-143" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;n_clusters &gt;= 1 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb132-144"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-145"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-145" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#genClusteredData'>genClusteredData</a>(<span class="at">n=</span><span class="dv">5</span>, <span class="at">p=</span><span class="dv">19</span>, <span class="at">k_unclustered=</span><span class="dv">2</span>,</span>
<span id="cb132-146"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-146" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cluster_size=</span>.<span class="dv">3</span>, <span class="at">n_clusters=</span><span class="dv">3</span>,</span>
<span id="cb132-147"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-147" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sig_clusters=</span><span class="dv">2</span>, <span class="at">rho=</span>.<span class="dv">8</span>,</span>
<span id="cb132-148"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-148" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">var=</span><span class="fl">1.1</span>, <span class="at">beta_latent=</span><span class="fl">1.5</span>,</span>
<span id="cb132-149"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-149" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">beta_unclustered=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">snr=</span><span class="dv">1</span>,</span>
<span id="cb132-150"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-150" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>),</span>
<span id="cb132-151"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-151" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;cluster_size &gt;= 1 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb132-152"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-153"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-153" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#genClusteredData'>genClusteredData</a>(<span class="at">p=</span><span class="dv">16</span>, <span class="at">k_unclustered=</span><span class="dv">2</span>,</span>
<span id="cb132-154"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-154" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cluster_size=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">3</span>,</span>
<span id="cb132-155"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-155" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sig_clusters=</span><span class="dv">2</span>, <span class="at">rho=</span>.<span class="dv">8</span>,</span>
<span id="cb132-156"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-156" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">var=</span><span class="fl">1.1</span>, <span class="at">beta_latent=</span><span class="fl">1.5</span>,</span>
<span id="cb132-157"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-157" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">beta_unclustered=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">snr=</span><span class="dv">1</span>,</span>
<span id="cb132-158"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-158" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>),</span>
<span id="cb132-159"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-159" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;p &gt;= n_clusters * cluster_size + k_unclustered is not TRUE&quot;</span>,</span>
<span id="cb132-160"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-160" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb132-161"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-162"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-162" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#genClusteredData'>genClusteredData</a>(<span class="at">n=</span><span class="dv">5</span>, <span class="at">p=</span><span class="dv">19</span>, <span class="at">k_unclustered=</span><span class="dv">2</span>,</span>
<span id="cb132-163"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-163" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cluster_size=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">3</span>,</span>
<span id="cb132-164"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-164" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sig_clusters=</span><span class="dv">2</span>, <span class="at">rho=</span><span class="dv">8</span>,</span>
<span id="cb132-165"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-165" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">var=</span><span class="fl">1.1</span>, <span class="at">beta_latent=</span><span class="fl">1.5</span>,</span>
<span id="cb132-166"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-166" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">beta_unclustered=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">snr=</span><span class="dv">1</span>,</span>
<span id="cb132-167"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-167" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>),</span>
<span id="cb132-168"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-168" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;abs(rho) &lt;= abs(var) is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb132-169"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-170"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-170" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#genClusteredData'>genClusteredData</a>(<span class="at">n=</span><span class="dv">5</span>, <span class="at">p=</span><span class="dv">19</span>, <span class="at">k_unclustered=</span><span class="dv">2</span>,</span>
<span id="cb132-171"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-171" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cluster_size=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">3</span>,</span>
<span id="cb132-172"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-172" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sig_clusters=</span><span class="dv">2</span>, <span class="at">rho=</span><span class="dv">0</span>,</span>
<span id="cb132-173"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-173" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">var=</span><span class="fl">1.1</span>, <span class="at">beta_latent=</span><span class="fl">1.5</span>,</span>
<span id="cb132-174"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-174" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">beta_unclustered=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">snr=</span><span class="dv">1</span>,</span>
<span id="cb132-175"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-175" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>),</span>
<span id="cb132-176"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-176" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;rho != 0 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb132-177"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-178"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-178" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#genClusteredData'>genClusteredData</a>(<span class="at">n=</span><span class="dv">5</span>, <span class="at">p=</span><span class="dv">19</span>, <span class="at">k_unclustered=</span><span class="dv">2</span>,</span>
<span id="cb132-179"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-179" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cluster_size=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">3</span>,</span>
<span id="cb132-180"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-180" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sig_clusters=</span><span class="dv">2</span>, <span class="at">rho=</span><span class="fl">0.8</span>,</span>
<span id="cb132-181"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-181" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">var=</span><span class="sc">-</span><span class="fl">1.1</span>, <span class="at">beta_latent=</span><span class="fl">1.5</span>,</span>
<span id="cb132-182"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-182" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">beta_unclustered=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">snr=</span><span class="dv">1</span>,</span>
<span id="cb132-183"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-183" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>),</span>
<span id="cb132-184"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-184" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;var &gt; 0 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb132-185"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-186"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-186" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#genClusteredData'>genClusteredData</a>(<span class="at">n=</span><span class="dv">5</span>, <span class="at">p=</span><span class="dv">19</span>, <span class="at">k_unclustered=</span><span class="dv">2</span>,</span>
<span id="cb132-187"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-187" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cluster_size=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">3</span>,</span>
<span id="cb132-188"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-188" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sig_clusters=</span><span class="dv">2</span>, <span class="at">rho=</span><span class="fl">0.8</span>,</span>
<span id="cb132-189"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-189" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">var=</span><span class="fl">1.1</span>, <span class="at">beta_latent=</span><span class="dv">0</span>,</span>
<span id="cb132-190"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-190" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">beta_unclustered=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">snr=</span><span class="dv">1</span>,</span>
<span id="cb132-191"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-191" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>),</span>
<span id="cb132-192"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-192" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;beta_latent != 0 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb132-193"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-194"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-194" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#genClusteredData'>genClusteredData</a>(<span class="at">n=</span><span class="dv">5</span>, <span class="at">p=</span><span class="dv">19</span>, <span class="at">k_unclustered=</span><span class="dv">2</span>,</span>
<span id="cb132-195"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-195" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cluster_size=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">3</span>,</span>
<span id="cb132-196"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-196" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sig_clusters=</span><span class="dv">2</span>, <span class="at">rho=</span><span class="fl">0.8</span>,</span>
<span id="cb132-197"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-197" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">var=</span><span class="fl">1.1</span>, <span class="at">beta_latent=</span><span class="fl">1.5</span>,</span>
<span id="cb132-198"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-198" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">beta_unclustered=</span><span class="dv">0</span>, <span class="at">snr=</span><span class="dv">1</span>,</span>
<span id="cb132-199"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-199" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>),</span>
<span id="cb132-200"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-200" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;beta_unclustered != 0 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb132-201"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-202"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-202" aria-hidden="true" tabindex="-1"></a>  <span class="co"># k_unclustered</span></span>
<span id="cb132-203"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-203" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#genClusteredData'>genClusteredData</a>(<span class="at">n=</span><span class="dv">5</span>, <span class="at">p=</span><span class="dv">19</span>, <span class="at">k_unclustered=</span><span class="st">&quot;2&quot;</span>,</span>
<span id="cb132-204"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-204" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cluster_size=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">3</span>,</span>
<span id="cb132-205"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-205" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sig_clusters=</span><span class="dv">2</span>, <span class="at">rho=</span><span class="fl">0.8</span>,</span>
<span id="cb132-206"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-206" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">var=</span><span class="fl">1.1</span>, <span class="at">beta_latent=</span><span class="fl">1.5</span>,</span>
<span id="cb132-207"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-207" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">beta_unclustered=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">snr=</span><span class="dv">1</span>,</span>
<span id="cb132-208"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-208" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>),</span>
<span id="cb132-209"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-209" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;is.numeric(k_unclustered) | is.integer(k_unclustered) is not TRUE&quot;</span>,</span>
<span id="cb132-210"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-210" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb132-211"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-212"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-212" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#genClusteredData'>genClusteredData</a>(<span class="at">n=</span><span class="dv">5</span>, <span class="at">p=</span><span class="dv">19</span>, <span class="at">k_unclustered=</span><span class="sc">-</span><span class="dv">2</span>,</span>
<span id="cb132-213"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-213" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cluster_size=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">3</span>,</span>
<span id="cb132-214"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-214" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sig_clusters=</span><span class="dv">2</span>, <span class="at">rho=</span><span class="fl">0.8</span>,</span>
<span id="cb132-215"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-215" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">var=</span><span class="fl">1.1</span>, <span class="at">beta_latent=</span><span class="fl">1.5</span>,</span>
<span id="cb132-216"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-216" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">beta_unclustered=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">snr=</span><span class="dv">1</span>,</span>
<span id="cb132-217"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-217" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>),</span>
<span id="cb132-218"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-218" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;k_unclustered &gt;= 0 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb132-219"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-220"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-220" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#genClusteredData'>genClusteredData</a>(<span class="at">n=</span><span class="dv">5</span>, <span class="at">p=</span><span class="dv">19</span>, <span class="at">k_unclustered=</span>.<span class="dv">2</span>,</span>
<span id="cb132-221"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-221" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cluster_size=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">3</span>,</span>
<span id="cb132-222"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-222" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sig_clusters=</span><span class="dv">2</span>, <span class="at">rho=</span><span class="fl">0.8</span>,</span>
<span id="cb132-223"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-223" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">var=</span><span class="fl">1.1</span>, <span class="at">beta_latent=</span><span class="fl">1.5</span>,</span>
<span id="cb132-224"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-224" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">beta_unclustered=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">snr=</span><span class="dv">1</span>,</span>
<span id="cb132-225"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-225" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>),</span>
<span id="cb132-226"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-226" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;k_unclustered == round(k_unclustered) is not TRUE&quot;</span>,</span>
<span id="cb132-227"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-227" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb132-228"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-229"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-229" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#genClusteredData'>genClusteredData</a>(<span class="at">n=</span><span class="dv">5</span>, <span class="at">p=</span><span class="dv">19</span>, <span class="at">k_unclustered=</span><span class="dv">2</span>,</span>
<span id="cb132-230"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-230" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cluster_size=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">3</span>,</span>
<span id="cb132-231"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-231" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sig_clusters=</span><span class="dv">2</span>, <span class="at">rho=</span><span class="fl">0.8</span>,</span>
<span id="cb132-232"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-232" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">var=</span><span class="fl">1.1</span>, <span class="at">beta_latent=</span><span class="fl">1.5</span>,</span>
<span id="cb132-233"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-233" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">beta_unclustered=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">snr=</span><span class="cn">NA</span>,</span>
<span id="cb132-234"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-234" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>),</span>
<span id="cb132-235"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-235" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;Must specify one of snr or sigma_eps_sq&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb132-236"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-237"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-237" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#genClusteredData'>genClusteredData</a>(<span class="at">n=</span><span class="dv">5</span>, <span class="at">p=</span><span class="dv">19</span>, <span class="at">k_unclustered=</span><span class="dv">2</span>,</span>
<span id="cb132-238"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-238" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cluster_size=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">3</span>,</span>
<span id="cb132-239"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-239" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sig_clusters=</span><span class="dv">2</span>, <span class="at">rho=</span><span class="fl">0.8</span>,</span>
<span id="cb132-240"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-240" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">var=</span><span class="fl">1.1</span>, <span class="at">beta_latent=</span><span class="fl">1.5</span>,</span>
<span id="cb132-241"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-241" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">beta_unclustered=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">snr=</span><span class="sc">-</span>.<span class="dv">2</span>,</span>
<span id="cb132-242"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-242" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sigma_eps_sq=</span><span class="cn">NA</span>),</span>
<span id="cb132-243"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-243" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;snr &gt; 0 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb132-244"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-245"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-245" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#genClusteredData'>genClusteredData</a>(<span class="at">n=</span><span class="dv">5</span>, <span class="at">p=</span><span class="dv">19</span>, <span class="at">k_unclustered=</span><span class="dv">2</span>,</span>
<span id="cb132-246"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-246" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">cluster_size=</span><span class="dv">5</span>, <span class="at">n_clusters=</span><span class="dv">3</span>,</span>
<span id="cb132-247"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-247" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sig_clusters=</span><span class="dv">2</span>, <span class="at">rho=</span><span class="fl">0.8</span>,</span>
<span id="cb132-248"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-248" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">var=</span><span class="fl">1.1</span>, <span class="at">beta_latent=</span><span class="fl">1.5</span>,</span>
<span id="cb132-249"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-249" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">beta_unclustered=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">snr=</span><span class="cn">NA</span>,</span>
<span id="cb132-250"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-250" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sigma_eps_sq=</span><span class="sc">-</span>.<span class="dv">3</span>),</span>
<span id="cb132-251"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-251" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;sigma_eps_sq &gt; 0 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb132-252"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-253"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb132-253" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## Test passed 😀</code></pre>
<p>getLassoLambda:</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Get lambda value for lasso</span></span>
<span id="cb134-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb134-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Chooses a lambda value for the lasso used on a subsample of size n/2 (as in</span></span>
<span id="cb134-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; cluster stability selection) by cross-validation.</span></span>
<span id="cb134-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param X An n x p numeric matrix (preferably) or a data.frame (which will</span></span>
<span id="cb134-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; be coerced internally to a matrix by the function model.matrix) containing</span></span>
<span id="cb134-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the p &gt;= 2 features/predictors that will be used by cluster stability</span></span>
<span id="cb134-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; selection.</span></span>
<span id="cb134-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param y The response; an n-dimensional numeric or integer vector. (Unlike</span></span>
<span id="cb134-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; in the more general css setup, this response must be real-valued since</span></span>
<span id="cb134-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; lambda will be determined using the lasso with cross-validation.)</span></span>
<span id="cb134-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param lambda_choice Character; either &quot;min&quot; or &quot;1se&quot;. If &quot;min&quot;, chooses</span></span>
<span id="cb134-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the lambda that minimizes the cross-validated error; if &quot;1se&quot;, chooses the</span></span>
<span id="cb134-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; largest lambda within one standard error of the minimum error lambda</span></span>
<span id="cb134-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; (resulting in a smaller selected set, which may be desirable because the</span></span>
<span id="cb134-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; model size corresponding to the minimum error lambda tends to be larger</span></span>
<span id="cb134-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; than optimal. See, for example, Bühlmann and Meinshausen 2006, Prop. 1 and</span></span>
<span id="cb134-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Bühlmann and van de Geer 2011, Section 2.5.1.). Default is &quot;1se&quot;.</span></span>
<span id="cb134-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param nfolds Numeric or integer; the number of folds for cross-validation.</span></span>
<span id="cb134-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Must be at least 4 (as specified by cv.glmnet). Default is 10.</span></span>
<span id="cb134-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return A numeric; the selected value of lambda.</span></span>
<span id="cb134-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @author Gregory Faletto, Jacob Bien</span></span>
<span id="cb134-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @references Bühlmann, P., &amp; Meinshausen, N. (2006). High-Dimensional Graphs</span></span>
<span id="cb134-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; and Variable Selection With the Lasso. \emph{The Annals of Statistics},</span></span>
<span id="cb134-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; 34(3), 1436–1462. \url{https://doi.org/10.1214/009053606000000281}.</span></span>
<span id="cb134-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; \cr Peter Bühlmann and Sara van de Geer. Statistics for High-Dimensional</span></span>
<span id="cb134-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Data. \emph{Springer Series in Statistics}. Springer, Heidelberg, 2011. ISBN</span></span>
<span id="cb134-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; 978-3-642-20191-2. \url{http://dx.doi.org/10.1007/978-3-642-20192-9}. \cr</span></span>
<span id="cb134-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Jerome Friedman, Trevor Hastie, Robert Tibshirani (2010). Regularization</span></span>
<span id="cb134-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Paths for Generalized Linear Models via Coordinate Descent. \emph{Journal of</span></span>
<span id="cb134-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Statistical Software}, 33(1), 1-22. URL \url{https://www.jstatsoft.org/v33/i01/}.</span></span>
<span id="cb134-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @export</span></span>
<span id="cb134-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-33" aria-hidden="true" tabindex="-1"></a><span id='getLassoLambda'>getLassoLambda</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(X, y, <span class="at">lambda_choice=</span><span class="st">&quot;1se&quot;</span>, <span class="at">nfolds=</span><span class="dv">10</span>){</span>
<span id="cb134-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.character</span>(lambda_choice))</span>
<span id="cb134-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(lambda_choice) <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb134-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="sc">!</span><span class="fu">is.na</span>(lambda_choice))</span>
<span id="cb134-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(lambda_choice <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;min&quot;</span>, <span class="st">&quot;1se&quot;</span>))</span>
<span id="cb134-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.matrix</span>(X))</span>
<span id="cb134-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.numeric</span>(X) <span class="sc">|</span> <span class="fu">is.integer</span>(X))</span>
<span id="cb134-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-41" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(X)</span>
<span id="cb134-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.numeric</span>(nfolds) <span class="sc">|</span> <span class="fu">is.integer</span>(nfolds))</span>
<span id="cb134-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(nfolds) <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb134-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(nfolds <span class="sc">==</span> <span class="fu">round</span>(nfolds))</span>
<span id="cb134-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(nfolds <span class="sc">&gt;</span> <span class="dv">3</span>)</span>
<span id="cb134-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-48"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-48" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Since we are using the lasso, we require y to be a real-valued response</span></span>
<span id="cb134-49"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># (unlike for the general cluster stability selection procedure, where y</span></span>
<span id="cb134-50"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-50" aria-hidden="true" tabindex="-1"></a>    <span class="co"># can have a more general format as long as a suitable feature selection</span></span>
<span id="cb134-51"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-51" aria-hidden="true" tabindex="-1"></a>    <span class="co"># function is provided by the user)</span></span>
<span id="cb134-52"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.numeric</span>(y) <span class="sc">|</span> <span class="fu">is.integer</span>(y))</span>
<span id="cb134-53"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(n <span class="sc">==</span> <span class="fu">length</span>(y))</span>
<span id="cb134-54"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-55"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-55" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sample size to use: inflate n/2 by a factor of nfolds/(nfolds - 1),</span></span>
<span id="cb134-56"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-56" aria-hidden="true" tabindex="-1"></a>    <span class="co"># so that each individual lasso fit is of size floor(n/2)</span></span>
<span id="cb134-57"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-58"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-58" aria-hidden="true" tabindex="-1"></a>    n_sample <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">round</span>(n<span class="sc">/</span><span class="dv">2</span><span class="sc">*</span>nfolds<span class="sc">/</span>(nfolds <span class="sc">-</span> <span class="dv">1</span>)), n)</span>
<span id="cb134-59"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-59" aria-hidden="true" tabindex="-1"></a>    nfolds <span class="ot">&lt;-</span> <span class="fu">min</span>(nfolds, n_sample)</span>
<span id="cb134-60"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-61"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-61" aria-hidden="true" tabindex="-1"></a>    inds_size <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, n_sample)</span>
<span id="cb134-62"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-62" aria-hidden="true" tabindex="-1"></a>    size_results <span class="ot">&lt;-</span> glmnet<span class="sc">::</span><span class="fu">cv.glmnet</span>(<span class="at">x=</span>X[inds_size, ], <span class="at">y=</span>y[inds_size],</span>
<span id="cb134-63"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">family=</span><span class="st">&quot;gaussian&quot;</span>, <span class="at">nfolds=</span>nfolds)</span>
<span id="cb134-64"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-65"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-65" aria-hidden="true" tabindex="-1"></a>    lambda_ret <span class="ot">&lt;-</span> size_results[[<span class="fu">paste</span>(<span class="st">&quot;lambda.&quot;</span>, lambda_choice, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)]]</span>
<span id="cb134-66"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-67"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-67" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check output</span></span>
<span id="cb134-68"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(lambda_ret) <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb134-69"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-69" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.numeric</span>(lambda_ret) <span class="sc">|</span> <span class="fu">is.integer</span>(lambda_ret))</span>
<span id="cb134-70"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(lambda_ret <span class="sc">&gt;=</span> <span class="dv">0</span>)</span>
<span id="cb134-71"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-72"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(lambda_ret)</span>
<span id="cb134-73"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb134-73" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Tests for getLassoLambda:</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-1" aria-hidden="true" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">test_that</span>(<span class="st">&quot;getLassoLambda works&quot;</span>, {</span>
<span id="cb135-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">7252</span>)</span>
<span id="cb135-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb135-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-4" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">10</span><span class="sc">*</span><span class="dv">6</span>), <span class="at">nrow=</span><span class="dv">10</span>, <span class="at">ncol=</span><span class="dv">6</span>)</span>
<span id="cb135-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-5" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">10</span>)</span>
<span id="cb135-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-7" aria-hidden="true" tabindex="-1"></a>  ret <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getLassoLambda'>getLassoLambda</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">lambda_choice=</span><span class="st">&quot;1se&quot;</span>, <span class="at">nfolds=</span><span class="dv">4</span>)</span>
<span id="cb135-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb135-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-9" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(ret) <span class="sc">|</span> <span class="fu">is.integer</span>(ret))</span>
<span id="cb135-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-10" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="sc">!</span><span class="fu">is.na</span>(ret))</span>
<span id="cb135-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-11" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(ret), <span class="dv">1</span>)</span>
<span id="cb135-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-12" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(ret <span class="sc">&gt;=</span> <span class="dv">0</span>)</span>
<span id="cb135-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb135-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-14" aria-hidden="true" tabindex="-1"></a>  ret <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getLassoLambda'>getLassoLambda</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">lambda_choice=</span><span class="st">&quot;min&quot;</span>, <span class="at">nfolds=</span><span class="dv">5</span>)</span>
<span id="cb135-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb135-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-16" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(ret) <span class="sc">|</span> <span class="fu">is.integer</span>(ret))</span>
<span id="cb135-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-17" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="sc">!</span><span class="fu">is.na</span>(ret))</span>
<span id="cb135-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-18" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(ret), <span class="dv">1</span>)</span>
<span id="cb135-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-19" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(ret <span class="sc">&gt;=</span> <span class="dv">0</span>)</span>
<span id="cb135-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb135-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Bad inputs</span></span>
<span id="cb135-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-22" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getLassoLambda'>getLassoLambda</a>(<span class="at">X=</span><span class="st">&quot;x&quot;</span>, <span class="at">y=</span>y), <span class="st">&quot;is.matrix(X) is not TRUE&quot;</span>,</span>
<span id="cb135-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-23" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb135-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb135-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-25" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getLassoLambda'>getLassoLambda</a>(<span class="at">X=</span>x[<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>, ], <span class="at">y=</span>y),</span>
<span id="cb135-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-26" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;n == length(y) is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb135-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb135-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-28" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getLassoLambda'>getLassoLambda</a>(<span class="at">X=</span>x, <span class="at">y=</span><span class="cn">TRUE</span>),</span>
<span id="cb135-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-29" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;is.numeric(y) | is.integer(y) is not TRUE&quot;</span>,</span>
<span id="cb135-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-30" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb135-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Error has quotation marks in it</span></span>
<span id="cb135-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-33" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getLassoLambda'>getLassoLambda</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">lambda_choice=</span><span class="st">&quot;mni&quot;</span>))</span>
<span id="cb135-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-35" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getLassoLambda'>getLassoLambda</a>(<span class="at">X=</span>x, <span class="at">y=</span>y,</span>
<span id="cb135-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-36" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">lambda_choice=</span><span class="fu">c</span>(<span class="st">&quot;min&quot;</span>, <span class="st">&quot;1se&quot;</span>)),</span>
<span id="cb135-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-37" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;length(lambda_choice) == 1 is not TRUE&quot;</span>,</span>
<span id="cb135-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-38" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb135-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-40" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getLassoLambda'>getLassoLambda</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">lambda_choice=</span><span class="dv">1</span>),</span>
<span id="cb135-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-41" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;is.character(lambda_choice) is not TRUE&quot;</span>,</span>
<span id="cb135-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-42" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb135-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb135-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-44" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getLassoLambda'>getLassoLambda</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">nfolds=</span><span class="st">&quot;5&quot;</span>),</span>
<span id="cb135-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-45" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;is.numeric(nfolds) | is.integer(nfolds) is not TRUE&quot;</span>,</span>
<span id="cb135-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-46" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb135-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb135-48"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-48" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getLassoLambda'>getLassoLambda</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">nfolds=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>),</span>
<span id="cb135-49"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-49" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;length(nfolds) == 1 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb135-50"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb135-51"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-51" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getLassoLambda'>getLassoLambda</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">nfolds=</span><span class="fl">3.2</span>),</span>
<span id="cb135-52"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-52" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;nfolds == round(nfolds) is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb135-53"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb135-54"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-54" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getLassoLambda'>getLassoLambda</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">nfolds=</span><span class="dv">3</span>),</span>
<span id="cb135-55"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-55" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;nfolds &gt; 3 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb135-56"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-57"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb135-57" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## ── Warning (&#39;&lt;text&gt;:7&#39;): getLassoLambda works ──────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getLassoLambda'>getLassoLambda</a>(X = x, y = y, lambda_choice = &quot;1se&quot;, nfolds = 4)
##  2. glmnet::cv.glmnet(...)
##  3. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:14&#39;): getLassoLambda works ─────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getLassoLambda'>getLassoLambda</a>(X = x, y = y, lambda_choice = &quot;min&quot;, nfolds = 5)
##  2. glmnet::cv.glmnet(...)
##  3. glmnet:::cv.glmnet.raw(...)</code></pre>
<p>getModelSize:</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Automated estimation of model size</span></span>
<span id="cb137-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb137-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; This function is uses the lasso with cross-validation to estimate the</span></span>
<span id="cb137-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; model size. Before using the lasso, in each cluster all features will be</span></span>
<span id="cb137-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; dropped from X except the one feature with the highest marginal correlation</span></span>
<span id="cb137-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; with y, as in the protolasso (Reid and Tibshirani 2016).</span></span>
<span id="cb137-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; </span></span>
<span id="cb137-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param X An n x p numeric matrix (preferably) or a data.frame (which will</span></span>
<span id="cb137-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; be coerced internally to a matrix by the function model.matrix) containing</span></span>
<span id="cb137-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the p &gt;= 2 features/predictors.</span></span>
<span id="cb137-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param y A length-n numeric vector containing the responses; `y[i]` is the</span></span>
<span id="cb137-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; response corresponding to observation `X[i, ]`. (Note that for the css</span></span>
<span id="cb137-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; function, y does not have to be a numeric response, but for this function,</span></span>
<span id="cb137-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the underlying selection procedure is the lasso, so y must be a real-valued</span></span>
<span id="cb137-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; response.)</span></span>
<span id="cb137-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param clusters A named list where each entry is an integer vector of indices</span></span>
<span id="cb137-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; of features that are in a common cluster, as in the output of css.</span></span>
<span id="cb137-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; (The length of list clusters is equal to the number of clusters.) All</span></span>
<span id="cb137-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; identified clusters must be non-overlapping, and all features must appear in</span></span>
<span id="cb137-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; exactly one cluster (any unclustered features should be in their own</span></span>
<span id="cb137-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; &quot;cluster&quot; of size 1).</span></span>
<span id="cb137-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return An integer; the estimated size of the model. The minimum returned</span></span>
<span id="cb137-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; value is 1, even if the lasso with cross-validation chose no features.</span></span>
<span id="cb137-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @author Gregory Faletto, Jacob Bien</span></span>
<span id="cb137-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @references Reid, S., &amp; Tibshirani, R. (2016). Sparse regression and marginal</span></span>
<span id="cb137-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; testing using cluster prototypes. \emph{Biostatistics}, 17(2), 364–376.</span></span>
<span id="cb137-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; \url{https://doi.org/10.1093/biostatistics/kxv049}.</span></span>
<span id="cb137-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @export</span></span>
<span id="cb137-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-29" aria-hidden="true" tabindex="-1"></a><span id='getModelSize'>getModelSize</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(X, y, clusters){</span>
<span id="cb137-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.matrix</span>(X) <span class="sc">|</span> <span class="fu">is.data.frame</span>(X))</span>
<span id="cb137-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if x is a matrix; if it&#39;s a data.frame, convert to matrix.</span></span>
<span id="cb137-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">is.data.frame</span>(X)){</span>
<span id="cb137-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-34" aria-hidden="true" tabindex="-1"></a>        X <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">model.matrix</span>(<span class="sc">~</span> ., X)</span>
<span id="cb137-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-35" aria-hidden="true" tabindex="-1"></a>        X <span class="ot">&lt;-</span> X[, <span class="fu">colnames</span>(X) <span class="sc">!=</span> <span class="st">&quot;(Intercept)&quot;</span>]</span>
<span id="cb137-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-36" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb137-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.matrix</span>(X))</span>
<span id="cb137-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(X)))</span>
<span id="cb137-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.numeric</span>(X) <span class="sc">|</span> <span class="fu">is.integer</span>(X))</span>
<span id="cb137-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-41" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(X)</span>
<span id="cb137-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-43" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Since the model size will be determined by cross-validation, the provided</span></span>
<span id="cb137-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-44" aria-hidden="true" tabindex="-1"></a>    <span class="co"># y must be real-valued (this should be checked internally in other</span></span>
<span id="cb137-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># functions before getModelSize is called, but this check is here just in</span></span>
<span id="cb137-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># case).</span></span>
<span id="cb137-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.numeric</span>(y) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.integer</span>(y)){</span>
<span id="cb137-48"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-48" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stop</span>(<span class="st">&quot;getModelSize is trying to determine max_num_clusts using the lasso with cross-validation, but the y provided to getModelSize was not real-valued.&quot;</span>)</span>
<span id="cb137-49"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-49" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb137-50"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(y) <span class="sc">==</span> n)</span>
<span id="cb137-51"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-52"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-52" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check clusters argument</span></span>
<span id="cb137-53"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-53" aria-hidden="true" tabindex="-1"></a>    clusters <span class="ot">&lt;-</span> <a href='helper-functions.html#checkCssClustersInput'>checkCssClustersInput</a>(clusters)</span>
<span id="cb137-54"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-55"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-55" aria-hidden="true" tabindex="-1"></a>    <span class="do">### Format clusters into a list where all features are in exactly one</span></span>
<span id="cb137-56"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-56" aria-hidden="true" tabindex="-1"></a>    <span class="co"># cluster (any unclustered features are put in their own &quot;cluster&quot; of size</span></span>
<span id="cb137-57"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-57" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 1).</span></span>
<span id="cb137-58"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-58" aria-hidden="true" tabindex="-1"></a>    clust_names <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="cn">NA</span>)</span>
<span id="cb137-59"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(<span class="fu">names</span>(clusters)) <span class="sc">&amp;</span> <span class="fu">is.list</span>(clusters)){</span>
<span id="cb137-60"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-60" aria-hidden="true" tabindex="-1"></a>        clust_names <span class="ot">&lt;-</span> <span class="fu">names</span>(clusters)</span>
<span id="cb137-61"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-61" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb137-62"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-63"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-63" aria-hidden="true" tabindex="-1"></a>    clusters <span class="ot">&lt;-</span> <a href='helper-functions.html#formatClusters'>formatClusters</a>(clusters, <span class="at">p=</span><span class="fu">ncol</span>(X),</span>
<span id="cb137-64"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">clust_names=</span>clust_names)<span class="sc">$</span>clusters</span>
<span id="cb137-65"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-66"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-66" aria-hidden="true" tabindex="-1"></a>    X_size <span class="ot">&lt;-</span> X</span>
<span id="cb137-67"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-68"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-68" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">length</span>(clusters) <span class="sc">&gt;</span> <span class="dv">0</span>){</span>
<span id="cb137-69"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-69" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Create modified design matrix by dropping all but one feature from</span></span>
<span id="cb137-70"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-70" aria-hidden="true" tabindex="-1"></a>        <span class="co"># each cluster</span></span>
<span id="cb137-71"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-71" aria-hidden="true" tabindex="-1"></a>        feats_to_drop <span class="ot">&lt;-</span> <span class="fu">integer</span>()</span>
<span id="cb137-72"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-72" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(clusters)){</span>
<span id="cb137-73"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-73" aria-hidden="true" tabindex="-1"></a>            cluster_i <span class="ot">&lt;-</span> clusters[[i]]</span>
<span id="cb137-74"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-74" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span>(<span class="fu">length</span>(cluster_i) <span class="sc">&gt;</span> <span class="dv">1</span>){</span>
<span id="cb137-75"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-75" aria-hidden="true" tabindex="-1"></a>                feat_to_keep <span class="ot">&lt;-</span> <a href='helper-functions.html#identifyPrototype'>identifyPrototype</a>(cluster_i, X, y)</span>
<span id="cb137-76"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-76" aria-hidden="true" tabindex="-1"></a>                feats_to_drop <span class="ot">&lt;-</span> <span class="fu">c</span>(feats_to_drop, <span class="fu">setdiff</span>(cluster_i,</span>
<span id="cb137-77"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-77" aria-hidden="true" tabindex="-1"></a>                    feat_to_keep))</span>
<span id="cb137-78"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-78" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb137-79"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-79" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb137-80"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-80" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="fu">length</span>(feats_to_drop) <span class="sc">&gt;</span> <span class="dv">0</span>){</span>
<span id="cb137-81"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-81" aria-hidden="true" tabindex="-1"></a>            X_size <span class="ot">&lt;-</span> X_size[, <span class="sc">-</span><span class="dv">1</span><span class="sc">*</span>feats_to_drop]</span>
<span id="cb137-82"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-82" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb137-83"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-83" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb137-84"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-85"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-85" aria-hidden="true" tabindex="-1"></a>    size_results <span class="ot">&lt;-</span> glmnet<span class="sc">::</span><span class="fu">cv.glmnet</span>(<span class="at">x=</span>X_size, <span class="at">y=</span>y, <span class="at">family=</span><span class="st">&quot;gaussian&quot;</span>)</span>
<span id="cb137-86"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-86" aria-hidden="true" tabindex="-1"></a>    coefs <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(glmnet<span class="sc">::</span><span class="fu">coef.glmnet</span>(size_results, <span class="at">s=</span><span class="st">&quot;lambda.1se&quot;</span>))</span>
<span id="cb137-87"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-88"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-88" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Number of nonzero coefficients (subtract one in order to ignore intercept)</span></span>
<span id="cb137-89"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-89" aria-hidden="true" tabindex="-1"></a>    size <span class="ot">&lt;-</span> <span class="fu">length</span>(coefs[coefs <span class="sc">!=</span> <span class="dv">0</span>]) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb137-90"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-91"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-91" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check output</span></span>
<span id="cb137-92"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-92" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.numeric</span>(size) <span class="sc">|</span> <span class="fu">is.integer</span>(size))</span>
<span id="cb137-93"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-93" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="sc">!</span><span class="fu">is.na</span>(size))</span>
<span id="cb137-94"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-94" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(size) <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb137-95"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-95" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(size <span class="sc">==</span> <span class="fu">round</span>(size))</span>
<span id="cb137-96"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-97"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-97" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">as.integer</span>(<span class="fu">max</span>(size, <span class="dv">1</span>)))</span>
<span id="cb137-98"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb137-98" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Tests for getModelSize:</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-1" aria-hidden="true" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">test_that</span>(<span class="st">&quot;getModelSize works&quot;</span>, {</span>
<span id="cb138-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">1723</span>)</span>
<span id="cb138-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb138-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-4" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#genClusteredData'>genClusteredData</a>(<span class="at">n=</span><span class="dv">15</span>, <span class="at">p=</span><span class="dv">11</span>, <span class="at">k_unclustered=</span><span class="dv">1</span>, <span class="at">cluster_size=</span><span class="dv">3</span>,</span>
<span id="cb138-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">n_clusters=</span><span class="dv">2</span>, <span class="at">sigma_eps_sq=</span><span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">6</span>))</span>
<span id="cb138-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb138-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-7" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> data<span class="sc">$</span>X</span>
<span id="cb138-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-8" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> data<span class="sc">$</span>y</span>
<span id="cb138-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb138-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-10" aria-hidden="true" tabindex="-1"></a>  good_clusters <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">red_cluster=</span>1L<span class="sc">:</span>3L, <span class="at">green_cluster=</span>4L<span class="sc">:</span>6L)</span>
<span id="cb138-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb138-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-12" aria-hidden="true" tabindex="-1"></a>  ret <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getModelSize'>getModelSize</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">clusters=</span>good_clusters)</span>
<span id="cb138-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb138-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-14" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(ret) <span class="sc">|</span> <span class="fu">is.integer</span>(ret))</span>
<span id="cb138-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-15" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="sc">!</span><span class="fu">is.na</span>(ret))</span>
<span id="cb138-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-16" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(ret), <span class="dv">1</span>)</span>
<span id="cb138-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-17" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(ret, <span class="fu">round</span>(ret))</span>
<span id="cb138-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-18" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(ret <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb138-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 11 features, but two clusters of size 3, so maximum size should</span></span>
<span id="cb138-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># be 11 - 2 - 2 = 7</span></span>
<span id="cb138-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-21" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(ret <span class="sc">&lt;=</span> <span class="dv">7</span>)</span>
<span id="cb138-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb138-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-23" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Trying other inputs</span></span>
<span id="cb138-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-25" aria-hidden="true" tabindex="-1"></a>  unnamed_clusters <span class="ot">&lt;-</span> <span class="fu">list</span>(1L<span class="sc">:</span>3L, 5L<span class="sc">:</span>8L)</span>
<span id="cb138-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb138-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-27" aria-hidden="true" tabindex="-1"></a>  ret <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getModelSize'>getModelSize</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">clusters=</span>unnamed_clusters)</span>
<span id="cb138-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb138-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-29" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(ret) <span class="sc">|</span> <span class="fu">is.integer</span>(ret))</span>
<span id="cb138-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-30" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="sc">!</span><span class="fu">is.na</span>(ret))</span>
<span id="cb138-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-31" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(ret), <span class="dv">1</span>)</span>
<span id="cb138-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-32" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(ret, <span class="fu">round</span>(ret))</span>
<span id="cb138-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-33" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(ret <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb138-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 11 features, but 3 in one cluster and 4 in another, so maximum size should</span></span>
<span id="cb138-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># be 11 - 2 - 3 = 6</span></span>
<span id="cb138-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-36" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(ret <span class="sc">&lt;=</span> <span class="dv">6</span>)</span>
<span id="cb138-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb138-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Single cluster</span></span>
<span id="cb138-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-39" aria-hidden="true" tabindex="-1"></a>  ret <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getModelSize'>getModelSize</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">clusters=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb138-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb138-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-41" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(ret) <span class="sc">|</span> <span class="fu">is.integer</span>(ret))</span>
<span id="cb138-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-42" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="sc">!</span><span class="fu">is.na</span>(ret))</span>
<span id="cb138-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-43" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(ret), <span class="dv">1</span>)</span>
<span id="cb138-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-44" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(ret, <span class="fu">round</span>(ret))</span>
<span id="cb138-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-45" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(ret <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb138-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 11 features, but 4 in one cluster, so maximum size should be 11 - 3 = 8</span></span>
<span id="cb138-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-47" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(ret <span class="sc">&lt;=</span> <span class="dv">8</span>)</span>
<span id="cb138-48"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb138-49"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb138-50"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Intentionally don&#39;t provide clusters for all feature, mix up formatting,</span></span>
<span id="cb138-51"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-51" aria-hidden="true" tabindex="-1"></a>  <span class="co"># etc.</span></span>
<span id="cb138-52"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-52" aria-hidden="true" tabindex="-1"></a>  good_clusters <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">red_cluster=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>)</span>
<span id="cb138-53"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb138-54"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-54" aria-hidden="true" tabindex="-1"></a>  ret <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getModelSize'>getModelSize</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">clusters=</span>good_clusters)</span>
<span id="cb138-55"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb138-56"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-56" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(ret) <span class="sc">|</span> <span class="fu">is.integer</span>(ret))</span>
<span id="cb138-57"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-57" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="sc">!</span><span class="fu">is.na</span>(ret))</span>
<span id="cb138-58"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-58" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(ret), <span class="dv">1</span>)</span>
<span id="cb138-59"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-59" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(ret, <span class="fu">round</span>(ret))</span>
<span id="cb138-60"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-60" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(ret <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb138-61"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 11 features, but 3 in one cluster and 4 in another, so maximum size should</span></span>
<span id="cb138-62"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-62" aria-hidden="true" tabindex="-1"></a>  <span class="co"># be 11 - 2 - 3 = 6</span></span>
<span id="cb138-63"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-63" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(ret <span class="sc">&lt;=</span> <span class="dv">6</span>)</span>
<span id="cb138-64"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-64" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb138-65"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-65" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Trying bad inputs</span></span>
<span id="cb138-66"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-66" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb138-67"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-67" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getModelSize'>getModelSize</a>(<span class="at">X=</span><span class="st">&quot;x&quot;</span>, <span class="at">y=</span>y, <span class="at">clusters=</span>good_clusters),</span>
<span id="cb138-68"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-68" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;is.matrix(X) | is.data.frame(X) is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb138-69"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-69" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb138-70"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-70" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getModelSize'>getModelSize</a>(<span class="at">X=</span>x[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, ], <span class="at">y=</span>y, <span class="at">clusters=</span>good_clusters),</span>
<span id="cb138-71"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-71" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;length(y) == n is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb138-72"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-73"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-73" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getModelSize'>getModelSize</a>(<span class="at">X=</span>x, <span class="at">y=</span><span class="cn">FALSE</span>, <span class="at">clusters=</span>good_clusters),</span>
<span id="cb138-74"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-74" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;getModelSize is trying to determine max_num_clusts using the lasso with cross-validation, but the y provided to getModelSize was not real-valued.&quot;</span>,</span>
<span id="cb138-75"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-75" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb138-76"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-77"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-77" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getModelSize'>getModelSize</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">clusters=</span><span class="fu">list</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">7</span>, <span class="dv">7</span><span class="sc">:</span><span class="dv">10</span>)),</span>
<span id="cb138-78"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-78" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;Overlapping clusters detected; clusters must be non-overlapping. Overlapping clusters: 1, 2.&quot;</span>,</span>
<span id="cb138-79"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-79" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb138-80"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-80" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb138-81"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-81" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getModelSize'>getModelSize</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">clusters=</span><span class="fu">list</span>(<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>, <span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>)),</span>
<span id="cb138-82"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-82" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;length(clusters) == length(unique(clusters)) is not TRUE&quot;</span>,</span>
<span id="cb138-83"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-83" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb138-84"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-85"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-85" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getModelSize'>getModelSize</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">clusters=</span><span class="dv">6</span><span class="sc">:</span><span class="dv">50</span>),</span>
<span id="cb138-86"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-86" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;length(all_clustered_feats) == p is not TRUE&quot;</span>,</span>
<span id="cb138-87"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-87" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb138-88"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-89"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-89" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getModelSize'>getModelSize</a>(<span class="at">X=</span>x, <span class="at">y=</span>y,</span>
<span id="cb138-90"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-90" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">clusters=</span><span class="fu">list</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>, <span class="fu">as.integer</span>(<span class="cn">NA</span>))),</span>
<span id="cb138-91"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-91" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;!is.na(clusters) are not all TRUE&quot;</span>,</span>
<span id="cb138-92"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-92" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb138-93"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-94"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-94" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getModelSize'>getModelSize</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">clusters=</span><span class="fu">list</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>, <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">5</span>))),</span>
<span id="cb138-95"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-95" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;length(clusters[[i]]) == length(unique(clusters[[i]])) is not TRUE&quot;</span>,</span>
<span id="cb138-96"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-96" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb138-97"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-98"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-98" aria-hidden="true" tabindex="-1"></a>   testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getModelSize'>getModelSize</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">clusters=</span><span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">1</span>)),</span>
<span id="cb138-99"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-99" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;all(clusters[[i]] &gt;= 1) is not TRUE&quot;</span>,</span>
<span id="cb138-100"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-100" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb138-101"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-102"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-102" aria-hidden="true" tabindex="-1"></a>   testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getModelSize'>getModelSize</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">clusters=</span><span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb138-103"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-103" aria-hidden="true" tabindex="-1"></a>                                                               <span class="fu">c</span>(<span class="fl">2.3</span>, <span class="fl">1.2</span>))),</span>
<span id="cb138-104"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-104" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;all(clusters[[i]] == round(clusters[[i]])) is not TRUE&quot;</span>,</span>
<span id="cb138-105"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-105" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb138-106"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-107"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb138-107" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## ── Warning (&#39;&lt;text&gt;:12&#39;): getModelSize works ───────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getModelSize'>getModelSize</a>(X = x, y = y, clusters = good_clusters)
##  2. glmnet::cv.glmnet(x = X_size, y = y, family = &quot;gaussian&quot;)
##  3. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:27&#39;): getModelSize works ───────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getModelSize'>getModelSize</a>(X = x, y = y, clusters = unnamed_clusters)
##  2. glmnet::cv.glmnet(x = X_size, y = y, family = &quot;gaussian&quot;)
##  3. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:39&#39;): getModelSize works ───────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getModelSize'>getModelSize</a>(X = x, y = y, clusters = 2:5)
##  2. glmnet::cv.glmnet(x = X_size, y = y, family = &quot;gaussian&quot;)
##  3. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:54&#39;): getModelSize works ───────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getModelSize'>getModelSize</a>(X = x, y = y, clusters = good_clusters)
##  2. glmnet::cv.glmnet(x = X_size, y = y, family = &quot;gaussian&quot;)
##  3. glmnet:::cv.glmnet.raw(...)</code></pre>
<p>printCssDf:</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Prepares a data.frame summarazing cluster stability selection output to print</span></span>
<span id="cb140-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb140-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Print a summary of the information from the css function.</span></span>
<span id="cb140-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param css_results An object of class &quot;cssr&quot; (the output of the function</span></span>
<span id="cb140-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; css).</span></span>
<span id="cb140-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param cutoff Numeric; the outputted data.frame will display only those</span></span>
<span id="cb140-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; clusters with selection proportions equal to at least cutoff. Must be between</span></span>
<span id="cb140-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; 0 and 1. Default is 0 (in which case either all clusters are displayed, or</span></span>
<span id="cb140-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; max_num_clusts are, if max_num_clusts is specified).</span></span>
<span id="cb140-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param min_num_clusts Integer or numeric; the minimum number of clusters to</span></span>
<span id="cb140-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; use regardless of cutoff. (That is, if the chosen cutoff returns fewer than</span></span>
<span id="cb140-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; min_num_clusts clusters, the cutoff will be increased until at least</span></span>
<span id="cb140-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; min_num_clusts clusters are selected.) Default is 1.</span></span>
<span id="cb140-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param max_num_clusts Integer or numeric; the maximum number of clusters to</span></span>
<span id="cb140-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; use regardless of cutoff. (That is, if the chosen cutoff returns more than</span></span>
<span id="cb140-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; max_num_clusts clusters, the cutoff will be decreased until at most</span></span>
<span id="cb140-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; max_num_clusts clusters are selected.) Default is NA (in which case</span></span>
<span id="cb140-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; max_num_clusts is ignored).</span></span>
<span id="cb140-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return A data.frame; each row contains a cluster, arranged in decreasing</span></span>
<span id="cb140-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; order of cluster selection proportion from top to bottom. The columns are</span></span>
<span id="cb140-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; ClustName (the name of the cluster that was either provided to css or made by</span></span>
<span id="cb140-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; css if no name was provided); ClustProtoName (the name of the selection</span></span>
<span id="cb140-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; prototype from the cluster, which is the feature with the greatest individual</span></span>
<span id="cb140-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; selection proportion among all the cluster members, with ties broken by</span></span>
<span id="cb140-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; choosing the feature with the highest correlation with the response if the</span></span>
<span id="cb140-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; response is real-valued; only returned if the features are named),</span></span>
<span id="cb140-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; ClustProtoNum (the column number of the prototype in the X matrix provided to</span></span>
<span id="cb140-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; css), and ClustSize (the size of the cluster).</span></span>
<span id="cb140-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @author Gregory Faletto, Jacob Bien</span></span>
<span id="cb140-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @export</span></span>
<span id="cb140-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-31" aria-hidden="true" tabindex="-1"></a><span id='printCssDf'>printCssDf</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(css_results, <span class="at">cutoff=</span><span class="dv">0</span>, <span class="at">min_num_clusts=</span><span class="dv">1</span>,</span>
<span id="cb140-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_num_clusts=</span><span class="cn">NA</span>){</span>
<span id="cb140-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check inputs</span></span>
<span id="cb140-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">class</span>(css_results) <span class="sc">==</span> <span class="st">&quot;cssr&quot;</span>)</span>
<span id="cb140-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-35" aria-hidden="true" tabindex="-1"></a>    <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkCutoff'>checkCutoff</a>(cutoff)</span>
<span id="cb140-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-37" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ncol</span>(css_results<span class="sc">$</span>feat_sel_mat)</span>
<span id="cb140-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-39" aria-hidden="true" tabindex="-1"></a>    <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkMinNumClusts'>checkMinNumClusts</a>(min_num_clusts, p, <span class="fu">length</span>(css_results<span class="sc">$</span>clusters))</span>
<span id="cb140-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-41" aria-hidden="true" tabindex="-1"></a>    max_num_clusts <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkMaxNumClusts'>checkMaxNumClusts</a>(max_num_clusts, min_num_clusts, p,</span>
<span id="cb140-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-42" aria-hidden="true" tabindex="-1"></a>        <span class="fu">length</span>(css_results<span class="sc">$</span>clusters))</span>
<span id="cb140-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-44" aria-hidden="true" tabindex="-1"></a>    sel_clusts <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssSelections'>getCssSelections</a>(css_results, <span class="at">cutoff=</span>cutoff,</span>
<span id="cb140-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">min_num_clusts=</span>min_num_clusts,</span>
<span id="cb140-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">max_num_clusts=</span>max_num_clusts)<span class="sc">$</span>selected_clusts</span>
<span id="cb140-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-48"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-48" aria-hidden="true" tabindex="-1"></a>    <span class="co"># sel_clusts is guaranteed to have length at least 1 by</span></span>
<span id="cb140-49"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># getCssSelections </span></span>
<span id="cb140-50"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-51"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-51" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get prototypes (feature from each cluster with highest selection</span></span>
<span id="cb140-52"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-52" aria-hidden="true" tabindex="-1"></a>    <span class="co"># proportion, breaking ties by using marginal correlations of features with</span></span>
<span id="cb140-53"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-53" aria-hidden="true" tabindex="-1"></a>    <span class="co"># y from data provided to css if y is real-valued)</span></span>
<span id="cb140-54"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-54" aria-hidden="true" tabindex="-1"></a>    prototypes <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getSelectionPrototypes'>getSelectionPrototypes</a>(css_results, sel_clusts)</span>
<span id="cb140-55"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-55" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb140-56"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-56" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Cluster selection proportions</span></span>
<span id="cb140-57"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">length</span>(sel_clusts) <span class="sc">&gt;</span> <span class="dv">1</span>){</span>
<span id="cb140-58"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-58" aria-hidden="true" tabindex="-1"></a>        sel_clust_sel_props <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(css_results<span class="sc">$</span>clus_sel_mat[,</span>
<span id="cb140-59"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-59" aria-hidden="true" tabindex="-1"></a>            <span class="fu">names</span>(sel_clusts)])</span>
<span id="cb140-60"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-60" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span>{</span>
<span id="cb140-61"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-61" aria-hidden="true" tabindex="-1"></a>        sel_clust_sel_props <span class="ot">&lt;-</span> <span class="fu">mean</span>(css_results<span class="sc">$</span>clus_sel_mat[,</span>
<span id="cb140-62"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-62" aria-hidden="true" tabindex="-1"></a>            <span class="fu">names</span>(sel_clusts)])</span>
<span id="cb140-63"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-63" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb140-64"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-65"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-65" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Data.frame: name of cluster, cluster prototype, selection proportion,</span></span>
<span id="cb140-66"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-66" aria-hidden="true" tabindex="-1"></a>    <span class="co"># cluster size</span></span>
<span id="cb140-67"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-68"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-68" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(<span class="fu">names</span>(prototypes))){</span>
<span id="cb140-69"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-69" aria-hidden="true" tabindex="-1"></a>        print_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ClustName=</span><span class="fu">names</span>(sel_clusts),</span>
<span id="cb140-70"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-70" aria-hidden="true" tabindex="-1"></a>            <span class="at">ClustProtoName=</span><span class="fu">names</span>(prototypes), <span class="at">ClustProtoNum=</span><span class="fu">unname</span>(prototypes),</span>
<span id="cb140-71"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-71" aria-hidden="true" tabindex="-1"></a>            <span class="at">ClustSelProp=</span>sel_clust_sel_props, <span class="at">ClustSize=</span><span class="fu">lengths</span>(sel_clusts))</span>
<span id="cb140-72"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-72" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span>{</span>
<span id="cb140-73"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-73" aria-hidden="true" tabindex="-1"></a>        print_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ClustName=</span><span class="fu">names</span>(sel_clusts),</span>
<span id="cb140-74"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-74" aria-hidden="true" tabindex="-1"></a>            <span class="at">ClustProtoNum=</span><span class="fu">unname</span>(prototypes), <span class="at">ClustSelProp=</span>sel_clust_sel_props,</span>
<span id="cb140-75"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-75" aria-hidden="true" tabindex="-1"></a>            <span class="at">ClustSize=</span><span class="fu">lengths</span>(sel_clusts))</span>
<span id="cb140-76"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-76" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb140-77"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-78"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-78" aria-hidden="true" tabindex="-1"></a>    print_df <span class="ot">&lt;-</span> print_df[<span class="fu">order</span>(print_df<span class="sc">$</span>ClustSelProp, <span class="at">decreasing=</span><span class="cn">TRUE</span>), ]</span>
<span id="cb140-79"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-80"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-80" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames</span>(print_df) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb140-81"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-81" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb140-82"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-82" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.data.frame</span>(print_df))</span>
<span id="cb140-83"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">nrow</span>(print_df) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb140-84"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-85"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-85" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(print_df)</span>
<span id="cb140-86"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb140-86" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>getSelectionPrototypes</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Identify selection prototypes from selected clusters</span></span>
<span id="cb141-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb141-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Takes in list of selected clusters and returns an integer vector of the</span></span>
<span id="cb141-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; indices of the features that were most frequently selected from each cluster</span></span>
<span id="cb141-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb141-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param css_results An object of class &quot;cssr&quot; (the output of the function</span></span>
<span id="cb141-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; css).</span></span>
<span id="cb141-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param selected_clusts A list of integer vectors; each vector must contain</span></span>
<span id="cb141-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the indices of features in a cluster.</span></span>
<span id="cb141-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return An integer vector (of length equal to the number of clusters) of the</span></span>
<span id="cb141-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; indices of the feature prototypes (the features from each cluster that were</span></span>
<span id="cb141-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; selected the most often individually by the base method in cluster stability</span></span>
<span id="cb141-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; selection). In the case of a tie, the tie is broken by choosing the feature</span></span>
<span id="cb141-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; most correlated with the response in the full data set provided to css.</span></span>
<span id="cb141-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @author Gregory Faletto, Jacob Bien</span></span>
<span id="cb141-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-16" aria-hidden="true" tabindex="-1"></a><span id='getSelectionPrototypes'>getSelectionPrototypes</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(css_results, selected_clusts){</span>
<span id="cb141-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb141-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check inputs</span></span>
<span id="cb141-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">class</span>(css_results) <span class="sc">==</span> <span class="st">&quot;cssr&quot;</span>)</span>
<span id="cb141-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.list</span>(selected_clusts))</span>
<span id="cb141-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-22" aria-hidden="true" tabindex="-1"></a>    n_selected_clusts <span class="ot">&lt;-</span> <span class="fu">length</span>(selected_clusts)</span>
<span id="cb141-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(n_selected_clusts <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb141-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">all</span>(<span class="fu">lengths</span>(selected_clusts) <span class="sc">&gt;=</span> <span class="dv">1</span>))</span>
<span id="cb141-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-26" aria-hidden="true" tabindex="-1"></a>    prototypes <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">as.integer</span>(<span class="cn">NA</span>), n_selected_clusts)</span>
<span id="cb141-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_selected_clusts){</span>
<span id="cb141-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-28" aria-hidden="true" tabindex="-1"></a>        clust_i <span class="ot">&lt;-</span> selected_clusts[[i]]</span>
<span id="cb141-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-29" aria-hidden="true" tabindex="-1"></a>        sel_props_i <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(css_results<span class="sc">$</span>feat_sel_mat)[clust_i]</span>
<span id="cb141-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-30" aria-hidden="true" tabindex="-1"></a>        proto_i <span class="ot">&lt;-</span> clust_i[sel_props_i <span class="sc">==</span> <span class="fu">max</span>(sel_props_i)]</span>
<span id="cb141-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-31" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">length</span>(proto_i) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb141-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="fu">length</span>(proto_i) <span class="sc">&gt;</span> <span class="dv">1</span>){</span>
<span id="cb141-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-33" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span>(<span class="fu">is.numeric</span>(css_results<span class="sc">$</span>y) <span class="sc">|</span> <span class="fu">is.integer</span>(css_results<span class="sc">$</span>y)){</span>
<span id="cb141-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-34" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Break tie by looking at marginal correlations</span></span>
<span id="cb141-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-35" aria-hidden="true" tabindex="-1"></a>                corrs_i <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">cor</span>(css_results<span class="sc">$</span>X[, proto_i], css_results<span class="sc">$</span>y)[, <span class="dv">1</span>]</span>
<span id="cb141-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-36" aria-hidden="true" tabindex="-1"></a>                corrs_i <span class="ot">&lt;-</span> <span class="fu">abs</span>(corrs_i)</span>
<span id="cb141-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-37" aria-hidden="true" tabindex="-1"></a>                proto_i <span class="ot">&lt;-</span> proto_i[corrs_i <span class="sc">==</span> <span class="fu">max</span>(corrs_i)]</span>
<span id="cb141-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-38" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb141-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-39" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb141-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-40" aria-hidden="true" tabindex="-1"></a>        <span class="co"># If there is still a tie, break by choosing the first feature of those</span></span>
<span id="cb141-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-41" aria-hidden="true" tabindex="-1"></a>        <span class="co"># remaining</span></span>
<span id="cb141-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-42" aria-hidden="true" tabindex="-1"></a>        prototypes[i] <span class="ot">&lt;-</span> proto_i[<span class="dv">1</span>]</span>
<span id="cb141-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-43" aria-hidden="true" tabindex="-1"></a>        <span class="fu">names</span>(prototypes)[i] <span class="ot">&lt;-</span> <span class="fu">colnames</span>(css_results<span class="sc">$</span>X)[proto_i]</span>
<span id="cb141-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-44" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb141-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check output</span></span>
<span id="cb141-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-48"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.integer</span>(prototypes))</span>
<span id="cb141-49"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(prototypes)))</span>
<span id="cb141-50"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(prototypes) <span class="sc">==</span> <span class="fu">length</span>(<span class="fu">unique</span>(prototypes)))</span>
<span id="cb141-51"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-52"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(prototypes)</span>
<span id="cb141-53"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb141-53" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Tests for getSelectionPrototypes:</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-1" aria-hidden="true" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">test_that</span>(<span class="st">&quot;getSelectionPrototypes works&quot;</span>, {</span>
<span id="cb142-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">67234</span>)</span>
<span id="cb142-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb142-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-4" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#genClusteredData'>genClusteredData</a>(<span class="at">n=</span><span class="dv">15</span>, <span class="at">p=</span><span class="dv">11</span>, <span class="at">k_unclustered=</span><span class="dv">1</span>, <span class="at">cluster_size=</span><span class="dv">3</span>,</span>
<span id="cb142-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">n_clusters=</span><span class="dv">2</span>, <span class="at">sig_clusters=</span><span class="dv">1</span>, <span class="at">sigma_eps_sq=</span><span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">6</span>))</span>
<span id="cb142-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb142-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-7" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> data<span class="sc">$</span>X</span>
<span id="cb142-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-8" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> data<span class="sc">$</span>y</span>
<span id="cb142-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb142-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-10" aria-hidden="true" tabindex="-1"></a>  good_clusters <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">red_cluster=</span>1L<span class="sc">:</span>3L, <span class="at">green_cluster=</span>4L<span class="sc">:</span>6L)</span>
<span id="cb142-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb142-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-12" aria-hidden="true" tabindex="-1"></a>  css_results <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">lambda=</span><span class="fl">0.01</span>, <span class="at">clusters=</span>good_clusters)</span>
<span id="cb142-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb142-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-14" aria-hidden="true" tabindex="-1"></a>  ret <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getSelectionPrototypes'>getSelectionPrototypes</a>(css_results, <span class="at">selected_clusts=</span>good_clusters)</span>
<span id="cb142-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb142-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-16" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.integer</span>(ret))</span>
<span id="cb142-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-17" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(ret)))</span>
<span id="cb142-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-18" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(ret), <span class="fu">length</span>(good_clusters))</span>
<span id="cb142-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-19" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(ret), <span class="fu">length</span>(<span class="fu">unique</span>(ret)))</span>
<span id="cb142-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(ret)){</span>
<span id="cb142-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-21" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_true</span>(ret[i] <span class="sc">%in%</span> good_clusters[[i]])</span>
<span id="cb142-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find the largest selection proportion of any feature in cluster i</span></span>
<span id="cb142-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-23" aria-hidden="true" tabindex="-1"></a>    max_prop <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">colMeans</span>(css_results<span class="sc">$</span>feat_sel_mat[, good_clusters[[i]]]))</span>
<span id="cb142-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find the selection proportion of the identified prototype</span></span>
<span id="cb142-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-25" aria-hidden="true" tabindex="-1"></a>    proto_prop <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(css_results<span class="sc">$</span>feat_sel_mat)[ret[i]]</span>
<span id="cb142-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-26" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_equal</span>(max_prop, proto_prop)</span>
<span id="cb142-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-27" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb142-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb142-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Try with only one selected cluster (still should be in a list)</span></span>
<span id="cb142-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-31" aria-hidden="true" tabindex="-1"></a>  ret <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getSelectionPrototypes'>getSelectionPrototypes</a>(css_results,</span>
<span id="cb142-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-32" aria-hidden="true" tabindex="-1"></a>                                <span class="at">selected_clusts=</span><span class="fu">list</span>(<span class="at">red_cluster=</span>1L<span class="sc">:</span>3L))</span>
<span id="cb142-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-34" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.integer</span>(ret))</span>
<span id="cb142-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-35" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="sc">!</span><span class="fu">is.na</span>(ret))</span>
<span id="cb142-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-36" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(ret), <span class="dv">1</span>)</span>
<span id="cb142-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-37" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(ret <span class="sc">%in%</span> 1L<span class="sc">:</span>3L)</span>
<span id="cb142-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Find the largest selection proportion of any feature in the cluster</span></span>
<span id="cb142-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-39" aria-hidden="true" tabindex="-1"></a>  max_prop <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">colMeans</span>(css_results<span class="sc">$</span>feat_sel_mat[, 1L<span class="sc">:</span>3L]))</span>
<span id="cb142-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Find the selection proportion of the identified prototype</span></span>
<span id="cb142-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-41" aria-hidden="true" tabindex="-1"></a>  proto_prop <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(css_results<span class="sc">$</span>feat_sel_mat)[ret]</span>
<span id="cb142-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-42" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(max_prop, proto_prop)</span>
<span id="cb142-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-44" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Trying bad inputs</span></span>
<span id="cb142-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Error contains quotation marks</span></span>
<span id="cb142-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-47" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getSelectionPrototypes'>getSelectionPrototypes</a>(x, good_clusters))</span>
<span id="cb142-48"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-49"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-49" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getSelectionPrototypes'>getSelectionPrototypes</a>(css_results, 1L<span class="sc">:</span>3L),</span>
<span id="cb142-50"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-50" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;is.list(selected_clusts) is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb142-51"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-52"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-52" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getSelectionPrototypes'>getSelectionPrototypes</a>(css_results, <span class="fu">list</span>()),</span>
<span id="cb142-53"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-53" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;n_selected_clusts &gt;= 1 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb142-54"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-55"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-55" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getSelectionPrototypes'>getSelectionPrototypes</a>(css_results,</span>
<span id="cb142-56"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-56" aria-hidden="true" tabindex="-1"></a>                                                <span class="fu">list</span>(<span class="at">red_cluster=</span>1L<span class="sc">:</span>3L,</span>
<span id="cb142-57"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-57" aria-hidden="true" tabindex="-1"></a>                                                     <span class="at">green_cluster=</span>4L<span class="sc">:</span>6L,</span>
<span id="cb142-58"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-58" aria-hidden="true" tabindex="-1"></a>                                                     <span class="at">bad_cluster=</span><span class="fu">integer</span>())),</span>
<span id="cb142-59"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-59" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;all(lengths(selected_clusts) &gt;= 1) is not TRUE&quot;</span>,</span>
<span id="cb142-60"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-60" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb142-61"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-62"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb142-62" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## Test passed 😸</code></pre>
<p>Tests for printCssDf:</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-1" aria-hidden="true" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">test_that</span>(<span class="st">&quot;printCssDf works&quot;</span>, {</span>
<span id="cb144-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">67234</span>)</span>
<span id="cb144-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-4" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#genClusteredData'>genClusteredData</a>(<span class="at">n=</span><span class="dv">15</span>, <span class="at">p=</span><span class="dv">11</span>, <span class="at">k_unclustered=</span><span class="dv">1</span>, <span class="at">cluster_size=</span><span class="dv">3</span>,</span>
<span id="cb144-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">n_clusters=</span><span class="dv">2</span>, <span class="at">sig_clusters=</span><span class="dv">1</span>, <span class="at">sigma_eps_sq=</span><span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">6</span>))</span>
<span id="cb144-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-7" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> data<span class="sc">$</span>X</span>
<span id="cb144-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-8" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> data<span class="sc">$</span>y</span>
<span id="cb144-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-10" aria-hidden="true" tabindex="-1"></a>  good_clusters <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">red_cluster=</span>1L<span class="sc">:</span>3L, <span class="at">green_cluster=</span>4L<span class="sc">:</span>6L)</span>
<span id="cb144-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-12" aria-hidden="true" tabindex="-1"></a>  css_results <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">lambda=</span><span class="fl">0.01</span>, <span class="at">clusters=</span>good_clusters, <span class="at">B=</span><span class="dv">10</span>)</span>
<span id="cb144-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-14" aria-hidden="true" tabindex="-1"></a>  ret <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#printCssDf'>printCssDf</a>(css_results)</span>
<span id="cb144-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-16" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.data.frame</span>(ret))</span>
<span id="cb144-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-17" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">colnames</span>(ret), <span class="fu">c</span>(<span class="st">&quot;ClustName&quot;</span>, <span class="st">&quot;ClustProtoNum&quot;</span>,</span>
<span id="cb144-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-18" aria-hidden="true" tabindex="-1"></a>                                              <span class="st">&quot;ClustSelProp&quot;</span>, <span class="st">&quot;ClustSize&quot;</span>))</span>
<span id="cb144-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Total number of clusters is 11 - (3 - 1) - (3 - 1) = 7</span></span>
<span id="cb144-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-21" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(ret), <span class="dv">7</span>)</span>
<span id="cb144-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-23" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.character</span>(ret<span class="sc">$</span>ClustName))</span>
<span id="cb144-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-24" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">names</span>(good_clusters) <span class="sc">%in%</span> ret<span class="sc">$</span>ClustName))</span>
<span id="cb144-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-25" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(ret<span class="sc">$</span>ClustName), <span class="fu">length</span>(<span class="fu">unique</span>(ret<span class="sc">$</span>ClustName)))</span>
<span id="cb144-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-27" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.integer</span>(ret<span class="sc">$</span>ClustProtoNum))</span>
<span id="cb144-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-28" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(ret[ret<span class="sc">$</span>ClustName<span class="sc">==</span><span class="st">&quot;red_cluster&quot;</span>,</span>
<span id="cb144-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-29" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;ClustProtoNum&quot;</span>] <span class="sc">%in%</span> 1L<span class="sc">:</span>3L)</span>
<span id="cb144-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-30" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(ret[ret<span class="sc">$</span>ClustName<span class="sc">==</span><span class="st">&quot;green_cluster&quot;</span>,</span>
<span id="cb144-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-31" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;ClustProtoNum&quot;</span>] <span class="sc">%in%</span> 4L<span class="sc">:</span>6L)</span>
<span id="cb144-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-32" aria-hidden="true" tabindex="-1"></a>  other_rows <span class="ot">&lt;-</span> <span class="sc">!</span>(ret<span class="sc">$</span>ClustName <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;red_cluster&quot;</span>, <span class="st">&quot;green_cluster&quot;</span>))</span>
<span id="cb144-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-33" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(ret[other_rows, <span class="st">&quot;ClustProtoNum&quot;</span>] <span class="sc">%in%</span> 7L<span class="sc">:</span>11L))</span>
<span id="cb144-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-34" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(ret[other_rows, <span class="st">&quot;ClustProtoNum&quot;</span>]) <span class="sc">==</span></span>
<span id="cb144-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-35" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">length</span>(<span class="fu">unique</span>(ret[other_rows, <span class="st">&quot;ClustProtoNum&quot;</span>])))</span>
<span id="cb144-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-37" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(ret<span class="sc">$</span>ClustSelProp))</span>
<span id="cb144-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-38" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(ret<span class="sc">$</span>ClustSelProp, <span class="fu">sort</span>(ret<span class="sc">$</span>ClustSelProp,</span>
<span id="cb144-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-39" aria-hidden="true" tabindex="-1"></a>                                                    <span class="at">decreasing=</span><span class="cn">TRUE</span>))</span>
<span id="cb144-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-41" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.integer</span>(ret<span class="sc">$</span>ClustSize))</span>
<span id="cb144-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-42" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(ret[ret<span class="sc">$</span>ClustName<span class="sc">==</span><span class="st">&quot;red_cluster&quot;</span>, <span class="st">&quot;ClustSize&quot;</span>], <span class="dv">3</span>)</span>
<span id="cb144-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-43" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(ret[ret<span class="sc">$</span>ClustName<span class="sc">==</span><span class="st">&quot;green_cluster&quot;</span>, <span class="st">&quot;ClustSize&quot;</span>], <span class="dv">3</span>)</span>
<span id="cb144-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-44" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(ret[other_rows, <span class="st">&quot;ClustSize&quot;</span>] <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb144-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Try again naming features</span></span>
<span id="cb144-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-48"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-48" aria-hidden="true" tabindex="-1"></a>  x_named <span class="ot">&lt;-</span> x</span>
<span id="cb144-49"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(x_named) <span class="ot">&lt;-</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>]</span>
<span id="cb144-50"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-51"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-51" aria-hidden="true" tabindex="-1"></a>  css_results_name_feats <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x_named, <span class="at">y=</span>y, <span class="at">lambda=</span><span class="fl">0.01</span>,</span>
<span id="cb144-52"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-52" aria-hidden="true" tabindex="-1"></a>                                <span class="at">clusters=</span>good_clusters, <span class="at">B=</span><span class="dv">10</span>)</span>
<span id="cb144-53"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-54"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-54" aria-hidden="true" tabindex="-1"></a>  ret <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#printCssDf'>printCssDf</a>(css_results_name_feats)</span>
<span id="cb144-55"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-56"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-56" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.data.frame</span>(ret))</span>
<span id="cb144-57"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-57" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">colnames</span>(ret), <span class="fu">c</span>(<span class="st">&quot;ClustName&quot;</span>, <span class="st">&quot;ClustProtoName&quot;</span>,</span>
<span id="cb144-58"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-58" aria-hidden="true" tabindex="-1"></a>                                              <span class="st">&quot;ClustProtoNum&quot;</span>, <span class="st">&quot;ClustSelProp&quot;</span>,</span>
<span id="cb144-59"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-59" aria-hidden="true" tabindex="-1"></a>                                              <span class="st">&quot;ClustSize&quot;</span>))</span>
<span id="cb144-60"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-61"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Total number of clusters is 11 - (3 - 1) - (3 - 1) = 7</span></span>
<span id="cb144-62"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-62" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(ret), <span class="dv">7</span>)</span>
<span id="cb144-63"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-64"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-64" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.character</span>(ret<span class="sc">$</span>ClustName))</span>
<span id="cb144-65"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-65" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">names</span>(good_clusters) <span class="sc">%in%</span> ret<span class="sc">$</span>ClustName))</span>
<span id="cb144-66"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-66" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(ret<span class="sc">$</span>ClustName), <span class="fu">length</span>(<span class="fu">unique</span>(ret<span class="sc">$</span>ClustName)))</span>
<span id="cb144-67"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-67" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-68"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-68" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.character</span>(ret<span class="sc">$</span>ClustProtoName))</span>
<span id="cb144-69"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-69" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(ret[ret<span class="sc">$</span>ClustName<span class="sc">==</span><span class="st">&quot;red_cluster&quot;</span>,</span>
<span id="cb144-70"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-70" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;ClustProtoName&quot;</span>] <span class="sc">%in%</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb144-71"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-71" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(ret[ret<span class="sc">$</span>ClustName<span class="sc">==</span><span class="st">&quot;green_cluster&quot;</span>,</span>
<span id="cb144-72"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-72" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;ClustProtoName&quot;</span>] <span class="sc">%in%</span> LETTERS[<span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>])</span>
<span id="cb144-73"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-73" aria-hidden="true" tabindex="-1"></a>  other_rows <span class="ot">&lt;-</span> <span class="sc">!</span>(ret<span class="sc">$</span>ClustName <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;red_cluster&quot;</span>, <span class="st">&quot;green_cluster&quot;</span>))</span>
<span id="cb144-74"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-74" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(ret[other_rows, <span class="st">&quot;ClustProtoName&quot;</span>] <span class="sc">%in%</span> LETTERS[<span class="dv">7</span><span class="sc">:</span><span class="dv">11</span>]))</span>
<span id="cb144-75"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-75" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(ret[other_rows, <span class="st">&quot;ClustProtoName&quot;</span>]) <span class="sc">==</span></span>
<span id="cb144-76"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-76" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">length</span>(<span class="fu">unique</span>(ret[other_rows, <span class="st">&quot;ClustProtoName&quot;</span>])))</span>
<span id="cb144-77"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-77" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-78"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-78" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.integer</span>(ret<span class="sc">$</span>ClustProtoNum))</span>
<span id="cb144-79"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-79" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(ret[ret<span class="sc">$</span>ClustName<span class="sc">==</span><span class="st">&quot;red_cluster&quot;</span>,</span>
<span id="cb144-80"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-80" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;ClustProtoNum&quot;</span>] <span class="sc">%in%</span> 1L<span class="sc">:</span>3L)</span>
<span id="cb144-81"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-81" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(ret[ret<span class="sc">$</span>ClustName<span class="sc">==</span><span class="st">&quot;green_cluster&quot;</span>,</span>
<span id="cb144-82"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-82" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;ClustProtoNum&quot;</span>] <span class="sc">%in%</span> 4L<span class="sc">:</span>6L)</span>
<span id="cb144-83"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-83" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(ret[other_rows, <span class="st">&quot;ClustProtoNum&quot;</span>] <span class="sc">%in%</span> 7L<span class="sc">:</span>11L))</span>
<span id="cb144-84"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-84" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(ret[other_rows, <span class="st">&quot;ClustProtoNum&quot;</span>]) <span class="sc">==</span></span>
<span id="cb144-85"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-85" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">length</span>(<span class="fu">unique</span>(ret[other_rows, <span class="st">&quot;ClustProtoNum&quot;</span>])))</span>
<span id="cb144-86"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-86" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-87"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-87" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(ret<span class="sc">$</span>ClustSelProp))</span>
<span id="cb144-88"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-88" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(ret<span class="sc">$</span>ClustSelProp, <span class="fu">sort</span>(ret<span class="sc">$</span>ClustSelProp,</span>
<span id="cb144-89"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-89" aria-hidden="true" tabindex="-1"></a>                                                    <span class="at">decreasing=</span><span class="cn">TRUE</span>))</span>
<span id="cb144-90"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-90" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-91"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-91" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.integer</span>(ret<span class="sc">$</span>ClustSize))</span>
<span id="cb144-92"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-92" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(ret[ret<span class="sc">$</span>ClustName<span class="sc">==</span><span class="st">&quot;red_cluster&quot;</span>, <span class="st">&quot;ClustSize&quot;</span>], <span class="dv">3</span>)</span>
<span id="cb144-93"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-93" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(ret[ret<span class="sc">$</span>ClustName<span class="sc">==</span><span class="st">&quot;green_cluster&quot;</span>, <span class="st">&quot;ClustSize&quot;</span>], <span class="dv">3</span>)</span>
<span id="cb144-94"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-94" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(ret[other_rows, <span class="st">&quot;ClustSize&quot;</span>] <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb144-95"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-95" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-96"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-96" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Unnamed clusters</span></span>
<span id="cb144-97"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-97" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-98"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-98" aria-hidden="true" tabindex="-1"></a>  unnamed_clusters <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb144-99"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-99" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-100"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-100" aria-hidden="true" tabindex="-1"></a>  css_results_unnamed <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">lambda=</span><span class="fl">0.01</span>, <span class="at">clusters=</span>unnamed_clusters,</span>
<span id="cb144-101"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-101" aria-hidden="true" tabindex="-1"></a>                             <span class="at">B=</span><span class="dv">10</span>)</span>
<span id="cb144-102"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-102" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-103"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-103" aria-hidden="true" tabindex="-1"></a>  ret <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#printCssDf'>printCssDf</a>(css_results_unnamed)</span>
<span id="cb144-104"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-104" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-105"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-105" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.data.frame</span>(ret))</span>
<span id="cb144-106"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-106" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">colnames</span>(ret), <span class="fu">c</span>(<span class="st">&quot;ClustName&quot;</span>, <span class="st">&quot;ClustProtoNum&quot;</span>,</span>
<span id="cb144-107"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-107" aria-hidden="true" tabindex="-1"></a>                                              <span class="st">&quot;ClustSelProp&quot;</span>, <span class="st">&quot;ClustSize&quot;</span>))</span>
<span id="cb144-108"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-108" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-109"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-109" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Total number of clusters is 11 - (3 - 1) - (3 - 1) = 7</span></span>
<span id="cb144-110"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-110" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">nrow</span>(ret), <span class="dv">7</span>)</span>
<span id="cb144-111"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-112"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-112" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.character</span>(ret<span class="sc">$</span>ClustName))</span>
<span id="cb144-113"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-113" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(ret<span class="sc">$</span>ClustName), <span class="fu">length</span>(<span class="fu">unique</span>(ret<span class="sc">$</span>ClustName)))</span>
<span id="cb144-114"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-114" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-115"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-115" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.integer</span>(ret<span class="sc">$</span>ClustProtoNum))</span>
<span id="cb144-116"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-116" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-117"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-117" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(ret<span class="sc">$</span>ClustSelProp))</span>
<span id="cb144-118"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-118" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(ret<span class="sc">$</span>ClustSelProp, <span class="fu">sort</span>(ret<span class="sc">$</span>ClustSelProp,</span>
<span id="cb144-119"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-119" aria-hidden="true" tabindex="-1"></a>                                                    <span class="at">decreasing=</span><span class="cn">TRUE</span>))</span>
<span id="cb144-120"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-120" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-121"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-121" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.integer</span>(ret<span class="sc">$</span>ClustSize))</span>
<span id="cb144-122"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-122" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-123"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-123" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Try other settings for cutoff, min_num_clusts, max_num_clusts, etc.</span></span>
<span id="cb144-124"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-124" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-125"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-125" aria-hidden="true" tabindex="-1"></a>  ret <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#printCssDf'>printCssDf</a>(css_results, <span class="at">max_num_clusts=</span><span class="dv">3</span>)</span>
<span id="cb144-126"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-126" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-127"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-127" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.data.frame</span>(ret))</span>
<span id="cb144-128"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-128" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">colnames</span>(ret), <span class="fu">c</span>(<span class="st">&quot;ClustName&quot;</span>, <span class="st">&quot;ClustProtoNum&quot;</span>,</span>
<span id="cb144-129"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-129" aria-hidden="true" tabindex="-1"></a>                                              <span class="st">&quot;ClustSelProp&quot;</span>, <span class="st">&quot;ClustSize&quot;</span>))</span>
<span id="cb144-130"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-131"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-131" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">nrow</span>(ret) <span class="sc">&lt;=</span> <span class="dv">3</span>)</span>
<span id="cb144-132"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-133"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-133" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.character</span>(ret<span class="sc">$</span>ClustName))</span>
<span id="cb144-134"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-134" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(ret<span class="sc">$</span>ClustName), <span class="fu">length</span>(<span class="fu">unique</span>(ret<span class="sc">$</span>ClustName)))</span>
<span id="cb144-135"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-135" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-136"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-136" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.integer</span>(ret<span class="sc">$</span>ClustProtoNum))</span>
<span id="cb144-137"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-137" aria-hidden="true" tabindex="-1"></a>  other_rows <span class="ot">&lt;-</span> <span class="sc">!</span>(ret<span class="sc">$</span>ClustName <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;red_cluster&quot;</span>, <span class="st">&quot;green_cluster&quot;</span>))</span>
<span id="cb144-138"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-138" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(ret[other_rows, <span class="st">&quot;ClustProtoNum&quot;</span>] <span class="sc">%in%</span> 7L<span class="sc">:</span>11L))</span>
<span id="cb144-139"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-139" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(ret[other_rows, <span class="st">&quot;ClustProtoNum&quot;</span>]) <span class="sc">==</span></span>
<span id="cb144-140"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-140" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">length</span>(<span class="fu">unique</span>(ret[other_rows, <span class="st">&quot;ClustProtoNum&quot;</span>])))</span>
<span id="cb144-141"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-141" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-142"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-142" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(ret<span class="sc">$</span>ClustSelProp))</span>
<span id="cb144-143"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-143" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(ret<span class="sc">$</span>ClustSelProp, <span class="fu">sort</span>(ret<span class="sc">$</span>ClustSelProp,</span>
<span id="cb144-144"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-144" aria-hidden="true" tabindex="-1"></a>                                                    <span class="at">decreasing=</span><span class="cn">TRUE</span>))</span>
<span id="cb144-145"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-145" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-146"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-146" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.integer</span>(ret<span class="sc">$</span>ClustSize))</span>
<span id="cb144-147"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-147" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(ret[other_rows, <span class="st">&quot;ClustSize&quot;</span>] <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb144-148"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-148" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-149"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-149" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="st">&quot;red_cluster&quot;</span> <span class="sc">%in%</span> ret<span class="sc">$</span>ClustName){</span>
<span id="cb144-150"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-150" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_true</span>(ret[ret<span class="sc">$</span>ClustName<span class="sc">==</span><span class="st">&quot;red_cluster&quot;</span>,</span>
<span id="cb144-151"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-151" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;ClustProtoNum&quot;</span>] <span class="sc">%in%</span> 1L<span class="sc">:</span>3L)</span>
<span id="cb144-152"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-152" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_equal</span>(ret[ret<span class="sc">$</span>ClustName<span class="sc">==</span><span class="st">&quot;red_cluster&quot;</span>, <span class="st">&quot;ClustSize&quot;</span>], <span class="dv">3</span>)</span>
<span id="cb144-153"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-153" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb144-154"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-154" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-155"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-155" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="st">&quot;green_cluster&quot;</span> <span class="sc">%in%</span> ret<span class="sc">$</span>ClustName){</span>
<span id="cb144-156"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-156" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_true</span>(ret[ret<span class="sc">$</span>ClustName<span class="sc">==</span><span class="st">&quot;green_cluster&quot;</span>,</span>
<span id="cb144-157"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-157" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;ClustProtoNum&quot;</span>] <span class="sc">%in%</span> 4L<span class="sc">:</span>6L)</span>
<span id="cb144-158"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-158" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_equal</span>(ret[ret<span class="sc">$</span>ClustName<span class="sc">==</span><span class="st">&quot;green_cluster&quot;</span>, <span class="st">&quot;ClustSize&quot;</span>], <span class="dv">3</span>)</span>
<span id="cb144-159"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-159" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb144-160"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-160" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-161"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-161" aria-hidden="true" tabindex="-1"></a>  ret <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#printCssDf'>printCssDf</a>(css_results, <span class="at">min_num_clusts=</span><span class="dv">2</span>, <span class="at">cutoff=</span><span class="dv">1</span>)</span>
<span id="cb144-162"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-162" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-163"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-163" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.data.frame</span>(ret))</span>
<span id="cb144-164"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-164" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">colnames</span>(ret), <span class="fu">c</span>(<span class="st">&quot;ClustName&quot;</span>, <span class="st">&quot;ClustProtoNum&quot;</span>,</span>
<span id="cb144-165"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-165" aria-hidden="true" tabindex="-1"></a>                                              <span class="st">&quot;ClustSelProp&quot;</span>, <span class="st">&quot;ClustSize&quot;</span>))</span>
<span id="cb144-166"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-166" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-167"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-167" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Total number of clusters is 11 - (3 - 1) - (3 - 1) = 7</span></span>
<span id="cb144-168"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-168" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">nrow</span>(ret) <span class="sc">&gt;=</span> <span class="dv">2</span>)</span>
<span id="cb144-169"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-169" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">nrow</span>(ret) <span class="sc">&lt;=</span> <span class="dv">7</span>)</span>
<span id="cb144-170"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-171"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-171" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.character</span>(ret<span class="sc">$</span>ClustName))</span>
<span id="cb144-172"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-172" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(ret<span class="sc">$</span>ClustName), <span class="fu">length</span>(<span class="fu">unique</span>(ret<span class="sc">$</span>ClustName)))</span>
<span id="cb144-173"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-173" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-174"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-174" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.integer</span>(ret<span class="sc">$</span>ClustProtoNum))</span>
<span id="cb144-175"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-175" aria-hidden="true" tabindex="-1"></a>  other_rows <span class="ot">&lt;-</span> <span class="sc">!</span>(ret<span class="sc">$</span>ClustName <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;red_cluster&quot;</span>, <span class="st">&quot;green_cluster&quot;</span>))</span>
<span id="cb144-176"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-176" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(ret[other_rows, <span class="st">&quot;ClustProtoNum&quot;</span>] <span class="sc">%in%</span> 7L<span class="sc">:</span>11L))</span>
<span id="cb144-177"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-177" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(ret[other_rows, <span class="st">&quot;ClustProtoNum&quot;</span>]) <span class="sc">==</span></span>
<span id="cb144-178"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-178" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">length</span>(<span class="fu">unique</span>(ret[other_rows, <span class="st">&quot;ClustProtoNum&quot;</span>])))</span>
<span id="cb144-179"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-179" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-180"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-180" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(ret<span class="sc">$</span>ClustSelProp))</span>
<span id="cb144-181"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-181" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(ret<span class="sc">$</span>ClustSelProp, <span class="fu">sort</span>(ret<span class="sc">$</span>ClustSelProp,</span>
<span id="cb144-182"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-182" aria-hidden="true" tabindex="-1"></a>                                                    <span class="at">decreasing=</span><span class="cn">TRUE</span>))</span>
<span id="cb144-183"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-183" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-184"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-184" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.integer</span>(ret<span class="sc">$</span>ClustSize))</span>
<span id="cb144-185"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-185" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(ret[other_rows, <span class="st">&quot;ClustSize&quot;</span>] <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb144-186"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-186" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-187"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-187" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="st">&quot;red_cluster&quot;</span> <span class="sc">%in%</span> ret<span class="sc">$</span>ClustName){</span>
<span id="cb144-188"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-188" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_true</span>(ret[ret<span class="sc">$</span>ClustName<span class="sc">==</span><span class="st">&quot;red_cluster&quot;</span>,</span>
<span id="cb144-189"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-189" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;ClustProtoNum&quot;</span>] <span class="sc">%in%</span> 1L<span class="sc">:</span>3L)</span>
<span id="cb144-190"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-190" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_equal</span>(ret[ret<span class="sc">$</span>ClustName<span class="sc">==</span><span class="st">&quot;red_cluster&quot;</span>, <span class="st">&quot;ClustSize&quot;</span>], <span class="dv">3</span>)</span>
<span id="cb144-191"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-191" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb144-192"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-192" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-193"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-193" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="st">&quot;green_cluster&quot;</span> <span class="sc">%in%</span> ret<span class="sc">$</span>ClustName){</span>
<span id="cb144-194"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-194" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_true</span>(ret[ret<span class="sc">$</span>ClustName<span class="sc">==</span><span class="st">&quot;green_cluster&quot;</span>,</span>
<span id="cb144-195"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-195" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;ClustProtoNum&quot;</span>] <span class="sc">%in%</span> 4L<span class="sc">:</span>6L)</span>
<span id="cb144-196"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-196" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_equal</span>(ret[ret<span class="sc">$</span>ClustName<span class="sc">==</span><span class="st">&quot;green_cluster&quot;</span>, <span class="st">&quot;ClustSize&quot;</span>], <span class="dv">3</span>)</span>
<span id="cb144-197"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-197" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb144-198"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-198" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-199"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-199" aria-hidden="true" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb144-200"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-200" aria-hidden="true" tabindex="-1"></a>  ret <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#printCssDf'>printCssDf</a>(css_results, <span class="at">cutoff=</span><span class="dv">1</span>)</span>
<span id="cb144-201"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-202"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-202" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.data.frame</span>(ret))</span>
<span id="cb144-203"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-203" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">colnames</span>(ret), <span class="fu">c</span>(<span class="st">&quot;ClustName&quot;</span>, <span class="st">&quot;ClustProtoNum&quot;</span>,</span>
<span id="cb144-204"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-204" aria-hidden="true" tabindex="-1"></a>                                              <span class="st">&quot;ClustSelProp&quot;</span>, <span class="st">&quot;ClustSize&quot;</span>))</span>
<span id="cb144-205"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-206"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-206" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">nrow</span>(ret) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb144-207"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-207" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">nrow</span>(ret) <span class="sc">&lt;=</span> <span class="dv">7</span>)</span>
<span id="cb144-208"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-209"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-209" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.character</span>(ret<span class="sc">$</span>ClustName))</span>
<span id="cb144-210"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-210" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(ret<span class="sc">$</span>ClustName), <span class="fu">length</span>(<span class="fu">unique</span>(ret<span class="sc">$</span>ClustName)))</span>
<span id="cb144-211"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-212"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-212" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.integer</span>(ret<span class="sc">$</span>ClustProtoNum))</span>
<span id="cb144-213"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-213" aria-hidden="true" tabindex="-1"></a>  other_rows <span class="ot">&lt;-</span> <span class="sc">!</span>(ret<span class="sc">$</span>ClustName <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;red_cluster&quot;</span>, <span class="st">&quot;green_cluster&quot;</span>))</span>
<span id="cb144-214"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-214" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(ret[other_rows, <span class="st">&quot;ClustProtoNum&quot;</span>] <span class="sc">%in%</span> 7L<span class="sc">:</span>11L))</span>
<span id="cb144-215"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-215" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(ret[other_rows, <span class="st">&quot;ClustProtoNum&quot;</span>]) <span class="sc">==</span></span>
<span id="cb144-216"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-216" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">length</span>(<span class="fu">unique</span>(ret[other_rows, <span class="st">&quot;ClustProtoNum&quot;</span>])))</span>
<span id="cb144-217"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-218"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-218" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(ret<span class="sc">$</span>ClustSelProp))</span>
<span id="cb144-219"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-219" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(ret<span class="sc">$</span>ClustSelProp, <span class="fu">sort</span>(ret<span class="sc">$</span>ClustSelProp,</span>
<span id="cb144-220"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-220" aria-hidden="true" tabindex="-1"></a>                                                    <span class="at">decreasing=</span><span class="cn">TRUE</span>))</span>
<span id="cb144-221"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-222"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-222" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.integer</span>(ret<span class="sc">$</span>ClustSize))</span>
<span id="cb144-223"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-223" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(ret[other_rows, <span class="st">&quot;ClustSize&quot;</span>] <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb144-224"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-225"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-225" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="st">&quot;red_cluster&quot;</span> <span class="sc">%in%</span> ret<span class="sc">$</span>ClustName){</span>
<span id="cb144-226"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-226" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_true</span>(ret[ret<span class="sc">$</span>ClustName<span class="sc">==</span><span class="st">&quot;red_cluster&quot;</span>,</span>
<span id="cb144-227"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-227" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;ClustProtoNum&quot;</span>] <span class="sc">%in%</span> 1L<span class="sc">:</span>3L)</span>
<span id="cb144-228"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-228" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_equal</span>(ret[ret<span class="sc">$</span>ClustName<span class="sc">==</span><span class="st">&quot;red_cluster&quot;</span>, <span class="st">&quot;ClustSize&quot;</span>], <span class="dv">3</span>)</span>
<span id="cb144-229"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-229" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb144-230"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-231"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-231" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="st">&quot;green_cluster&quot;</span> <span class="sc">%in%</span> ret<span class="sc">$</span>ClustName){</span>
<span id="cb144-232"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-232" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_true</span>(ret[ret<span class="sc">$</span>ClustName<span class="sc">==</span><span class="st">&quot;green_cluster&quot;</span>,</span>
<span id="cb144-233"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-233" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;ClustProtoNum&quot;</span>] <span class="sc">%in%</span> 4L<span class="sc">:</span>6L)</span>
<span id="cb144-234"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-234" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_equal</span>(ret[ret<span class="sc">$</span>ClustName<span class="sc">==</span><span class="st">&quot;green_cluster&quot;</span>, <span class="st">&quot;ClustSize&quot;</span>], <span class="dv">3</span>)</span>
<span id="cb144-235"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-235" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb144-236"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-237"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-237" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Trying bad inputs</span></span>
<span id="cb144-238"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-239"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-239" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Error has quotation marks in it</span></span>
<span id="cb144-240"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-240" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#printCssDf'>printCssDf</a>(<span class="st">&quot;css_results&quot;</span>))</span>
<span id="cb144-241"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-241" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-242"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-242" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#printCssDf'>printCssDf</a>(css_results, <span class="at">cutoff=</span><span class="sc">-</span>.<span class="dv">1</span>),</span>
<span id="cb144-243"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-243" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;cutoff &gt;= 0 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb144-244"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-244" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-245"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-245" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#printCssDf'>printCssDf</a>(css_results, <span class="at">min_num_clusts=</span><span class="fl">3.2</span>),</span>
<span id="cb144-246"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-246" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;min_num_clusts == round(min_num_clusts) is not TRUE&quot;</span>,</span>
<span id="cb144-247"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-247" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb144-248"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-248" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-249"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-249" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#printCssDf'>printCssDf</a>(css_results, <span class="at">max_num_clusts=</span><span class="st">&quot;5&quot;</span>),</span>
<span id="cb144-250"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-250" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;is.numeric(max_num_clusts) | is.integer(max_num_clusts) is not TRUE&quot;</span>,</span>
<span id="cb144-251"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-251" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb144-252"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb144-252" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## Test passed 🎉</code></pre>
<p>print.cssr</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Print cluster stability selection output</span></span>
<span id="cb146-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb146-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb146-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Print a summary of the information from the css function (using output from</span></span>
<span id="cb146-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb146-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; printCssDf function).</span></span>
<span id="cb146-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb146-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param x An object of class &quot;cssr&quot; (the output of the function css).</span></span>
<span id="cb146-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb146-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param cutoff Numeric; print.cssr will display only those</span></span>
<span id="cb146-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb146-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; clusters with selection proportions equal to at least cutoff. Must be between</span></span>
<span id="cb146-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb146-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; 0 and 1. Default is 0 (in which case either all clusters are displayed, or</span></span>
<span id="cb146-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb146-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; max_num_clusts are, if max_num_clusts is specified).</span></span>
<span id="cb146-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb146-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param min_num_clusts Integer or numeric; the minimum number of clusters to</span></span>
<span id="cb146-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb146-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; use regardless of cutoff. (That is, if the chosen cutoff returns fewer than</span></span>
<span id="cb146-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb146-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; min_num_clusts clusters, the cutoff will be increased until at least</span></span>
<span id="cb146-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb146-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; min_num_clusts clusters are selected.) Default is 1.</span></span>
<span id="cb146-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb146-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param max_num_clusts Integer or numeric; the maximum number of clusters to</span></span>
<span id="cb146-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb146-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; use regardless of cutoff. (That is, if the chosen cutoff returns more than</span></span>
<span id="cb146-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb146-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; max_num_clusts clusters, the cutoff will be decreased until at most</span></span>
<span id="cb146-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb146-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; max_num_clusts clusters are selected.) Default is NA (in which case</span></span>
<span id="cb146-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb146-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; max_num_clusts is ignored).</span></span>
<span id="cb146-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb146-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param ... Additional arguments to generic print.data.frame function</span></span>
<span id="cb146-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb146-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return A data.frame; each row contains a cluster, arranged in decreasing</span></span>
<span id="cb146-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb146-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; order of cluster selection proportion from top to bottom. The columns are</span></span>
<span id="cb146-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb146-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; ClustName (the name of the cluster that was either provided to css or made by</span></span>
<span id="cb146-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb146-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; css if no name was provided); ClustProtoName (the name of the selection</span></span>
<span id="cb146-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb146-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; prototype from the cluster, which is the feature with the greatest individual</span></span>
<span id="cb146-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb146-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; selection proportion among all the cluster members, with ties broken by</span></span>
<span id="cb146-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb146-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; choosing the feature with the highest correlation with the response if the</span></span>
<span id="cb146-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb146-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; response is real-valued; only returned if the features are named),</span></span>
<span id="cb146-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb146-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; ClustProtoNum (the column number of the prototype in the X matrix provided to</span></span>
<span id="cb146-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb146-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; css), and ClustSize (the size of the cluster).</span></span>
<span id="cb146-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb146-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @author Gregory Faletto, Jacob Bien</span></span>
<span id="cb146-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb146-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @export</span></span>
<span id="cb146-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb146-32" aria-hidden="true" tabindex="-1"></a><span id='print.cssr'>print.cssr</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">cutoff=</span><span class="dv">0</span>, <span class="at">min_num_clusts=</span><span class="dv">1</span>, <span class="at">max_num_clusts=</span><span class="cn">NA</span>, ...){</span>
<span id="cb146-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb146-33" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#printCssDf'>printCssDf</a>(<span class="at">css_results=</span>x, <span class="at">cutoff=</span>cutoff,</span>
<span id="cb146-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb146-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">min_num_clusts=</span>min_num_clusts, <span class="at">max_num_clusts=</span>max_num_clusts)</span>
<span id="cb146-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb146-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print.data.frame</span>(df, ...)</span>
<span id="cb146-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb146-36" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="convenient-wrapper-functions" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Convenient Wrapper Functions<a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#convenient-wrapper-functions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Finally, we provide convenient wrapper functions which yield user-desired output in a single step at the price of flexibility and efficiency. cssSelect yields a selected set of clusters and features (the same output as getCssSelections) in a single function call. cssPredict takes in a training/selection data set as well as a test X. It uses the labeled data to select a set of features and train an OLS model on the selected features, and then it generates predictions on the test set using the fitted model.</p>
<p>Besides requiring only a single function call to yield desired output, these wrapper functions also automatically select hyperparameters (lambda used for the lasso, a desired model size, and even selecdtion and training splits for cssPredict) in a sensible way if these values are not provided by the user. So these functions are very convenient for an end user who wants quick results without getting “under the hood.”</p>
<p>The two main disadvantages of these functions are flexibility and computational efficiency. For simplicity of use, these functions do not provide as many options as the component functions they call (for example, min_num_clusts is not an available argument for these models). Further, both of these functions make (computationally intensive) calls to css internally every time they are called, so these functions are not recommended for users who want to tinker with the model size and other parameters. Instead, it would be more efficient to call css once and then work with the output as desired using the other package functions, which are very efficient given the stored output from css.</p>
<p>cssSelect and cssPredict have no new dependencies; they rely only on already-defined functions.</p>
<p>cssSelect:</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Obtain a selected set of clusters and features using cluster stability</span></span>
<span id="cb147-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; selection</span></span>
<span id="cb147-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb147-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Takes in data X and y and returns a set of clusters (and a set of features)</span></span>
<span id="cb147-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; that are useful for predicting y from the data in X. This is a wrapper</span></span>
<span id="cb147-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; function for css and getCssSelections. Using cssSelect is simpler, but it</span></span>
<span id="cb147-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; has fewer options, and it executes the full (computationally expensive)</span></span>
<span id="cb147-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; subsampling procedured every time it is called. In contrast, css can be</span></span>
<span id="cb147-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; called just once, and then getCssSelections can quickly return results using</span></span>
<span id="cb147-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; different values of cutoff, max_num_clusts, etc. from the calculations done</span></span>
<span id="cb147-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; in one call to css.</span></span>
<span id="cb147-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param X An n x p numeric matrix (preferably) or a data.frame (which will</span></span>
<span id="cb147-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; be coerced internally to a matrix by the function model.matrix) containing</span></span>
<span id="cb147-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the p &gt;= 2 features/predictors.</span></span>
<span id="cb147-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param y A length-n numeric vector containing the responses; `y[i]` is the</span></span>
<span id="cb147-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; response corresponding to observation `X[i, ]`. (Note that for the css</span></span>
<span id="cb147-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; function, y does not have to be a numeric response, but for this function,</span></span>
<span id="cb147-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the underlying selection procedure is the lasso, so y must be a real-valued</span></span>
<span id="cb147-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; response.)</span></span>
<span id="cb147-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param clusters Optional; either an integer vector of a list of integer</span></span>
<span id="cb147-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; vectors; each vector should contain the indices of a cluster of features (a</span></span>
<span id="cb147-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; subset of 1:p). (If there is only one cluster, clusters can either be a list</span></span>
<span id="cb147-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; of length 1 or an integer vector.) All of the provided clusters must be</span></span>
<span id="cb147-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; non-overlapping. Every feature not appearing in any cluster will be assumed</span></span>
<span id="cb147-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; to be unclustered (that is, they  will be treated as if they are in a</span></span>
<span id="cb147-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; &quot;cluster&quot; containing only themselves). If clusters is a list of length 0 (or</span></span>
<span id="cb147-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; a list only containing clusters of length 1), then <a href='now-to-the-package-itself.html#css'>css</a>() returns the same</span></span>
<span id="cb147-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; results as stability selection (so feat_sel_mat will be identical to</span></span>
<span id="cb147-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; clus_sel_mat). Names for the clusters will be needed later; any clusters that</span></span>
<span id="cb147-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; are not given names in the list clusters will be given names automatically by</span></span>
<span id="cb147-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; css. Default is list() (so no clusters are specified, and every feature is</span></span>
<span id="cb147-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; assumed to be in a &quot;cluster&quot; containng only itself).</span></span>
<span id="cb147-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param lambda Optional; the tuning parameter to be used by the lasso for</span></span>
<span id="cb147-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; feature selection in each subsample. If lambda is not provided, cssSelect</span></span>
<span id="cb147-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; will choose one automatically by cross-validation. Default is NA.</span></span>
<span id="cb147-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param cutoff Numeric; cssSelect will only select those clusters with</span></span>
<span id="cb147-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; selection proportions equal to at least cutoff. Must be between 0 and 1.</span></span>
<span id="cb147-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Default is NA (in which case max_num_clusts are used).</span></span>
<span id="cb147-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param max_num_clusts Integer or numeric; the maximum number of clusters to</span></span>
<span id="cb147-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; use regardless of cutoff. (That is, if the chosen cutoff returns more than</span></span>
<span id="cb147-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; max_num_clusts clusters, the cutoff will be decreased until at most</span></span>
<span id="cb147-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; max_num_clusts clusters are selected.) Default is NA (in which case</span></span>
<span id="cb147-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; either cutoff is used to choose the number of clusters, or if cutoff was also</span></span>
<span id="cb147-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; unspecified, cssSelect chooses max_num_clusts by cross-validation).</span></span>
<span id="cb147-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param auto_select_size Logical; if TRUE, then max_num_clusts will be</span></span>
<span id="cb147-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; automatically estimated using the lasso with cross-validation. Default is</span></span>
<span id="cb147-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; TRUE, though his argument is ignored if either cutoff or max_num_clusts is</span></span>
<span id="cb147-48"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; provided. (If desired output is to return all clusters, you should set</span></span>
<span id="cb147-49"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; auto_select_size to FALSE and do not provide cutoff or max_num_clusts.)</span></span>
<span id="cb147-50"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return A named list with two items. \item{selected_clusts}{A list of</span></span>
<span id="cb147-51"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; integer vectors; each vector contains the indices of one of the selected</span></span>
<span id="cb147-52"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; clusters.} \item{selected_feats}{An integer vector; the indices of the</span></span>
<span id="cb147-53"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; all of the selected features within all of the selected clusters (typically</span></span>
<span id="cb147-54"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; only one feature is selected from each cluster).}</span></span>
<span id="cb147-55"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @author Gregory Faletto, Jacob Bien</span></span>
<span id="cb147-56"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @export</span></span>
<span id="cb147-57"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-57" aria-hidden="true" tabindex="-1"></a><span id='cssSelect'>cssSelect</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(X, y, <span class="at">clusters =</span> <span class="fu">list</span>(), <span class="at">lambda=</span><span class="cn">NA</span>, <span class="at">cutoff=</span><span class="cn">NA</span>,</span>
<span id="cb147-58"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_num_clusts=</span><span class="cn">NA</span>, <span class="at">auto_select_size=</span><span class="cn">TRUE</span>){</span>
<span id="cb147-59"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-60"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-60" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check inputs (most inputs will be checked by called functions)</span></span>
<span id="cb147-61"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-62"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="sc">!</span><span class="fu">is.na</span>(auto_select_size))</span>
<span id="cb147-63"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(auto_select_size) <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb147-64"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.logical</span>(auto_select_size))</span>
<span id="cb147-65"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-66"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-66" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.matrix</span>(X) <span class="sc">|</span> <span class="fu">is.data.frame</span>(X))</span>
<span id="cb147-67"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-67" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(X)))</span>
<span id="cb147-68"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-69"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-69" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if x is a matrix; if it&#39;s a data.frame, convert to matrix.</span></span>
<span id="cb147-70"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-70" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">is.data.frame</span>(X)){</span>
<span id="cb147-71"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-71" aria-hidden="true" tabindex="-1"></a>        X <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">model.matrix</span>(<span class="sc">~</span> ., X)</span>
<span id="cb147-72"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-72" aria-hidden="true" tabindex="-1"></a>        X <span class="ot">&lt;-</span> X[, <span class="fu">colnames</span>(X) <span class="sc">!=</span> <span class="st">&quot;(Intercept)&quot;</span>]</span>
<span id="cb147-73"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-73" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb147-74"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-75"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-75" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.matrix</span>(X))</span>
<span id="cb147-76"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-76" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(X)))</span>
<span id="cb147-77"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-78"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-78" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.numeric</span>(y) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.integer</span>(y)){</span>
<span id="cb147-79"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-79" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stop</span>(<span class="st">&quot;The provided y must be real-valued, because cssSelect uses the lasso for feature selection. (In order to use a different form of response, use the css function and provide your own selection function accommodating your choice of y.)&quot;</span>)</span>
<span id="cb147-80"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-80" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb147-81"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-82"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-82" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(lambda) <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb147-83"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-83" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">is.na</span>(lambda)){</span>
<span id="cb147-84"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-84" aria-hidden="true" tabindex="-1"></a>        lambda <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getLassoLambda'>getLassoLambda</a>(X, y)</span>
<span id="cb147-85"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-85" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb147-86"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-87"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-87" aria-hidden="true" tabindex="-1"></a>    css_results <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(X, y, lambda, clusters)</span>
<span id="cb147-88"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-89"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-89" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If no indication of how to select model size was provided, choose model</span></span>
<span id="cb147-90"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-90" aria-hidden="true" tabindex="-1"></a>    <span class="co"># size by cross-validation</span></span>
<span id="cb147-91"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-91" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">is.na</span>(cutoff) <span class="sc">&amp;</span> <span class="fu">is.na</span>(max_num_clusts)){</span>
<span id="cb147-92"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-92" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(auto_select_size){</span>
<span id="cb147-93"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-93" aria-hidden="true" tabindex="-1"></a>            max_num_clusts <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getModelSize'>getModelSize</a>(X, y, css_results<span class="sc">$</span>clusters)</span>
<span id="cb147-94"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-94" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb147-95"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-95" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb147-96"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-97"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-97" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">is.na</span>(cutoff)){</span>
<span id="cb147-98"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-98" aria-hidden="true" tabindex="-1"></a>        cutoff <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb147-99"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-99" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb147-100"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-101"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-101" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get selected features</span></span>
<span id="cb147-102"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-102" aria-hidden="true" tabindex="-1"></a>    <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssSelections'>getCssSelections</a>(css_results, <span class="at">weighting=</span><span class="st">&quot;sparse&quot;</span>, <span class="at">cutoff=</span>cutoff,</span>
<span id="cb147-103"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-103" aria-hidden="true" tabindex="-1"></a>        <span class="at">min_num_clusts=</span><span class="dv">1</span>, <span class="at">max_num_clusts=</span>max_num_clusts)</span>
<span id="cb147-104"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb147-104" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Tests for cssSelect:</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-1" aria-hidden="true" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">test_that</span>(<span class="st">&quot;cssSelect works&quot;</span>, {</span>
<span id="cb148-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">73212</span>)</span>
<span id="cb148-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-4" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#genClusteredData'>genClusteredData</a>(<span class="at">n=</span><span class="dv">15</span>, <span class="at">p=</span><span class="dv">11</span>, <span class="at">k_unclustered=</span><span class="dv">1</span>, <span class="at">cluster_size=</span><span class="dv">3</span>,</span>
<span id="cb148-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">n_clusters=</span><span class="dv">2</span>, <span class="at">sig_clusters=</span><span class="dv">1</span>, <span class="at">sigma_eps_sq=</span><span class="dv">1</span>)</span>
<span id="cb148-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-7" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> data<span class="sc">$</span>X</span>
<span id="cb148-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-8" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> data<span class="sc">$</span>y</span>
<span id="cb148-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Intentionally don&#39;t provide clusters for all features, mix up formatting,</span></span>
<span id="cb148-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># etc.</span></span>
<span id="cb148-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-12" aria-hidden="true" tabindex="-1"></a>  good_clusters <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">red_cluster=</span>1L<span class="sc">:</span>3L, <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb148-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-14" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssSelect'>cssSelect</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">clusters=</span>good_clusters)</span>
<span id="cb148-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-16" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res))</span>
<span id="cb148-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-17" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), <span class="dv">2</span>)</span>
<span id="cb148-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-18" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(res), <span class="fu">c</span>(<span class="st">&quot;selected_clusts&quot;</span>, <span class="st">&quot;selected_feats&quot;</span>))</span>
<span id="cb148-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-20" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="sc">!</span><span class="fu">is.null</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts)))</span>
<span id="cb148-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-21" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.character</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts)))</span>
<span id="cb148-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-22" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_clusts) <span class="sc">&lt;=</span></span>
<span id="cb148-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-23" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">length</span>(res<span class="sc">$</span>selected_feats))</span>
<span id="cb148-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Total of 11 - 2*(3 - 1) = 7 clusters</span></span>
<span id="cb148-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-25" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_clusts) <span class="sc">&lt;=</span> <span class="dv">7</span>)</span>
<span id="cb148-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-26" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_clusts) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb148-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-28" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res<span class="sc">$</span>selected_clusts))</span>
<span id="cb148-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-29" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts)),</span>
<span id="cb148-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-30" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts))))</span>
<span id="cb148-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-31" aria-hidden="true" tabindex="-1"></a>  already_used_feats <span class="ot">&lt;-</span> <span class="fu">integer</span>()</span>
<span id="cb148-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-32" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(res<span class="sc">$</span>selected_clusts)){</span>
<span id="cb148-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-33" aria-hidden="true" tabindex="-1"></a>    sels_i <span class="ot">&lt;-</span> res<span class="sc">$</span>selected_clusts[[i]]</span>
<span id="cb148-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-34" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(sels_i) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb148-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-35" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.integer</span>(sels_i))</span>
<span id="cb148-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-36" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(sels_i <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>))</span>
<span id="cb148-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-37" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(sels_i), <span class="fu">length</span>(<span class="fu">unique</span>(sels_i)))</span>
<span id="cb148-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-38" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">intersect</span>(already_used_feats, sels_i)), <span class="dv">0</span>)</span>
<span id="cb148-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-39" aria-hidden="true" tabindex="-1"></a>    already_used_feats <span class="ot">&lt;-</span> <span class="fu">c</span>(already_used_feats, sels_i)</span>
<span id="cb148-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-40" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb148-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-41" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(already_used_feats) <span class="sc">&lt;=</span> <span class="dv">11</span>)</span>
<span id="cb148-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-42" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(already_used_feats),</span>
<span id="cb148-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-43" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">length</span>(<span class="fu">unique</span>(already_used_feats)))</span>
<span id="cb148-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-44" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(already_used_feats <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>))</span>
<span id="cb148-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-46" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_feats) <span class="sc">&lt;=</span> <span class="dv">11</span>)</span>
<span id="cb148-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-47" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.integer</span>(res<span class="sc">$</span>selected_feats))</span>
<span id="cb148-48"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-48" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_feats) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb148-49"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-49" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_feats)),</span>
<span id="cb148-50"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-50" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_feats))))</span>
<span id="cb148-51"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-51" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(res<span class="sc">$</span>selected_feats <span class="sc">&gt;=</span> <span class="dv">1</span>))</span>
<span id="cb148-52"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-52" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(res<span class="sc">$</span>selected_feats <span class="sc">&lt;=</span> <span class="dv">11</span>))</span>
<span id="cb148-53"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-53" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_feats),</span>
<span id="cb148-54"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-54" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">length</span>(<span class="fu">unique</span>(res<span class="sc">$</span>selected_feats)))</span>
<span id="cb148-55"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-56"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-56" aria-hidden="true" tabindex="-1"></a>  <span class="co"># No provided clusters</span></span>
<span id="cb148-57"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-58"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-58" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssSelect'>cssSelect</a>(<span class="at">X=</span>x, <span class="at">y=</span>y)</span>
<span id="cb148-59"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-60"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-60" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res))</span>
<span id="cb148-61"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-61" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), <span class="dv">2</span>)</span>
<span id="cb148-62"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-62" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(res), <span class="fu">c</span>(<span class="st">&quot;selected_clusts&quot;</span>, <span class="st">&quot;selected_feats&quot;</span>))</span>
<span id="cb148-63"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-63" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-64"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-64" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="sc">!</span><span class="fu">is.null</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts)))</span>
<span id="cb148-65"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-65" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.character</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts)))</span>
<span id="cb148-66"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-66" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_clusts) <span class="sc">&lt;=</span></span>
<span id="cb148-67"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-67" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">length</span>(res<span class="sc">$</span>selected_feats))</span>
<span id="cb148-68"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-69"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-69" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_clusts) <span class="sc">&lt;=</span> <span class="dv">11</span>)</span>
<span id="cb148-70"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-70" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_clusts) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb148-71"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-72"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-72" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res<span class="sc">$</span>selected_clusts))</span>
<span id="cb148-73"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-73" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts)),</span>
<span id="cb148-74"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-74" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts))))</span>
<span id="cb148-75"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-75" aria-hidden="true" tabindex="-1"></a>  already_used_feats <span class="ot">&lt;-</span> <span class="fu">integer</span>()</span>
<span id="cb148-76"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-76" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(res<span class="sc">$</span>selected_clusts)){</span>
<span id="cb148-77"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-77" aria-hidden="true" tabindex="-1"></a>    sels_i <span class="ot">&lt;-</span> res<span class="sc">$</span>selected_clusts[[i]]</span>
<span id="cb148-78"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-78" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(sels_i) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb148-79"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-79" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.integer</span>(sels_i))</span>
<span id="cb148-80"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-80" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(sels_i <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>))</span>
<span id="cb148-81"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-81" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(sels_i), <span class="fu">length</span>(<span class="fu">unique</span>(sels_i)))</span>
<span id="cb148-82"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-82" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">intersect</span>(already_used_feats, sels_i)), <span class="dv">0</span>)</span>
<span id="cb148-83"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-83" aria-hidden="true" tabindex="-1"></a>    already_used_feats <span class="ot">&lt;-</span> <span class="fu">c</span>(already_used_feats, sels_i)</span>
<span id="cb148-84"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-84" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb148-85"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-85" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(already_used_feats) <span class="sc">&lt;=</span> <span class="dv">11</span>)</span>
<span id="cb148-86"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-86" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(already_used_feats),</span>
<span id="cb148-87"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-87" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">length</span>(<span class="fu">unique</span>(already_used_feats)))</span>
<span id="cb148-88"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-88" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(already_used_feats <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>))</span>
<span id="cb148-89"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-89" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-90"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-90" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_feats) <span class="sc">&lt;=</span> <span class="dv">11</span>)</span>
<span id="cb148-91"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-91" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.integer</span>(res<span class="sc">$</span>selected_feats))</span>
<span id="cb148-92"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-92" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_feats) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb148-93"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-93" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_feats)),</span>
<span id="cb148-94"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-94" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_feats))))</span>
<span id="cb148-95"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-95" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(res<span class="sc">$</span>selected_feats <span class="sc">&gt;=</span> <span class="dv">1</span>))</span>
<span id="cb148-96"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-96" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(res<span class="sc">$</span>selected_feats <span class="sc">&lt;=</span> <span class="dv">11</span>))</span>
<span id="cb148-97"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-97" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_feats),</span>
<span id="cb148-98"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-98" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">length</span>(<span class="fu">unique</span>(res<span class="sc">$</span>selected_feats)))</span>
<span id="cb148-99"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-100"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-100" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Trying other inputs</span></span>
<span id="cb148-101"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-102"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-102" aria-hidden="true" tabindex="-1"></a>  <span class="co"># X as a data.frame</span></span>
<span id="cb148-103"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-103" aria-hidden="true" tabindex="-1"></a>  X_df <span class="ot">&lt;-</span> datasets<span class="sc">::</span>mtcars</span>
<span id="cb148-104"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-104" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-105"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-105" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssSelect'>cssSelect</a>(<span class="at">X=</span>X_df, <span class="at">y=</span>stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="fu">nrow</span>(X_df)), <span class="at">clusters=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb148-106"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-106" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-107"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-107" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res))</span>
<span id="cb148-108"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-108" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), <span class="dv">2</span>)</span>
<span id="cb148-109"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-109" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(res), <span class="fu">c</span>(<span class="st">&quot;selected_clusts&quot;</span>, <span class="st">&quot;selected_feats&quot;</span>))</span>
<span id="cb148-110"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-110" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-111"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-111" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="sc">!</span><span class="fu">is.null</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts)))</span>
<span id="cb148-112"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-112" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.character</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts)))</span>
<span id="cb148-113"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-113" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_clusts) <span class="sc">&lt;=</span></span>
<span id="cb148-114"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-114" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">length</span>(res<span class="sc">$</span>selected_feats))</span>
<span id="cb148-115"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-115" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Total of ncol(X_df) - (3 - 1) clusters</span></span>
<span id="cb148-116"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-116" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_clusts) <span class="sc">&lt;=</span> <span class="fu">ncol</span>(X_df) <span class="sc">-</span> <span class="dv">2</span>)</span>
<span id="cb148-117"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-117" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_clusts) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb148-118"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-119"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-119" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res<span class="sc">$</span>selected_clusts))</span>
<span id="cb148-120"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-120" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts)),</span>
<span id="cb148-121"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-121" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts))))</span>
<span id="cb148-122"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-122" aria-hidden="true" tabindex="-1"></a>  already_used_feats <span class="ot">&lt;-</span> <span class="fu">integer</span>()</span>
<span id="cb148-123"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-123" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(res<span class="sc">$</span>selected_clusts)){</span>
<span id="cb148-124"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-124" aria-hidden="true" tabindex="-1"></a>    sels_i <span class="ot">&lt;-</span> res<span class="sc">$</span>selected_clusts[[i]]</span>
<span id="cb148-125"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-125" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(sels_i) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb148-126"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-126" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.integer</span>(sels_i))</span>
<span id="cb148-127"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-127" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(sels_i <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(X_df)))</span>
<span id="cb148-128"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-128" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(sels_i), <span class="fu">length</span>(<span class="fu">unique</span>(sels_i)))</span>
<span id="cb148-129"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-129" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">intersect</span>(already_used_feats, sels_i)), <span class="dv">0</span>)</span>
<span id="cb148-130"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-130" aria-hidden="true" tabindex="-1"></a>    already_used_feats <span class="ot">&lt;-</span> <span class="fu">c</span>(already_used_feats, sels_i)</span>
<span id="cb148-131"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-131" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb148-132"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-132" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(already_used_feats) <span class="sc">&lt;=</span> <span class="fu">ncol</span>(X_df))</span>
<span id="cb148-133"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-133" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(already_used_feats),</span>
<span id="cb148-134"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-134" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">length</span>(<span class="fu">unique</span>(already_used_feats)))</span>
<span id="cb148-135"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-135" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(already_used_feats <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(X_df)))</span>
<span id="cb148-136"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-137"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-137" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_feats) <span class="sc">&lt;=</span> <span class="fu">ncol</span>(X_df))</span>
<span id="cb148-138"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-138" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.integer</span>(res<span class="sc">$</span>selected_feats))</span>
<span id="cb148-139"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-139" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_feats) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb148-140"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-140" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_feats)),</span>
<span id="cb148-141"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-141" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_feats))))</span>
<span id="cb148-142"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-142" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(res<span class="sc">$</span>selected_feats <span class="sc">&gt;=</span> <span class="dv">1</span>))</span>
<span id="cb148-143"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-143" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(res<span class="sc">$</span>selected_feats <span class="sc">&lt;=</span> <span class="fu">ncol</span>(X_df)))</span>
<span id="cb148-144"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-144" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_feats),</span>
<span id="cb148-145"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-145" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">length</span>(<span class="fu">unique</span>(res<span class="sc">$</span>selected_feats)))</span>
<span id="cb148-146"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-147"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-147" aria-hidden="true" tabindex="-1"></a>  <span class="co"># X as a dataframe with factors (number of columns of final design matrix</span></span>
<span id="cb148-148"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-148" aria-hidden="true" tabindex="-1"></a>  <span class="co"># after one-hot encoding factors won&#39;t match number of columns of df2)</span></span>
<span id="cb148-149"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-149" aria-hidden="true" tabindex="-1"></a>  df2 <span class="ot">&lt;-</span> X_df</span>
<span id="cb148-150"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-150" aria-hidden="true" tabindex="-1"></a>  df2<span class="sc">$</span>cyl <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df2<span class="sc">$</span>cyl)</span>
<span id="cb148-151"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-151" aria-hidden="true" tabindex="-1"></a>  df2<span class="sc">$</span>vs <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df2<span class="sc">$</span>vs)</span>
<span id="cb148-152"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-152" aria-hidden="true" tabindex="-1"></a>  df2<span class="sc">$</span>am <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df2<span class="sc">$</span>am)</span>
<span id="cb148-153"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-153" aria-hidden="true" tabindex="-1"></a>  df2<span class="sc">$</span>gear <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df2<span class="sc">$</span>gear)</span>
<span id="cb148-154"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-154" aria-hidden="true" tabindex="-1"></a>  df2<span class="sc">$</span>carb <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df2<span class="sc">$</span>carb)</span>
<span id="cb148-155"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-155" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-156"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-156" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssSelect'>cssSelect</a>(<span class="at">X=</span>df2, <span class="at">y=</span>stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="fu">nrow</span>(X_df)), <span class="at">clusters=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb148-157"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-157" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-158"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-158" aria-hidden="true" tabindex="-1"></a>  X_df_mat <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">model.matrix</span>(<span class="sc">~</span> ., df2)</span>
<span id="cb148-159"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-159" aria-hidden="true" tabindex="-1"></a>  X_df_mat <span class="ot">&lt;-</span> X_df_mat[, <span class="fu">colnames</span>(X_df_mat) <span class="sc">!=</span> <span class="st">&quot;(Intercept)&quot;</span>]</span>
<span id="cb148-160"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-160" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ncol</span>(X_df_mat)</span>
<span id="cb148-161"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-161" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-162"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-162" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res))</span>
<span id="cb148-163"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-163" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), <span class="dv">2</span>)</span>
<span id="cb148-164"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-164" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(res), <span class="fu">c</span>(<span class="st">&quot;selected_clusts&quot;</span>, <span class="st">&quot;selected_feats&quot;</span>))</span>
<span id="cb148-165"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-165" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-166"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-166" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="sc">!</span><span class="fu">is.null</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts)))</span>
<span id="cb148-167"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-167" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.character</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts)))</span>
<span id="cb148-168"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-168" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_clusts) <span class="sc">&lt;=</span></span>
<span id="cb148-169"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-169" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">length</span>(res<span class="sc">$</span>selected_feats))</span>
<span id="cb148-170"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-170" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Total of p - (3 - 1) clusters</span></span>
<span id="cb148-171"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-171" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_clusts) <span class="sc">&lt;=</span> p <span class="sc">-</span> <span class="dv">2</span>)</span>
<span id="cb148-172"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-172" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_clusts) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb148-173"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-174"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-174" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res<span class="sc">$</span>selected_clusts))</span>
<span id="cb148-175"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-175" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts)),</span>
<span id="cb148-176"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-176" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts))))</span>
<span id="cb148-177"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-177" aria-hidden="true" tabindex="-1"></a>  already_used_feats <span class="ot">&lt;-</span> <span class="fu">integer</span>()</span>
<span id="cb148-178"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-178" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(res<span class="sc">$</span>selected_clusts)){</span>
<span id="cb148-179"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-179" aria-hidden="true" tabindex="-1"></a>    sels_i <span class="ot">&lt;-</span> res<span class="sc">$</span>selected_clusts[[i]]</span>
<span id="cb148-180"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-180" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(sels_i) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb148-181"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-181" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.integer</span>(sels_i))</span>
<span id="cb148-182"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-182" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(sels_i <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span>p))</span>
<span id="cb148-183"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-183" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(sels_i), <span class="fu">length</span>(<span class="fu">unique</span>(sels_i)))</span>
<span id="cb148-184"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-184" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">intersect</span>(already_used_feats, sels_i)), <span class="dv">0</span>)</span>
<span id="cb148-185"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-185" aria-hidden="true" tabindex="-1"></a>    already_used_feats <span class="ot">&lt;-</span> <span class="fu">c</span>(already_used_feats, sels_i)</span>
<span id="cb148-186"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-186" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb148-187"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-187" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(already_used_feats) <span class="sc">&lt;=</span> p)</span>
<span id="cb148-188"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-188" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(already_used_feats),</span>
<span id="cb148-189"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-189" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">length</span>(<span class="fu">unique</span>(already_used_feats)))</span>
<span id="cb148-190"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-190" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(already_used_feats <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span>p))</span>
<span id="cb148-191"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-192"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-192" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_feats) <span class="sc">&lt;=</span> p)</span>
<span id="cb148-193"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-193" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.integer</span>(res<span class="sc">$</span>selected_feats))</span>
<span id="cb148-194"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-194" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_feats) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb148-195"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-195" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_feats)),</span>
<span id="cb148-196"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-196" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_feats))))</span>
<span id="cb148-197"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-197" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(res<span class="sc">$</span>selected_feats <span class="sc">&gt;=</span> <span class="dv">1</span>))</span>
<span id="cb148-198"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-198" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(res<span class="sc">$</span>selected_feats <span class="sc">&lt;=</span> p))</span>
<span id="cb148-199"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-199" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_feats),</span>
<span id="cb148-200"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-200" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">length</span>(<span class="fu">unique</span>(res<span class="sc">$</span>selected_feats)))</span>
<span id="cb148-201"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-202"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-203"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-203" aria-hidden="true" tabindex="-1"></a>  <span class="co"># X as a matrix with column names</span></span>
<span id="cb148-204"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-204" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> x</span>
<span id="cb148-205"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-205" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(x2) <span class="ot">&lt;-</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>]</span>
<span id="cb148-206"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-206" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-207"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-207" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssSelect'>cssSelect</a>(<span class="at">X=</span>x2, <span class="at">y=</span>y, <span class="at">clusters=</span>good_clusters)</span>
<span id="cb148-208"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-208" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-209"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-209" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res))</span>
<span id="cb148-210"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-210" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), <span class="dv">2</span>)</span>
<span id="cb148-211"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-211" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(res), <span class="fu">c</span>(<span class="st">&quot;selected_clusts&quot;</span>, <span class="st">&quot;selected_feats&quot;</span>))</span>
<span id="cb148-212"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-212" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-213"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-213" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="sc">!</span><span class="fu">is.null</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts)))</span>
<span id="cb148-214"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-214" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.character</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts)))</span>
<span id="cb148-215"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-215" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_clusts) <span class="sc">&lt;=</span></span>
<span id="cb148-216"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-216" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">length</span>(res<span class="sc">$</span>selected_feats))</span>
<span id="cb148-217"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-217" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Total of 11 - 2*(3 - 1) = 7 clusters</span></span>
<span id="cb148-218"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-218" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_clusts) <span class="sc">&lt;=</span> <span class="dv">7</span>)</span>
<span id="cb148-219"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-219" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_clusts) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb148-220"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-221"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-221" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res<span class="sc">$</span>selected_clusts))</span>
<span id="cb148-222"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-222" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts)),</span>
<span id="cb148-223"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-223" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts))))</span>
<span id="cb148-224"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-224" aria-hidden="true" tabindex="-1"></a>  already_used_feats <span class="ot">&lt;-</span> <span class="fu">integer</span>()</span>
<span id="cb148-225"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-225" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(res<span class="sc">$</span>selected_clusts)){</span>
<span id="cb148-226"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-226" aria-hidden="true" tabindex="-1"></a>    sels_i <span class="ot">&lt;-</span> res<span class="sc">$</span>selected_clusts[[i]]</span>
<span id="cb148-227"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-227" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(sels_i) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb148-228"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-228" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.integer</span>(sels_i))</span>
<span id="cb148-229"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-229" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(sels_i <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>))</span>
<span id="cb148-230"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-230" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(sels_i), <span class="fu">length</span>(<span class="fu">unique</span>(sels_i)))</span>
<span id="cb148-231"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-231" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">intersect</span>(already_used_feats, sels_i)), <span class="dv">0</span>)</span>
<span id="cb148-232"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-232" aria-hidden="true" tabindex="-1"></a>    already_used_feats <span class="ot">&lt;-</span> <span class="fu">c</span>(already_used_feats, sels_i)</span>
<span id="cb148-233"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-233" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb148-234"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-234" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(already_used_feats) <span class="sc">&lt;=</span> <span class="dv">11</span>)</span>
<span id="cb148-235"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-235" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(already_used_feats),</span>
<span id="cb148-236"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-236" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">length</span>(<span class="fu">unique</span>(already_used_feats)))</span>
<span id="cb148-237"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-237" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(already_used_feats <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>))</span>
<span id="cb148-238"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-238" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-239"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-239" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_feats) <span class="sc">&lt;=</span> <span class="dv">11</span>)</span>
<span id="cb148-240"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-240" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.integer</span>(res<span class="sc">$</span>selected_feats))</span>
<span id="cb148-241"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-241" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_feats) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb148-242"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-242" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_feats)),</span>
<span id="cb148-243"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-243" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_feats))))</span>
<span id="cb148-244"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-244" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(res<span class="sc">$</span>selected_feats <span class="sc">&gt;=</span> <span class="dv">1</span>))</span>
<span id="cb148-245"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-245" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(res<span class="sc">$</span>selected_feats <span class="sc">&lt;=</span> <span class="dv">11</span>))</span>
<span id="cb148-246"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-246" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_feats),</span>
<span id="cb148-247"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-247" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">length</span>(<span class="fu">unique</span>(res<span class="sc">$</span>selected_feats)))</span>
<span id="cb148-248"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-248" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-249"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-249" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Vary inputs</span></span>
<span id="cb148-250"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-250" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssSelect'>cssSelect</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">clusters=</span>good_clusters, <span class="at">lambda=</span><span class="fl">0.01</span>)</span>
<span id="cb148-251"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-251" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-252"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-252" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res))</span>
<span id="cb148-253"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-253" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), <span class="dv">2</span>)</span>
<span id="cb148-254"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-254" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(res), <span class="fu">c</span>(<span class="st">&quot;selected_clusts&quot;</span>, <span class="st">&quot;selected_feats&quot;</span>))</span>
<span id="cb148-255"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-255" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-256"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-256" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssSelect'>cssSelect</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">clusters=</span>good_clusters, <span class="at">cutoff=</span><span class="fl">0.6</span>)</span>
<span id="cb148-257"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-257" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-258"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-258" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res))</span>
<span id="cb148-259"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-259" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), <span class="dv">2</span>)</span>
<span id="cb148-260"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-260" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(res), <span class="fu">c</span>(<span class="st">&quot;selected_clusts&quot;</span>, <span class="st">&quot;selected_feats&quot;</span>))</span>
<span id="cb148-261"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-261" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-262"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-262" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssSelect'>cssSelect</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">clusters=</span>good_clusters, <span class="at">max_num_clusts=</span><span class="dv">6</span>)</span>
<span id="cb148-263"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-263" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-264"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-264" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res))</span>
<span id="cb148-265"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-265" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), <span class="dv">2</span>)</span>
<span id="cb148-266"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-266" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(res), <span class="fu">c</span>(<span class="st">&quot;selected_clusts&quot;</span>, <span class="st">&quot;selected_feats&quot;</span>))</span>
<span id="cb148-267"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-267" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_clusts) <span class="sc">&lt;=</span> <span class="dv">6</span>)</span>
<span id="cb148-268"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-268" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-269"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-269" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssSelect'>cssSelect</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">clusters=</span>good_clusters, <span class="at">auto_select_size=</span><span class="cn">FALSE</span>)</span>
<span id="cb148-270"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-271"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-271" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res))</span>
<span id="cb148-272"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-272" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), <span class="dv">2</span>)</span>
<span id="cb148-273"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-273" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(res), <span class="fu">c</span>(<span class="st">&quot;selected_clusts&quot;</span>, <span class="st">&quot;selected_feats&quot;</span>))</span>
<span id="cb148-274"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-274" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Total of 11 - 2*(3 - 1) = 7 clusters</span></span>
<span id="cb148-275"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-275" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_clusts), <span class="dv">7</span>)</span>
<span id="cb148-276"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-276" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-277"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-277" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Bad inputs</span></span>
<span id="cb148-278"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-278" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssSelect'>cssSelect</a>(<span class="at">X=</span>x[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, ], <span class="at">y=</span>y),</span>
<span id="cb148-279"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-279" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;n == length(y) is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb148-280"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-280" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-281"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-281" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssSelect'>cssSelect</a>(<span class="at">X=</span><span class="fu">character</span>(<span class="dv">5</span>), <span class="at">y=</span>y),</span>
<span id="cb148-282"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-282" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;is.matrix(X) | is.data.frame(X) is not TRUE&quot;</span>,</span>
<span id="cb148-283"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-283" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb148-284"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-284" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-285"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-285" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssSelect'>cssSelect</a>(<span class="at">X=</span>x, <span class="at">y=</span><span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>, <span class="dv">5</span>, <span class="dv">3</span>)),</span>
<span id="cb148-286"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-286" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;!is.matrix(y) is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb148-287"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-287" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-288"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-288" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssSelect'>cssSelect</a>(<span class="at">X=</span>x, <span class="at">y=</span><span class="fu">factor</span>(<span class="fu">rbinom</span>(<span class="dv">15</span>, <span class="at">size=</span><span class="dv">1</span>, <span class="at">prob=</span>.<span class="dv">5</span>))),</span>
<span id="cb148-289"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-289" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;The provided y must be real-valued, because cssSelect uses the lasso for feature selection. (In order to use a different form of response, use the css function and provide your own selection function accommodating your choice of y.)&quot;</span>,</span>
<span id="cb148-290"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-290" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb148-291"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-291" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-292"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-292" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssSelect'>cssSelect</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">clusters=</span><span class="st">&quot;clusters&quot;</span>),</span>
<span id="cb148-293"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-293" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;is.numeric(clusters) | is.integer(clusters) is not TRUE&quot;</span>,</span>
<span id="cb148-294"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-294" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb148-295"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-295" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-296"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-296" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssSelect'>cssSelect</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">lambda=</span><span class="sc">-</span>.<span class="dv">1</span>),</span>
<span id="cb148-297"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-297" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;For method cssLasso, lambda must be nonnegative.&quot;</span>,</span>
<span id="cb148-298"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-298" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb148-299"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-299" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-300"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-300" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssSelect'>cssSelect</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">cutoff=</span><span class="fl">1.1</span>),</span>
<span id="cb148-301"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-301" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;cutoff &lt;= 1 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb148-302"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-302" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-303"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-303" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssSelect'>cssSelect</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">max_num_clusts=</span><span class="dv">1000</span>),</span>
<span id="cb148-304"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-304" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;max_num_clusts &lt;= p is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb148-305"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-305" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-306"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-306" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssSelect'>cssSelect</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">auto_select_size=</span><span class="dv">1</span>),</span>
<span id="cb148-307"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-307" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;is.logical(auto_select_size) is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb148-308"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb148-308" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## ── Warning (&#39;&lt;text&gt;:14&#39;): cssSelect works ──────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssSelect'>cssSelect</a>(X = x, y = y, clusters = good_clusters)
##  2. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getLassoLambda'>getLassoLambda</a>(X, y)
##  3. glmnet::cv.glmnet(...)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:14&#39;): cssSelect works ──────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssSelect'>cssSelect</a>(X = x, y = y, clusters = good_clusters)
##  2. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getModelSize'>getModelSize</a>(X, y, css_results$clusters)
##  3. glmnet::cv.glmnet(x = X_size, y = y, family = &quot;gaussian&quot;)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:58&#39;): cssSelect works ──────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssSelect'>cssSelect</a>(X = x, y = y)
##  2. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getLassoLambda'>getLassoLambda</a>(X, y)
##  3. glmnet::cv.glmnet(...)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:58&#39;): cssSelect works ──────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssSelect'>cssSelect</a>(X = x, y = y)
##  2. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getModelSize'>getModelSize</a>(X, y, css_results$clusters)
##  3. glmnet::cv.glmnet(x = X_size, y = y, family = &quot;gaussian&quot;)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:105&#39;): cssSelect works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssSelect'>cssSelect</a>(X = X_df, y = stats::rnorm(nrow(X_df)), clusters = 1:3)
##  2. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getLassoLambda'>getLassoLambda</a>(X, y)
##  3. glmnet::cv.glmnet(...)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:105&#39;): cssSelect works ─────────────────────────────────────
## Returning more than max_num_clusts = 1 clusters because increasing the cutoff any further would require returning 0 clusters
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssSelect'>cssSelect</a>(X = X_df, y = stats::rnorm(nrow(X_df)), clusters = 1:3)
##  2. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssSelections'>getCssSelections</a>(...)
##  3. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getSelectedClusters'>getSelectedClusters</a>(...)
##  4. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#checkSelectedClusters'>checkSelectedClusters</a>(...)
## 
## ── Warning (&#39;&lt;text&gt;:156&#39;): cssSelect works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssSelect'>cssSelect</a>(X = df2, y = stats::rnorm(nrow(X_df)), clusters = 1:3)
##  2. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getLassoLambda'>getLassoLambda</a>(X, y)
##  3. glmnet::cv.glmnet(...)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:207&#39;): cssSelect works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssSelect'>cssSelect</a>(X = x2, y = y, clusters = good_clusters)
##  2. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getLassoLambda'>getLassoLambda</a>(X, y)
##  3. glmnet::cv.glmnet(...)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:207&#39;): cssSelect works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssSelect'>cssSelect</a>(X = x2, y = y, clusters = good_clusters)
##  2. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getModelSize'>getModelSize</a>(X, y, css_results$clusters)
##  3. glmnet::cv.glmnet(x = X_size, y = y, family = &quot;gaussian&quot;)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:250&#39;): cssSelect works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssSelect'>cssSelect</a>(X = x, y = y, clusters = good_clusters, lambda = 0.01)
##  2. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getModelSize'>getModelSize</a>(X, y, css_results$clusters)
##  3. glmnet::cv.glmnet(x = X_size, y = y, family = &quot;gaussian&quot;)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:256&#39;): cssSelect works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssSelect'>cssSelect</a>(X = x, y = y, clusters = good_clusters, cutoff = 0.6)
##  2. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getLassoLambda'>getLassoLambda</a>(X, y)
##  3. glmnet::cv.glmnet(...)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:262&#39;): cssSelect works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssSelect'>cssSelect</a>(X = x, y = y, clusters = good_clusters, max_num_clusts = 6)
##  2. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getLassoLambda'>getLassoLambda</a>(X, y)
##  3. glmnet::cv.glmnet(...)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:269&#39;): cssSelect works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssSelect'>cssSelect</a>(X = x, y = y, clusters = good_clusters, auto_select_size = FALSE)
##  2. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getLassoLambda'>getLassoLambda</a>(X, y)
##  3. glmnet::cv.glmnet(...)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:285&#39;): cssSelect works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##   1. testthat::expect_error(...)
##   7. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssSelect'>cssSelect</a>(X = x, y = matrix(1:15, 5, 3))
##   8. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getLassoLambda'>getLassoLambda</a>(X, y)
##   9. glmnet::cv.glmnet(...)
##  10. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:292&#39;): cssSelect works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##   1. testthat::expect_error(...)
##   7. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssSelect'>cssSelect</a>(X = x, y = y, clusters = &quot;clusters&quot;)
##   8. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getLassoLambda'>getLassoLambda</a>(X, y)
##   9. glmnet::cv.glmnet(...)
##  10. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:300&#39;): cssSelect works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##   1. testthat::expect_error(...)
##   7. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssSelect'>cssSelect</a>(X = x, y = y, cutoff = 1.1)
##   8. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getLassoLambda'>getLassoLambda</a>(X, y)
##   9. glmnet::cv.glmnet(...)
##  10. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:303&#39;): cssSelect works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##   1. testthat::expect_error(...)
##   7. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssSelect'>cssSelect</a>(X = x, y = y, max_num_clusts = 1000)
##   8. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getLassoLambda'>getLassoLambda</a>(X, y)
##   9. glmnet::cv.glmnet(...)
##  10. glmnet:::cv.glmnet.raw(...)</code></pre>
<p>cssPredict:</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Wrapper function to generate predictions from cluster stability selected</span></span>
<span id="cb150-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; model in one step</span></span>
<span id="cb150-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb150-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Select clusters using cluster stability selection, form cluster</span></span>
<span id="cb150-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; representatives, fit a linear model, and generate predictions from a matrix</span></span>
<span id="cb150-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; of unlabeled data. This is a wrapper function for css and getCssPreds. Using</span></span>
<span id="cb150-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; cssPredict is simpler, but it has fewer options, and it executes the full</span></span>
<span id="cb150-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; (computationally expensive) subsampling procedured every time it is called.</span></span>
<span id="cb150-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; In contrast, css can be called just once, and then cssPredict can quickly</span></span>
<span id="cb150-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; return results for different matrices of new data or using different values</span></span>
<span id="cb150-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; of cutoff, max_num_clusts, etc. by using the calculations done in one call to</span></span>
<span id="cb150-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; css.</span></span>
<span id="cb150-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb150-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param X_train_selec An n x p numeric matrix (preferably) or a data.frame</span></span>
<span id="cb150-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; (which will be coerced internally to a matrix by the function model.matrix)</span></span>
<span id="cb150-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; containing the p &gt;= 2 features/predictors. The data from X_train_selec and</span></span>
<span id="cb150-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; y_train_selec will be split into two parts; half of the data will be used for</span></span>
<span id="cb150-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; feature selection by cluster stability selection, and half will be used for</span></span>
<span id="cb150-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; estimating a linear model on the selected cluster representatives.</span></span>
<span id="cb150-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param y_train_selec A length-n numeric vector containing the responses;</span></span>
<span id="cb150-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; `y[i]` is the response corresponding to observation `X[i, ]`. Unlke the more</span></span>
<span id="cb150-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; general setup of css, y_train_selec must be real-valued because predictions</span></span>
<span id="cb150-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; will be generated by ordinary least squares.</span></span>
<span id="cb150-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param X_test A numeric matrix (preferably) or a data.frame (which will</span></span>
<span id="cb150-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; be coerced internally to a matrix by the function model.matrix) containing</span></span>
<span id="cb150-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the data that will be used to generate predictions. Must contain the same</span></span>
<span id="cb150-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; features (in the same number of columns) as X_train_selec, and if the columns</span></span>
<span id="cb150-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; of X_test are named, they must match the names of X_train_selec.</span></span>
<span id="cb150-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param clusters Optional; either an integer vector of a list of integer</span></span>
<span id="cb150-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; vectors; each vector should contain the indices of a cluster of features (a</span></span>
<span id="cb150-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; subset of 1:p). (If there is only one cluster, clusters can either be a list</span></span>
<span id="cb150-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; of length 1 or an integer vector.) All of the provided clusters must be</span></span>
<span id="cb150-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; non-overlapping. Every feature not appearing in any cluster will be assumed</span></span>
<span id="cb150-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; to be unclustered (that is, they  will be treated as if they are in a</span></span>
<span id="cb150-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; &quot;cluster&quot; containing only themselves). If clusters is a list of length 0 (or</span></span>
<span id="cb150-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; a list only containing clusters of length 1), then <a href='now-to-the-package-itself.html#css'>css</a>() returns the same</span></span>
<span id="cb150-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; results as stability selection (so feat_sel_mat will be identical to</span></span>
<span id="cb150-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; clus_sel_mat). Names for the clusters will be needed later; any clusters that</span></span>
<span id="cb150-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; are not given names in the list clusters will be given names automatically by</span></span>
<span id="cb150-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; css. Default is list() (so no clusters are specified, and every feature is</span></span>
<span id="cb150-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; assumed to be in a &quot;cluster&quot; containng only itself).</span></span>
<span id="cb150-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param lambda Optional; the tuning parameter to be used by the lasso for</span></span>
<span id="cb150-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; feature selection in each subsample. If lambda is not provided, cssPredict</span></span>
<span id="cb150-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; will choose one automatically by cross-validation. Default is NA.</span></span>
<span id="cb150-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param cutoff Numeric; getCssPreds will make use only of those clusters with</span></span>
<span id="cb150-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; selection proportions equal to at least cutoff. Must be between 0 and 1.</span></span>
<span id="cb150-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Default is 0 (in which case either all clusters are used, or max_num_clusts</span></span>
<span id="cb150-48"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; are used, if max_num_clusts is specified).</span></span>
<span id="cb150-49"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param max_num_clusts Integer or numeric; the maximum number of clusters to</span></span>
<span id="cb150-50"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; use regardless of cutoff. (That is, if the chosen cutoff returns more than</span></span>
<span id="cb150-51"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; max_num_clusts clusters, the cutoff will be decreased until at most</span></span>
<span id="cb150-52"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; max_num_clusts clusters are selected.) Default is NA (in which case</span></span>
<span id="cb150-53"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; max_num_clusts is ignored).</span></span>
<span id="cb150-54"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param train_inds Optional; an integer or numeric vector containing the</span></span>
<span id="cb150-55"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; indices of observations in X and y to set aside for model training after</span></span>
<span id="cb150-56"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; feature selection. If train_inds is not provided, half of the data will be</span></span>
<span id="cb150-57"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; used for feature selection and half for model estimation (chosen at random).</span></span>
<span id="cb150-58"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param auto_select_size Logical; if TRUE, then max_num_clusts will be</span></span>
<span id="cb150-59"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; automatically estimated using the lasso with cross-validation. Default is</span></span>
<span id="cb150-60"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; TRUE, though his argument is ignored if either cutoff or max_num_clusts is</span></span>
<span id="cb150-61"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; provided. (If desired output is to generate predictions using all clusters,</span></span>
<span id="cb150-62"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; you should set auto_select_size to FALSE and do not provide cutoff or</span></span>
<span id="cb150-63"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; max_num_clusts.)</span></span>
<span id="cb150-64"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return A numeric vector of length nrow(X_test) of predictions</span></span>
<span id="cb150-65"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; corresponding to the observations from X_test.</span></span>
<span id="cb150-66"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @author Gregory Faletto, Jacob Bien</span></span>
<span id="cb150-67"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @export</span></span>
<span id="cb150-68"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-68" aria-hidden="true" tabindex="-1"></a><span id='cssPredict'>cssPredict</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(X_train_selec, y_train_selec, X_test, <span class="at">clusters=</span><span class="fu">list</span>(),</span>
<span id="cb150-69"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">lambda=</span><span class="cn">NA</span>, <span class="at">cutoff=</span><span class="cn">NA</span>, <span class="at">max_num_clusts=</span><span class="cn">NA</span>, <span class="at">train_inds=</span><span class="cn">NA</span>,</span>
<span id="cb150-70"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">auto_select_size=</span><span class="cn">TRUE</span>){</span>
<span id="cb150-71"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-72"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-72" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check inputs (most inputs will be checked by called functions)</span></span>
<span id="cb150-73"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-73" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.numeric</span>(y_train_selec) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.integer</span>(y_train_selec)){</span>
<span id="cb150-74"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-74" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stop</span>(<span class="st">&quot;The provided y_train_selec must be real-valued, because predictions will be generated by ordinary least squares regression.&quot;</span>)</span>
<span id="cb150-75"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-75" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb150-76"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-77"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-77" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="sc">!</span><span class="fu">is.na</span>(auto_select_size))</span>
<span id="cb150-78"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-78" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(auto_select_size) <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb150-79"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-79" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.logical</span>(auto_select_size))</span>
<span id="cb150-80"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-81"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-81" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.matrix</span>(X_train_selec) <span class="sc">|</span> <span class="fu">is.data.frame</span>(X_train_selec))</span>
<span id="cb150-82"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-82" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(X_train_selec)))</span>
<span id="cb150-83"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-84"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-84" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if x is a matrix; if it&#39;s a data.frame, convert to matrix.</span></span>
<span id="cb150-85"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-85" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">is.data.frame</span>(X_train_selec)){</span>
<span id="cb150-86"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-86" aria-hidden="true" tabindex="-1"></a>        X_train_selec <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">model.matrix</span>(<span class="sc">~</span> ., X_train_selec)</span>
<span id="cb150-87"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-87" aria-hidden="true" tabindex="-1"></a>        X_train_selec <span class="ot">&lt;-</span> X_train_selec[, <span class="fu">colnames</span>(X_train_selec) <span class="sc">!=</span></span>
<span id="cb150-88"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-88" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;(Intercept)&quot;</span>]</span>
<span id="cb150-89"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-89" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb150-90"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-91"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.matrix</span>(X_train_selec))</span>
<span id="cb150-92"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-92" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(X_train_selec)))</span>
<span id="cb150-93"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-94"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-94" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(X_train_selec)</span>
<span id="cb150-95"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-96"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-96" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">any</span>(<span class="fu">is.na</span>(train_inds))){</span>
<span id="cb150-97"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-97" aria-hidden="true" tabindex="-1"></a>        train_inds <span class="ot">&lt;-</span> <span class="fu">sample</span>(n, <span class="at">size=</span><span class="fu">round</span>(n<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb150-98"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-98" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb150-99"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-100"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-100" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(lambda) <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb150-101"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-101" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">is.na</span>(lambda)){</span>
<span id="cb150-102"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-102" aria-hidden="true" tabindex="-1"></a>        lambda <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getLassoLambda'>getLassoLambda</a>(X_train_selec[<span class="fu">setdiff</span>(<span class="dv">1</span><span class="sc">:</span>n, train_inds), ],</span>
<span id="cb150-103"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-103" aria-hidden="true" tabindex="-1"></a>            y_train_selec[<span class="fu">setdiff</span>(<span class="dv">1</span><span class="sc">:</span>n, train_inds)]) </span>
<span id="cb150-104"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-104" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb150-105"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-106"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-106" aria-hidden="true" tabindex="-1"></a>    css_results <span class="ot">&lt;-</span> <a href='now-to-the-package-itself.html#css'>css</a>(<span class="at">X=</span>X_train_selec, <span class="at">y=</span>y_train_selec, <span class="at">lambda=</span>lambda,</span>
<span id="cb150-107"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-107" aria-hidden="true" tabindex="-1"></a>        <span class="at">clusters=</span>clusters, <span class="at">train_inds=</span>train_inds)</span>
<span id="cb150-108"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-109"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-109" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If no indication of how to select model size was provided, choose model</span></span>
<span id="cb150-110"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-110" aria-hidden="true" tabindex="-1"></a>    <span class="co"># size by cross-validation</span></span>
<span id="cb150-111"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-111" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">is.na</span>(cutoff) <span class="sc">&amp;</span> <span class="fu">is.na</span>(max_num_clusts)){</span>
<span id="cb150-112"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-112" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(auto_select_size){</span>
<span id="cb150-113"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-113" aria-hidden="true" tabindex="-1"></a>            max_num_clusts <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getModelSize'>getModelSize</a>(X_train_selec[train_inds, ],</span>
<span id="cb150-114"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-114" aria-hidden="true" tabindex="-1"></a>                y_train_selec[train_inds], css_results<span class="sc">$</span>clusters)</span>
<span id="cb150-115"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-115" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb150-116"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-116" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb150-117"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-118"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-118" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">is.na</span>(cutoff)){</span>
<span id="cb150-119"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-119" aria-hidden="true" tabindex="-1"></a>        cutoff <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb150-120"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-120" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb150-121"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-122"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-122" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get predictions</span></span>
<span id="cb150-123"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-123" aria-hidden="true" tabindex="-1"></a>    <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getCssPreds'>getCssPreds</a>(css_results, <span class="at">testX=</span>X_test, <span class="at">weighting=</span><span class="st">&quot;weighted_avg&quot;</span>,</span>
<span id="cb150-124"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-124" aria-hidden="true" tabindex="-1"></a>        <span class="at">cutoff=</span>cutoff, <span class="at">max_num_clusts=</span>max_num_clusts)</span>
<span id="cb150-125"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb150-125" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Tests for cssPredict:</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-1" aria-hidden="true" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">test_that</span>(<span class="st">&quot;cssPredict works&quot;</span>, {</span>
<span id="cb151-2"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">84231</span>)</span>
<span id="cb151-3"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb151-4"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-4" aria-hidden="true" tabindex="-1"></a>  train_data <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#genClusteredData'>genClusteredData</a>(<span class="at">n=</span><span class="dv">30</span>, <span class="at">p=</span><span class="dv">11</span>, <span class="at">k_unclustered=</span><span class="dv">1</span>, <span class="at">cluster_size=</span><span class="dv">3</span>,</span>
<span id="cb151-5"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">n_clusters=</span><span class="dv">2</span>, <span class="at">sig_clusters=</span><span class="dv">1</span>, <span class="at">sigma_eps_sq=</span><span class="dv">1</span>)</span>
<span id="cb151-6"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb151-7"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-7" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> train_data<span class="sc">$</span>X</span>
<span id="cb151-8"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-8" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> train_data<span class="sc">$</span>y</span>
<span id="cb151-9"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb151-10"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-10" aria-hidden="true" tabindex="-1"></a>  test_x <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#genClusteredData'>genClusteredData</a>(<span class="at">n=</span><span class="dv">5</span>, <span class="at">p=</span><span class="dv">11</span>, <span class="at">k_unclustered=</span><span class="dv">1</span>, <span class="at">cluster_size=</span><span class="dv">3</span>,</span>
<span id="cb151-11"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-11" aria-hidden="true" tabindex="-1"></a>                          <span class="at">n_clusters=</span><span class="dv">2</span>, <span class="at">sig_clusters=</span><span class="dv">1</span>, <span class="at">sigma_eps_sq=</span><span class="dv">1</span>)<span class="sc">$</span>X</span>
<span id="cb151-12"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb151-13"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Intentionally don&#39;t provide clusters for all features, mix up formatting,</span></span>
<span id="cb151-14"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># etc.</span></span>
<span id="cb151-15"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-15" aria-hidden="true" tabindex="-1"></a>  good_clusters <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">red_cluster=</span>1L<span class="sc">:</span>3L, <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb151-16"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb151-17"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-17" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssPredict'>cssPredict</a>(<span class="at">X_train_selec=</span>x, <span class="at">y_train_selec=</span>y, <span class="at">X_test=</span>test_x,</span>
<span id="cb151-18"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">clusters=</span>good_clusters)</span>
<span id="cb151-19"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb151-20"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-20" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(res)))</span>
<span id="cb151-21"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-21" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res))</span>
<span id="cb151-22"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-22" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), <span class="dv">5</span>)</span>
<span id="cb151-23"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb151-24"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># No provided clusters</span></span>
<span id="cb151-25"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-26"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-26" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssPredict'>cssPredict</a>(<span class="at">X_train_selec=</span>x, <span class="at">y_train_selec=</span>y, <span class="at">X_test=</span>test_x)</span>
<span id="cb151-27"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-28"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-28" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(res)))</span>
<span id="cb151-29"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-29" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res))</span>
<span id="cb151-30"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-30" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), <span class="dv">5</span>)</span>
<span id="cb151-31"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb151-32"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Provide training indices</span></span>
<span id="cb151-33"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb151-34"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-34" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssPredict'>cssPredict</a>(<span class="at">X_train_selec=</span>x, <span class="at">y_train_selec=</span>y, <span class="at">X_test=</span>test_x,</span>
<span id="cb151-35"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-35" aria-hidden="true" tabindex="-1"></a>                    <span class="at">train_inds=</span><span class="dv">13</span><span class="sc">:</span><span class="dv">28</span>)</span>
<span id="cb151-36"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb151-37"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-37" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(res)))</span>
<span id="cb151-38"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-38" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res))</span>
<span id="cb151-39"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-39" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), <span class="dv">5</span>)</span>
<span id="cb151-40"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-41"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-41" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Trying other inputs</span></span>
<span id="cb151-42"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-43"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-43" aria-hidden="true" tabindex="-1"></a>  <span class="co"># X as a data.frame</span></span>
<span id="cb151-44"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-44" aria-hidden="true" tabindex="-1"></a>  X_df <span class="ot">&lt;-</span> datasets<span class="sc">::</span>mtcars</span>
<span id="cb151-45"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb151-46"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-46" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(X_df)</span>
<span id="cb151-47"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-47" aria-hidden="true" tabindex="-1"></a>  test_inds <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">round</span>(n<span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb151-48"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-48" aria-hidden="true" tabindex="-1"></a>  n_test <span class="ot">&lt;-</span> <span class="fu">length</span>(test_inds)</span>
<span id="cb151-49"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-49" aria-hidden="true" tabindex="-1"></a>  selec_train_inds <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="dv">1</span><span class="sc">:</span>n, test_inds)</span>
<span id="cb151-50"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-50" aria-hidden="true" tabindex="-1"></a>  n_selec_train <span class="ot">&lt;-</span> <span class="fu">length</span>(selec_train_inds)</span>
<span id="cb151-51"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-52"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-52" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssPredict'>cssPredict</a>(<span class="at">X_train_selec=</span>X_df[selec_train_inds, ],</span>
<span id="cb151-53"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-53" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y_train_selec=</span>stats<span class="sc">::</span><span class="fu">rnorm</span>(n_selec_train),</span>
<span id="cb151-54"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-54" aria-hidden="true" tabindex="-1"></a>                    <span class="at">X_test=</span>X_df[test_inds, ])</span>
<span id="cb151-55"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb151-56"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-56" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(res)))</span>
<span id="cb151-57"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-57" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res))</span>
<span id="cb151-58"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-58" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), n_test)</span>
<span id="cb151-59"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-60"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-60" aria-hidden="true" tabindex="-1"></a>  <span class="co"># X as a dataframe with factors (number of columns of final design matrix</span></span>
<span id="cb151-61"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># after one-hot encoding factors won&#39;t match number of columns of df2)</span></span>
<span id="cb151-62"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-62" aria-hidden="true" tabindex="-1"></a>  df2 <span class="ot">&lt;-</span> X_df</span>
<span id="cb151-63"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-63" aria-hidden="true" tabindex="-1"></a>  df2<span class="sc">$</span>cyl <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df2<span class="sc">$</span>cyl)</span>
<span id="cb151-64"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-64" aria-hidden="true" tabindex="-1"></a>  df2<span class="sc">$</span>vs <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df2<span class="sc">$</span>vs)</span>
<span id="cb151-65"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-65" aria-hidden="true" tabindex="-1"></a>  df2<span class="sc">$</span>am <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df2<span class="sc">$</span>am)</span>
<span id="cb151-66"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-66" aria-hidden="true" tabindex="-1"></a>  df2<span class="sc">$</span>gear <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df2<span class="sc">$</span>gear)</span>
<span id="cb151-67"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-67" aria-hidden="true" tabindex="-1"></a>  df2<span class="sc">$</span>carb <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df2<span class="sc">$</span>carb)</span>
<span id="cb151-68"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-68" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb151-69"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-69" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssPredict'>cssPredict</a>(<span class="at">X_train_selec=</span>df2[selec_train_inds, ],</span>
<span id="cb151-70"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-70" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y_train_selec=</span>stats<span class="sc">::</span><span class="fu">rnorm</span>(n_selec_train),</span>
<span id="cb151-71"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-71" aria-hidden="true" tabindex="-1"></a>                    <span class="at">X_test=</span>df2[test_inds, ])</span>
<span id="cb151-72"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-72" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb151-73"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-73" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(res)))</span>
<span id="cb151-74"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-74" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res))</span>
<span id="cb151-75"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-75" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), n_test)</span>
<span id="cb151-76"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-77"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-77" aria-hidden="true" tabindex="-1"></a>  <span class="co"># X as a matrix with column names</span></span>
<span id="cb151-78"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-78" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> x</span>
<span id="cb151-79"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(x2) <span class="ot">&lt;-</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>]</span>
<span id="cb151-80"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-80" aria-hidden="true" tabindex="-1"></a>  test_x2 <span class="ot">&lt;-</span> test_x</span>
<span id="cb151-81"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(test_x2) <span class="ot">&lt;-</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>]</span>
<span id="cb151-82"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-83"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-83" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssPredict'>cssPredict</a>(<span class="at">X_train_selec=</span>x2, <span class="at">y_train_selec=</span>y, <span class="at">X_test=</span>test_x2,</span>
<span id="cb151-84"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-84" aria-hidden="true" tabindex="-1"></a>                    <span class="at">clusters=</span>good_clusters)</span>
<span id="cb151-85"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-85" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb151-86"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-86" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(res)))</span>
<span id="cb151-87"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-87" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res))</span>
<span id="cb151-88"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-88" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), <span class="dv">5</span>)</span>
<span id="cb151-89"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-90"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-90" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Vary inputs</span></span>
<span id="cb151-91"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-91" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssPredict'>cssPredict</a>(<span class="at">X_train_selec=</span>x, <span class="at">y_train_selec=</span>y, <span class="at">X_test=</span>test_x,</span>
<span id="cb151-92"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-92" aria-hidden="true" tabindex="-1"></a>                    <span class="at">lambda=</span><span class="fl">0.01</span>)</span>
<span id="cb151-93"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-93" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb151-94"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-94" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(res)))</span>
<span id="cb151-95"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-95" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res))</span>
<span id="cb151-96"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-96" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), <span class="dv">5</span>)</span>
<span id="cb151-97"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-98"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-98" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssPredict'>cssPredict</a>(<span class="at">X_train_selec=</span>x, <span class="at">y_train_selec=</span>y, <span class="at">X_test=</span>test_x, <span class="at">cutoff=</span><span class="fl">0.6</span>)</span>
<span id="cb151-99"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-99" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb151-100"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-100" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(res)))</span>
<span id="cb151-101"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-101" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res))</span>
<span id="cb151-102"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-102" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), <span class="dv">5</span>)</span>
<span id="cb151-103"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-104"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-104" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssPredict'>cssPredict</a>(<span class="at">X_train_selec=</span>x, <span class="at">y_train_selec=</span>y, <span class="at">X_test=</span>test_x,</span>
<span id="cb151-105"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-105" aria-hidden="true" tabindex="-1"></a>                    <span class="at">max_num_clusts=</span><span class="dv">6</span>)</span>
<span id="cb151-106"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-106" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb151-107"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-107" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(res)))</span>
<span id="cb151-108"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-108" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res))</span>
<span id="cb151-109"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-109" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), <span class="dv">5</span>)</span>
<span id="cb151-110"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-111"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-111" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssPredict'>cssPredict</a>(<span class="at">X_train_selec=</span>x, <span class="at">y_train_selec=</span>y, <span class="at">X_test=</span>test_x,</span>
<span id="cb151-112"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-112" aria-hidden="true" tabindex="-1"></a>                    <span class="at">auto_select_size=</span><span class="cn">FALSE</span>)</span>
<span id="cb151-113"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-113" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb151-114"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-114" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(res)))</span>
<span id="cb151-115"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-115" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res))</span>
<span id="cb151-116"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-116" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), <span class="dv">5</span>)</span>
<span id="cb151-117"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-118"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-118" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Bad inputs</span></span>
<span id="cb151-119"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-119" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssPredict'>cssPredict</a>(<span class="at">X_train_selec=</span>x[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, ], <span class="at">y_train_selec=</span>y,</span>
<span id="cb151-120"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-120" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">X_test=</span>test_x),</span>
<span id="cb151-121"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-121" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;length(y) == n is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb151-122"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-123"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-123" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssPredict'>cssPredict</a>(<span class="at">X_train_selec=</span><span class="fu">character</span>(<span class="dv">30</span>),</span>
<span id="cb151-124"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-124" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">y_train_selec=</span>y, <span class="at">X_test=</span>test_x),</span>
<span id="cb151-125"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-125" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;is.matrix(X_train_selec) | is.data.frame(X_train_selec) is not TRUE&quot;</span>,</span>
<span id="cb151-126"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-126" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb151-127"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-128"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-128" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssPredict'>cssPredict</a>(<span class="at">X_train_selec=</span>x,</span>
<span id="cb151-129"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-129" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">y_train_selec=</span><span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>, <span class="dv">10</span>, <span class="dv">3</span>),</span>
<span id="cb151-130"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-130" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">X_test=</span>test_x), <span class="st">&quot;!is.matrix(y) is not TRUE&quot;</span>,</span>
<span id="cb151-131"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-131" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb151-132"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-133"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-133" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssPredict'>cssPredict</a>(<span class="at">X_train_selec=</span>x,</span>
<span id="cb151-134"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-134" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">y_train_selec=</span><span class="fu">factor</span>(<span class="fu">rbinom</span>(<span class="dv">30</span>, <span class="at">size=</span><span class="dv">1</span>,</span>
<span id="cb151-135"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-135" aria-hidden="true" tabindex="-1"></a>                                                                <span class="at">prob=</span>.<span class="dv">5</span>)),</span>
<span id="cb151-136"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-136" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">X_test=</span>test_x),</span>
<span id="cb151-137"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-137" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;The provided y_train_selec must be real-valued, because predictions will be generated by ordinary least squares regression.&quot;</span>,</span>
<span id="cb151-138"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-138" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb151-139"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-140"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-140" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssPredict'>cssPredict</a>(<span class="at">X_train_selec=</span>x, <span class="at">y_train_selec=</span>y,</span>
<span id="cb151-141"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-141" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">X_test=</span>test_x, <span class="at">clusters=</span><span class="st">&quot;clusters&quot;</span>),</span>
<span id="cb151-142"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-142" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;is.numeric(clusters) | is.integer(clusters) is not TRUE&quot;</span>,</span>
<span id="cb151-143"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-143" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb151-144"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-145"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-145" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssPredict'>cssPredict</a>(<span class="at">X_train_selec=</span>x, <span class="at">y_train_selec=</span>y,</span>
<span id="cb151-146"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-146" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">X_test=</span>test_x, <span class="at">lambda=</span><span class="st">&quot;lambda&quot;</span>),</span>
<span id="cb151-147"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-147" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;For method cssLasso, lambda must be a numeric.&quot;</span>,</span>
<span id="cb151-148"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-148" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb151-149"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-150"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-150" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssPredict'>cssPredict</a>(<span class="at">X_train_selec=</span>x, <span class="at">y_train_selec=</span>y,</span>
<span id="cb151-151"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-151" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">X_test=</span>test_x, <span class="at">cutoff=</span><span class="sc">-</span>.<span class="dv">1</span>),</span>
<span id="cb151-152"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-152" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;cutoff &gt;= 0 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb151-153"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-154"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-154" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssPredict'>cssPredict</a>(<span class="at">X_train_selec=</span>x, <span class="at">y_train_selec=</span>y,</span>
<span id="cb151-155"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-155" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">X_test=</span>test_x, <span class="at">max_num_clusts=</span><span class="dv">0</span>),</span>
<span id="cb151-156"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-156" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;max_num_clusts &gt;= 1 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb151-157"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-158"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-158" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssPredict'>cssPredict</a>(<span class="at">X_train_selec=</span>x, <span class="at">y_train_selec=</span>y,</span>
<span id="cb151-159"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-159" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">X_test=</span>test_x, <span class="at">auto_select_size=</span><span class="fu">c</span>(<span class="cn">TRUE</span>,</span>
<span id="cb151-160"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-160" aria-hidden="true" tabindex="-1"></a>                                                                      <span class="cn">FALSE</span>)),</span>
<span id="cb151-161"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-161" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;length(auto_select_size) == 1 is not TRUE&quot;</span>,</span>
<span id="cb151-162"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-162" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb151-163"><a href="tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cb151-163" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## ── Warning (&#39;&lt;text&gt;:17&#39;): cssPredict works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssPredict'>cssPredict</a>(...)
##  2. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getLassoLambda'>getLassoLambda</a>(...)
##  3. glmnet::cv.glmnet(...)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:17&#39;): cssPredict works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssPredict'>cssPredict</a>(...)
##  2. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getModelSize'>getModelSize</a>(...)
##  3. glmnet::cv.glmnet(x = X_size, y = y, family = &quot;gaussian&quot;)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:26&#39;): cssPredict works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssPredict'>cssPredict</a>(X_train_selec = x, y_train_selec = y, X_test = test_x)
##  2. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getLassoLambda'>getLassoLambda</a>(...)
##  3. glmnet::cv.glmnet(...)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:26&#39;): cssPredict works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssPredict'>cssPredict</a>(X_train_selec = x, y_train_selec = y, X_test = test_x)
##  2. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getModelSize'>getModelSize</a>(...)
##  3. glmnet::cv.glmnet(x = X_size, y = y, family = &quot;gaussian&quot;)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:34&#39;): cssPredict works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssPredict'>cssPredict</a>(...)
##  2. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getLassoLambda'>getLassoLambda</a>(...)
##  3. glmnet::cv.glmnet(...)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:34&#39;): cssPredict works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssPredict'>cssPredict</a>(...)
##  2. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getModelSize'>getModelSize</a>(...)
##  3. glmnet::cv.glmnet(x = X_size, y = y, family = &quot;gaussian&quot;)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:52&#39;): cssPredict works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssPredict'>cssPredict</a>(...)
##  2. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getLassoLambda'>getLassoLambda</a>(...)
##  3. glmnet::cv.glmnet(...)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:52&#39;): cssPredict works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssPredict'>cssPredict</a>(...)
##  2. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getModelSize'>getModelSize</a>(...)
##  3. glmnet::cv.glmnet(x = X_size, y = y, family = &quot;gaussian&quot;)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:69&#39;): cssPredict works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssPredict'>cssPredict</a>(...)
##  2. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getLassoLambda'>getLassoLambda</a>(...)
##  3. glmnet::cv.glmnet(...)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:69&#39;): cssPredict works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssPredict'>cssPredict</a>(...)
##  2. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getModelSize'>getModelSize</a>(...)
##  3. glmnet::cv.glmnet(x = X_size, y = y, family = &quot;gaussian&quot;)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:83&#39;): cssPredict works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssPredict'>cssPredict</a>(...)
##  2. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getLassoLambda'>getLassoLambda</a>(...)
##  3. glmnet::cv.glmnet(...)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:83&#39;): cssPredict works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssPredict'>cssPredict</a>(...)
##  2. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getModelSize'>getModelSize</a>(...)
##  3. glmnet::cv.glmnet(x = X_size, y = y, family = &quot;gaussian&quot;)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:91&#39;): cssPredict works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssPredict'>cssPredict</a>(...)
##  2. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getModelSize'>getModelSize</a>(...)
##  3. glmnet::cv.glmnet(x = X_size, y = y, family = &quot;gaussian&quot;)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:98&#39;): cssPredict works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssPredict'>cssPredict</a>(...)
##  2. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getLassoLambda'>getLassoLambda</a>(...)
##  3. glmnet::cv.glmnet(...)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:104&#39;): cssPredict works ────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssPredict'>cssPredict</a>(...)
##  2. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getLassoLambda'>getLassoLambda</a>(...)
##  3. glmnet::cv.glmnet(...)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:111&#39;): cssPredict works ────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssPredict'>cssPredict</a>(...)
##  2. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getLassoLambda'>getLassoLambda</a>(...)
##  3. glmnet::cv.glmnet(...)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:119&#39;): cssPredict works ────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##   1. testthat::expect_error(...)
##   7. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssPredict'>cssPredict</a>(X_train_selec = x[1:10, ], y_train_selec = y, X_test = test_x)
##   8. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getLassoLambda'>getLassoLambda</a>(...)
##   9. glmnet::cv.glmnet(...)
##  10. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:128&#39;): cssPredict works ────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##   1. testthat::expect_error(...)
##   7. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssPredict'>cssPredict</a>(...)
##   8. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getLassoLambda'>getLassoLambda</a>(...)
##   9. glmnet::cv.glmnet(...)
##  10. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:140&#39;): cssPredict works ────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##   1. testthat::expect_error(...)
##   7. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssPredict'>cssPredict</a>(...)
##   8. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getLassoLambda'>getLassoLambda</a>(...)
##   9. glmnet::cv.glmnet(...)
##  10. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:150&#39;): cssPredict works ────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##   1. testthat::expect_error(...)
##   7. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssPredict'>cssPredict</a>(...)
##   8. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getLassoLambda'>getLassoLambda</a>(...)
##   9. glmnet::cv.glmnet(...)
##  10. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:154&#39;): cssPredict works ────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##   1. testthat::expect_error(...)
##   7. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#cssPredict'>cssPredict</a>(...)
##   8. litr (local) <a href='tests-for-main-functions-in-css-now-that-helper-functions-have-been-defined.html#getLassoLambda'>getLassoLambda</a>(...)
##   9. glmnet::cv.glmnet(...)
##  10. glmnet:::cv.glmnet.raw(...)</code></pre>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="helper-functions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="competitor-methods.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
