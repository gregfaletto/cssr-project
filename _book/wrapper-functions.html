<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7 Convenient wrapper functions | Creating the cssr R package</title>
  <meta name="description" content="7 Convenient wrapper functions | Creating the cssr R package" />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="7 Convenient wrapper functions | Creating the cssr R package" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 Convenient wrapper functions | Creating the cssr R package" />
  
  
  

<meta name="author" content="Gregory Faletto" />


<meta name="date" content="2023-02-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="other-useful.html"/>
<link rel="next" href="competitor-methods.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="overview.html"><a href="overview.html"><i class="fa fa-check"></i><b>2</b> Overview</a>
<ul>
<li class="chapter" data-level="2.1" data-path="overview.html"><a href="overview.html#background"><i class="fa fa-check"></i><b>2.1</b> Background</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="overview.html"><a href="overview.html#cpss"><i class="fa fa-check"></i><b>2.1.1</b> Complementary pairs stability selection</a></li>
<li class="chapter" data-level="2.1.2" data-path="overview.html"><a href="overview.html#cluster-stability-selection"><i class="fa fa-check"></i><b>2.1.2</b> Cluster stability selection</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="overview.html"><a href="overview.html#outline"><i class="fa fa-check"></i><b>2.2</b> Outline</a></li>
<li class="chapter" data-level="2.3" data-path="overview.html"><a href="overview.html#package-setup"><i class="fa fa-check"></i><b>2.3</b> Package setup</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="css.html"><a href="css.html"><i class="fa fa-check"></i><b>3</b> The core function: <code>css</code></a>
<ul>
<li class="chapter" data-level="3.1" data-path="css.html"><a href="css.html#main-components-of-css"><i class="fa fa-check"></i><b>3.1</b> Main components of <code>css</code></a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="css.html"><a href="css.html#generating-subsamples"><i class="fa fa-check"></i><b>3.1.1</b> Generating subsamples</a></li>
<li class="chapter" data-level="3.1.2" data-path="css.html"><a href="css.html#forming-selection-matrices"><i class="fa fa-check"></i><b>3.1.2</b> Forming selection matrices</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="css.html"><a href="css.html#helper-functions"><i class="fa fa-check"></i><b>3.2</b> Helper functions</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="tests-for-main-functions-in-cssr.html"><a href="tests-for-main-functions-in-cssr.html"><i class="fa fa-check"></i><b>4</b> Tests for main functions in <code>cssr</code></a></li>
<li class="chapter" data-level="5" data-path="sel-and-pred.html"><a href="sel-and-pred.html"><i class="fa fa-check"></i><b>5</b> Selection and prediction functions</a></li>
<li class="chapter" data-level="6" data-path="other-useful.html"><a href="other-useful.html"><i class="fa fa-check"></i><b>6</b> Other useful functions</a></li>
<li class="chapter" data-level="7" data-path="wrapper-functions.html"><a href="wrapper-functions.html"><i class="fa fa-check"></i><b>7</b> Convenient wrapper functions</a></li>
<li class="chapter" data-level="8" data-path="competitor-methods.html"><a href="competitor-methods.html"><i class="fa fa-check"></i><b>8</b> Competitor Methods</a></li>
<li class="chapter" data-level="9" data-path="documenting-the-package-and-adding-readme-and-pkgdown-website.html"><a href="documenting-the-package-and-adding-readme-and-pkgdown-website.html"><i class="fa fa-check"></i><b>9</b> Documenting the package and adding README and pkgdown website</a>
<ul>
<li class="chapter" data-level="9.1" data-path="documenting-the-package-and-adding-readme-and-pkgdown-website.html"><a href="documenting-the-package-and-adding-readme-and-pkgdown-website.html#add-readme"><i class="fa fa-check"></i><b>9.1</b> Add README</a></li>
<li class="chapter" data-level="9.2" data-path="documenting-the-package-and-adding-readme-and-pkgdown-website.html"><a href="documenting-the-package-and-adding-readme-and-pkgdown-website.html#add-pkdgown-site"><i class="fa fa-check"></i><b>9.2</b> Add pkdgown site</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Creating the <code>cssr</code> R package</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="wrapper-functions" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">7</span> Convenient wrapper functions<a href="wrapper-functions.html#wrapper-functions" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Finally, we provide convenient wrapper functions which yield user-desired output in a single step at the price of flexibility and efficiency. <code><a href='wrapper-functions.html#cssSelect'>cssSelect</a>()</code> yields a selected set of clusters and features (the same output as <code><a href='sel-and-pred.html#getCssSelections'>getCssSelections</a>()</code>) in a single function call. <code><a href='wrapper-functions.html#cssPredict'>cssPredict</a>()</code> takes in a training/selection data set as well as a test X. It uses the labeled data to select a set of features and train an OLS model on the selected features, and then it generates predictions on the test set using the fitted model.</p>
<p>Besides requiring only a single function call to yield desired output, these wrapper functions also automatically select hyperparameters (lambda used for the lasso, a desired model size, and even selection and training splits for <code><a href='wrapper-functions.html#cssPredict'>cssPredict</a>()</code>) in a sensible way if these values are not provided by the user. So these functions are very convenient for an end user who wants quick results without getting “under the hood.”</p>
<p>The two main disadvantages of these functions are flexibility and computational efficiency. For simplicity of use, these functions do not provide as many options as the component functions they call (for example, <code>min_num_clusts</code> is not an available argument for these models). Further, both of these functions make (computationally intensive) calls to <code><a href='css.html#css'>css</a>()</code> internally every time they are called, so these functions are not recommended for users who want to tinker with the model size and other parameters. Instead, it would be more efficient to call css once and then work with the output as desired using the other package functions, which are very efficient given the stored output from <code><a href='css.html#css'>css</a>()</code>.</p>
<p><code><a href='wrapper-functions.html#cssSelect'>cssSelect</a>()</code> and <code><a href='wrapper-functions.html#cssPredict'>cssPredict</a>()</code> have no new dependencies; they rely only on already-defined functions.</p>
<p><code><a href='wrapper-functions.html#cssSelect'>cssSelect</a>()</code>:</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="wrapper-functions.html#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Obtain a selected set of clusters and features using cluster stability</span></span>
<span id="cb156-2"><a href="wrapper-functions.html#cb156-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; selection</span></span>
<span id="cb156-3"><a href="wrapper-functions.html#cb156-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb156-4"><a href="wrapper-functions.html#cb156-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Takes in data X and y and returns a set of clusters (and a set of features)</span></span>
<span id="cb156-5"><a href="wrapper-functions.html#cb156-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; that are useful for predicting y from the data in X. This is a wrapper</span></span>
<span id="cb156-6"><a href="wrapper-functions.html#cb156-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; function for css and getCssSelections. Using cssSelect is simpler, but it</span></span>
<span id="cb156-7"><a href="wrapper-functions.html#cb156-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; has fewer options, and it executes the full (computationally expensive)</span></span>
<span id="cb156-8"><a href="wrapper-functions.html#cb156-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; subsampling procedured every time it is called. In contrast, css can be</span></span>
<span id="cb156-9"><a href="wrapper-functions.html#cb156-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; called just once, and then getCssSelections can quickly return results using</span></span>
<span id="cb156-10"><a href="wrapper-functions.html#cb156-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; different values of cutoff, max_num_clusts, etc. from the calculations done</span></span>
<span id="cb156-11"><a href="wrapper-functions.html#cb156-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; in one call to css.</span></span>
<span id="cb156-12"><a href="wrapper-functions.html#cb156-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param X An n x p numeric matrix (preferably) or a data.frame (which will</span></span>
<span id="cb156-13"><a href="wrapper-functions.html#cb156-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; be coerced internally to a matrix by the function model.matrix) containing</span></span>
<span id="cb156-14"><a href="wrapper-functions.html#cb156-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the p &gt;= 2 features/predictors.</span></span>
<span id="cb156-15"><a href="wrapper-functions.html#cb156-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param y A length-n numeric vector containing the responses; `y[i]` is the</span></span>
<span id="cb156-16"><a href="wrapper-functions.html#cb156-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; response corresponding to observation `X[i, ]`. (Note that for the css</span></span>
<span id="cb156-17"><a href="wrapper-functions.html#cb156-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; function, y does not have to be a numeric response, but for this function,</span></span>
<span id="cb156-18"><a href="wrapper-functions.html#cb156-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the underlying selection procedure is the lasso, so y must be a real-valued</span></span>
<span id="cb156-19"><a href="wrapper-functions.html#cb156-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; response.)</span></span>
<span id="cb156-20"><a href="wrapper-functions.html#cb156-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param clusters Optional; either an integer vector of a list of integer</span></span>
<span id="cb156-21"><a href="wrapper-functions.html#cb156-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; vectors; each vector should contain the indices of a cluster of features (a</span></span>
<span id="cb156-22"><a href="wrapper-functions.html#cb156-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; subset of 1:p). (If there is only one cluster, clusters can either be a list</span></span>
<span id="cb156-23"><a href="wrapper-functions.html#cb156-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; of length 1 or an integer vector.) All of the provided clusters must be</span></span>
<span id="cb156-24"><a href="wrapper-functions.html#cb156-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; non-overlapping. Every feature not appearing in any cluster will be assumed</span></span>
<span id="cb156-25"><a href="wrapper-functions.html#cb156-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; to be unclustered (that is, they  will be treated as if they are in a</span></span>
<span id="cb156-26"><a href="wrapper-functions.html#cb156-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; &quot;cluster&quot; containing only themselves). If clusters is a list of length 0 (or</span></span>
<span id="cb156-27"><a href="wrapper-functions.html#cb156-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; a list only containing clusters of length 1), then <a href='css.html#css'>css</a>() returns the same</span></span>
<span id="cb156-28"><a href="wrapper-functions.html#cb156-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; results as stability selection (so feat_sel_mat will be identical to</span></span>
<span id="cb156-29"><a href="wrapper-functions.html#cb156-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; clus_sel_mat). Names for the clusters will be needed later; any clusters that</span></span>
<span id="cb156-30"><a href="wrapper-functions.html#cb156-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; are not given names in the list clusters will be given names automatically by</span></span>
<span id="cb156-31"><a href="wrapper-functions.html#cb156-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; css. </span><span class="al">CAUTION</span><span class="co">: if the provided X is a data.frame that contains a categorical</span></span>
<span id="cb156-32"><a href="wrapper-functions.html#cb156-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; feature with more than two levels, then the resulting matrix made from</span></span>
<span id="cb156-33"><a href="wrapper-functions.html#cb156-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; model.matrix will have a different number of columns than the provided</span></span>
<span id="cb156-34"><a href="wrapper-functions.html#cb156-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; data.frame, some of the feature numbers will change, and the clusters</span></span>
<span id="cb156-35"><a href="wrapper-functions.html#cb156-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; argument will not work properly (in the current version of the package). To</span></span>
<span id="cb156-36"><a href="wrapper-functions.html#cb156-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; get correct results in this case, please use model.matrix to convert the</span></span>
<span id="cb156-37"><a href="wrapper-functions.html#cb156-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; data.frame to a numeric matrix on your own, then provide this matrix and</span></span>
<span id="cb156-38"><a href="wrapper-functions.html#cb156-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; cluster assignments with respect to this matrix. Default is list() (so no</span></span>
<span id="cb156-39"><a href="wrapper-functions.html#cb156-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; clusters are specified, and every feature is assumed to be in a &quot;cluster&quot;</span></span>
<span id="cb156-40"><a href="wrapper-functions.html#cb156-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; containing only itself).</span></span>
<span id="cb156-41"><a href="wrapper-functions.html#cb156-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param lambda Optional; the tuning parameter to be used by the lasso for</span></span>
<span id="cb156-42"><a href="wrapper-functions.html#cb156-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; feature selection in each subsample. If lambda is not provided, cssSelect</span></span>
<span id="cb156-43"><a href="wrapper-functions.html#cb156-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; will choose one automatically by cross-validation. Default is NA.</span></span>
<span id="cb156-44"><a href="wrapper-functions.html#cb156-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param cutoff Numeric; cssSelect will only select those clusters with</span></span>
<span id="cb156-45"><a href="wrapper-functions.html#cb156-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; selection proportions equal to at least cutoff. Must be between 0 and 1.</span></span>
<span id="cb156-46"><a href="wrapper-functions.html#cb156-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Default is NA (in which case max_num_clusts are used).</span></span>
<span id="cb156-47"><a href="wrapper-functions.html#cb156-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param max_num_clusts Integer or numeric; the maximum number of clusters to</span></span>
<span id="cb156-48"><a href="wrapper-functions.html#cb156-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; use regardless of cutoff. (That is, if the chosen cutoff returns more than</span></span>
<span id="cb156-49"><a href="wrapper-functions.html#cb156-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; max_num_clusts clusters, the cutoff will be decreased until at most</span></span>
<span id="cb156-50"><a href="wrapper-functions.html#cb156-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; max_num_clusts clusters are selected.) Default is NA (in which case</span></span>
<span id="cb156-51"><a href="wrapper-functions.html#cb156-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; either cutoff is used to choose the number of clusters, or if cutoff was also</span></span>
<span id="cb156-52"><a href="wrapper-functions.html#cb156-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; unspecified, cssSelect chooses max_num_clusts by cross-validation).</span></span>
<span id="cb156-53"><a href="wrapper-functions.html#cb156-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param auto_select_size Logical; if TRUE, then max_num_clusts will be</span></span>
<span id="cb156-54"><a href="wrapper-functions.html#cb156-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; automatically estimated using the lasso with cross-validation. Default is</span></span>
<span id="cb156-55"><a href="wrapper-functions.html#cb156-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; TRUE, though his argument is ignored if either cutoff or max_num_clusts is</span></span>
<span id="cb156-56"><a href="wrapper-functions.html#cb156-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; provided. (If desired output is to return all clusters, you should set</span></span>
<span id="cb156-57"><a href="wrapper-functions.html#cb156-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; auto_select_size to FALSE and do not provide cutoff or max_num_clusts.)</span></span>
<span id="cb156-58"><a href="wrapper-functions.html#cb156-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return A named list with two items. \item{selected_clusts}{A list of</span></span>
<span id="cb156-59"><a href="wrapper-functions.html#cb156-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; integer vectors; each vector contains the indices of one of the selected</span></span>
<span id="cb156-60"><a href="wrapper-functions.html#cb156-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; clusters.} \item{selected_feats}{An integer vector; the indices of the</span></span>
<span id="cb156-61"><a href="wrapper-functions.html#cb156-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; all of the selected features within all of the selected clusters (typically</span></span>
<span id="cb156-62"><a href="wrapper-functions.html#cb156-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; only one feature is selected from each cluster).}</span></span>
<span id="cb156-63"><a href="wrapper-functions.html#cb156-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @author Gregory Faletto, Jacob Bien</span></span>
<span id="cb156-64"><a href="wrapper-functions.html#cb156-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @export</span></span>
<span id="cb156-65"><a href="wrapper-functions.html#cb156-65" aria-hidden="true" tabindex="-1"></a><span id='cssSelect'>cssSelect</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(X, y, <span class="at">clusters =</span> <span class="fu">list</span>(), <span class="at">lambda=</span><span class="cn">NA</span>, <span class="at">cutoff=</span><span class="cn">NA</span>,</span>
<span id="cb156-66"><a href="wrapper-functions.html#cb156-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_num_clusts=</span><span class="cn">NA</span>, <span class="at">auto_select_size=</span><span class="cn">TRUE</span>){</span>
<span id="cb156-67"><a href="wrapper-functions.html#cb156-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-68"><a href="wrapper-functions.html#cb156-68" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check inputs (most inputs will be checked by called functions)</span></span>
<span id="cb156-69"><a href="wrapper-functions.html#cb156-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-70"><a href="wrapper-functions.html#cb156-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="sc">!</span><span class="fu">is.na</span>(auto_select_size))</span>
<span id="cb156-71"><a href="wrapper-functions.html#cb156-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(auto_select_size) <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb156-72"><a href="wrapper-functions.html#cb156-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.logical</span>(auto_select_size))</span>
<span id="cb156-73"><a href="wrapper-functions.html#cb156-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-74"><a href="wrapper-functions.html#cb156-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.matrix</span>(X) <span class="sc">|</span> <span class="fu">is.data.frame</span>(X))</span>
<span id="cb156-75"><a href="wrapper-functions.html#cb156-75" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(X)))</span>
<span id="cb156-76"><a href="wrapper-functions.html#cb156-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-77"><a href="wrapper-functions.html#cb156-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-78"><a href="wrapper-functions.html#cb156-78" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if x is a matrix; if it&#39;s a data.frame, convert to matrix.</span></span>
<span id="cb156-79"><a href="wrapper-functions.html#cb156-79" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">is.data.frame</span>(X)){</span>
<span id="cb156-80"><a href="wrapper-functions.html#cb156-80" aria-hidden="true" tabindex="-1"></a>        p <span class="ot">&lt;-</span> <span class="fu">ncol</span>(X)</span>
<span id="cb156-81"><a href="wrapper-functions.html#cb156-81" aria-hidden="true" tabindex="-1"></a>        X <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">model.matrix</span>(<span class="sc">~</span> ., X)</span>
<span id="cb156-82"><a href="wrapper-functions.html#cb156-82" aria-hidden="true" tabindex="-1"></a>        X <span class="ot">&lt;-</span> X[, <span class="fu">colnames</span>(X) <span class="sc">!=</span> <span class="st">&quot;(Intercept)&quot;</span>]</span>
<span id="cb156-83"><a href="wrapper-functions.html#cb156-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-84"><a href="wrapper-functions.html#cb156-84" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="fu">length</span>(clusters) <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> (p <span class="sc">!=</span> <span class="fu">ncol</span>(X))){</span>
<span id="cb156-85"><a href="wrapper-functions.html#cb156-85" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stop</span>(<span class="st">&quot;When stats::model.matrix converted the provided data.frame X to a matrix, the number of columns changed (probably because the provided data.frame contained a factor variable with at least three levels). Please convert the data.frame X to a matrix yourself using model.matrix and provide cluster assignments according to the columns of the new matrix.&quot;</span>)</span>
<span id="cb156-86"><a href="wrapper-functions.html#cb156-86" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb156-87"><a href="wrapper-functions.html#cb156-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-88"><a href="wrapper-functions.html#cb156-88" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb156-89"><a href="wrapper-functions.html#cb156-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-90"><a href="wrapper-functions.html#cb156-90" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.matrix</span>(X))</span>
<span id="cb156-91"><a href="wrapper-functions.html#cb156-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(X)))</span>
<span id="cb156-92"><a href="wrapper-functions.html#cb156-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-93"><a href="wrapper-functions.html#cb156-93" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.numeric</span>(y) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.integer</span>(y)){</span>
<span id="cb156-94"><a href="wrapper-functions.html#cb156-94" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stop</span>(<span class="st">&quot;The provided y must be real-valued, because cssSelect uses the lasso for feature selection. (In order to use a different form of response, use the css function and provide your own selection function accommodating your choice of y.)&quot;</span>)</span>
<span id="cb156-95"><a href="wrapper-functions.html#cb156-95" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb156-96"><a href="wrapper-functions.html#cb156-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-97"><a href="wrapper-functions.html#cb156-97" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(lambda) <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb156-98"><a href="wrapper-functions.html#cb156-98" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">is.na</span>(lambda)){</span>
<span id="cb156-99"><a href="wrapper-functions.html#cb156-99" aria-hidden="true" tabindex="-1"></a>        lambda <span class="ot">&lt;-</span> <a href='other-useful.html#getLassoLambda'>getLassoLambda</a>(X, y)</span>
<span id="cb156-100"><a href="wrapper-functions.html#cb156-100" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb156-101"><a href="wrapper-functions.html#cb156-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-102"><a href="wrapper-functions.html#cb156-102" aria-hidden="true" tabindex="-1"></a>    css_results <span class="ot">&lt;-</span> <a href='css.html#css'>css</a>(X, y, lambda, clusters)</span>
<span id="cb156-103"><a href="wrapper-functions.html#cb156-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-104"><a href="wrapper-functions.html#cb156-104" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If no indication of how to select model size was provided, choose model</span></span>
<span id="cb156-105"><a href="wrapper-functions.html#cb156-105" aria-hidden="true" tabindex="-1"></a>    <span class="co"># size by cross-validation</span></span>
<span id="cb156-106"><a href="wrapper-functions.html#cb156-106" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">is.na</span>(cutoff) <span class="sc">&amp;</span> <span class="fu">is.na</span>(max_num_clusts)){</span>
<span id="cb156-107"><a href="wrapper-functions.html#cb156-107" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(auto_select_size){</span>
<span id="cb156-108"><a href="wrapper-functions.html#cb156-108" aria-hidden="true" tabindex="-1"></a>            max_num_clusts <span class="ot">&lt;-</span> <a href='other-useful.html#getModelSize'>getModelSize</a>(X, y, css_results<span class="sc">$</span>clusters)</span>
<span id="cb156-109"><a href="wrapper-functions.html#cb156-109" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb156-110"><a href="wrapper-functions.html#cb156-110" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb156-111"><a href="wrapper-functions.html#cb156-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-112"><a href="wrapper-functions.html#cb156-112" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">is.na</span>(cutoff)){</span>
<span id="cb156-113"><a href="wrapper-functions.html#cb156-113" aria-hidden="true" tabindex="-1"></a>        cutoff <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb156-114"><a href="wrapper-functions.html#cb156-114" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb156-115"><a href="wrapper-functions.html#cb156-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-116"><a href="wrapper-functions.html#cb156-116" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get selected features</span></span>
<span id="cb156-117"><a href="wrapper-functions.html#cb156-117" aria-hidden="true" tabindex="-1"></a>    <a href='sel-and-pred.html#getCssSelections'>getCssSelections</a>(css_results, <span class="at">weighting=</span><span class="st">&quot;sparse&quot;</span>, <span class="at">cutoff=</span>cutoff,</span>
<span id="cb156-118"><a href="wrapper-functions.html#cb156-118" aria-hidden="true" tabindex="-1"></a>        <span class="at">min_num_clusts=</span><span class="dv">1</span>, <span class="at">max_num_clusts=</span>max_num_clusts)</span>
<span id="cb156-119"><a href="wrapper-functions.html#cb156-119" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Tests for <code><a href='wrapper-functions.html#cssSelect'>cssSelect</a>()</code>:</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="wrapper-functions.html#cb157-1" aria-hidden="true" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">test_that</span>(<span class="st">&quot;cssSelect works&quot;</span>, {</span>
<span id="cb157-2"><a href="wrapper-functions.html#cb157-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">73212</span>)</span>
<span id="cb157-3"><a href="wrapper-functions.html#cb157-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-4"><a href="wrapper-functions.html#cb157-4" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <a href='other-useful.html#genClusteredData'>genClusteredData</a>(<span class="at">n=</span><span class="dv">15</span>, <span class="at">p=</span><span class="dv">11</span>, <span class="at">k_unclustered=</span><span class="dv">2</span>, <span class="at">cluster_size=</span><span class="dv">3</span>,</span>
<span id="cb157-5"><a href="wrapper-functions.html#cb157-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">n_clusters=</span><span class="dv">2</span>, <span class="at">sig_clusters=</span><span class="dv">1</span>, <span class="at">sigma_eps_sq=</span><span class="dv">1</span>)</span>
<span id="cb157-6"><a href="wrapper-functions.html#cb157-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-7"><a href="wrapper-functions.html#cb157-7" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> data<span class="sc">$</span>X</span>
<span id="cb157-8"><a href="wrapper-functions.html#cb157-8" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> data<span class="sc">$</span>y</span>
<span id="cb157-9"><a href="wrapper-functions.html#cb157-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-10"><a href="wrapper-functions.html#cb157-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Intentionally don&#39;t provide clusters for all features, mix up formatting,</span></span>
<span id="cb157-11"><a href="wrapper-functions.html#cb157-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># etc.</span></span>
<span id="cb157-12"><a href="wrapper-functions.html#cb157-12" aria-hidden="true" tabindex="-1"></a>  good_clusters <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">red_cluster=</span>1L<span class="sc">:</span>3L, <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb157-13"><a href="wrapper-functions.html#cb157-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-14"><a href="wrapper-functions.html#cb157-14" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='wrapper-functions.html#cssSelect'>cssSelect</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">clusters=</span>good_clusters)</span>
<span id="cb157-15"><a href="wrapper-functions.html#cb157-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-16"><a href="wrapper-functions.html#cb157-16" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res))</span>
<span id="cb157-17"><a href="wrapper-functions.html#cb157-17" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), <span class="dv">2</span>)</span>
<span id="cb157-18"><a href="wrapper-functions.html#cb157-18" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(res), <span class="fu">c</span>(<span class="st">&quot;selected_clusts&quot;</span>, <span class="st">&quot;selected_feats&quot;</span>))</span>
<span id="cb157-19"><a href="wrapper-functions.html#cb157-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-20"><a href="wrapper-functions.html#cb157-20" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="sc">!</span><span class="fu">is.null</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts)))</span>
<span id="cb157-21"><a href="wrapper-functions.html#cb157-21" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.character</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts)))</span>
<span id="cb157-22"><a href="wrapper-functions.html#cb157-22" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_clusts) <span class="sc">&lt;=</span></span>
<span id="cb157-23"><a href="wrapper-functions.html#cb157-23" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">length</span>(res<span class="sc">$</span>selected_feats))</span>
<span id="cb157-24"><a href="wrapper-functions.html#cb157-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Total of 11 - 2*(3 - 1) = 7 clusters</span></span>
<span id="cb157-25"><a href="wrapper-functions.html#cb157-25" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_clusts) <span class="sc">&lt;=</span> <span class="dv">7</span>)</span>
<span id="cb157-26"><a href="wrapper-functions.html#cb157-26" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_clusts) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb157-27"><a href="wrapper-functions.html#cb157-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-28"><a href="wrapper-functions.html#cb157-28" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res<span class="sc">$</span>selected_clusts))</span>
<span id="cb157-29"><a href="wrapper-functions.html#cb157-29" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts)),</span>
<span id="cb157-30"><a href="wrapper-functions.html#cb157-30" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts))))</span>
<span id="cb157-31"><a href="wrapper-functions.html#cb157-31" aria-hidden="true" tabindex="-1"></a>  already_used_feats <span class="ot">&lt;-</span> <span class="fu">integer</span>()</span>
<span id="cb157-32"><a href="wrapper-functions.html#cb157-32" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(res<span class="sc">$</span>selected_clusts)){</span>
<span id="cb157-33"><a href="wrapper-functions.html#cb157-33" aria-hidden="true" tabindex="-1"></a>    sels_i <span class="ot">&lt;-</span> res<span class="sc">$</span>selected_clusts[[i]]</span>
<span id="cb157-34"><a href="wrapper-functions.html#cb157-34" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(sels_i) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb157-35"><a href="wrapper-functions.html#cb157-35" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.integer</span>(sels_i))</span>
<span id="cb157-36"><a href="wrapper-functions.html#cb157-36" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(sels_i <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>))</span>
<span id="cb157-37"><a href="wrapper-functions.html#cb157-37" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(sels_i), <span class="fu">length</span>(<span class="fu">unique</span>(sels_i)))</span>
<span id="cb157-38"><a href="wrapper-functions.html#cb157-38" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">intersect</span>(already_used_feats, sels_i)), <span class="dv">0</span>)</span>
<span id="cb157-39"><a href="wrapper-functions.html#cb157-39" aria-hidden="true" tabindex="-1"></a>    already_used_feats <span class="ot">&lt;-</span> <span class="fu">c</span>(already_used_feats, sels_i)</span>
<span id="cb157-40"><a href="wrapper-functions.html#cb157-40" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb157-41"><a href="wrapper-functions.html#cb157-41" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(already_used_feats) <span class="sc">&lt;=</span> <span class="dv">11</span>)</span>
<span id="cb157-42"><a href="wrapper-functions.html#cb157-42" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(already_used_feats),</span>
<span id="cb157-43"><a href="wrapper-functions.html#cb157-43" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">length</span>(<span class="fu">unique</span>(already_used_feats)))</span>
<span id="cb157-44"><a href="wrapper-functions.html#cb157-44" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(already_used_feats <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>))</span>
<span id="cb157-45"><a href="wrapper-functions.html#cb157-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-46"><a href="wrapper-functions.html#cb157-46" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_feats) <span class="sc">&lt;=</span> <span class="dv">11</span>)</span>
<span id="cb157-47"><a href="wrapper-functions.html#cb157-47" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.integer</span>(res<span class="sc">$</span>selected_feats))</span>
<span id="cb157-48"><a href="wrapper-functions.html#cb157-48" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_feats) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb157-49"><a href="wrapper-functions.html#cb157-49" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_feats)),</span>
<span id="cb157-50"><a href="wrapper-functions.html#cb157-50" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_feats))))</span>
<span id="cb157-51"><a href="wrapper-functions.html#cb157-51" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(res<span class="sc">$</span>selected_feats <span class="sc">&gt;=</span> <span class="dv">1</span>))</span>
<span id="cb157-52"><a href="wrapper-functions.html#cb157-52" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(res<span class="sc">$</span>selected_feats <span class="sc">&lt;=</span> <span class="dv">11</span>))</span>
<span id="cb157-53"><a href="wrapper-functions.html#cb157-53" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_feats),</span>
<span id="cb157-54"><a href="wrapper-functions.html#cb157-54" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">length</span>(<span class="fu">unique</span>(res<span class="sc">$</span>selected_feats)))</span>
<span id="cb157-55"><a href="wrapper-functions.html#cb157-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-56"><a href="wrapper-functions.html#cb157-56" aria-hidden="true" tabindex="-1"></a>  <span class="co"># No provided clusters</span></span>
<span id="cb157-57"><a href="wrapper-functions.html#cb157-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-58"><a href="wrapper-functions.html#cb157-58" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='wrapper-functions.html#cssSelect'>cssSelect</a>(<span class="at">X=</span>x, <span class="at">y=</span>y)</span>
<span id="cb157-59"><a href="wrapper-functions.html#cb157-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-60"><a href="wrapper-functions.html#cb157-60" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res))</span>
<span id="cb157-61"><a href="wrapper-functions.html#cb157-61" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), <span class="dv">2</span>)</span>
<span id="cb157-62"><a href="wrapper-functions.html#cb157-62" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(res), <span class="fu">c</span>(<span class="st">&quot;selected_clusts&quot;</span>, <span class="st">&quot;selected_feats&quot;</span>))</span>
<span id="cb157-63"><a href="wrapper-functions.html#cb157-63" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-64"><a href="wrapper-functions.html#cb157-64" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="sc">!</span><span class="fu">is.null</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts)))</span>
<span id="cb157-65"><a href="wrapper-functions.html#cb157-65" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.character</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts)))</span>
<span id="cb157-66"><a href="wrapper-functions.html#cb157-66" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_clusts) <span class="sc">&lt;=</span></span>
<span id="cb157-67"><a href="wrapper-functions.html#cb157-67" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">length</span>(res<span class="sc">$</span>selected_feats))</span>
<span id="cb157-68"><a href="wrapper-functions.html#cb157-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-69"><a href="wrapper-functions.html#cb157-69" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_clusts) <span class="sc">&lt;=</span> <span class="dv">11</span>)</span>
<span id="cb157-70"><a href="wrapper-functions.html#cb157-70" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_clusts) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb157-71"><a href="wrapper-functions.html#cb157-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-72"><a href="wrapper-functions.html#cb157-72" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res<span class="sc">$</span>selected_clusts))</span>
<span id="cb157-73"><a href="wrapper-functions.html#cb157-73" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts)),</span>
<span id="cb157-74"><a href="wrapper-functions.html#cb157-74" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts))))</span>
<span id="cb157-75"><a href="wrapper-functions.html#cb157-75" aria-hidden="true" tabindex="-1"></a>  already_used_feats <span class="ot">&lt;-</span> <span class="fu">integer</span>()</span>
<span id="cb157-76"><a href="wrapper-functions.html#cb157-76" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(res<span class="sc">$</span>selected_clusts)){</span>
<span id="cb157-77"><a href="wrapper-functions.html#cb157-77" aria-hidden="true" tabindex="-1"></a>    sels_i <span class="ot">&lt;-</span> res<span class="sc">$</span>selected_clusts[[i]]</span>
<span id="cb157-78"><a href="wrapper-functions.html#cb157-78" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(sels_i) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb157-79"><a href="wrapper-functions.html#cb157-79" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.integer</span>(sels_i))</span>
<span id="cb157-80"><a href="wrapper-functions.html#cb157-80" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(sels_i <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>))</span>
<span id="cb157-81"><a href="wrapper-functions.html#cb157-81" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(sels_i), <span class="fu">length</span>(<span class="fu">unique</span>(sels_i)))</span>
<span id="cb157-82"><a href="wrapper-functions.html#cb157-82" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">intersect</span>(already_used_feats, sels_i)), <span class="dv">0</span>)</span>
<span id="cb157-83"><a href="wrapper-functions.html#cb157-83" aria-hidden="true" tabindex="-1"></a>    already_used_feats <span class="ot">&lt;-</span> <span class="fu">c</span>(already_used_feats, sels_i)</span>
<span id="cb157-84"><a href="wrapper-functions.html#cb157-84" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb157-85"><a href="wrapper-functions.html#cb157-85" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(already_used_feats) <span class="sc">&lt;=</span> <span class="dv">11</span>)</span>
<span id="cb157-86"><a href="wrapper-functions.html#cb157-86" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(already_used_feats),</span>
<span id="cb157-87"><a href="wrapper-functions.html#cb157-87" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">length</span>(<span class="fu">unique</span>(already_used_feats)))</span>
<span id="cb157-88"><a href="wrapper-functions.html#cb157-88" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(already_used_feats <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>))</span>
<span id="cb157-89"><a href="wrapper-functions.html#cb157-89" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-90"><a href="wrapper-functions.html#cb157-90" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_feats) <span class="sc">&lt;=</span> <span class="dv">11</span>)</span>
<span id="cb157-91"><a href="wrapper-functions.html#cb157-91" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.integer</span>(res<span class="sc">$</span>selected_feats))</span>
<span id="cb157-92"><a href="wrapper-functions.html#cb157-92" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_feats) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb157-93"><a href="wrapper-functions.html#cb157-93" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_feats)),</span>
<span id="cb157-94"><a href="wrapper-functions.html#cb157-94" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_feats))))</span>
<span id="cb157-95"><a href="wrapper-functions.html#cb157-95" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(res<span class="sc">$</span>selected_feats <span class="sc">&gt;=</span> <span class="dv">1</span>))</span>
<span id="cb157-96"><a href="wrapper-functions.html#cb157-96" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(res<span class="sc">$</span>selected_feats <span class="sc">&lt;=</span> <span class="dv">11</span>))</span>
<span id="cb157-97"><a href="wrapper-functions.html#cb157-97" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_feats),</span>
<span id="cb157-98"><a href="wrapper-functions.html#cb157-98" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">length</span>(<span class="fu">unique</span>(res<span class="sc">$</span>selected_feats)))</span>
<span id="cb157-99"><a href="wrapper-functions.html#cb157-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-100"><a href="wrapper-functions.html#cb157-100" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Trying other inputs</span></span>
<span id="cb157-101"><a href="wrapper-functions.html#cb157-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-102"><a href="wrapper-functions.html#cb157-102" aria-hidden="true" tabindex="-1"></a>  <span class="co"># X as a data.frame</span></span>
<span id="cb157-103"><a href="wrapper-functions.html#cb157-103" aria-hidden="true" tabindex="-1"></a>  X_df <span class="ot">&lt;-</span> datasets<span class="sc">::</span>mtcars</span>
<span id="cb157-104"><a href="wrapper-functions.html#cb157-104" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-105"><a href="wrapper-functions.html#cb157-105" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='wrapper-functions.html#cssSelect'>cssSelect</a>(<span class="at">X=</span>X_df, <span class="at">y=</span>stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="fu">nrow</span>(X_df)), <span class="at">clusters=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb157-106"><a href="wrapper-functions.html#cb157-106" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-107"><a href="wrapper-functions.html#cb157-107" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res))</span>
<span id="cb157-108"><a href="wrapper-functions.html#cb157-108" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), <span class="dv">2</span>)</span>
<span id="cb157-109"><a href="wrapper-functions.html#cb157-109" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(res), <span class="fu">c</span>(<span class="st">&quot;selected_clusts&quot;</span>, <span class="st">&quot;selected_feats&quot;</span>))</span>
<span id="cb157-110"><a href="wrapper-functions.html#cb157-110" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-111"><a href="wrapper-functions.html#cb157-111" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="sc">!</span><span class="fu">is.null</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts)))</span>
<span id="cb157-112"><a href="wrapper-functions.html#cb157-112" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.character</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts)))</span>
<span id="cb157-113"><a href="wrapper-functions.html#cb157-113" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_clusts) <span class="sc">&lt;=</span></span>
<span id="cb157-114"><a href="wrapper-functions.html#cb157-114" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">length</span>(res<span class="sc">$</span>selected_feats))</span>
<span id="cb157-115"><a href="wrapper-functions.html#cb157-115" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Total of ncol(X_df) - (3 - 1) clusters</span></span>
<span id="cb157-116"><a href="wrapper-functions.html#cb157-116" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_clusts) <span class="sc">&lt;=</span> <span class="fu">ncol</span>(X_df) <span class="sc">-</span> <span class="dv">2</span>)</span>
<span id="cb157-117"><a href="wrapper-functions.html#cb157-117" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_clusts) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb157-118"><a href="wrapper-functions.html#cb157-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-119"><a href="wrapper-functions.html#cb157-119" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res<span class="sc">$</span>selected_clusts))</span>
<span id="cb157-120"><a href="wrapper-functions.html#cb157-120" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts)),</span>
<span id="cb157-121"><a href="wrapper-functions.html#cb157-121" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts))))</span>
<span id="cb157-122"><a href="wrapper-functions.html#cb157-122" aria-hidden="true" tabindex="-1"></a>  already_used_feats <span class="ot">&lt;-</span> <span class="fu">integer</span>()</span>
<span id="cb157-123"><a href="wrapper-functions.html#cb157-123" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(res<span class="sc">$</span>selected_clusts)){</span>
<span id="cb157-124"><a href="wrapper-functions.html#cb157-124" aria-hidden="true" tabindex="-1"></a>    sels_i <span class="ot">&lt;-</span> res<span class="sc">$</span>selected_clusts[[i]]</span>
<span id="cb157-125"><a href="wrapper-functions.html#cb157-125" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(sels_i) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb157-126"><a href="wrapper-functions.html#cb157-126" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.integer</span>(sels_i))</span>
<span id="cb157-127"><a href="wrapper-functions.html#cb157-127" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(sels_i <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(X_df)))</span>
<span id="cb157-128"><a href="wrapper-functions.html#cb157-128" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(sels_i), <span class="fu">length</span>(<span class="fu">unique</span>(sels_i)))</span>
<span id="cb157-129"><a href="wrapper-functions.html#cb157-129" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">intersect</span>(already_used_feats, sels_i)), <span class="dv">0</span>)</span>
<span id="cb157-130"><a href="wrapper-functions.html#cb157-130" aria-hidden="true" tabindex="-1"></a>    already_used_feats <span class="ot">&lt;-</span> <span class="fu">c</span>(already_used_feats, sels_i)</span>
<span id="cb157-131"><a href="wrapper-functions.html#cb157-131" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb157-132"><a href="wrapper-functions.html#cb157-132" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(already_used_feats) <span class="sc">&lt;=</span> <span class="fu">ncol</span>(X_df))</span>
<span id="cb157-133"><a href="wrapper-functions.html#cb157-133" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(already_used_feats),</span>
<span id="cb157-134"><a href="wrapper-functions.html#cb157-134" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">length</span>(<span class="fu">unique</span>(already_used_feats)))</span>
<span id="cb157-135"><a href="wrapper-functions.html#cb157-135" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(already_used_feats <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(X_df)))</span>
<span id="cb157-136"><a href="wrapper-functions.html#cb157-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-137"><a href="wrapper-functions.html#cb157-137" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_feats) <span class="sc">&lt;=</span> <span class="fu">ncol</span>(X_df))</span>
<span id="cb157-138"><a href="wrapper-functions.html#cb157-138" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.integer</span>(res<span class="sc">$</span>selected_feats))</span>
<span id="cb157-139"><a href="wrapper-functions.html#cb157-139" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_feats) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb157-140"><a href="wrapper-functions.html#cb157-140" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_feats)),</span>
<span id="cb157-141"><a href="wrapper-functions.html#cb157-141" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_feats))))</span>
<span id="cb157-142"><a href="wrapper-functions.html#cb157-142" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(res<span class="sc">$</span>selected_feats <span class="sc">&gt;=</span> <span class="dv">1</span>))</span>
<span id="cb157-143"><a href="wrapper-functions.html#cb157-143" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(res<span class="sc">$</span>selected_feats <span class="sc">&lt;=</span> <span class="fu">ncol</span>(X_df)))</span>
<span id="cb157-144"><a href="wrapper-functions.html#cb157-144" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_feats),</span>
<span id="cb157-145"><a href="wrapper-functions.html#cb157-145" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">length</span>(<span class="fu">unique</span>(res<span class="sc">$</span>selected_feats)))</span>
<span id="cb157-146"><a href="wrapper-functions.html#cb157-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-147"><a href="wrapper-functions.html#cb157-147" aria-hidden="true" tabindex="-1"></a>  <span class="co"># X as a dataframe with factors (number of columns of final design matrix</span></span>
<span id="cb157-148"><a href="wrapper-functions.html#cb157-148" aria-hidden="true" tabindex="-1"></a>  <span class="co"># after one-hot encoding factors won&#39;t match number of columns of df2)</span></span>
<span id="cb157-149"><a href="wrapper-functions.html#cb157-149" aria-hidden="true" tabindex="-1"></a>  <span class="co"># cyl, gear, and carb are factors with more than 2 levels</span></span>
<span id="cb157-150"><a href="wrapper-functions.html#cb157-150" aria-hidden="true" tabindex="-1"></a>  df2 <span class="ot">&lt;-</span> X_df</span>
<span id="cb157-151"><a href="wrapper-functions.html#cb157-151" aria-hidden="true" tabindex="-1"></a>  df2<span class="sc">$</span>cyl <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df2<span class="sc">$</span>cyl)</span>
<span id="cb157-152"><a href="wrapper-functions.html#cb157-152" aria-hidden="true" tabindex="-1"></a>  df2<span class="sc">$</span>vs <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df2<span class="sc">$</span>vs)</span>
<span id="cb157-153"><a href="wrapper-functions.html#cb157-153" aria-hidden="true" tabindex="-1"></a>  df2<span class="sc">$</span>am <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df2<span class="sc">$</span>am)</span>
<span id="cb157-154"><a href="wrapper-functions.html#cb157-154" aria-hidden="true" tabindex="-1"></a>  df2<span class="sc">$</span>gear <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df2<span class="sc">$</span>gear)</span>
<span id="cb157-155"><a href="wrapper-functions.html#cb157-155" aria-hidden="true" tabindex="-1"></a>  df2<span class="sc">$</span>carb <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df2<span class="sc">$</span>carb)</span>
<span id="cb157-156"><a href="wrapper-functions.html#cb157-156" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-157"><a href="wrapper-functions.html#cb157-157" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Should get error if I try to use data.frame with clusters, since data.frame</span></span>
<span id="cb157-158"><a href="wrapper-functions.html#cb157-158" aria-hidden="true" tabindex="-1"></a>  <span class="co"># has factors with more than two levels</span></span>
<span id="cb157-159"><a href="wrapper-functions.html#cb157-159" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='wrapper-functions.html#cssSelect'>cssSelect</a>(<span class="at">X=</span>df2, <span class="at">y=</span>stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="fu">nrow</span>(X_df)),</span>
<span id="cb157-160"><a href="wrapper-functions.html#cb157-160" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">clusters=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>),</span>
<span id="cb157-161"><a href="wrapper-functions.html#cb157-161" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;When stats::model.matrix converted the provided data.frame X to a matrix, the number of columns changed (probably because the provided data.frame contained a factor variable with at least three levels). Please convert the data.frame X to a matrix yourself using model.matrix and provide cluster assignments according to the columns of the new matrix.&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb157-162"><a href="wrapper-functions.html#cb157-162" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-163"><a href="wrapper-functions.html#cb157-163" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Should be fine if I don&#39;t use clusters</span></span>
<span id="cb157-164"><a href="wrapper-functions.html#cb157-164" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='wrapper-functions.html#cssSelect'>cssSelect</a>(<span class="at">X=</span>df2, <span class="at">y=</span>stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="fu">nrow</span>(X_df)))</span>
<span id="cb157-165"><a href="wrapper-functions.html#cb157-165" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-166"><a href="wrapper-functions.html#cb157-166" aria-hidden="true" tabindex="-1"></a>  X_df_mat <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">model.matrix</span>(<span class="sc">~</span> ., df2)</span>
<span id="cb157-167"><a href="wrapper-functions.html#cb157-167" aria-hidden="true" tabindex="-1"></a>  X_df_mat <span class="ot">&lt;-</span> X_df_mat[, <span class="fu">colnames</span>(X_df_mat) <span class="sc">!=</span> <span class="st">&quot;(Intercept)&quot;</span>]</span>
<span id="cb157-168"><a href="wrapper-functions.html#cb157-168" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ncol</span>(X_df_mat)</span>
<span id="cb157-169"><a href="wrapper-functions.html#cb157-169" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-170"><a href="wrapper-functions.html#cb157-170" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res))</span>
<span id="cb157-171"><a href="wrapper-functions.html#cb157-171" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), <span class="dv">2</span>)</span>
<span id="cb157-172"><a href="wrapper-functions.html#cb157-172" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(res), <span class="fu">c</span>(<span class="st">&quot;selected_clusts&quot;</span>, <span class="st">&quot;selected_feats&quot;</span>))</span>
<span id="cb157-173"><a href="wrapper-functions.html#cb157-173" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-174"><a href="wrapper-functions.html#cb157-174" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="sc">!</span><span class="fu">is.null</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts)))</span>
<span id="cb157-175"><a href="wrapper-functions.html#cb157-175" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.character</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts)))</span>
<span id="cb157-176"><a href="wrapper-functions.html#cb157-176" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_clusts) <span class="sc">&lt;=</span></span>
<span id="cb157-177"><a href="wrapper-functions.html#cb157-177" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">length</span>(res<span class="sc">$</span>selected_feats))</span>
<span id="cb157-178"><a href="wrapper-functions.html#cb157-178" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Total of p - (3 - 1) clusters</span></span>
<span id="cb157-179"><a href="wrapper-functions.html#cb157-179" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_clusts) <span class="sc">&lt;=</span> p <span class="sc">-</span> <span class="dv">2</span>)</span>
<span id="cb157-180"><a href="wrapper-functions.html#cb157-180" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_clusts) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb157-181"><a href="wrapper-functions.html#cb157-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-182"><a href="wrapper-functions.html#cb157-182" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res<span class="sc">$</span>selected_clusts))</span>
<span id="cb157-183"><a href="wrapper-functions.html#cb157-183" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts)),</span>
<span id="cb157-184"><a href="wrapper-functions.html#cb157-184" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts))))</span>
<span id="cb157-185"><a href="wrapper-functions.html#cb157-185" aria-hidden="true" tabindex="-1"></a>  already_used_feats <span class="ot">&lt;-</span> <span class="fu">integer</span>()</span>
<span id="cb157-186"><a href="wrapper-functions.html#cb157-186" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(res<span class="sc">$</span>selected_clusts)){</span>
<span id="cb157-187"><a href="wrapper-functions.html#cb157-187" aria-hidden="true" tabindex="-1"></a>    sels_i <span class="ot">&lt;-</span> res<span class="sc">$</span>selected_clusts[[i]]</span>
<span id="cb157-188"><a href="wrapper-functions.html#cb157-188" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(sels_i) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb157-189"><a href="wrapper-functions.html#cb157-189" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.integer</span>(sels_i))</span>
<span id="cb157-190"><a href="wrapper-functions.html#cb157-190" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(sels_i <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span>p))</span>
<span id="cb157-191"><a href="wrapper-functions.html#cb157-191" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(sels_i), <span class="fu">length</span>(<span class="fu">unique</span>(sels_i)))</span>
<span id="cb157-192"><a href="wrapper-functions.html#cb157-192" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">intersect</span>(already_used_feats, sels_i)), <span class="dv">0</span>)</span>
<span id="cb157-193"><a href="wrapper-functions.html#cb157-193" aria-hidden="true" tabindex="-1"></a>    already_used_feats <span class="ot">&lt;-</span> <span class="fu">c</span>(already_used_feats, sels_i)</span>
<span id="cb157-194"><a href="wrapper-functions.html#cb157-194" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb157-195"><a href="wrapper-functions.html#cb157-195" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(already_used_feats) <span class="sc">&lt;=</span> p)</span>
<span id="cb157-196"><a href="wrapper-functions.html#cb157-196" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(already_used_feats),</span>
<span id="cb157-197"><a href="wrapper-functions.html#cb157-197" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">length</span>(<span class="fu">unique</span>(already_used_feats)))</span>
<span id="cb157-198"><a href="wrapper-functions.html#cb157-198" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(already_used_feats <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span>p))</span>
<span id="cb157-199"><a href="wrapper-functions.html#cb157-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-200"><a href="wrapper-functions.html#cb157-200" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_feats) <span class="sc">&lt;=</span> p)</span>
<span id="cb157-201"><a href="wrapper-functions.html#cb157-201" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.integer</span>(res<span class="sc">$</span>selected_feats))</span>
<span id="cb157-202"><a href="wrapper-functions.html#cb157-202" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_feats) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb157-203"><a href="wrapper-functions.html#cb157-203" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_feats)),</span>
<span id="cb157-204"><a href="wrapper-functions.html#cb157-204" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_feats))))</span>
<span id="cb157-205"><a href="wrapper-functions.html#cb157-205" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(res<span class="sc">$</span>selected_feats <span class="sc">&gt;=</span> <span class="dv">1</span>))</span>
<span id="cb157-206"><a href="wrapper-functions.html#cb157-206" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(res<span class="sc">$</span>selected_feats <span class="sc">&lt;=</span> p))</span>
<span id="cb157-207"><a href="wrapper-functions.html#cb157-207" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_feats),</span>
<span id="cb157-208"><a href="wrapper-functions.html#cb157-208" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">length</span>(<span class="fu">unique</span>(res<span class="sc">$</span>selected_feats)))</span>
<span id="cb157-209"><a href="wrapper-functions.html#cb157-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-210"><a href="wrapper-functions.html#cb157-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-211"><a href="wrapper-functions.html#cb157-211" aria-hidden="true" tabindex="-1"></a>  <span class="co"># X as a matrix with column names</span></span>
<span id="cb157-212"><a href="wrapper-functions.html#cb157-212" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> x</span>
<span id="cb157-213"><a href="wrapper-functions.html#cb157-213" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(x2) <span class="ot">&lt;-</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>]</span>
<span id="cb157-214"><a href="wrapper-functions.html#cb157-214" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-215"><a href="wrapper-functions.html#cb157-215" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='wrapper-functions.html#cssSelect'>cssSelect</a>(<span class="at">X=</span>x2, <span class="at">y=</span>y, <span class="at">clusters=</span>good_clusters)</span>
<span id="cb157-216"><a href="wrapper-functions.html#cb157-216" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-217"><a href="wrapper-functions.html#cb157-217" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res))</span>
<span id="cb157-218"><a href="wrapper-functions.html#cb157-218" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), <span class="dv">2</span>)</span>
<span id="cb157-219"><a href="wrapper-functions.html#cb157-219" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(res), <span class="fu">c</span>(<span class="st">&quot;selected_clusts&quot;</span>, <span class="st">&quot;selected_feats&quot;</span>))</span>
<span id="cb157-220"><a href="wrapper-functions.html#cb157-220" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-221"><a href="wrapper-functions.html#cb157-221" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="sc">!</span><span class="fu">is.null</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts)))</span>
<span id="cb157-222"><a href="wrapper-functions.html#cb157-222" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.character</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts)))</span>
<span id="cb157-223"><a href="wrapper-functions.html#cb157-223" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_clusts) <span class="sc">&lt;=</span></span>
<span id="cb157-224"><a href="wrapper-functions.html#cb157-224" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">length</span>(res<span class="sc">$</span>selected_feats))</span>
<span id="cb157-225"><a href="wrapper-functions.html#cb157-225" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Total of 11 - 2*(3 - 1) = 7 clusters</span></span>
<span id="cb157-226"><a href="wrapper-functions.html#cb157-226" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_clusts) <span class="sc">&lt;=</span> <span class="dv">7</span>)</span>
<span id="cb157-227"><a href="wrapper-functions.html#cb157-227" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_clusts) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb157-228"><a href="wrapper-functions.html#cb157-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-229"><a href="wrapper-functions.html#cb157-229" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res<span class="sc">$</span>selected_clusts))</span>
<span id="cb157-230"><a href="wrapper-functions.html#cb157-230" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts)),</span>
<span id="cb157-231"><a href="wrapper-functions.html#cb157-231" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_clusts))))</span>
<span id="cb157-232"><a href="wrapper-functions.html#cb157-232" aria-hidden="true" tabindex="-1"></a>  already_used_feats <span class="ot">&lt;-</span> <span class="fu">integer</span>()</span>
<span id="cb157-233"><a href="wrapper-functions.html#cb157-233" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(res<span class="sc">$</span>selected_clusts)){</span>
<span id="cb157-234"><a href="wrapper-functions.html#cb157-234" aria-hidden="true" tabindex="-1"></a>    sels_i <span class="ot">&lt;-</span> res<span class="sc">$</span>selected_clusts[[i]]</span>
<span id="cb157-235"><a href="wrapper-functions.html#cb157-235" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(sels_i) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb157-236"><a href="wrapper-functions.html#cb157-236" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.integer</span>(sels_i))</span>
<span id="cb157-237"><a href="wrapper-functions.html#cb157-237" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(sels_i <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>))</span>
<span id="cb157-238"><a href="wrapper-functions.html#cb157-238" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(sels_i), <span class="fu">length</span>(<span class="fu">unique</span>(sels_i)))</span>
<span id="cb157-239"><a href="wrapper-functions.html#cb157-239" aria-hidden="true" tabindex="-1"></a>    testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">intersect</span>(already_used_feats, sels_i)), <span class="dv">0</span>)</span>
<span id="cb157-240"><a href="wrapper-functions.html#cb157-240" aria-hidden="true" tabindex="-1"></a>    already_used_feats <span class="ot">&lt;-</span> <span class="fu">c</span>(already_used_feats, sels_i)</span>
<span id="cb157-241"><a href="wrapper-functions.html#cb157-241" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb157-242"><a href="wrapper-functions.html#cb157-242" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(already_used_feats) <span class="sc">&lt;=</span> <span class="dv">11</span>)</span>
<span id="cb157-243"><a href="wrapper-functions.html#cb157-243" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(already_used_feats),</span>
<span id="cb157-244"><a href="wrapper-functions.html#cb157-244" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">length</span>(<span class="fu">unique</span>(already_used_feats)))</span>
<span id="cb157-245"><a href="wrapper-functions.html#cb157-245" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(already_used_feats <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>))</span>
<span id="cb157-246"><a href="wrapper-functions.html#cb157-246" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-247"><a href="wrapper-functions.html#cb157-247" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_feats) <span class="sc">&lt;=</span> <span class="dv">11</span>)</span>
<span id="cb157-248"><a href="wrapper-functions.html#cb157-248" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.integer</span>(res<span class="sc">$</span>selected_feats))</span>
<span id="cb157-249"><a href="wrapper-functions.html#cb157-249" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_feats) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb157-250"><a href="wrapper-functions.html#cb157-250" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_feats)),</span>
<span id="cb157-251"><a href="wrapper-functions.html#cb157-251" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">names</span>(res<span class="sc">$</span>selected_feats))))</span>
<span id="cb157-252"><a href="wrapper-functions.html#cb157-252" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(res<span class="sc">$</span>selected_feats <span class="sc">&gt;=</span> <span class="dv">1</span>))</span>
<span id="cb157-253"><a href="wrapper-functions.html#cb157-253" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(res<span class="sc">$</span>selected_feats <span class="sc">&lt;=</span> <span class="dv">11</span>))</span>
<span id="cb157-254"><a href="wrapper-functions.html#cb157-254" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_feats),</span>
<span id="cb157-255"><a href="wrapper-functions.html#cb157-255" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">length</span>(<span class="fu">unique</span>(res<span class="sc">$</span>selected_feats)))</span>
<span id="cb157-256"><a href="wrapper-functions.html#cb157-256" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-257"><a href="wrapper-functions.html#cb157-257" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Vary inputs</span></span>
<span id="cb157-258"><a href="wrapper-functions.html#cb157-258" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='wrapper-functions.html#cssSelect'>cssSelect</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">clusters=</span>good_clusters, <span class="at">lambda=</span><span class="fl">0.01</span>)</span>
<span id="cb157-259"><a href="wrapper-functions.html#cb157-259" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-260"><a href="wrapper-functions.html#cb157-260" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res))</span>
<span id="cb157-261"><a href="wrapper-functions.html#cb157-261" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), <span class="dv">2</span>)</span>
<span id="cb157-262"><a href="wrapper-functions.html#cb157-262" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(res), <span class="fu">c</span>(<span class="st">&quot;selected_clusts&quot;</span>, <span class="st">&quot;selected_feats&quot;</span>))</span>
<span id="cb157-263"><a href="wrapper-functions.html#cb157-263" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-264"><a href="wrapper-functions.html#cb157-264" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='wrapper-functions.html#cssSelect'>cssSelect</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">clusters=</span>good_clusters, <span class="at">cutoff=</span><span class="fl">0.6</span>)</span>
<span id="cb157-265"><a href="wrapper-functions.html#cb157-265" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-266"><a href="wrapper-functions.html#cb157-266" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res))</span>
<span id="cb157-267"><a href="wrapper-functions.html#cb157-267" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), <span class="dv">2</span>)</span>
<span id="cb157-268"><a href="wrapper-functions.html#cb157-268" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(res), <span class="fu">c</span>(<span class="st">&quot;selected_clusts&quot;</span>, <span class="st">&quot;selected_feats&quot;</span>))</span>
<span id="cb157-269"><a href="wrapper-functions.html#cb157-269" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-270"><a href="wrapper-functions.html#cb157-270" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='wrapper-functions.html#cssSelect'>cssSelect</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">clusters=</span>good_clusters, <span class="at">max_num_clusts=</span><span class="dv">6</span>)</span>
<span id="cb157-271"><a href="wrapper-functions.html#cb157-271" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-272"><a href="wrapper-functions.html#cb157-272" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res))</span>
<span id="cb157-273"><a href="wrapper-functions.html#cb157-273" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), <span class="dv">2</span>)</span>
<span id="cb157-274"><a href="wrapper-functions.html#cb157-274" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(res), <span class="fu">c</span>(<span class="st">&quot;selected_clusts&quot;</span>, <span class="st">&quot;selected_feats&quot;</span>))</span>
<span id="cb157-275"><a href="wrapper-functions.html#cb157-275" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_clusts) <span class="sc">&lt;=</span> <span class="dv">6</span>)</span>
<span id="cb157-276"><a href="wrapper-functions.html#cb157-276" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-277"><a href="wrapper-functions.html#cb157-277" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='wrapper-functions.html#cssSelect'>cssSelect</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">clusters=</span>good_clusters, <span class="at">auto_select_size=</span><span class="cn">FALSE</span>)</span>
<span id="cb157-278"><a href="wrapper-functions.html#cb157-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-279"><a href="wrapper-functions.html#cb157-279" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.list</span>(res))</span>
<span id="cb157-280"><a href="wrapper-functions.html#cb157-280" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), <span class="dv">2</span>)</span>
<span id="cb157-281"><a href="wrapper-functions.html#cb157-281" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_identical</span>(<span class="fu">names</span>(res), <span class="fu">c</span>(<span class="st">&quot;selected_clusts&quot;</span>, <span class="st">&quot;selected_feats&quot;</span>))</span>
<span id="cb157-282"><a href="wrapper-functions.html#cb157-282" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Total of 11 - 2*(3 - 1) = 7 clusters</span></span>
<span id="cb157-283"><a href="wrapper-functions.html#cb157-283" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res<span class="sc">$</span>selected_clusts), <span class="dv">7</span>)</span>
<span id="cb157-284"><a href="wrapper-functions.html#cb157-284" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-285"><a href="wrapper-functions.html#cb157-285" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Bad inputs</span></span>
<span id="cb157-286"><a href="wrapper-functions.html#cb157-286" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='wrapper-functions.html#cssSelect'>cssSelect</a>(<span class="at">X=</span>x[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, ], <span class="at">y=</span>y),</span>
<span id="cb157-287"><a href="wrapper-functions.html#cb157-287" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;n == length(y) is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb157-288"><a href="wrapper-functions.html#cb157-288" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-289"><a href="wrapper-functions.html#cb157-289" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='wrapper-functions.html#cssSelect'>cssSelect</a>(<span class="at">X=</span><span class="fu">character</span>(<span class="dv">5</span>), <span class="at">y=</span>y),</span>
<span id="cb157-290"><a href="wrapper-functions.html#cb157-290" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;is.matrix(X) | is.data.frame(X) is not TRUE&quot;</span>,</span>
<span id="cb157-291"><a href="wrapper-functions.html#cb157-291" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb157-292"><a href="wrapper-functions.html#cb157-292" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-293"><a href="wrapper-functions.html#cb157-293" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='wrapper-functions.html#cssSelect'>cssSelect</a>(<span class="at">X=</span>x, <span class="at">y=</span><span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>, <span class="dv">5</span>, <span class="dv">3</span>)),</span>
<span id="cb157-294"><a href="wrapper-functions.html#cb157-294" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;!is.matrix(y) is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb157-295"><a href="wrapper-functions.html#cb157-295" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-296"><a href="wrapper-functions.html#cb157-296" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='wrapper-functions.html#cssSelect'>cssSelect</a>(<span class="at">X=</span>x, <span class="at">y=</span><span class="fu">factor</span>(<span class="fu">rbinom</span>(<span class="dv">15</span>, <span class="at">size=</span><span class="dv">1</span>, <span class="at">prob=</span>.<span class="dv">5</span>))),</span>
<span id="cb157-297"><a href="wrapper-functions.html#cb157-297" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;The provided y must be real-valued, because cssSelect uses the lasso for feature selection. (In order to use a different form of response, use the css function and provide your own selection function accommodating your choice of y.)&quot;</span>,</span>
<span id="cb157-298"><a href="wrapper-functions.html#cb157-298" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb157-299"><a href="wrapper-functions.html#cb157-299" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-300"><a href="wrapper-functions.html#cb157-300" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='wrapper-functions.html#cssSelect'>cssSelect</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">clusters=</span><span class="st">&quot;clusters&quot;</span>),</span>
<span id="cb157-301"><a href="wrapper-functions.html#cb157-301" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;is.numeric(clusters) | is.integer(clusters) is not TRUE&quot;</span>,</span>
<span id="cb157-302"><a href="wrapper-functions.html#cb157-302" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb157-303"><a href="wrapper-functions.html#cb157-303" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-304"><a href="wrapper-functions.html#cb157-304" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='wrapper-functions.html#cssSelect'>cssSelect</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">lambda=</span><span class="sc">-</span>.<span class="dv">1</span>),</span>
<span id="cb157-305"><a href="wrapper-functions.html#cb157-305" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;For method cssLasso, lambda must be nonnegative.&quot;</span>,</span>
<span id="cb157-306"><a href="wrapper-functions.html#cb157-306" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb157-307"><a href="wrapper-functions.html#cb157-307" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-308"><a href="wrapper-functions.html#cb157-308" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='wrapper-functions.html#cssSelect'>cssSelect</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">cutoff=</span><span class="fl">1.1</span>),</span>
<span id="cb157-309"><a href="wrapper-functions.html#cb157-309" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;cutoff &lt;= 1 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb157-310"><a href="wrapper-functions.html#cb157-310" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-311"><a href="wrapper-functions.html#cb157-311" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='wrapper-functions.html#cssSelect'>cssSelect</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">max_num_clusts=</span><span class="dv">1000</span>),</span>
<span id="cb157-312"><a href="wrapper-functions.html#cb157-312" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;max_num_clusts &lt;= p is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb157-313"><a href="wrapper-functions.html#cb157-313" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-314"><a href="wrapper-functions.html#cb157-314" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='wrapper-functions.html#cssSelect'>cssSelect</a>(<span class="at">X=</span>x, <span class="at">y=</span>y, <span class="at">auto_select_size=</span><span class="dv">1</span>),</span>
<span id="cb157-315"><a href="wrapper-functions.html#cb157-315" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;is.logical(auto_select_size) is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb157-316"><a href="wrapper-functions.html#cb157-316" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## ── Warning (&#39;&lt;text&gt;:14&#39;): cssSelect works ──────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='wrapper-functions.html#cssSelect'>cssSelect</a>(X = x, y = y, clusters = good_clusters)
##  2. litr (local) <a href='other-useful.html#getLassoLambda'>getLassoLambda</a>(X, y)
##  3. glmnet::cv.glmnet(...)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:14&#39;): cssSelect works ──────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='wrapper-functions.html#cssSelect'>cssSelect</a>(X = x, y = y, clusters = good_clusters)
##  2. litr (local) <a href='other-useful.html#getModelSize'>getModelSize</a>(X, y, css_results$clusters)
##  3. glmnet::cv.glmnet(x = X_size, y = y, family = &quot;gaussian&quot;)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:58&#39;): cssSelect works ──────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='wrapper-functions.html#cssSelect'>cssSelect</a>(X = x, y = y)
##  2. litr (local) <a href='other-useful.html#getLassoLambda'>getLassoLambda</a>(X, y)
##  3. glmnet::cv.glmnet(...)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:58&#39;): cssSelect works ──────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='wrapper-functions.html#cssSelect'>cssSelect</a>(X = x, y = y)
##  2. litr (local) <a href='other-useful.html#getModelSize'>getModelSize</a>(X, y, css_results$clusters)
##  3. glmnet::cv.glmnet(x = X_size, y = y, family = &quot;gaussian&quot;)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:105&#39;): cssSelect works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='wrapper-functions.html#cssSelect'>cssSelect</a>(X = X_df, y = stats::rnorm(nrow(X_df)), clusters = 1:3)
##  2. litr (local) <a href='other-useful.html#getLassoLambda'>getLassoLambda</a>(X, y)
##  3. glmnet::cv.glmnet(...)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:105&#39;): cssSelect works ─────────────────────────────────────
## Returning more than max_num_clusts = 1 clusters because increasing the cutoff any further would require returning 0 clusters
## Backtrace:
##  1. litr (local) <a href='wrapper-functions.html#cssSelect'>cssSelect</a>(X = X_df, y = stats::rnorm(nrow(X_df)), clusters = 1:3)
##  2. litr (local) <a href='sel-and-pred.html#getCssSelections'>getCssSelections</a>(...)
##  3. litr (local) <a href='sel-and-pred.html#getSelectedClusters'>getSelectedClusters</a>(...)
##  4. litr (local) <a href='sel-and-pred.html#checkSelectedClusters'>checkSelectedClusters</a>(...)
## 
## ── Warning (&#39;&lt;text&gt;:164&#39;): cssSelect works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='wrapper-functions.html#cssSelect'>cssSelect</a>(X = df2, y = stats::rnorm(nrow(X_df)))
##  2. litr (local) <a href='other-useful.html#getLassoLambda'>getLassoLambda</a>(X, y)
##  3. glmnet::cv.glmnet(...)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:215&#39;): cssSelect works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='wrapper-functions.html#cssSelect'>cssSelect</a>(X = x2, y = y, clusters = good_clusters)
##  2. litr (local) <a href='other-useful.html#getLassoLambda'>getLassoLambda</a>(X, y)
##  3. glmnet::cv.glmnet(...)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:215&#39;): cssSelect works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='wrapper-functions.html#cssSelect'>cssSelect</a>(X = x2, y = y, clusters = good_clusters)
##  2. litr (local) <a href='other-useful.html#getModelSize'>getModelSize</a>(X, y, css_results$clusters)
##  3. glmnet::cv.glmnet(x = X_size, y = y, family = &quot;gaussian&quot;)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:258&#39;): cssSelect works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='wrapper-functions.html#cssSelect'>cssSelect</a>(X = x, y = y, clusters = good_clusters, lambda = 0.01)
##  2. litr (local) <a href='other-useful.html#getModelSize'>getModelSize</a>(X, y, css_results$clusters)
##  3. glmnet::cv.glmnet(x = X_size, y = y, family = &quot;gaussian&quot;)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:264&#39;): cssSelect works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='wrapper-functions.html#cssSelect'>cssSelect</a>(X = x, y = y, clusters = good_clusters, cutoff = 0.6)
##  2. litr (local) <a href='other-useful.html#getLassoLambda'>getLassoLambda</a>(X, y)
##  3. glmnet::cv.glmnet(...)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:270&#39;): cssSelect works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='wrapper-functions.html#cssSelect'>cssSelect</a>(X = x, y = y, clusters = good_clusters, max_num_clusts = 6)
##  2. litr (local) <a href='other-useful.html#getLassoLambda'>getLassoLambda</a>(X, y)
##  3. glmnet::cv.glmnet(...)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:277&#39;): cssSelect works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='wrapper-functions.html#cssSelect'>cssSelect</a>(X = x, y = y, clusters = good_clusters, auto_select_size = FALSE)
##  2. litr (local) <a href='other-useful.html#getLassoLambda'>getLassoLambda</a>(X, y)
##  3. glmnet::cv.glmnet(...)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:293&#39;): cssSelect works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##   1. testthat::expect_error(...)
##   7. litr (local) <a href='wrapper-functions.html#cssSelect'>cssSelect</a>(X = x, y = matrix(1:15, 5, 3))
##   8. litr (local) <a href='other-useful.html#getLassoLambda'>getLassoLambda</a>(X, y)
##   9. glmnet::cv.glmnet(...)
##  10. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:300&#39;): cssSelect works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##   1. testthat::expect_error(...)
##   7. litr (local) <a href='wrapper-functions.html#cssSelect'>cssSelect</a>(X = x, y = y, clusters = &quot;clusters&quot;)
##   8. litr (local) <a href='other-useful.html#getLassoLambda'>getLassoLambda</a>(X, y)
##   9. glmnet::cv.glmnet(...)
##  10. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:308&#39;): cssSelect works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##   1. testthat::expect_error(...)
##   7. litr (local) <a href='wrapper-functions.html#cssSelect'>cssSelect</a>(X = x, y = y, cutoff = 1.1)
##   8. litr (local) <a href='other-useful.html#getLassoLambda'>getLassoLambda</a>(X, y)
##   9. glmnet::cv.glmnet(...)
##  10. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:311&#39;): cssSelect works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##   1. testthat::expect_error(...)
##   7. litr (local) <a href='wrapper-functions.html#cssSelect'>cssSelect</a>(X = x, y = y, max_num_clusts = 1000)
##   8. litr (local) <a href='other-useful.html#getLassoLambda'>getLassoLambda</a>(X, y)
##   9. glmnet::cv.glmnet(...)
##  10. glmnet:::cv.glmnet.raw(...)</code></pre>
<p><code><a href='wrapper-functions.html#cssPredict'>cssPredict</a>()</code>:</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="wrapper-functions.html#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Wrapper function to generate predictions from cluster stability selected</span></span>
<span id="cb159-2"><a href="wrapper-functions.html#cb159-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; model in one step</span></span>
<span id="cb159-3"><a href="wrapper-functions.html#cb159-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb159-4"><a href="wrapper-functions.html#cb159-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Select clusters using cluster stability selection, form cluster</span></span>
<span id="cb159-5"><a href="wrapper-functions.html#cb159-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; representatives, fit a linear model, and generate predictions from a matrix</span></span>
<span id="cb159-6"><a href="wrapper-functions.html#cb159-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; of unlabeled data. This is a wrapper function for css and getCssPreds. Using</span></span>
<span id="cb159-7"><a href="wrapper-functions.html#cb159-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; cssPredict is simpler, but it has fewer options, and it executes the full</span></span>
<span id="cb159-8"><a href="wrapper-functions.html#cb159-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; (computationally expensive) subsampling procedured every time it is called.</span></span>
<span id="cb159-9"><a href="wrapper-functions.html#cb159-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; In contrast, css can be called just once, and then cssPredict can quickly</span></span>
<span id="cb159-10"><a href="wrapper-functions.html#cb159-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; return results for different matrices of new data or using different values</span></span>
<span id="cb159-11"><a href="wrapper-functions.html#cb159-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; of cutoff, max_num_clusts, etc. by using the calculations done in one call to</span></span>
<span id="cb159-12"><a href="wrapper-functions.html#cb159-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; css.</span></span>
<span id="cb159-13"><a href="wrapper-functions.html#cb159-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb159-14"><a href="wrapper-functions.html#cb159-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param X_train_selec An n x p numeric matrix (preferably) or a data.frame</span></span>
<span id="cb159-15"><a href="wrapper-functions.html#cb159-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; (which will be coerced internally to a matrix by the function model.matrix)</span></span>
<span id="cb159-16"><a href="wrapper-functions.html#cb159-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; containing the p &gt;= 2 features/predictors. The data from X_train_selec and</span></span>
<span id="cb159-17"><a href="wrapper-functions.html#cb159-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; y_train_selec will be split into two parts; half of the data will be used for</span></span>
<span id="cb159-18"><a href="wrapper-functions.html#cb159-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; feature selection by cluster stability selection, and half will be used for</span></span>
<span id="cb159-19"><a href="wrapper-functions.html#cb159-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; estimating a linear model on the selected cluster representatives.</span></span>
<span id="cb159-20"><a href="wrapper-functions.html#cb159-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param y_train_selec A length-n numeric vector containing the responses;</span></span>
<span id="cb159-21"><a href="wrapper-functions.html#cb159-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; `y[i]` is the response corresponding to observation `X[i, ]`. Unlke the more</span></span>
<span id="cb159-22"><a href="wrapper-functions.html#cb159-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; general setup of css, y_train_selec must be real-valued because predictions</span></span>
<span id="cb159-23"><a href="wrapper-functions.html#cb159-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; will be generated by ordinary least squares.</span></span>
<span id="cb159-24"><a href="wrapper-functions.html#cb159-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param X_test A numeric matrix (preferably) or a data.frame (which will</span></span>
<span id="cb159-25"><a href="wrapper-functions.html#cb159-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; be coerced internally to a matrix by the function model.matrix) containing</span></span>
<span id="cb159-26"><a href="wrapper-functions.html#cb159-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; the data that will be used to generate predictions. Must contain the same</span></span>
<span id="cb159-27"><a href="wrapper-functions.html#cb159-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; features (in the same number of columns) as X_train_selec, and if the columns</span></span>
<span id="cb159-28"><a href="wrapper-functions.html#cb159-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; of X_test are named, they must match the names of X_train_selec.</span></span>
<span id="cb159-29"><a href="wrapper-functions.html#cb159-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param clusters Optional; either an integer vector of a list of integer</span></span>
<span id="cb159-30"><a href="wrapper-functions.html#cb159-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; vectors; each vector should contain the indices of a cluster of features (a</span></span>
<span id="cb159-31"><a href="wrapper-functions.html#cb159-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; subset of 1:p). (If there is only one cluster, clusters can either be a list</span></span>
<span id="cb159-32"><a href="wrapper-functions.html#cb159-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; of length 1 or an integer vector.) All of the provided clusters must be</span></span>
<span id="cb159-33"><a href="wrapper-functions.html#cb159-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; non-overlapping. Every feature not appearing in any cluster will be assumed</span></span>
<span id="cb159-34"><a href="wrapper-functions.html#cb159-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; to be unclustered (that is, they  will be treated as if they are in a</span></span>
<span id="cb159-35"><a href="wrapper-functions.html#cb159-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; &quot;cluster&quot; containing only themselves). If clusters is a list of length 0 (or</span></span>
<span id="cb159-36"><a href="wrapper-functions.html#cb159-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; a list only containing clusters of length 1), then <a href='css.html#css'>css</a>() returns the same</span></span>
<span id="cb159-37"><a href="wrapper-functions.html#cb159-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; results as stability selection (so feat_sel_mat will be identical to</span></span>
<span id="cb159-38"><a href="wrapper-functions.html#cb159-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; clus_sel_mat). Names for the clusters will be needed later; any clusters that</span></span>
<span id="cb159-39"><a href="wrapper-functions.html#cb159-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; are not given names in the list clusters will be given names automatically by</span></span>
<span id="cb159-40"><a href="wrapper-functions.html#cb159-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; css. </span><span class="al">CAUTION</span><span class="co">: if the provided X is a data.frame that contains a categorical</span></span>
<span id="cb159-41"><a href="wrapper-functions.html#cb159-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; feature with more than two levels, then the resulting matrix made from</span></span>
<span id="cb159-42"><a href="wrapper-functions.html#cb159-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; model.matrix will have a different number of columns than the provided</span></span>
<span id="cb159-43"><a href="wrapper-functions.html#cb159-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; data.frame, some of the feature numbers will change, and the clusters</span></span>
<span id="cb159-44"><a href="wrapper-functions.html#cb159-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; argument will not work properly (in the current version of the package). To</span></span>
<span id="cb159-45"><a href="wrapper-functions.html#cb159-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; get correct results in this case, please use model.matrix to convert the</span></span>
<span id="cb159-46"><a href="wrapper-functions.html#cb159-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; data.frame to a numeric matrix on your own, then provide this matrix and</span></span>
<span id="cb159-47"><a href="wrapper-functions.html#cb159-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; cluster assignments with respect to this matrix.Default is list() (so no</span></span>
<span id="cb159-48"><a href="wrapper-functions.html#cb159-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; clusters are specified, and every feature is assumed to be in a &quot;cluster&quot;</span></span>
<span id="cb159-49"><a href="wrapper-functions.html#cb159-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; containing only itself).</span></span>
<span id="cb159-50"><a href="wrapper-functions.html#cb159-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param lambda Optional; the tuning parameter to be used by the lasso for</span></span>
<span id="cb159-51"><a href="wrapper-functions.html#cb159-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; feature selection in each subsample. If lambda is not provided, cssPredict</span></span>
<span id="cb159-52"><a href="wrapper-functions.html#cb159-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; will choose one automatically by cross-validation. Default is NA.</span></span>
<span id="cb159-53"><a href="wrapper-functions.html#cb159-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param cutoff Numeric; getCssPreds will make use only of those clusters with</span></span>
<span id="cb159-54"><a href="wrapper-functions.html#cb159-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; selection proportions equal to at least cutoff. Must be between 0 and 1.</span></span>
<span id="cb159-55"><a href="wrapper-functions.html#cb159-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Default is 0 (in which case either all clusters are used, or max_num_clusts</span></span>
<span id="cb159-56"><a href="wrapper-functions.html#cb159-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; are used, if max_num_clusts is specified).</span></span>
<span id="cb159-57"><a href="wrapper-functions.html#cb159-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param max_num_clusts Integer or numeric; the maximum number of clusters to</span></span>
<span id="cb159-58"><a href="wrapper-functions.html#cb159-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; use regardless of cutoff. (That is, if the chosen cutoff returns more than</span></span>
<span id="cb159-59"><a href="wrapper-functions.html#cb159-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; max_num_clusts clusters, the cutoff will be decreased until at most</span></span>
<span id="cb159-60"><a href="wrapper-functions.html#cb159-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; max_num_clusts clusters are selected.) Default is NA (in which case</span></span>
<span id="cb159-61"><a href="wrapper-functions.html#cb159-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; max_num_clusts is ignored).</span></span>
<span id="cb159-62"><a href="wrapper-functions.html#cb159-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param train_inds Optional; an integer or numeric vector containing the</span></span>
<span id="cb159-63"><a href="wrapper-functions.html#cb159-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; indices of observations in X and y to set aside for model training after</span></span>
<span id="cb159-64"><a href="wrapper-functions.html#cb159-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; feature selection. If train_inds is not provided, half of the data will be</span></span>
<span id="cb159-65"><a href="wrapper-functions.html#cb159-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; used for feature selection and half for model estimation (chosen at random).</span></span>
<span id="cb159-66"><a href="wrapper-functions.html#cb159-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param auto_select_size Logical; if TRUE, then max_num_clusts will be</span></span>
<span id="cb159-67"><a href="wrapper-functions.html#cb159-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; automatically estimated using the lasso with cross-validation. Default is</span></span>
<span id="cb159-68"><a href="wrapper-functions.html#cb159-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; TRUE, though his argument is ignored if either cutoff or max_num_clusts is</span></span>
<span id="cb159-69"><a href="wrapper-functions.html#cb159-69" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; provided. (If desired output is to generate predictions using all clusters,</span></span>
<span id="cb159-70"><a href="wrapper-functions.html#cb159-70" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; you should set auto_select_size to FALSE and do not provide cutoff or</span></span>
<span id="cb159-71"><a href="wrapper-functions.html#cb159-71" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; max_num_clusts.)</span></span>
<span id="cb159-72"><a href="wrapper-functions.html#cb159-72" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return A numeric vector of length nrow(X_test) of predictions</span></span>
<span id="cb159-73"><a href="wrapper-functions.html#cb159-73" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; corresponding to the observations from X_test.</span></span>
<span id="cb159-74"><a href="wrapper-functions.html#cb159-74" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @author Gregory Faletto, Jacob Bien</span></span>
<span id="cb159-75"><a href="wrapper-functions.html#cb159-75" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @export</span></span>
<span id="cb159-76"><a href="wrapper-functions.html#cb159-76" aria-hidden="true" tabindex="-1"></a><span id='cssPredict'>cssPredict</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(X_train_selec, y_train_selec, X_test, <span class="at">clusters=</span><span class="fu">list</span>(),</span>
<span id="cb159-77"><a href="wrapper-functions.html#cb159-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">lambda=</span><span class="cn">NA</span>, <span class="at">cutoff=</span><span class="cn">NA</span>, <span class="at">max_num_clusts=</span><span class="cn">NA</span>, <span class="at">train_inds=</span><span class="cn">NA</span>,</span>
<span id="cb159-78"><a href="wrapper-functions.html#cb159-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">auto_select_size=</span><span class="cn">TRUE</span>){</span>
<span id="cb159-79"><a href="wrapper-functions.html#cb159-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-80"><a href="wrapper-functions.html#cb159-80" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check inputs (most inputs will be checked by called functions)</span></span>
<span id="cb159-81"><a href="wrapper-functions.html#cb159-81" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.numeric</span>(y_train_selec) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.integer</span>(y_train_selec)){</span>
<span id="cb159-82"><a href="wrapper-functions.html#cb159-82" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stop</span>(<span class="st">&quot;The provided y_train_selec must be real-valued, because predictions will be generated by ordinary least squares regression.&quot;</span>)</span>
<span id="cb159-83"><a href="wrapper-functions.html#cb159-83" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb159-84"><a href="wrapper-functions.html#cb159-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-85"><a href="wrapper-functions.html#cb159-85" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="sc">!</span><span class="fu">is.na</span>(auto_select_size))</span>
<span id="cb159-86"><a href="wrapper-functions.html#cb159-86" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(auto_select_size) <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb159-87"><a href="wrapper-functions.html#cb159-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.logical</span>(auto_select_size))</span>
<span id="cb159-88"><a href="wrapper-functions.html#cb159-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-89"><a href="wrapper-functions.html#cb159-89" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.matrix</span>(X_train_selec) <span class="sc">|</span> <span class="fu">is.data.frame</span>(X_train_selec))</span>
<span id="cb159-90"><a href="wrapper-functions.html#cb159-90" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(X_train_selec)))</span>
<span id="cb159-91"><a href="wrapper-functions.html#cb159-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-92"><a href="wrapper-functions.html#cb159-92" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if x is a matrix; if it&#39;s a data.frame, convert to matrix.</span></span>
<span id="cb159-93"><a href="wrapper-functions.html#cb159-93" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">is.data.frame</span>(X_train_selec)){</span>
<span id="cb159-94"><a href="wrapper-functions.html#cb159-94" aria-hidden="true" tabindex="-1"></a>        p <span class="ot">&lt;-</span> <span class="fu">ncol</span>(X_train_selec)</span>
<span id="cb159-95"><a href="wrapper-functions.html#cb159-95" aria-hidden="true" tabindex="-1"></a>        X_train_selec <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">model.matrix</span>(<span class="sc">~</span> ., X_train_selec)</span>
<span id="cb159-96"><a href="wrapper-functions.html#cb159-96" aria-hidden="true" tabindex="-1"></a>        X_train_selec <span class="ot">&lt;-</span> X_train_selec[, <span class="fu">colnames</span>(X_train_selec) <span class="sc">!=</span></span>
<span id="cb159-97"><a href="wrapper-functions.html#cb159-97" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;(Intercept)&quot;</span>]</span>
<span id="cb159-98"><a href="wrapper-functions.html#cb159-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-99"><a href="wrapper-functions.html#cb159-99" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="fu">length</span>(clusters) <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> (p <span class="sc">!=</span> <span class="fu">ncol</span>(X_train_selec))){</span>
<span id="cb159-100"><a href="wrapper-functions.html#cb159-100" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stop</span>(<span class="st">&quot;When stats::model.matrix converted the provided data.frame X_train_selec to a matrix, the number of columns changed (probably because the provided data.frame contained a factor variable with at least three levels). Please convert X_train_selec to a matrix yourself using model.matrix and provide cluster assignments according to the columns of the new matrix.&quot;</span>)</span>
<span id="cb159-101"><a href="wrapper-functions.html#cb159-101" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb159-102"><a href="wrapper-functions.html#cb159-102" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb159-103"><a href="wrapper-functions.html#cb159-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-104"><a href="wrapper-functions.html#cb159-104" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.matrix</span>(X_train_selec))</span>
<span id="cb159-105"><a href="wrapper-functions.html#cb159-105" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(X_train_selec)))</span>
<span id="cb159-106"><a href="wrapper-functions.html#cb159-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-107"><a href="wrapper-functions.html#cb159-107" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(X_train_selec)</span>
<span id="cb159-108"><a href="wrapper-functions.html#cb159-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-109"><a href="wrapper-functions.html#cb159-109" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">any</span>(<span class="fu">is.na</span>(train_inds))){</span>
<span id="cb159-110"><a href="wrapper-functions.html#cb159-110" aria-hidden="true" tabindex="-1"></a>        train_inds <span class="ot">&lt;-</span> <span class="fu">sample</span>(n, <span class="at">size=</span><span class="fu">round</span>(n<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb159-111"><a href="wrapper-functions.html#cb159-111" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb159-112"><a href="wrapper-functions.html#cb159-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-113"><a href="wrapper-functions.html#cb159-113" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">length</span>(lambda) <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb159-114"><a href="wrapper-functions.html#cb159-114" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">is.na</span>(lambda)){</span>
<span id="cb159-115"><a href="wrapper-functions.html#cb159-115" aria-hidden="true" tabindex="-1"></a>        lambda <span class="ot">&lt;-</span> <a href='other-useful.html#getLassoLambda'>getLassoLambda</a>(X_train_selec[<span class="fu">setdiff</span>(<span class="dv">1</span><span class="sc">:</span>n, train_inds), ],</span>
<span id="cb159-116"><a href="wrapper-functions.html#cb159-116" aria-hidden="true" tabindex="-1"></a>            y_train_selec[<span class="fu">setdiff</span>(<span class="dv">1</span><span class="sc">:</span>n, train_inds)]) </span>
<span id="cb159-117"><a href="wrapper-functions.html#cb159-117" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb159-118"><a href="wrapper-functions.html#cb159-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-119"><a href="wrapper-functions.html#cb159-119" aria-hidden="true" tabindex="-1"></a>    css_results <span class="ot">&lt;-</span> <a href='css.html#css'>css</a>(<span class="at">X=</span>X_train_selec, <span class="at">y=</span>y_train_selec, <span class="at">lambda=</span>lambda,</span>
<span id="cb159-120"><a href="wrapper-functions.html#cb159-120" aria-hidden="true" tabindex="-1"></a>        <span class="at">clusters=</span>clusters, <span class="at">train_inds=</span>train_inds)</span>
<span id="cb159-121"><a href="wrapper-functions.html#cb159-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-122"><a href="wrapper-functions.html#cb159-122" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If no indication of how to select model size was provided, choose model</span></span>
<span id="cb159-123"><a href="wrapper-functions.html#cb159-123" aria-hidden="true" tabindex="-1"></a>    <span class="co"># size by cross-validation</span></span>
<span id="cb159-124"><a href="wrapper-functions.html#cb159-124" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">is.na</span>(cutoff) <span class="sc">&amp;</span> <span class="fu">is.na</span>(max_num_clusts)){</span>
<span id="cb159-125"><a href="wrapper-functions.html#cb159-125" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(auto_select_size){</span>
<span id="cb159-126"><a href="wrapper-functions.html#cb159-126" aria-hidden="true" tabindex="-1"></a>            max_num_clusts <span class="ot">&lt;-</span> <a href='other-useful.html#getModelSize'>getModelSize</a>(X_train_selec[train_inds, ],</span>
<span id="cb159-127"><a href="wrapper-functions.html#cb159-127" aria-hidden="true" tabindex="-1"></a>                y_train_selec[train_inds], css_results<span class="sc">$</span>clusters)</span>
<span id="cb159-128"><a href="wrapper-functions.html#cb159-128" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb159-129"><a href="wrapper-functions.html#cb159-129" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb159-130"><a href="wrapper-functions.html#cb159-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-131"><a href="wrapper-functions.html#cb159-131" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">is.na</span>(cutoff)){</span>
<span id="cb159-132"><a href="wrapper-functions.html#cb159-132" aria-hidden="true" tabindex="-1"></a>        cutoff <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb159-133"><a href="wrapper-functions.html#cb159-133" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb159-134"><a href="wrapper-functions.html#cb159-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-135"><a href="wrapper-functions.html#cb159-135" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get predictions</span></span>
<span id="cb159-136"><a href="wrapper-functions.html#cb159-136" aria-hidden="true" tabindex="-1"></a>    <a href='sel-and-pred.html#getCssPreds'>getCssPreds</a>(css_results, <span class="at">testX=</span>X_test, <span class="at">weighting=</span><span class="st">&quot;weighted_avg&quot;</span>,</span>
<span id="cb159-137"><a href="wrapper-functions.html#cb159-137" aria-hidden="true" tabindex="-1"></a>        <span class="at">cutoff=</span>cutoff, <span class="at">max_num_clusts=</span>max_num_clusts)</span>
<span id="cb159-138"><a href="wrapper-functions.html#cb159-138" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Tests for <code><a href='wrapper-functions.html#cssPredict'>cssPredict</a>()</code>:</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="wrapper-functions.html#cb160-1" aria-hidden="true" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">test_that</span>(<span class="st">&quot;cssPredict works&quot;</span>, {</span>
<span id="cb160-2"><a href="wrapper-functions.html#cb160-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">84231</span>)</span>
<span id="cb160-3"><a href="wrapper-functions.html#cb160-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb160-4"><a href="wrapper-functions.html#cb160-4" aria-hidden="true" tabindex="-1"></a>  train_data <span class="ot">&lt;-</span> <a href='other-useful.html#genClusteredData'>genClusteredData</a>(<span class="at">n=</span><span class="dv">30</span>, <span class="at">p=</span><span class="dv">11</span>, <span class="at">k_unclustered=</span><span class="dv">2</span>, <span class="at">cluster_size=</span><span class="dv">3</span>,</span>
<span id="cb160-5"><a href="wrapper-functions.html#cb160-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">n_clusters=</span><span class="dv">2</span>, <span class="at">sig_clusters=</span><span class="dv">1</span>, <span class="at">sigma_eps_sq=</span><span class="dv">1</span>)</span>
<span id="cb160-6"><a href="wrapper-functions.html#cb160-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb160-7"><a href="wrapper-functions.html#cb160-7" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> train_data<span class="sc">$</span>X</span>
<span id="cb160-8"><a href="wrapper-functions.html#cb160-8" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> train_data<span class="sc">$</span>y</span>
<span id="cb160-9"><a href="wrapper-functions.html#cb160-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb160-10"><a href="wrapper-functions.html#cb160-10" aria-hidden="true" tabindex="-1"></a>  test_x <span class="ot">&lt;-</span> <a href='other-useful.html#genClusteredData'>genClusteredData</a>(<span class="at">n=</span><span class="dv">5</span>, <span class="at">p=</span><span class="dv">11</span>, <span class="at">k_unclustered=</span><span class="dv">2</span>, <span class="at">cluster_size=</span><span class="dv">3</span>,</span>
<span id="cb160-11"><a href="wrapper-functions.html#cb160-11" aria-hidden="true" tabindex="-1"></a>                          <span class="at">n_clusters=</span><span class="dv">2</span>, <span class="at">sig_clusters=</span><span class="dv">1</span>, <span class="at">sigma_eps_sq=</span><span class="dv">1</span>)<span class="sc">$</span>X</span>
<span id="cb160-12"><a href="wrapper-functions.html#cb160-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb160-13"><a href="wrapper-functions.html#cb160-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Intentionally don&#39;t provide clusters for all features, mix up formatting,</span></span>
<span id="cb160-14"><a href="wrapper-functions.html#cb160-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># etc.</span></span>
<span id="cb160-15"><a href="wrapper-functions.html#cb160-15" aria-hidden="true" tabindex="-1"></a>  good_clusters <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">red_cluster=</span>1L<span class="sc">:</span>3L, <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb160-16"><a href="wrapper-functions.html#cb160-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb160-17"><a href="wrapper-functions.html#cb160-17" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='wrapper-functions.html#cssPredict'>cssPredict</a>(<span class="at">X_train_selec=</span>x, <span class="at">y_train_selec=</span>y, <span class="at">X_test=</span>test_x,</span>
<span id="cb160-18"><a href="wrapper-functions.html#cb160-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">clusters=</span>good_clusters)</span>
<span id="cb160-19"><a href="wrapper-functions.html#cb160-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb160-20"><a href="wrapper-functions.html#cb160-20" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(res)))</span>
<span id="cb160-21"><a href="wrapper-functions.html#cb160-21" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res))</span>
<span id="cb160-22"><a href="wrapper-functions.html#cb160-22" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), <span class="dv">5</span>)</span>
<span id="cb160-23"><a href="wrapper-functions.html#cb160-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb160-24"><a href="wrapper-functions.html#cb160-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># No provided clusters</span></span>
<span id="cb160-25"><a href="wrapper-functions.html#cb160-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-26"><a href="wrapper-functions.html#cb160-26" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='wrapper-functions.html#cssPredict'>cssPredict</a>(<span class="at">X_train_selec=</span>x, <span class="at">y_train_selec=</span>y, <span class="at">X_test=</span>test_x)</span>
<span id="cb160-27"><a href="wrapper-functions.html#cb160-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-28"><a href="wrapper-functions.html#cb160-28" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(res)))</span>
<span id="cb160-29"><a href="wrapper-functions.html#cb160-29" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res))</span>
<span id="cb160-30"><a href="wrapper-functions.html#cb160-30" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), <span class="dv">5</span>)</span>
<span id="cb160-31"><a href="wrapper-functions.html#cb160-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb160-32"><a href="wrapper-functions.html#cb160-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Provide training indices</span></span>
<span id="cb160-33"><a href="wrapper-functions.html#cb160-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb160-34"><a href="wrapper-functions.html#cb160-34" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='wrapper-functions.html#cssPredict'>cssPredict</a>(<span class="at">X_train_selec=</span>x, <span class="at">y_train_selec=</span>y, <span class="at">X_test=</span>test_x,</span>
<span id="cb160-35"><a href="wrapper-functions.html#cb160-35" aria-hidden="true" tabindex="-1"></a>                    <span class="at">train_inds=</span><span class="dv">13</span><span class="sc">:</span><span class="dv">28</span>)</span>
<span id="cb160-36"><a href="wrapper-functions.html#cb160-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb160-37"><a href="wrapper-functions.html#cb160-37" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(res)))</span>
<span id="cb160-38"><a href="wrapper-functions.html#cb160-38" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res))</span>
<span id="cb160-39"><a href="wrapper-functions.html#cb160-39" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), <span class="dv">5</span>)</span>
<span id="cb160-40"><a href="wrapper-functions.html#cb160-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-41"><a href="wrapper-functions.html#cb160-41" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Trying other inputs</span></span>
<span id="cb160-42"><a href="wrapper-functions.html#cb160-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-43"><a href="wrapper-functions.html#cb160-43" aria-hidden="true" tabindex="-1"></a>  <span class="co"># X as a data.frame</span></span>
<span id="cb160-44"><a href="wrapper-functions.html#cb160-44" aria-hidden="true" tabindex="-1"></a>  X_df <span class="ot">&lt;-</span> datasets<span class="sc">::</span>mtcars</span>
<span id="cb160-45"><a href="wrapper-functions.html#cb160-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb160-46"><a href="wrapper-functions.html#cb160-46" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(X_df)</span>
<span id="cb160-47"><a href="wrapper-functions.html#cb160-47" aria-hidden="true" tabindex="-1"></a>  test_inds <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">round</span>(n<span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb160-48"><a href="wrapper-functions.html#cb160-48" aria-hidden="true" tabindex="-1"></a>  n_test <span class="ot">&lt;-</span> <span class="fu">length</span>(test_inds)</span>
<span id="cb160-49"><a href="wrapper-functions.html#cb160-49" aria-hidden="true" tabindex="-1"></a>  selec_train_inds <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="dv">1</span><span class="sc">:</span>n, test_inds)</span>
<span id="cb160-50"><a href="wrapper-functions.html#cb160-50" aria-hidden="true" tabindex="-1"></a>  n_selec_train <span class="ot">&lt;-</span> <span class="fu">length</span>(selec_train_inds)</span>
<span id="cb160-51"><a href="wrapper-functions.html#cb160-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-52"><a href="wrapper-functions.html#cb160-52" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='wrapper-functions.html#cssPredict'>cssPredict</a>(<span class="at">X_train_selec=</span>X_df[selec_train_inds, ],</span>
<span id="cb160-53"><a href="wrapper-functions.html#cb160-53" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y_train_selec=</span>stats<span class="sc">::</span><span class="fu">rnorm</span>(n_selec_train),</span>
<span id="cb160-54"><a href="wrapper-functions.html#cb160-54" aria-hidden="true" tabindex="-1"></a>                    <span class="at">X_test=</span>X_df[test_inds, ])</span>
<span id="cb160-55"><a href="wrapper-functions.html#cb160-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb160-56"><a href="wrapper-functions.html#cb160-56" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(res)))</span>
<span id="cb160-57"><a href="wrapper-functions.html#cb160-57" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res))</span>
<span id="cb160-58"><a href="wrapper-functions.html#cb160-58" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), n_test)</span>
<span id="cb160-59"><a href="wrapper-functions.html#cb160-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-60"><a href="wrapper-functions.html#cb160-60" aria-hidden="true" tabindex="-1"></a>  <span class="co"># X as a dataframe with factors (number of columns of final design matrix</span></span>
<span id="cb160-61"><a href="wrapper-functions.html#cb160-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># after one-hot encoding factors won&#39;t match number of columns of df2)</span></span>
<span id="cb160-62"><a href="wrapper-functions.html#cb160-62" aria-hidden="true" tabindex="-1"></a>  <span class="co"># cyl, gear, and carb are factors with more than 2 levels</span></span>
<span id="cb160-63"><a href="wrapper-functions.html#cb160-63" aria-hidden="true" tabindex="-1"></a>  df2 <span class="ot">&lt;-</span> X_df</span>
<span id="cb160-64"><a href="wrapper-functions.html#cb160-64" aria-hidden="true" tabindex="-1"></a>  df2<span class="sc">$</span>cyl <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df2<span class="sc">$</span>cyl)</span>
<span id="cb160-65"><a href="wrapper-functions.html#cb160-65" aria-hidden="true" tabindex="-1"></a>  df2<span class="sc">$</span>vs <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df2<span class="sc">$</span>vs)</span>
<span id="cb160-66"><a href="wrapper-functions.html#cb160-66" aria-hidden="true" tabindex="-1"></a>  df2<span class="sc">$</span>am <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df2<span class="sc">$</span>am)</span>
<span id="cb160-67"><a href="wrapper-functions.html#cb160-67" aria-hidden="true" tabindex="-1"></a>  df2<span class="sc">$</span>gear <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df2<span class="sc">$</span>gear)</span>
<span id="cb160-68"><a href="wrapper-functions.html#cb160-68" aria-hidden="true" tabindex="-1"></a>  df2<span class="sc">$</span>carb <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df2<span class="sc">$</span>carb)</span>
<span id="cb160-69"><a href="wrapper-functions.html#cb160-69" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb160-70"><a href="wrapper-functions.html#cb160-70" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Should get error if clusters are provided because df2 contains factors with</span></span>
<span id="cb160-71"><a href="wrapper-functions.html#cb160-71" aria-hidden="true" tabindex="-1"></a>  <span class="co"># more than two levels</span></span>
<span id="cb160-72"><a href="wrapper-functions.html#cb160-72" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='wrapper-functions.html#cssPredict'>cssPredict</a>(<span class="at">X_train_selec=</span>df2[selec_train_inds, ],</span>
<span id="cb160-73"><a href="wrapper-functions.html#cb160-73" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">y_train_selec=</span>stats<span class="sc">::</span><span class="fu">rnorm</span>(n_selec_train),</span>
<span id="cb160-74"><a href="wrapper-functions.html#cb160-74" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">X_test=</span>df2[test_inds, ], <span class="at">clusters=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>),</span>
<span id="cb160-75"><a href="wrapper-functions.html#cb160-75" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;When stats::model.matrix converted the provided data.frame X_train_selec to a matrix, the number of columns changed (probably because the provided data.frame contained a factor variable with at least three levels). Please convert X_train_selec to a matrix yourself using model.matrix and provide cluster assignments according to the columns of the new matrix.&quot;</span>,</span>
<span id="cb160-76"><a href="wrapper-functions.html#cb160-76" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb160-77"><a href="wrapper-functions.html#cb160-77" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb160-78"><a href="wrapper-functions.html#cb160-78" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Should be fine if no clusters are provided</span></span>
<span id="cb160-79"><a href="wrapper-functions.html#cb160-79" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='wrapper-functions.html#cssPredict'>cssPredict</a>(<span class="at">X_train_selec=</span>df2[selec_train_inds, ],</span>
<span id="cb160-80"><a href="wrapper-functions.html#cb160-80" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y_train_selec=</span>stats<span class="sc">::</span><span class="fu">rnorm</span>(n_selec_train),</span>
<span id="cb160-81"><a href="wrapper-functions.html#cb160-81" aria-hidden="true" tabindex="-1"></a>                    <span class="at">X_test=</span>df2[test_inds, ])</span>
<span id="cb160-82"><a href="wrapper-functions.html#cb160-82" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb160-83"><a href="wrapper-functions.html#cb160-83" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(res)))</span>
<span id="cb160-84"><a href="wrapper-functions.html#cb160-84" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res))</span>
<span id="cb160-85"><a href="wrapper-functions.html#cb160-85" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), n_test)</span>
<span id="cb160-86"><a href="wrapper-functions.html#cb160-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-87"><a href="wrapper-functions.html#cb160-87" aria-hidden="true" tabindex="-1"></a>  <span class="co"># X as a matrix with column names</span></span>
<span id="cb160-88"><a href="wrapper-functions.html#cb160-88" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> x</span>
<span id="cb160-89"><a href="wrapper-functions.html#cb160-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(x2) <span class="ot">&lt;-</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>]</span>
<span id="cb160-90"><a href="wrapper-functions.html#cb160-90" aria-hidden="true" tabindex="-1"></a>  test_x2 <span class="ot">&lt;-</span> test_x</span>
<span id="cb160-91"><a href="wrapper-functions.html#cb160-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(test_x2) <span class="ot">&lt;-</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>]</span>
<span id="cb160-92"><a href="wrapper-functions.html#cb160-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-93"><a href="wrapper-functions.html#cb160-93" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='wrapper-functions.html#cssPredict'>cssPredict</a>(<span class="at">X_train_selec=</span>x2, <span class="at">y_train_selec=</span>y, <span class="at">X_test=</span>test_x2,</span>
<span id="cb160-94"><a href="wrapper-functions.html#cb160-94" aria-hidden="true" tabindex="-1"></a>                    <span class="at">clusters=</span>good_clusters)</span>
<span id="cb160-95"><a href="wrapper-functions.html#cb160-95" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb160-96"><a href="wrapper-functions.html#cb160-96" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(res)))</span>
<span id="cb160-97"><a href="wrapper-functions.html#cb160-97" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res))</span>
<span id="cb160-98"><a href="wrapper-functions.html#cb160-98" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), <span class="dv">5</span>)</span>
<span id="cb160-99"><a href="wrapper-functions.html#cb160-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-100"><a href="wrapper-functions.html#cb160-100" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Vary inputs</span></span>
<span id="cb160-101"><a href="wrapper-functions.html#cb160-101" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='wrapper-functions.html#cssPredict'>cssPredict</a>(<span class="at">X_train_selec=</span>x, <span class="at">y_train_selec=</span>y, <span class="at">X_test=</span>test_x,</span>
<span id="cb160-102"><a href="wrapper-functions.html#cb160-102" aria-hidden="true" tabindex="-1"></a>                    <span class="at">lambda=</span><span class="fl">0.01</span>)</span>
<span id="cb160-103"><a href="wrapper-functions.html#cb160-103" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb160-104"><a href="wrapper-functions.html#cb160-104" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(res)))</span>
<span id="cb160-105"><a href="wrapper-functions.html#cb160-105" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res))</span>
<span id="cb160-106"><a href="wrapper-functions.html#cb160-106" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), <span class="dv">5</span>)</span>
<span id="cb160-107"><a href="wrapper-functions.html#cb160-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-108"><a href="wrapper-functions.html#cb160-108" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='wrapper-functions.html#cssPredict'>cssPredict</a>(<span class="at">X_train_selec=</span>x, <span class="at">y_train_selec=</span>y, <span class="at">X_test=</span>test_x, <span class="at">cutoff=</span><span class="fl">0.6</span>)</span>
<span id="cb160-109"><a href="wrapper-functions.html#cb160-109" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb160-110"><a href="wrapper-functions.html#cb160-110" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(res)))</span>
<span id="cb160-111"><a href="wrapper-functions.html#cb160-111" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res))</span>
<span id="cb160-112"><a href="wrapper-functions.html#cb160-112" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), <span class="dv">5</span>)</span>
<span id="cb160-113"><a href="wrapper-functions.html#cb160-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-114"><a href="wrapper-functions.html#cb160-114" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='wrapper-functions.html#cssPredict'>cssPredict</a>(<span class="at">X_train_selec=</span>x, <span class="at">y_train_selec=</span>y, <span class="at">X_test=</span>test_x,</span>
<span id="cb160-115"><a href="wrapper-functions.html#cb160-115" aria-hidden="true" tabindex="-1"></a>                    <span class="at">max_num_clusts=</span><span class="dv">6</span>)</span>
<span id="cb160-116"><a href="wrapper-functions.html#cb160-116" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb160-117"><a href="wrapper-functions.html#cb160-117" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(res)))</span>
<span id="cb160-118"><a href="wrapper-functions.html#cb160-118" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res))</span>
<span id="cb160-119"><a href="wrapper-functions.html#cb160-119" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), <span class="dv">5</span>)</span>
<span id="cb160-120"><a href="wrapper-functions.html#cb160-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-121"><a href="wrapper-functions.html#cb160-121" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <a href='wrapper-functions.html#cssPredict'>cssPredict</a>(<span class="at">X_train_selec=</span>x, <span class="at">y_train_selec=</span>y, <span class="at">X_test=</span>test_x,</span>
<span id="cb160-122"><a href="wrapper-functions.html#cb160-122" aria-hidden="true" tabindex="-1"></a>                    <span class="at">auto_select_size=</span><span class="cn">FALSE</span>)</span>
<span id="cb160-123"><a href="wrapper-functions.html#cb160-123" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb160-124"><a href="wrapper-functions.html#cb160-124" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(res)))</span>
<span id="cb160-125"><a href="wrapper-functions.html#cb160-125" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">is.numeric</span>(res))</span>
<span id="cb160-126"><a href="wrapper-functions.html#cb160-126" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_equal</span>(<span class="fu">length</span>(res), <span class="dv">5</span>)</span>
<span id="cb160-127"><a href="wrapper-functions.html#cb160-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-128"><a href="wrapper-functions.html#cb160-128" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Bad inputs</span></span>
<span id="cb160-129"><a href="wrapper-functions.html#cb160-129" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='wrapper-functions.html#cssPredict'>cssPredict</a>(<span class="at">X_train_selec=</span>x[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, ], <span class="at">y_train_selec=</span>y,</span>
<span id="cb160-130"><a href="wrapper-functions.html#cb160-130" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">X_test=</span>test_x),</span>
<span id="cb160-131"><a href="wrapper-functions.html#cb160-131" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;length(y) == n is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb160-132"><a href="wrapper-functions.html#cb160-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-133"><a href="wrapper-functions.html#cb160-133" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='wrapper-functions.html#cssPredict'>cssPredict</a>(<span class="at">X_train_selec=</span><span class="fu">character</span>(<span class="dv">30</span>),</span>
<span id="cb160-134"><a href="wrapper-functions.html#cb160-134" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">y_train_selec=</span>y, <span class="at">X_test=</span>test_x),</span>
<span id="cb160-135"><a href="wrapper-functions.html#cb160-135" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;is.matrix(X_train_selec) | is.data.frame(X_train_selec) is not TRUE&quot;</span>,</span>
<span id="cb160-136"><a href="wrapper-functions.html#cb160-136" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb160-137"><a href="wrapper-functions.html#cb160-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-138"><a href="wrapper-functions.html#cb160-138" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='wrapper-functions.html#cssPredict'>cssPredict</a>(<span class="at">X_train_selec=</span>x,</span>
<span id="cb160-139"><a href="wrapper-functions.html#cb160-139" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">y_train_selec=</span><span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>, <span class="dv">10</span>, <span class="dv">3</span>),</span>
<span id="cb160-140"><a href="wrapper-functions.html#cb160-140" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">X_test=</span>test_x), <span class="st">&quot;!is.matrix(y) is not TRUE&quot;</span>,</span>
<span id="cb160-141"><a href="wrapper-functions.html#cb160-141" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb160-142"><a href="wrapper-functions.html#cb160-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-143"><a href="wrapper-functions.html#cb160-143" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='wrapper-functions.html#cssPredict'>cssPredict</a>(<span class="at">X_train_selec=</span>x,</span>
<span id="cb160-144"><a href="wrapper-functions.html#cb160-144" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">y_train_selec=</span><span class="fu">factor</span>(<span class="fu">rbinom</span>(<span class="dv">30</span>, <span class="at">size=</span><span class="dv">1</span>,</span>
<span id="cb160-145"><a href="wrapper-functions.html#cb160-145" aria-hidden="true" tabindex="-1"></a>                                                                <span class="at">prob=</span>.<span class="dv">5</span>)),</span>
<span id="cb160-146"><a href="wrapper-functions.html#cb160-146" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">X_test=</span>test_x),</span>
<span id="cb160-147"><a href="wrapper-functions.html#cb160-147" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;The provided y_train_selec must be real-valued, because predictions will be generated by ordinary least squares regression.&quot;</span>,</span>
<span id="cb160-148"><a href="wrapper-functions.html#cb160-148" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb160-149"><a href="wrapper-functions.html#cb160-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-150"><a href="wrapper-functions.html#cb160-150" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='wrapper-functions.html#cssPredict'>cssPredict</a>(<span class="at">X_train_selec=</span>x, <span class="at">y_train_selec=</span>y,</span>
<span id="cb160-151"><a href="wrapper-functions.html#cb160-151" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">X_test=</span>test_x, <span class="at">clusters=</span><span class="st">&quot;clusters&quot;</span>),</span>
<span id="cb160-152"><a href="wrapper-functions.html#cb160-152" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;is.numeric(clusters) | is.integer(clusters) is not TRUE&quot;</span>,</span>
<span id="cb160-153"><a href="wrapper-functions.html#cb160-153" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb160-154"><a href="wrapper-functions.html#cb160-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-155"><a href="wrapper-functions.html#cb160-155" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='wrapper-functions.html#cssPredict'>cssPredict</a>(<span class="at">X_train_selec=</span>x, <span class="at">y_train_selec=</span>y,</span>
<span id="cb160-156"><a href="wrapper-functions.html#cb160-156" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">X_test=</span>test_x, <span class="at">lambda=</span><span class="st">&quot;lambda&quot;</span>),</span>
<span id="cb160-157"><a href="wrapper-functions.html#cb160-157" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;For method cssLasso, lambda must be a numeric.&quot;</span>,</span>
<span id="cb160-158"><a href="wrapper-functions.html#cb160-158" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb160-159"><a href="wrapper-functions.html#cb160-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-160"><a href="wrapper-functions.html#cb160-160" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='wrapper-functions.html#cssPredict'>cssPredict</a>(<span class="at">X_train_selec=</span>x, <span class="at">y_train_selec=</span>y,</span>
<span id="cb160-161"><a href="wrapper-functions.html#cb160-161" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">X_test=</span>test_x, <span class="at">cutoff=</span><span class="sc">-</span>.<span class="dv">1</span>),</span>
<span id="cb160-162"><a href="wrapper-functions.html#cb160-162" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;cutoff &gt;= 0 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb160-163"><a href="wrapper-functions.html#cb160-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-164"><a href="wrapper-functions.html#cb160-164" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='wrapper-functions.html#cssPredict'>cssPredict</a>(<span class="at">X_train_selec=</span>x, <span class="at">y_train_selec=</span>y,</span>
<span id="cb160-165"><a href="wrapper-functions.html#cb160-165" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">X_test=</span>test_x, <span class="at">max_num_clusts=</span><span class="dv">0</span>),</span>
<span id="cb160-166"><a href="wrapper-functions.html#cb160-166" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;max_num_clusts &gt;= 1 is not TRUE&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb160-167"><a href="wrapper-functions.html#cb160-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-168"><a href="wrapper-functions.html#cb160-168" aria-hidden="true" tabindex="-1"></a>  testthat<span class="sc">::</span><span class="fu">expect_error</span>(<a href='wrapper-functions.html#cssPredict'>cssPredict</a>(<span class="at">X_train_selec=</span>x, <span class="at">y_train_selec=</span>y,</span>
<span id="cb160-169"><a href="wrapper-functions.html#cb160-169" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">X_test=</span>test_x, <span class="at">auto_select_size=</span><span class="fu">c</span>(<span class="cn">TRUE</span>,</span>
<span id="cb160-170"><a href="wrapper-functions.html#cb160-170" aria-hidden="true" tabindex="-1"></a>                                                                      <span class="cn">FALSE</span>)),</span>
<span id="cb160-171"><a href="wrapper-functions.html#cb160-171" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;length(auto_select_size) == 1 is not TRUE&quot;</span>,</span>
<span id="cb160-172"><a href="wrapper-functions.html#cb160-172" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb160-173"><a href="wrapper-functions.html#cb160-173" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## ── Warning (&#39;&lt;text&gt;:17&#39;): cssPredict works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='wrapper-functions.html#cssPredict'>cssPredict</a>(...)
##  2. litr (local) <a href='other-useful.html#getLassoLambda'>getLassoLambda</a>(...)
##  3. glmnet::cv.glmnet(...)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:17&#39;): cssPredict works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='wrapper-functions.html#cssPredict'>cssPredict</a>(...)
##  2. litr (local) <a href='other-useful.html#getModelSize'>getModelSize</a>(...)
##  3. glmnet::cv.glmnet(x = X_size, y = y, family = &quot;gaussian&quot;)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:26&#39;): cssPredict works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='wrapper-functions.html#cssPredict'>cssPredict</a>(X_train_selec = x, y_train_selec = y, X_test = test_x)
##  2. litr (local) <a href='other-useful.html#getLassoLambda'>getLassoLambda</a>(...)
##  3. glmnet::cv.glmnet(...)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:26&#39;): cssPredict works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='wrapper-functions.html#cssPredict'>cssPredict</a>(X_train_selec = x, y_train_selec = y, X_test = test_x)
##  2. litr (local) <a href='other-useful.html#getModelSize'>getModelSize</a>(...)
##  3. glmnet::cv.glmnet(x = X_size, y = y, family = &quot;gaussian&quot;)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:34&#39;): cssPredict works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='wrapper-functions.html#cssPredict'>cssPredict</a>(...)
##  2. litr (local) <a href='other-useful.html#getLassoLambda'>getLassoLambda</a>(...)
##  3. glmnet::cv.glmnet(...)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:34&#39;): cssPredict works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='wrapper-functions.html#cssPredict'>cssPredict</a>(...)
##  2. litr (local) <a href='other-useful.html#getModelSize'>getModelSize</a>(...)
##  3. glmnet::cv.glmnet(x = X_size, y = y, family = &quot;gaussian&quot;)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:52&#39;): cssPredict works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='wrapper-functions.html#cssPredict'>cssPredict</a>(...)
##  2. litr (local) <a href='other-useful.html#getLassoLambda'>getLassoLambda</a>(...)
##  3. glmnet::cv.glmnet(...)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:52&#39;): cssPredict works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='wrapper-functions.html#cssPredict'>cssPredict</a>(...)
##  2. litr (local) <a href='other-useful.html#getModelSize'>getModelSize</a>(...)
##  3. glmnet::cv.glmnet(x = X_size, y = y, family = &quot;gaussian&quot;)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:79&#39;): cssPredict works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='wrapper-functions.html#cssPredict'>cssPredict</a>(...)
##  2. litr (local) <a href='other-useful.html#getLassoLambda'>getLassoLambda</a>(...)
##  3. glmnet::cv.glmnet(...)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:79&#39;): cssPredict works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='wrapper-functions.html#cssPredict'>cssPredict</a>(...)
##  2. litr (local) <a href='other-useful.html#getModelSize'>getModelSize</a>(...)
##  3. glmnet::cv.glmnet(x = X_size, y = y, family = &quot;gaussian&quot;)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:93&#39;): cssPredict works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='wrapper-functions.html#cssPredict'>cssPredict</a>(...)
##  2. litr (local) <a href='other-useful.html#getLassoLambda'>getLassoLambda</a>(...)
##  3. glmnet::cv.glmnet(...)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:93&#39;): cssPredict works ─────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='wrapper-functions.html#cssPredict'>cssPredict</a>(...)
##  2. litr (local) <a href='other-useful.html#getModelSize'>getModelSize</a>(...)
##  3. glmnet::cv.glmnet(x = X_size, y = y, family = &quot;gaussian&quot;)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:101&#39;): cssPredict works ────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='wrapper-functions.html#cssPredict'>cssPredict</a>(...)
##  2. litr (local) <a href='other-useful.html#getModelSize'>getModelSize</a>(...)
##  3. glmnet::cv.glmnet(x = X_size, y = y, family = &quot;gaussian&quot;)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:108&#39;): cssPredict works ────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='wrapper-functions.html#cssPredict'>cssPredict</a>(...)
##  2. litr (local) <a href='other-useful.html#getLassoLambda'>getLassoLambda</a>(...)
##  3. glmnet::cv.glmnet(...)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:114&#39;): cssPredict works ────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='wrapper-functions.html#cssPredict'>cssPredict</a>(...)
##  2. litr (local) <a href='other-useful.html#getLassoLambda'>getLassoLambda</a>(...)
##  3. glmnet::cv.glmnet(...)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:121&#39;): cssPredict works ────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##  1. litr (local) <a href='wrapper-functions.html#cssPredict'>cssPredict</a>(...)
##  2. litr (local) <a href='other-useful.html#getLassoLambda'>getLassoLambda</a>(...)
##  3. glmnet::cv.glmnet(...)
##  4. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:129&#39;): cssPredict works ────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##   1. testthat::expect_error(...)
##   7. litr (local) <a href='wrapper-functions.html#cssPredict'>cssPredict</a>(X_train_selec = x[1:10, ], y_train_selec = y, X_test = test_x)
##   8. litr (local) <a href='other-useful.html#getLassoLambda'>getLassoLambda</a>(...)
##   9. glmnet::cv.glmnet(...)
##  10. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:138&#39;): cssPredict works ────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##   1. testthat::expect_error(...)
##   7. litr (local) <a href='wrapper-functions.html#cssPredict'>cssPredict</a>(...)
##   8. litr (local) <a href='other-useful.html#getLassoLambda'>getLassoLambda</a>(...)
##   9. glmnet::cv.glmnet(...)
##  10. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:150&#39;): cssPredict works ────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##   1. testthat::expect_error(...)
##   7. litr (local) <a href='wrapper-functions.html#cssPredict'>cssPredict</a>(...)
##   8. litr (local) <a href='other-useful.html#getLassoLambda'>getLassoLambda</a>(...)
##   9. glmnet::cv.glmnet(...)
##  10. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:160&#39;): cssPredict works ────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##   1. testthat::expect_error(...)
##   7. litr (local) <a href='wrapper-functions.html#cssPredict'>cssPredict</a>(...)
##   8. litr (local) <a href='other-useful.html#getLassoLambda'>getLassoLambda</a>(...)
##   9. glmnet::cv.glmnet(...)
##  10. glmnet:::cv.glmnet.raw(...)
## 
## ── Warning (&#39;&lt;text&gt;:164&#39;): cssPredict works ────────────────────────────────────
## Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold
## Backtrace:
##   1. testthat::expect_error(...)
##   7. litr (local) <a href='wrapper-functions.html#cssPredict'>cssPredict</a>(...)
##   8. litr (local) <a href='other-useful.html#getLassoLambda'>getLassoLambda</a>(...)
##   9. glmnet::cv.glmnet(...)
##  10. glmnet:::cv.glmnet.raw(...)</code></pre>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="other-useful.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="competitor-methods.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
